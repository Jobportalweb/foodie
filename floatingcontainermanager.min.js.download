(globalThis.wordOnlineChunks=globalThis.wordOnlineChunks||[]).push([[85215],{50103:function(t,e,n){"use strict";n.r(e),n.d(e,{FactoryGlobal:function(){return Rt}});var i,o,r,a,s=n(5069),c=n(69702);function d(t){switch(t){case i.CommentThread:return s.cM.CommentThread;case i.TrackedChange:return s.cM.TrackedChange;default:return s.cM.CommentThread}}!function(t){t[t.CommentThread=0]="CommentThread",t[t.TrackedChange=1]="TrackedChange"}(i||(i={})),function(t){t[t.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry"}(o||(o={})),function(t){t[t.Error=10]="Error",t[t.Warning=15]="Warning",t[t.Info=50]="Info",t[t.Verbose=100]="Verbose",t[t.Spam=200]="Spam"}(r||(r={})),function(t){t[t.containerVirtualizationEnabled=0]="containerVirtualizationEnabled"}(a||(a={}));var l,h=function(){function t(t,e,n){void 0===n&&(n=0),this.disableRepositioningAnimation=!1,this.positionFixed=!1,this.anchorLeft=0,this.shouldUpdatePositions=!1,this.aggregateHeight=0,this.possibleTopForNextContainer=0,this.renderMode=s.G9.Integrated,this.constructContainerId=t,this.ulsLogger=e,this.activeContainerAnchorLeft=n}return t.prototype.getAggregateHeight=function(){return this.aggregateHeight},t.prototype.calculateNewPositions=function(t,e,n){this.disableRepositioningAnimation=!!n&&!!n.disableRepositioningAnimation,this.positionFixed=!!n&&!!n.positionFixed,this.shouldUpdatePositions=!n||!1!==n.shouldUpdatePositions;var i=t[0];if(this.anchorLeft=i&&i.anchorLeft?i.anchorLeft:0,n&&n.activeContainerInfo){var o=n.activeContainerInfo;this.updateContainerPositionsAroundActiveContainer(t,e,o)}else{var r=n?n.topOfFirstContainer:void 0;this.setRestPositionOfContainers(t,e,r)}},t.prototype.updateContainersPositions=function(t,e,n){this.calculateNewPositions(t,e,n)},t.prototype.updateContainerPositionsAroundActiveContainer=function(t,e,n){var i=e[n.containerId];if(i){var a=i.floatingContainerRef,s=this.shouldUpdatePositions&&a?a.height():i.position.height;this.shouldUpdatePositions&&a&&(a.anchorPoint().y!==i.anchorTop||a.anchorPoint().x!==this.activeContainerAnchorLeft)&&a.updateContainerPosition({anchorPoint:{x:this.activeContainerAnchorLeft,y:i.anchorTop},disableRepositioningAnimation:this.disableRepositioningAnimation,positionFixed:this.positionFixed}),this.updateFloatingContainerPositionInCache(e,n.containerId,(0,c.Cl)((0,c.Cl)({},i.position),{x:this.activeContainerAnchorLeft,y:i.anchorTop})),this.updateContainerPositionsAboveActiveContainer(t,e,i.anchorTop,n.containerPositionIndex-1),this.possibleTopForNextContainer=this.getBottomPositionOfContainer(i,i.anchorTop,s),this.updateContainerPositionsDownwards(t,e,n.containerPositionIndex+1),this.aggregateHeight=n.containerPositionIndex===t.length-1?s+i.anchorTop:this.aggregateHeight}else this.ulsLogger.sendTraceTag(595358743,o.msoulscat_Wac_Telemetry,r.Error,"Floating container info does not exist for the active container Id: ".concat(n.containerId))},t.prototype.updateContainerPositionsDownwards=function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=!1);for(var o={},r=n;r<t.length;r+=1)if((a=t[r])&&a.contentId){if(!(s=this.getFloatingContainerInfo(a,e)))continue;o[a.contentId]=this.shouldUpdatePositions&&s.floatingContainerRef?s.floatingContainerRef.height():s.position.height}for(r=n;r<t.length;r+=1){var a,s=this.getFloatingContainerInfo(t[r],e),c=(a=t[r])&&a.contentId;if(void 0===s||!c)return;var d=this.updateFloatingContainerPosition(t[r],e,o[c]);if(r===t.length-1&&s&&(this.aggregateHeight=o[c]+s.position.y),i&&d)return}},t.prototype.updateContainerPositionsAboveActiveContainer=function(t,e,n,i){var o=t[0]?t[0].anchorTop:void 0;this.setRestPositionOfContainers(t.slice(0,i+1),e,o);for(var r=n,a=i;a>=0;a-=1){var s=this.getFloatingContainerInfo(t[a],e);if(void 0===s||this.getBottomPositionOfContainer(s)<=r)return;var d=s.floatingContainerRef,l=r-(this.shouldUpdatePositions&&d?d.height():s.position.height)-10;this.shouldUpdatePositions&&d&&d.updateContainerPosition({anchorPoint:{x:this.anchorLeft,y:l},disableRepositioningAnimation:this.disableRepositioningAnimation,positionFixed:this.positionFixed}),this.updateFloatingContainerPositionInCache(e,this.getContainerId(t[a]),(0,c.Cl)((0,c.Cl)({},s.position),{x:this.anchorLeft,y:l})),r=l}},t.prototype.setRestPositionOfContainers=function(t,e,n){var i;if(t.length>0){var o=this.getFloatingContainerInfo(t[0],e);if(void 0===o)return;var r=null===(i=o.floatingContainerRef)||void 0===i?void 0:i.anchorPoint().y,a=this.shouldUpdatePositions&&void 0!==r&&!this.positionFixed?r:o.position.y;this.possibleTopForNextContainer=null!=n?n:Math.max(o.anchorTop,a),this.updateContainerPositionsDownwards(t,e,0)}},t.prototype.getFloatingContainerInfo=function(t,e){return e[this.getContainerId(t)]},t.prototype.getContainerId=function(t){var e=t.contentId;return this.constructContainerId({contentId:e,contentType:d(t.containerContentType),renderMode:this.renderMode})},t.prototype.updateFloatingContainerPosition=function(t,e,n){var i=this.getFloatingContainerInfo(t,e);if(void 0===i)return!1;var o=this.shouldUpdatePositions&&i.floatingContainerRef?i.floatingContainerRef.anchorPoint().y:i.position.y,r=Math.max(this.possibleTopForNextContainer,i.anchorTop);return r!==o&&(this.shouldUpdatePositions&&i.floatingContainerRef&&i.floatingContainerRef.updateContainerPosition({anchorPoint:{x:this.anchorLeft,y:r},disableRepositioningAnimation:this.disableRepositioningAnimation,positionFixed:this.positionFixed}),this.updateFloatingContainerPositionInCache(e,this.getContainerId(t),(0,c.Cl)((0,c.Cl)({},i.position),{x:this.anchorLeft,y:r}))),this.possibleTopForNextContainer=this.getBottomPositionOfContainer(i,r,n),r===o},t.prototype.getBottomPositionOfContainer=function(t,e,n){void 0===e&&(e=void 0),void 0===n&&(n=void 0);var i,o,r=t.floatingContainerRef,a=null==r?void 0:r.anchorPoint().y;return this.shouldUpdatePositions&&r&&void 0!==a?(i=a,o=r.height()):(i=t.position.y,o=t.position.height),(null!=e?e:i)+(null!=n?n:o)+10},t.prototype.updateFloatingContainerPositionInCache=function(t,e,n){t[e].position=n},t}(),u=n(81036),p=function(){function t(t){this.eventSink=t}return t.prototype.unsubscribe=function(){this.eventSink.unsubscribe(this)},t}(),C=function(){function t(){this.handlers=[]}return t.prototype.subscribe=function(t){var e=new p(this);return this.handlers.push({subscription:e,handler:t}),e},t.prototype.unsubscribe=function(t){this.handlers=this.handlers.filter((function(e){return e.subscription!==t}))},t.prototype.trigger=function(t){this.handlers.forEach((function(e){return e.handler(t,e.subscription)}))},t}(),g=function(){function t(t){this.onContainerShouldBeCreated=new C,this.motionDuration=u.Sw.duration4,this.posUpdateAnimationsInProgress=!1,this.containerVirtualizationEnabled=!1,t&&(this.containerVirtualizationEnabled=!!t.containerVirtualizationEnabled)}return t.prototype.updateContainersVisibility=function(t,e,n,i,o){var r=this;if(void 0===n&&(n=!1),void 0===o&&(o=!1),e.height>0){var a={viewportTop:e.y-e.height/2,viewportBottom:e.y+1.5*e.height,containerIdToInfoMap:t,activeContainerId:i};if(!o&&!this.posUpdateAnimationsInProgress)return void this.handleContainerVirtualization(n,a);this.posUpdateAnimationsInProgress=!0,this.showContainersComingIntoViewport(a),setTimeout((function(){r.updatePositions(a,n),window.clearTimeout(r.hideContainersTimeout),r.hideContainersTimeout=window.setTimeout((function(){r.hideContainersOutsideViewport(a),r.posUpdateAnimationsInProgress=!1}),parseInt(r.motionDuration,10))}),0)}},t.prototype.handleContainerVirtualization=function(t,e){var n=this;Object.keys(e.containerIdToInfoMap).forEach((function(i){var o=n.extractContainerInfo(i,e);n.updateContainerVisibility(o,e.activeContainerId===i),n.updateContainerPosition(o,t)}))},t.prototype.showContainersComingIntoViewport=function(t){var e=this;Object.keys(t.containerIdToInfoMap).forEach((function(n){var i=e.extractContainerInfo(n,t);e.updateContainerVisibility(i,t.activeContainerId===n)}))},t.prototype.hideContainersOutsideViewport=function(t){var e=this;Object.keys(t.containerIdToInfoMap).forEach((function(n){var i=e.extractContainerInfo(n,t);e.updateContainerVisibility(i,t.activeContainerId===n)}))},t.prototype.updatePositions=function(t,e){var n=this;Object.keys(t.containerIdToInfoMap).forEach((function(i){var o=n.extractContainerInfo(i,t);n.updateContainerPosition(o,e)}))},t.prototype.updateContainerVisibility=function(t,e){if(t.containerRef&&t.containerElement){var n=t.isContainerInViewport||e;t.containerElement.style.display=n?"block":"none",this.containerVirtualizationEnabled&&t.containerRef.updateContainerVirtualization(!n)}},t.prototype.updateContainerPosition=function(t,e){var n=t.containerElement;n&&(n.style.top="".concat(t.containerPosition.y,"px"),n.style.left="".concat(t.containerPosition.x,"px"),n.style.transitionDuration=e?"0ms":this.motionDuration)},t.prototype.extractContainerInfo=function(t,e){var n,i=e.containerIdToInfoMap[t],o=i.floatingContainerRef,r=i.position,a={containerElement:void 0,isContainerInViewport:r.y+r.height>=e.viewportTop&&r.y<=e.viewportBottom,containerRef:void 0,containerPosition:r};return o&&(a.containerRef=o,a.containerElement=null===(n=document.getElementById(o.parentDivId()))||void 0===n?void 0:n.querySelector("[id ^= 'floatingContainerView']")),a},t}(),f=n(32722),v=n(31530),I=n(18187),m=n(88672),T=n(89744),y=n(91069);!function(t){t[t.Enablement=1]="Enablement",t[t.Focus=2]="Focus",t[t.Hover=3]="Hover",t[t.Resize=4]="Resize",t[t.Visibility=5]="Visibility"}(l||(l={}));var b,x=n(85552);function A(t,e){return{type:t,payload:e}}!function(t){t.ChangeRenderedContentIdentifierType="CHANGE_RENDERED_CONTENT_IDENTIFIER",t.EmptyActionType="",t.RemoveVisibilityAnimationType="REMOVE_VISIBILITY_ANIMATION",t.RepositionType="REPOSITION_FLOATING_CONTAINER",t.SetContentType="SET_CONTENT",t.UpdateContainerVirtualizationType="UPDATE_FLOATING_CONTAINER_VIRTUALIZATION",t.UpdateContainerVisibilityType="UPDATE_FLOATING_CONTAINER_VISIBILITY",t.UpdateContentMaxDimensionsType="UPDATE_CONTENT_MAX_DIMENSIONS",t.UpdateContentSetItemDetailsType="UPDATE_CONTENT_SET_ITEM_DETAILS"}(b||(b={}));var P={anchorPoint:{x:0,y:0}};function F(t,e){var n;return void 0===e&&(e=P),{anchorPoint:e.anchorPoint,contentIdentifier:t,disableRepositioningAnimation:!1,isVisible:!1,isVirtualized:!1,maxDimensions:e.maxDimensions||{},positionFixed:!1,useVisibilityAnimation:!1,accessibilityMetadata:null!==(n=e.accessibilityMetadata)&&void 0!==n?n:{}}}var R={contentId:"",contentType:s.cM.Empty};function S(t,e){switch(void 0===t&&(t=F(R)),void 0===e&&(e=A(b.EmptyActionType,{})),e.type){case b.ChangeRenderedContentIdentifierType:return function(t,e){return t.contentIdentifier.contentId===e.payload.newContentIdentifier.contentId&&t.contentIdentifier.contentType===e.payload.newContentIdentifier.contentType?t:(0,c.Cl)((0,c.Cl)({},t),{contentIdentifier:e.payload.newContentIdentifier})}(t,e);case b.RemoveVisibilityAnimationType:return function(t){return(0,c.Cl)((0,c.Cl)({},t),{useVisibilityAnimation:!1})}(t);case b.RepositionType:return function(t,e){return t.anchorPoint.x===e.payload.anchorPoint.x&&t.anchorPoint.y===e.payload.anchorPoint.y&&t.disableRepositioningAnimation===e.payload.disableRepositioningAnimation&&t.positionFixed===e.payload.positionFixed?t:(0,c.Cl)((0,c.Cl)({},t),{anchorPoint:e.payload.anchorPoint,disableRepositioningAnimation:e.payload.disableRepositioningAnimation,positionFixed:e.payload.positionFixed})}(t,e);case b.SetContentType:return function(t,e){return(0,c.Cl)((0,c.Cl)({},t),{content:e.payload.content,isVisible:!!e.payload.content&&t.isVisible})}(t,e);case b.UpdateContentMaxDimensionsType:return function(t,e){return t.maxDimensions.height===e.payload.maxDimensions.height&&t.maxDimensions.width===e.payload.maxDimensions.width?t:(0,c.Cl)((0,c.Cl)({},t),{maxDimensions:e.payload.maxDimensions})}(t,e);case b.UpdateContentSetItemDetailsType:return function(t,e){var n,i=null===(n=t.accessibilityMetadata)||void 0===n?void 0:n.setItem,o=e.payload.setItemDetails;return i===o||i&&o&&i.positionInSet===o.positionInSet&&i.setSize===o.setSize&&i.level===o.level?t:(0,c.Cl)((0,c.Cl)({},t),{accessibilityMetadata:(0,c.Cl)((0,c.Cl)({},t.accessibilityMetadata),{setItem:o})})}(t,e);case b.UpdateContainerVisibilityType:return function(t,e){return(0,c.Cl)((0,c.Cl)({},t),{isVisible:e.payload.isVisible,useVisibilityAnimation:e.payload.useVisibilityAnimation})}(t,e);case b.UpdateContainerVirtualizationType:return function(t,e){return(0,c.Cl)((0,c.Cl)({},t),{isVirtualized:e.payload.isVirtualized})}(t,e);default:return t}}function E(t){return A(b.SetContentType,{content:t})}var k=function(t){return t.isVirtualized},w=n(40299),M=n(78435),D=(0,w.i7)({from:{opacity:0,visibility:"visible"},to:{opacity:1}}),U=(0,w.i7)({from:{opacity:1,visibility:"visible"},to:{opacity:0,visibility:"hidden"}}),V=(0,M.J9)((function(t,e,n,i){return{floatingContainerView:(0,w.Zq)({animationName:e?t?D:U:void 0,animationDuration:"".concat(300,"ms"),animationTimingFunction:u.OV.decelerate,background:"transparent",position:i?"fixed":"absolute",transitionDuration:t&&!n?u.Sw.duration4:"0s",transitionProperty:"top, left",transitionTimingFunction:u.OV.decelerate,visibility:t?"visible":"hidden"})}})),j=n(61612),O=n(53521);function N(t){return"floatingContainerView".concat(t.contentId,"Type").concat(t.contentType)}var L,z=function(t){function e(e){var n=t.call(this,e)||this;return n.handleResizeUpdates=function(t){t.forEach((function(t){n.props.onContainerStateChanged.trigger({stateChangeType:l.Resize,contentIdentifier:n.props.contentIdentifier,contentRect:t.contentRect})}))},n.triggerVisibilityUpdateNotification=function(){n.props.onContainerStateChanged.trigger({stateChangeType:l.Visibility,contentIdentifier:n.props.contentIdentifier,isVisible:n.props.isVisible})},n.getHostedResource=function(t){return{id:t}},n.onFocusChange=function(t,e){var i=t.relatedTarget||document.activeElement;n.parentDivRef&&i instanceof HTMLElement&&n.parentDivRef.contains(i)||n.props.onContainerStateChanged.trigger({stateChangeType:l.Focus,contentIdentifier:n.props.contentIdentifier,isFocused:e})},n.onFocusOut=function(t){n.onFocusChange(t,!1)},n.onFocusIn=function(t){n.onFocusChange(t,!0)},n.onMouseEnter=function(){n.props.onContainerStateChanged.trigger({stateChangeType:l.Hover,contentIdentifier:n.props.contentIdentifier,isHovered:!0})},n.onMouseLeave=function(){n.props.onContainerStateChanged.trigger({stateChangeType:l.Hover,contentIdentifier:n.props.contentIdentifier,isHovered:!1})},n.setContentRef=function(t){n.contentRef=t},n.setParentDivRef=function(t){t!==n.parentDivRef&&(n.parentDivRef&&(n.resizeObserver.unobserve(n.parentDivRef),n.parentDivRef.removeEventListener("focusin",n.onFocusIn,!0),n.parentDivRef.removeEventListener("focusout",n.onFocusOut,!0)),t&&(n.resizeObserver.observe(t),t.addEventListener("focusin",n.onFocusIn,!0),t.addEventListener("focusout",n.onFocusOut,!0))),n.parentDivRef=t},n.contentRef=void 0,n.parentDivRef=void 0,n.resizeObserver=new O.A((function(t){window.requestAnimationFrame((function(){n.handleResizeUpdates(t)}))})),n.setContentRef=n.setContentRef.bind(n),n.setParentDivRef=n.setParentDivRef.bind(n),n.getHostedResource=(0,j.CT)(n.getHostedResource.bind(n)),n}return(0,c.C6)(e,t),e.prototype.componentDidMount=function(){this.triggerVisibilityUpdateNotification()},e.prototype.componentDidUpdate=function(t){var e=this,n=!1;t.isVisible!==this.props.isVisible&&(this.props.useVisibilityAnimation&&!this.props.isVisible?n=!0:this.triggerVisibilityUpdateNotification()),this.props.useVisibilityAnimation&&setTimeout((function(){n&&e.triggerVisibilityUpdateNotification(),e.props.removeVisibilityAnimation()}),300)},e.prototype.height=function(){return this.parentDivRef?this.parentDivRef.clientHeight:0},e.prototype.width=function(){return this.parentDivRef?this.parentDivRef.clientWidth:0},e.prototype.setFocus=function(){this.contentRef&&this.contentRef.focus()},e.prototype.render=function(){if(!this.props.anchorPoint||void 0===this.props.anchorPoint.x||void 0===this.props.anchorPoint.y||!this.props.content)return null;var t=V(this.props.isVisible,this.props.useVisibilityAnimation,this.props.disableRepositioningAnimation,this.props.positionFixed),e=this.props.content;return m.createElement("div",{key:N(this.props.contentIdentifier),id:N(this.props.contentIdentifier),ref:this.setParentDivRef,className:t.floatingContainerView,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,style:{left:this.props.anchorPoint.x,top:this.props.anchorPoint.y}},m.createElement(e,{componentRef:this.setContentRef,resource:this.getHostedResource(this.props.contentIdentifier.contentId),maximumDimensions:this.props.maxDimensions,isVirtualized:this.props.isVirtualized,accessibilityMetadata:this.props.accessibilityMetadata}))},e}(m.Component),H=(0,y.connect)((function(t){return{accessibilityMetadata:t.accessibilityMetadata,anchorPoint:t.anchorPoint,content:t.content,contentIdentifier:t.contentIdentifier,disableRepositioningAnimation:t.disableRepositioningAnimation,isVisible:t.isVisible,isVirtualized:t.isVirtualized,maxDimensions:t.maxDimensions,positionFixed:t.positionFixed,useVisibilityAnimation:t.useVisibilityAnimation}}),(function(t,e){return{removeVisibilityAnimation:function(){t(A(b.RemoveVisibilityAnimationType,{}))}}}),void 0,{forwardRef:!0})(z),_=function(){function t(t,e,n,i){var o;this.onContainerStateChanged=new C,this.floatingContainerRef=void 0,this.extensionUpdatedEventSubscription=void 0,this.unsubscribeStoreListener=function(){},this.canShow=!1,!1===i.isDraftContainer&&(this.floatingContainerCreationActivity=(0,f.i7)().createActivityObject("FloatingContainerCreation",(0,f.t4)(f.ZK.GlobalAPI),(0,f.Zx)())),this.store=(o=F(n,i))?(0,x.y$)(S,o):(0,x.y$)(S),this.extensionProvider=e,this.setContentFromExtension(),this.parentDiv=document.createElement("div"),this.parentDiv.id=i.containerId||(0,v.O)(),t.appendChild(this.parentDiv),this.observeStore=this.observeStore.bind(this),this.onUpdatedEventHandler=this.onUpdatedEventHandler.bind(this),this.setFloatingContainerRef=this.setFloatingContainerRef.bind(this),this.observeStore(n),this.render()}return t.prototype.anchorPoint=function(){return this.store.getState().anchorPoint},t.prototype.contentIdentifier=function(){return this.store.getState().contentIdentifier},t.prototype.height=function(){return this.floatingContainerRef?this.floatingContainerRef.height():0},t.prototype.width=function(){return this.floatingContainerRef?this.floatingContainerRef.width():0},t.prototype.parentDivId=function(){return this.parentDiv.id},t.prototype.observeStore=function(t){var e=this;if((0,s.gq)(this.extensionProvider)){var n=t;this.unsubscribeStoreListener=this.store.subscribe((function(){var t=e.contentIdentifier();n.contentId===t.contentId&&n.contentType===t.contentType||(n=t,e.removeExtensionUpdatedEventSubscription(),e.setContentFromExtension())}))}},t.prototype.setContentFromExtension=function(){var t=this,e=void 0;if((0,s.gq)(this.extensionProvider)){if(e=this.extensionProvider.getExtension(this.contentIdentifier().contentId),this.extensionUpdatedEventSubscription||(this.extensionUpdatedEventSubscription=e.onUpdated.subscribe((function(e){t.onUpdatedEventHandler()}))),e.priority===s.OR.Disabled)return this.canShow=!1,void this.store.dispatch(E(void 0))}else e=this.extensionProvider.getExtension();this.canShow=!0,(0,I.l9)().getComponent(e.componentKey).then((function(e){t.store.dispatch(E(e.component)),t.floatingContainerCreationActivity&&(t.floatingContainerCreationActivity.successTag(593872975),t.floatingContainerCreationActivity=void 0)})).catch((function(t){(0,f.i7)().assertConditionTag(!1,"Error when registering component in setContentFromExtension ".concat(t),595632583)}))},t.prototype.render=function(){var t={onContainerStateChanged:this.onContainerStateChanged};T.render(m.createElement(y.Provider,{store:this.store},m.createElement(H,(0,c.Cl)({ref:this.setFloatingContainerRef},t))),this.parentDiv)},t.prototype.updateContainerPosition=function(t){var e,n,i;this.store.dispatch((e=t.anchorPoint,n=!!t.disableRepositioningAnimation,i=!!t.positionFixed,A(b.RepositionType,{anchorPoint:e,disableRepositioningAnimation:n,positionFixed:i})))},t.prototype.updateMaximumDimensions=function(t){this.store.dispatch(function(t){return A(b.UpdateContentMaxDimensionsType,{maxDimensions:t})}(t))},t.prototype.updateSetItemDetails=function(t){this.store.dispatch(function(t){return A(b.UpdateContentSetItemDetailsType,{setItemDetails:t})}(t))},t.prototype.updateContainerVirtualization=function(t){t&&!k(this.store.getState())?this.store.dispatch(A(b.UpdateContainerVirtualizationType,{isVirtualized:!0})):k(this.store.getState())&&this.store.dispatch(A(b.UpdateContainerVirtualizationType,{isVirtualized:!1}))},t.prototype.showFloatingContainer=function(t){return!!this.canShow&&(this.store.dispatch(function(t){return A(b.UpdateContainerVisibilityType,{isVisible:!0,useVisibilityAnimation:t})}(!!t)),!0)},t.prototype.hideFloatingContainer=function(t){this.store.dispatch(function(t){return A(b.UpdateContainerVisibilityType,{isVisible:!1,useVisibilityAnimation:t})}(!!t))},t.prototype.destroyFloatingContainer=function(t){var e=this;this.unsubscribeStoreListener(),this.removeExtensionUpdatedEventSubscription(),this.hideFloatingContainer(t),t?setTimeout((function(){e.cleanupDomOnDestroy()}),300):this.cleanupDomOnDestroy()},t.prototype.cleanupDomOnDestroy=function(){T.unmountComponentAtNode(this.parentDiv),this.parentDiv.parentElement&&this.parentDiv.parentElement.removeChild(this.parentDiv)},t.prototype.isShowing=function(){return this.store.getState().isVisible},t.prototype.setFocus=function(){var t=this;this.floatingContainerRef?this.floatingContainerRef.setFocus():setTimeout((function(){var e;return null===(e=t.floatingContainerRef)||void 0===e?void 0:e.setFocus()}))},t.prototype.changeRenderedContentIdentifier=function(t){this.store.dispatch(function(t){return A(b.ChangeRenderedContentIdentifierType,{newContentIdentifier:t})}(t))},t.prototype.onUpdatedEventHandler=function(){var t=this.canShow;this.setContentFromExtension(),t!==this.canShow&&this.onContainerStateChanged.trigger({stateChangeType:l.Enablement,contentIdentifier:this.contentIdentifier(),isEnabled:this.canShow})},t.prototype.removeExtensionUpdatedEventSubscription=function(){this.extensionUpdatedEventSubscription&&(this.extensionUpdatedEventSubscription.unsubscribe(),this.extensionUpdatedEventSubscription=void 0)},t.prototype.setFloatingContainerRef=function(t){this.floatingContainerRef=null!=t?t:void 0},t}(),B=new(function(){function t(){}return t.prototype.createFloatingContainer=function(t,e,n,i){return new _(t,e,n,i)},t}()),G=n(24819),W=n(95270),$=n(38435);!function(t){t[t.DeselectionEnabled=0]="DeselectionEnabled",t[t.FloatingContainerVirtualizationEnabled=1]="FloatingContainerVirtualizationEnabled",t[t.ImproveJumpingFixEnabled=2]="ImproveJumpingFixEnabled",t[t.ShouldInitialize=3]="ShouldInitialize",t[t.ScrollingPerfImprovementEnabled=4]="ScrollingPerfImprovementEnabled",t[t.SynchronousContainerPositioningEnabled=5]="SynchronousContainerPositioningEnabled",t[t.TrackChangesInSidetrackEnabled=6]="TrackChangesInSidetrackEnabled",t[t.ContentNavigationApiEnabled=7]="ContentNavigationApiEnabled",t[t.ReturnToDraftFixEnabled=8]="ReturnToDraftFixEnabled",t[t.RibbonCommentFilteringEnabled=9]="RibbonCommentFilteringEnabled",t[t.CommentHorizontalShiftEnabled=10]="CommentHorizontalShiftEnabled"}(L||(L={}));var Q,q=n(13190),K=n(15185);!function(t){t[t.Focus=0]="Focus"}(Q||(Q={}));var Z=n(80913);function J(t){return`${t.contentId}_${t.contentType}_${t.renderMode}`}function Y(t){switch(t){case s.cM.CommentThread:return i.CommentThread;case s.cM.TrackedChange:return i.TrackedChange;default:return i.CommentThread}}const X=({id:t,containerContent:e,componentRef:n})=>{const[i,o]=m.useState(e),r=m.useCallback((t=>{switch(t.type){case"content":o(t.data);break;case"behavior":t.data.action===Q.Focus&&d.current?.focus()}}),[]),a=Ft.getTrackChangesStore(),c=Ft.getFCContentNavigationAPI(),d=m.useRef(null),l=m.useCallback((()=>{d.current?.focus()}),[]),h=m.useCallback((()=>t),[t]);m.useEffect((()=>(a.registerOnStoreUpdate(t,r),n&&n({focus:l,getInstanceId:h}),()=>{a.removeFromStore(t)})),[t,n,r,a,l,h]);const u=m.useMemo((()=>({definitionType:"TrackChangeDefinition",authorName:i.authorName??"",authorColor:i.authorColor??"",changeDescriptor:i.changeDescriptor,acceptDisabled:!!i.acceptDisabled,rejectDisabled:!!i.rejectDisabled,theme:i.theme})),[i]),p=m.useMemo((()=>a.cardStrings),[a.cardStrings]),C=m.useMemo((()=>a.getCardActionCallbacks(t)),[t,a]),g=m.useMemo((()=>({definition:u,strings:p,onAcceptHoverIn:C.onAcceptHoverIn,onRejectHoverIn:C.onRejectHoverIn,onAcceptHoverOut:C.onAcceptHoverOut,onRejectHoverOut:C.onRejectHoverOut,onAcceptClick:C.onAcceptClick,onRejectClick:C.onRejectClick,style:a.cardStyles})),[u,p,C.onAcceptHoverIn,C.onRejectHoverIn,C.onAcceptHoverOut,C.onRejectHoverOut,C.onAcceptClick,C.onRejectClick,a]),f=m.useCallback((()=>{C.onCardClick(),l()}),[C,l]),v=m.useCallback((()=>{C.onCardHoverIn()}),[C]),I=m.useCallback((()=>{C.onCardHoverOut()}),[C]),T=m.useCallback((e=>{const n="ArrowDown"===(i=e.key)||"Down"===i?Z.w.Next:"ArrowUp"===i||"Up"===i?Z.w.Previous:Z.w.None;var i;n!==Z.w.None&&(c?.selectNextOrPreviousContent({selectDirection:n,preventLooping:!1,reason:Z.G6.Keyboarding,restrictToCurrentContext:!0,from:{contentId:t,contentType:s.cM.TrackedChange}}),e.preventDefault())}),[c,t]),y=m.useMemo((()=>{const t=i.theme?.borderColor?`1px solid ${i.theme.borderColor}`:void 0;return(0,w.Zq)({outline:"none",boxShadow:"0 0 2px rgba(0, 0, 0, 0.12), 0 2px 4px rgba(0,0,0,0.14)",borderRadius:"4px",":hover":{boxShadow:"0 0 2px rgba(0, 0, 0, 0.12), 0 4px 8px rgba(0,0,0,0.14)"},border:t,":focus":{boxShadow:"0 0 2px rgba(0, 0, 0, 0.12), 0 8px 16px rgba(0,0,0,0.14)"}})}),[i]);return m.createElement("div",{onClick:f,onMouseEnter:v,onMouseLeave:I,onKeyDown:T,tabIndex:0,ref:d,className:y},m.createElement(K.I,{...g}))},tt=t=>{const e=Ft.getTrackChangesStore().getContainerContent(t.resource?.id);return e?m.createElement(X,{id:t.resource?.id,containerContent:e,componentRef:t.componentRef}):null},et="TrackedChange",nt="canvas",it="floatingComments";var ot=n(91489),rt=n(70369);const at={width:0,height:0,x:0,y:0};function st(t){return void 0!==t.hasBeenRendered}class ct{addContentAnchorPosition(t,e=0,n=-1){const i=n>-1?n:this.getContentCardInsertionPoint(t.anchorTop)+e;return this.contentAnchorPositions.splice(i,0,t),i}getContainerIdToInfoMap(){return this.containerIdToInfoMap}getContentAnchorPositions(){return this.contentAnchorPositions}getContentAnchorPosition(t){const e=this.getContentCardIndex(t);if(e>-1)return this.contentAnchorPositions[e]}initializeAndRenderFloatingContainer(t,e,n,i=!0,o=!1){let r=!1;return r=this.initializeFloatingContainerState(t,n,i,o),o&&this.renderFloatingContainerAtAnchorPosition(e),r}isContainerInViewPort(t){return t>this.viewportInfo.y-.5*this.viewportInfo.height&&t<this.viewportInfo.y+1.5*this.viewportInfo.height}removeContentAnchorPosition(t){const e=this.getContentCardIndex(t);return-1===e?(this.ULS.sendTraceTag(595736577,W.n.msoulscat_Wac_Telemetry,$.k.Error,`[RemoveContentAnchorPosition]Content anchor position for id ${t} does not exist.`),-1):(this.contentAnchorPositions.splice(e,1),e)}checkIfContainerIdCorrespondsToGivenPosition(t,e){return t===this.getContainerIdUsingPositionalIndex(e)}getContainerIdUsingPositionalIndex(t){const e=this.contentAnchorPositions[t];return J({contentId:e.contentId,contentType:d(e.containerContentType),renderMode:s.G9.Integrated})}createFloatingContainer(t,e,n,i){if(this.dhcContainerPanel)return this.floatingContainerFactory.createFloatingContainer(this.dhcContainerPanel,t,{contentId:e.contentId,contentType:d(e.containerContentType)},{anchorPoint:{x:0,y:n},isDraftContainer:i});this.ULS.sendTraceTag(595883361,W.n.msoulscat_Wac_Telemetry,$.k.Error,"[createFloatingContainer]dhcContainerPanel is not yet set.")}initializeFloatingContainerState(t,e,n,i){if(t){const o=this.contentTypeToExtensionProviderMap.get(d(t.containerContentType));if(void 0===o)return this.ULS.sendTraceTag(595883363,W.n.msoulscat_Wac_Telemetry,$.k.Error,`[initializeFCState]ExtensionProvider not found for contentType ${t.containerContentType}`),!1;const r=t.contentId;if(!r)return this.ULS.sendTraceTag(595883407,W.n.msoulscat_Wac_Telemetry,$.k.Error,"[initializeFCState]ContentId is null or empty."),!1;const a=J({contentId:r,contentType:d(t.containerContentType),renderMode:s.G9.Integrated});let c;if(n){if(c=this.createFloatingContainer(o,{contentId:r,containerContentType:t.containerContentType},t.anchorTop,i),!c)return this.ULS.sendTraceTag(595886286,W.n.msoulscat_Wac_Telemetry,$.k.Error,`[createFloatingContainer] Could not create fc for content id ${r}`),!1;c.onContainerStateChanged.subscribe(this.getContainerStateChangedCallback(e,a))}if(this.containerIdToInfoMap[a])this.containerIdToInfoMap[a].floatingContainerRef=c;else{const e={position:{height:0,width:0,x:0,y:t.anchorTop},...this.containerIdToInfoMap[a],anchorTop:t.anchorTop,floatingContainerRef:c,hasBeenRendered:!1};this.containerIdToInfoMap[a]=e}return!0}return!1}constructor(t,e,n,i,o){this.supportedContentTypes=[s.cM.CommentThread,s.cM.TrackedChange],this.getContentCardIndex=(t,e)=>{if(!this.containerIdToInfoMap[t])return this.ULS.sendTraceTag(595883362,W.n.msoulscat_Wac_Telemetry,$.k.Error,`[getContentCardIndex]Container with id ${t} does not exist.`),-1;let n=this.containerIdToInfoMap[t].anchorTop;n=e?Math.max(n,e):n;const i=this.getContentCardInsertionPoint(n);for(let e=i;e<this.contentAnchorPositions.length;e+=1)if(this.checkIfContainerIdCorrespondsToGivenPosition(t,e))return e;for(let e=0;e<i;e+=1)if(this.checkIfContainerIdCorrespondsToGivenPosition(t,e))return e;return-1},this.initializeExtensionProviderCollection=t=>{this.extensionProviderCollection=this.contentExtensionHostAPIGetter().getExtensions(this.supportedContentTypes,s.wn),this.updateContentTypeToExtensionProviderMap(t),this.extensionProviderCollection.onUpdated.subscribe((()=>this.updateContentTypeToExtensionProviderMap(t)))},this.getContentCardInsertionPoint=t=>{let e,n=0,i=this.contentAnchorPositions.length;for(;n<i;)e=n+Math.floor((i-n)/2),this.contentAnchorPositions[e].anchorTop<t-4?n=e+1:i=e;return n},this.getContainerStateChangedCallback=(t,e)=>(n,i)=>{switch(n.stateChangeType){case l.Resize:t(n,i);break;case l.Visibility:n.isVisible&&!this.commentsTTVRReported&&e===this.lastCommentVisibleID&&((0,ot.Sb)(ot.a4,{component:nt,subComponent:it,state:rt.aB}),(0,ot.Sb)(ot.a4,{component:nt,subComponent:it,state:rt.Z1}),this.commentsTTVRReported=!0)}},this.renderFloatingContainerAtAnchorPosition=t=>{const e=this.containerIdToInfoMap[t];e&&e.floatingContainerRef&&e.floatingContainerRef.showFloatingContainer(!0)},this.updateContentTypeToExtensionProviderMap=t=>{this.contentTypeToExtensionProviderMap.clear(),void 0!==this.extensionProviderCollection?(this.areCommentExtensionProvidersDefinedOnce||(this.areCommentExtensionProvidersDefinedOnce=0!==this.extensionProviderCollection.providers.filter((t=>t.scope.contentType===s.cM.CommentThread&&t.scope.renderMode===s.G9.Integrated)).length),this.extensionProviderCollection.providers.forEach((t=>{t.scope.renderMode===s.G9.Integrated&&this.contentTypeToExtensionProviderMap.set(t.scope.contentType,t)})),t()):this.ULS.sendTraceTag(595886287,W.n.msoulscat_Wac_Telemetry,$.k.Error,"extensionProviderCollection should not be null")},this.contentExtensionHostAPIGetter=t,this.dhcContainerPanel=e,this.isCommentPaneOpen=!1,this.areCommentExtensionProvidersDefinedOnce=!1,this.viewportInfo=o||at,this.containerIdToInfoMap={},this.contentAnchorPositions=[],this.contentTypeToExtensionProviderMap=new Map,this.floatingContainerFactory=n,this.ULS=i,this.processedContainersVisibleAtBoot=!1,this.isFirstCommentRenderDone=!1,this.lastCommentVisibleID="",this.commentsTTVRReported=!1}}class dt{initialize(){this.fcManagerInitialized||(this.store.initializeExtensionProviderCollection(this.updateCommentPaneState),this.floatingContainerVirtualizer.onContainerShouldBeCreated.subscribe(this.containerShouldBeCreatedEventHandler),this.fcManagerInitialized=!0)}enterFixedPositionMode(){this.inFixedMode=!0}exitFixedPositionMode(){this.inFixedMode=!1}setFirstCommentRenderDone(){this.store.isFirstCommentRenderDone=!0}setContainerCreationPauseState(t){this.pauseContainerCreation=t,t&&(this.containerCreationEnqueueTimes={},this.isContainerQueueInProgress=!1)}clearSelection(t=!1){if(this.store.activeContainerId){const e=this.store.getContainerIdToInfoMap()[this.store.activeContainerId];if(this.store.activeContainerId=void 0,!e)return;if(e.position.x=0,t)return;this.positionFloatingContainers()}}setInitialActiveContainerId(t){this.isInitialActiveIdSet=!0,this.clearSelection(),t&&t.contentId&&(this.store.activeContainerId=J({contentId:t.contentId,contentType:d(t.containerContentType),renderMode:s.G9.Integrated}))}setInitialActiveContainerIdV2(t,e){this.isInitialActiveIdSet=!0,this.clearSelection(),t&&t.contentId&&(this.store.activeContainerId=J({contentId:t.contentId,contentType:d(t.containerContentType),renderMode:s.G9.Integrated}),e&&(this.onInitialActiveContainerRender=e))}insertContentAnchorPosition(t,e,n){const i=n&&Math.abs(t.anchorTop-e)<=4?this.store.getContentCardIndex(n)+1:-1;this.store.addContentAnchorPosition(t,0,i)}processContentAnchorPositionsInView(t){let e,n,i=!1,o=0;if(t.forEach(((r,a)=>{if(r){const c=r.contentId;if(!c)return void this.store.ULS.sendTraceTag(595903808,W.n.msoulscat_Wac_Telemetry,$.k.Error,"[processContentAnchorPosition]ContentId is null.");const l=J({contentId:c,contentType:d(r.containerContentType),renderMode:s.G9.Integrated}),h=t.length;this.trackLastCommentRenderedInViewport(r,a,l,h);const u=this.store.getContainerIdToInfoMap()[l];if(!u){const t=this.store.initializeAndRenderFloatingContainer(r,l,this.onContainerResize,!1);return t&&!this.containerCreationQueue.includes(l)&&(this.containerCreationQueue.push(l),this.containerCreationEnqueueTimes[l]=Date.now()),void(t&&(this.insertContentAnchorPosition(r,o,e),e=l,o=r.anchorTop))}const p=this.store.getContentCardIndex(l,r.anchorTop);if(-1===p)return void this.store.ULS.sendTraceTag(595883392,W.n.msoulscat_Wac_Telemetry,$.k.Error,"[processContentAnchorPosition]Container was supposed to be found.");const C=this.store.getContentAnchorPositions()[p],g=void 0!==n&&u.position.y>=n.position.y&&u.position.y<=n.position.y+n.position.height,f=Math.abs(C.anchorTop-r.anchorTop)>4;if(i=i||f||g,f){const t=J({contentId:c,contentType:d(r.containerContentType),renderMode:s.G9.Integrated});this.store.removeContentAnchorPosition(t),this.insertContentAnchorPosition(r,o,e)}e=l,o=r.anchorTop,u.anchorTop=r.anchorTop,n=u}})),this.updateProcessedContainersVisibleAtBootState(),!this.featureSettings.TrackChangesInSidetrackEnabled&&this.isContainerQueueInProgress||this.processContainerQueue(),i||this.inFixedMode){const t=this.store.getContentAnchorPositions().length>0?this.store.getContentAnchorPositions()[0].anchorTop:void 0;this.positionFloatingContainers(this.store.getContentAnchorPositions(),t,this.store.activeContainerId)}}processContainerQueue(){if(0===this.containerCreationQueue.length||this.pauseContainerCreation)return void(this.isContainerQueueInProgress=!1);this.isContainerQueueInProgress=!0;const t=this.containerCreationQueue.shift(),e=this.store.getContentAnchorPosition(t);if(e)if(this.store.isContainerInViewPort(e.anchorTop)){if(!this.featureSettings.TrackChangesInSidetrackEnabled||!this.containerCreationTimers[t]){const n=window.setTimeout((()=>{this.containerCreationTimers[t]&&(this.containerCreationTimers[t].creationStarted=!0),this.createContainer(e,t),this.setupStallDetector(t)}),this.containerDelayTimeMs);this.containerCreationTimers[t]={timer:n,creationStarted:!1}}}else this.deleteContainer(t),this.processContainerQueue();else this.featureSettings.TrackChangesInSidetrackEnabled&&this.processContainerQueue()}trackLastCommentRenderedInViewport(t,e,n,i){this.store.processedContainersVisibleAtBoot||(this.store.isContainerInViewPort(t.anchorTop)?this.store.lastCommentVisibleID=n:0===e&&(0,ot.Sb)(ot.a4,{component:nt,subComponent:it,state:"unused"})),e!==i-1||this.store.processedContainersVisibleAtBoot||(this.store.processedContainersVisibleAtBoot=!0)}updateProcessedContainersVisibleAtBootState(){this.store.isFirstCommentRenderDone&&!this.store.processedContainersVisibleAtBoot&&(this.store.processedContainersVisibleAtBoot=!0,(0,ot.Sb)(ot.a4,{component:nt,subComponent:it,state:"unused"}))}setupStallDetector(t){this.stallDetectorUsed=!1,(!this.featureSettings.TrackChangesInSidetrackEnabled||void 0===this.stallDetectorTimeoutId)&&(this.stallDetectorTimeoutId=window.setTimeout((()=>{this.stallDetectorUsed=!0,this.processContainerQueue(),this.store.ULS.sendTraceTag(593281990,W.n.msoulscat_Wac_Telemetry,$.k.Warning,`[CommentCreationQueueStallDetector]: Container ${t} creation resize call not received or took too long`)}),this.queueStallDetectionTimeMs))}createContainer(t,e){if(this.store.initializeAndRenderFloatingContainer(t,e,this.onContainerResize,!0)){if(this.containerCreationEnqueueTimes[e]){const t=Date.now();this.store.ULS.sendTraceTag(593891910,W.n.msoulscat_Wac_Telemetry,$.k.Info,"[DelayCreationPerfMetric]TimeToCreateCommentFromEnqueue:"+(t-this.containerCreationEnqueueTimes[e])),delete this.containerCreationEnqueueTimes[e]}}else this.deleteContainer(e),this.processContainerQueue()}onCommentPaneStateChange(){this.store.isCommentPaneOpen?(this.store.areCommentExtensionProvidersDefinedOnce&&this.destroyAllContainers(),this.paneOpenedCallback&&this.paneOpenedCallback()):this.paneClosedCallback&&this.paneClosedCallback()}deleteContainer(t,e=!1){const n=this.store.removeContentAnchorPosition(t);if(-1===n)return-1;const i=this.store.getContainerIdToInfoMap()[t].floatingContainerRef;return i&&(i.destroyFloatingContainer(e),this.featureSettings.TrackChangesInSidetrackEnabled||(clearTimeout(this.containerCreationTimers[t]?.timer),delete this.containerCreationTimers[t],this.removeFromCreationQueue(t))),this.featureSettings.TrackChangesInSidetrackEnabled&&(void 0!==this.containerCreationTimers[t]&&(this.containerCreationTimers[t].creationStarted?(clearTimeout(this.stallDetectorTimeoutId),this.stallDetectorTimeoutId=void 0):clearTimeout(this.containerCreationTimers[t].timer),delete this.containerCreationTimers[t]),this.removeFromCreationQueue(t)),delete this.store.getContainerIdToInfoMap()[t],delete this.containerCreationEnqueueTimes[t],n}destroyAllContainers(){const t=Object.keys(this.store.getContainerIdToInfoMap());t.length>0&&this.destroyAllContainersCallback&&this.destroyAllContainersCallback(),t.forEach((t=>{this.deleteContainer(t)})),this.isContainerQueueInProgress=!1,this.containerCreationEnqueueTimes={},this.containerCreationTimers={},this.containerCreationQueue=[]}positionFloatingContainers(t,e,n,i=!1,o=!1){if(t&&t.length>0){const o=n?{containerId:n,containerPositionIndex:this.store.getContentCardIndex(n)}:void 0;this.floatingContainerPositioner.calculateNewPositions(t,this.store.getContainerIdToInfoMap(),{activeContainerInfo:o,disableRepositioningAnimation:i||this.inFixedMode,topOfFirstContainer:e,shouldUpdatePositions:!1})}let r=n;r=r??this.store.activeContainerId,this.floatingContainerVirtualizer.updateContainersVisibility(this.store.getContainerIdToInfoMap(),this.store.viewportInfo,i||this.inFixedMode||void 0!==this.replacementContentId,this.isInitialActiveIdSet?void 0:r,o)}positionContainersOnResize(t,e,n){let i=this.store.getContentCardIndex(t);const o=this.store.activeContainerId?this.store.getContentCardIndex(this.store.activeContainerId):void 0;void 0!==o&&o>=i?this.positionFloatingContainers(this.store.getContentAnchorPositions(),void 0,this.store.activeContainerId,n):(i-=st(e)&&e.hasBeenRendered||!(i>0)?0:1,this.positionFloatingContainers(this.store.getContentAnchorPositions().slice(i),void 0,void 0,n)),st(e)&&(e.hasBeenRendered=!0)}removeFromCreationQueue(t){const e=this.containerCreationQueue.indexOf(t);e>-1&&this.containerCreationQueue.splice(e,1)}constructor(t,e,n,o,r,a,c,h){this.floatingContainerPositioner=t,this.floatingContainerVirtualizer=e,this.store=n,this.featureSettings=a,this.trackChangesStore=h,this.isInitialActiveIdSet=!1,this.inFixedMode=!1,this.firstContainerBeingRendered=!0,this.fcManagerInitialized=!1,this.pauseContainerCreation=!1,this.containerDelayTimeMs=10,this.containerCreationQueue=[],this.isContainerQueueInProgress=!1,this.containerCreationTimers={},this.containerCreationEnqueueTimes={},this.stallDetectorTimeoutId=void 0,this.stallDetectorUsed=!1,this.queueStallDetectionTimeMs=1e3,this.draftContainerId="",this.ribbonCommentFilteringEnabled=!1,this.emitEvent=(t,e)=>{if(this.store.isCommentPaneOpen||!this.store.dhcContainerPanel||!this.store.areCommentExtensionProvidersDefinedOnce)return this.store.ULS.sendTraceTag(538022540,W.n.msoulscat_Wac_Telemetry,$.k.Warning,`FCM not handling the event. {\n          isCommentPaneOpen: ${this.store.isCommentPaneOpen},\n          dhcContainerPanelNotDefined: ${!this.store.dhcContainerPanel},\n          extensionProvidersNotDefined: ${!this.store.areCommentExtensionProvidersDefinedOnce}\n        }`),void(e&&e.viewportInfo&&(this.store.viewportInfo=e.viewportInfo));switch(t){case bt.AddContainer:if(e&&e.contentAnchorPosition){const t=e.contentAnchorPosition.contentId,n=e.noOfPrecedingThreadsOnSameLine?e.noOfPrecedingThreadsOnSameLine:0;if(!t)return void this.store.ULS.sendTraceTag(595903774,W.n.msoulscat_Wac_Telemetry,$.k.Error,"[AddContainer]ContentId is null.");const i=J({contentId:t,contentType:d(e.contentAnchorPosition.containerContentType),renderMode:s.G9.Integrated}),o=this.store.getContainerIdToInfoMap()[i];if(void 0!==this.containerCreationTimers[i])return void this.store.ULS.sendTraceTag(509634193,W.n.msoulscat_Wac_Telemetry,$.k.Warning,"[AddContainer]Container Creation in queue.");if(o&&o.floatingContainerRef)return void this.store.ULS.sendTraceTag(595097123,W.n.msoulscat_Wac_Telemetry,$.k.Warning,"[AddContainer]Container already exists.");const r=this.store.initializeAndRenderFloatingContainer(e.contentAnchorPosition,i,this.onContainerResize,void 0,!0);if(this.draftContainerId=t,r){this.store.addContentAnchorPosition(e.contentAnchorPosition,n);const i={contentId:t,containerContentType:e.contentAnchorPosition.containerContentType};e.shouldSetFocus&&this.emitEvent(bt.FocusContainer,{containerContentDescriptor:i})}}break;case bt.DeleteContainer:if(e&&e.containerContentDescriptor){if(!e.containerContentDescriptor.contentId)return void this.store.ULS.sendTraceTag(595903775,W.n.msoulscat_Wac_Telemetry,$.k.Error,"[DeleteContainer]ContentId is null.");const t=J({contentId:e.containerContentDescriptor.contentId,contentType:d(e.containerContentDescriptor.containerContentType),renderMode:s.G9.Integrated}),n=this.store.getContainerIdToInfoMap()[t];if(!n)return void this.store.ULS.sendTraceTag(595723333,W.n.msoulscat_Wac_Telemetry,$.k.Error,`[DeleteContainer]Container info for id ${t} does not exist.`);const i=n.position.y,o=this.deleteContainer(t,!!e.animateOutOnDeletion);if(-1===o)return;this.store.activeContainerId&&this.store.activeContainerId!==t?this.positionFloatingContainers(this.store.getContentAnchorPositions(),void 0,this.store.activeContainerId):this.positionFloatingContainers(this.store.getContentAnchorPositions().slice(o),i)}break;case bt.FocusContainer:if(e&&e.containerContentDescriptor){if(!e.containerContentDescriptor.contentId)return void this.store.ULS.sendTraceTag(595903777,W.n.msoulscat_Wac_Telemetry,$.k.Error,"[FocusContainer]ContentId is null.");const t=J({contentId:e.containerContentDescriptor.contentId,contentType:d(e.containerContentDescriptor.containerContentType),renderMode:s.G9.Integrated});if(!this.store.getContainerIdToInfoMap()[t])return this.store.ULS.sendTraceTag(595903778,W.n.msoulscat_Wac_Telemetry,$.k.Error,`[FocusContainer]Container with id ${t} does not exist`),void this.setInitialActiveContainerIdV2(e.containerContentDescriptor,null);this.store.activeContainerId!==t&&(this.clearSelection(!0),this.positionFloatingContainers(this.store.getContentAnchorPositions(),void 0,t,void 0,!0));const n=this.store.getContainerIdToInfoMap()[t].floatingContainerRef;e.shouldSetFocus&&n&&n.setFocus(),this.store.activeContainerId=t}break;case bt.SendContainersInView:if(e&&e.contentAnchorPositions){if(e.containerContentByType&&e.containerContentByType[i.TrackedChange]){const t=e.containerContentByType[i.TrackedChange];for(const[e,n]of Object.entries(t))this.trackChangesStore.addOrUpdateStore(e,n)}this.processContentAnchorPositionsInView(e.contentAnchorPositions)}break;case bt.UpdateViewportInfo:e&&e.viewportInfo&&(this.store.viewportInfo=e.viewportInfo,this.featureSettings.SynchronousContainerPositioningEnabled||this.positionFloatingContainers());break;case bt.ReplaceContainerContent:if(e&&e.infoToReplaceContent){const t=e.infoToReplaceContent.currentContentId,n=e.infoToReplaceContent.newContentId;if(!t||!n)return void this.store.ULS.sendTraceTag(595855174,W.n.msoulscat_Wac_Telemetry,$.k.Error,`[ReplaceContainerContent]${t?"NewContentId":"CurrentContentId"} is null.`);const i=J({contentId:t,contentType:d(e.infoToReplaceContent.containerContentType),renderMode:s.G9.Integrated}),o=this.store.getContainerIdToInfoMap()[i];if(!o)return void this.store.ULS.sendTraceTag(595855175,W.n.msoulscat_Wac_Telemetry,$.k.Error,`[ReplaceContainerContent]ContainerInfo for id ${i} does not exist`);if(!o.floatingContainerRef)return void this.store.ULS.sendTraceTag(595855176,W.n.msoulscat_Wac_Telemetry,$.k.Error,`[ReplaceContainerContent]FloatingContainerRef with id ${i} does not exist`);o.floatingContainerRef.changeRenderedContentIdentifier({contentId:n,contentType:d(e.infoToReplaceContent.containerContentType)}),this.replacementContentId=n;const r=J({contentId:n,contentType:d(e.infoToReplaceContent.containerContentType),renderMode:s.G9.Integrated}),a=this.store.getContentCardIndex(i);if(-1===a)return void this.store.ULS.sendTraceTag(595855178,W.n.msoulscat_Wac_Telemetry,$.k.Error,`[ReplaceContainerContent]Positional index for content id ${t} should not be negative`);this.store.activeContainerId=this.store.activeContainerId===i?r:this.store.activeContainerId,this.store.getContainerIdToInfoMap()[r]=o,delete this.store.getContainerIdToInfoMap()[i],this.store.getContentAnchorPositions()[a].contentId=n}break;case bt.UpdateContainersVisibility:this.positionFloatingContainers();break;case bt.FilterApplied:this.ribbonCommentFilteringEnabled&&(e?.filteredContent?.includedContent.forEach((t=>{if(t.contentId){const e=J({contentId:t.contentId,contentType:d(t.containerContentType),renderMode:s.G9.Integrated}),n=this.store.getContainerIdToInfoMap()[e];n&&n.floatingContainerRef&&n.floatingContainerRef.showFloatingContainer(!0)}})),e?.filteredContent?.excludedContent.forEach((t=>{if(t.contentId){const e=J({contentId:t.contentId,contentType:d(t.containerContentType),renderMode:s.G9.Integrated}),n=this.store.getContainerIdToInfoMap()[e];n&&n.floatingContainerRef&&n.floatingContainerRef.hideFloatingContainer(!0)}})))}},this.getAreContainersEnabled=()=>!this.store.isCommentPaneOpen&&this.store.areCommentExtensionProvidersDefinedOnce,this.getContentAnchorPosition=t=>{if(!t)return null;const e=J({contentId:t,contentType:s.cM.CommentThread,renderMode:s.G9.Integrated}),n=this.store.getContentCardIndex(e);return-1!==n?this.store.getContentAnchorPositions()[n]:null},this.containerShouldBeCreatedEventHandler=t=>{const e=this.store.getContentCardIndex(t.containerId);this.store.initializeAndRenderFloatingContainer(this.store.getContentAnchorPositions()[e],t.containerId,this.onContainerResize)},this.updateCommentPaneState=()=>{this.store.isCommentPaneOpen=!0,this.store.extensionProviderCollection&&(this.store.isCommentPaneOpen=0===this.store.extensionProviderCollection.providers.filter((t=>t.scope.contentType===s.cM.CommentThread&&t.scope.renderMode===s.G9.Integrated)).length),this.onCommentPaneStateChange()},this.onContainerResize=t=>{if(this.store.isCommentPaneOpen||t.stateChangeType!==l.Resize||0===t.contentRect.height)return;const e=t.contentIdentifier,n=J({contentId:e.contentId,contentType:e.contentType,renderMode:s.G9.Integrated}),i=this.store.getContainerIdToInfoMap()[n];if(!i)return void this.store.ULS.sendTraceTag(595646153,W.n.msoulscat_Wac_Telemetry,$.k.Error,`[ContainerResize] ContainerInfo does not exist, id: ${n}, size: ${t.contentRect.height}`);const o=i.position.height!==t.contentRect.height;if(this.isInitialActiveIdSet&&this.store.activeContainerId===n&&i.floatingContainerRef&&(this.onInitialActiveContainerRender?(this.onInitialActiveContainerRender(),this.onInitialActiveContainerRender=void 0):i.floatingContainerRef.setFocus()),!o)return;if(i.position.height=t.contentRect.height,i.position.width=t.contentRect.width,this.firstContainerBeingRendered){const t=window.performance&&window.performance.now?window.performance.now():Date.now();this.store.ULS.sendTraceTag(595718473,W.n.msoulscat_Wac_Telemetry,$.k.Info,t.toString()),wacBoot.WacSkeletalBoot.isSkeletalDeepLink()&&(Box4.FastViewExtensions.setDeepLinkComplete(),document.body.classList.remove("Deeplink"),Box4.FastViewExtensions.dismiss(),wacBoot.WacSkeletalBoot.setComponentReady("SkeletalPage")),this.firstContainerBeingRendered=!1}const r=void 0!==this.containerCreationTimers[n];if(this.featureSettings.DeselectionEnabled?this.positionContainersOnResize(n,i,r):this.positionFloatingContainers(this.store.getContentAnchorPositions(),void 0,this.store.activeContainerId,r),e.contentId&&e.contentId===this.draftContainerId){const t=this.store.isContainerInViewPort(i.anchorTop);this.store.ULS.sendTraceTag(553747984,W.n.msoulscat_Wac_Telemetry,$.k.Info,`[ContainerResize] Draft Container created with id: ${e.contentId} created and in viewport ${t}`)}this.isInitialActiveIdSet&&this.store.activeContainerId===n&&i.floatingContainerRef&&(this.isInitialActiveIdSet=!1),i.floatingContainerRef&&i.floatingContainerRef.showFloatingContainer(r),t.contentIdentifier.contentId===this.replacementContentId&&(this.replacementContentId=void 0),r&&(delete this.containerCreationTimers[n],void 0!==this.stallDetectorUsed&&(window.clearTimeout(this.stallDetectorTimeoutId),this.stallDetectorTimeoutId=void 0,this.processContainerQueue()))},this.paneClosedCallback=o,this.paneOpenedCallback=r,this.destroyAllContainersCallback=c,this.ribbonCommentFilteringEnabled=a.RibbonCommentFilteringEnabled,a.ShouldInitialize&&this.initialize(),a.TrackChangesInSidetrackEnabled&&((0,I.l9)().registerComponent(et,tt),async function(){const t={priority:s.OR.Primary,renderMode:s.G9.Integrated,instanceId:q.T,componentDimensions:void 0};return(0,s.Ld)().registerExtension(s.cM.TrackedChange,et,t)}().catch((t=>{this.store.ULS.sendTraceTag(538022360,W.n.msoulscat_Wac_Telemetry,$.k.Warning,`Failed to register TrackChange extension: ${t}`)})))}}var lt=n(27549);class ht{bringContentIntoView(t){this.wordContentNavigationApi.bringContentIntoView({contentIdentifier:{contentId:t.contentIdentifier.contentId,containerContentType:Y(t.contentIdentifier.contentType)}})}moveFocus(t){this.wordContentNavigationApi.moveFocus({resource:{contentId:t.resource?.contentId,containerContentType:Y(t.resource?.contentType)}})}selectNextOrPreviousContent(t){this.wordContentNavigationApi.selectNextOrPreviousContent({selectDirection:this.directionTranslation[t.selectDirection],reason:this.navReasonTranslation[t.reason],preventLooping:t.preventLooping,restrictToCurrentContext:t.restrictToCurrentContext,from:t.from&&{contentId:t.from.contentId,containerContentType:Y(t.from.contentType)}})}constructor(t){this.wordContentNavigationApi=t,this.directionTranslation={[lt.w.None]:xt.None,[lt.w.Previous]:xt.Previous,[lt.w.Next]:xt.Next},this.navReasonTranslation={[Z.G6.HostAction]:At.HostAction,[Z.G6.Keyboarding]:At.Keyboarding}}}class ut{get cardStyles(){return this.styles}get cardStrings(){return this.strings??{regularHeading:"Accept or reject suggestion?",acceptHoveredHeading:"Accept Suggestion",rejectHoveredHeading:"Reject Suggestion"}}loadStrings(t="en-US"){this.stringLoader.loadStrings(t).then((t=>{this.strings={regularHeading:t.TrackChangeCardAcceptOrRejectSuggestionLabel,acceptHoveredHeading:t.TrackChangeCardAcceptSuggestionLabel,rejectHoveredHeading:t.TrackChangeCardRejectSuggestionLabel}})).catch((t=>{}))}registerOnStoreUpdate(t,e){this.storeUpdateHandlers.set(t,e)}addOrUpdateStore(t,e){this.trackChangeInfoById.set(t,e);const n=this.storeUpdateHandlers.get(t);n&&n({type:"content",data:e})}removeFromStore(t){this.trackChangeInfoById.delete(t),this.storeUpdateHandlers.delete(t)}reloadStore(){this.updateVersion++}registerTrackChangeCardActionExecuter(t){this.trackChangeCardActionExecuter=t}getCardActionCallbacks(t){return{onAcceptClick:this.createActionCallback("AcceptClick",t),onRejectClick:this.createActionCallback("RejectClick",t),onAcceptHoverIn:this.createActionCallback("AcceptMouseOver",t),onAcceptHoverOut:this.createActionCallback("AcceptMouseOut",t),onRejectHoverIn:this.createActionCallback("RejectMouseOver",t),onRejectHoverOut:this.createActionCallback("RejectMouseOut",t),onCardHoverIn:this.createActionCallback("CardMouseOver",t),onCardHoverOut:this.createActionCallback("CardMouseOut",t),onCardClick:this.createActionCallback("CardClick",t)}}getContainerContent(t){return this.trackChangeInfoById.get(t)}clearStore(){this.trackChangeInfoById.clear(),this.storeUpdateHandlers.clear()}focusTrackChangeCard(t){const e=this.storeUpdateHandlers.get(t);e&&e({type:"behavior",data:{action:Q.Focus}})}createActionCallback(t,e){return()=>{this.trackChangeCardActionExecuter&&this.trackChangeCardActionExecuter(t,this.updateVersion,e)}}constructor(t){this.stringLoader=t,this.trackChangeInfoById=new Map,this.storeUpdateHandlers=new Map,this.updateVersion=0,this.styles={minWidth:238,maxWidth:238,borderRadius:4}}}var pt=n(71958),Ct=n(12248),gt=n(76524),ft=n(95275);class vt{async loadStrings(t){return n(34972)(`./${t}/canvas-contextual.json`).then((async t=>t)).catch((t=>ft.CB))}}var It=n(76851),mt=n(87309),Tt=n(97193);class yt{updateFilterForFilteredRangeId(t,e){if(!this.filterMap.has(t))return;const n=this.updateOrder(t,e);this.triggerFilterSurveryOnFilterUpdate(e),n.length>0&&this.onFilteredRangeUpdated.trigger({filterId:t,payload:{changes:n}})}triggerFilterSurveryOnFilterUpdate(t){!this.currentActiveFilter||t.CommentThread?.resolutionStatus===this.currentActiveFilter.CommentThread?.resolutionStatus&&t.mentionsToCurrentUser===this.currentActiveFilter?.mentionsToCurrentUser||this.wordFilterAPI.triggerFilterSurvey?.(),this.currentActiveFilter=t}async getExistingFilteredRange(t){const e=this.filterMap.get(t),n=this.filteredContentMap.get(t);if(e&&n)return{content:n,filter:e.filter,filterId:t,supportsFilterUpdates:e.supportsFilterUpdates}}setActiveFilteredRange(t){this.activeFilteredRange=t,t&&this.wordFilterAPI.updateCurrentFilteredContent?.(this.idsInFilter.get(t),{mentionsToCurrentUser:this.filterMap.get(t)?.filter.mentionsToCurrentUser,resolutionStatus:this.filterMap.get(t)?.filter.CommentThread?.resolutionStatus},void 0)}async getActiveFilteredRangeId(){return this.activeFilteredRange}async getFilteredRange(t){const e=(0,mt.g)();return this.updateOrder(e,t.hostFilter),{filterId:e,content:this.filteredContentMap.get(e)??[],supportsFilterUpdates:t.supportsFilterUpdates,filter:t.hostFilter}}teardownFilteredRange(t){this.filteredContentMap.delete(t),this.filterMap.delete(t)}getCapabilities(){return Promise.resolve({supportedContentTypes:s.cM.CommentThread,supportsMentionToMeFilter:!0})}async getHostSpecificLabels(){return{}}async getFilterUsers(){return[]}updateOrder(t,e){const n=new Set,o=this.filteredContentMap.get(t)??[],r=this.wordFilterAPI?.getAllContent().filter((t=>{if(t?.contentId&&t?.containerContentType===i.CommentThread){const i=t.contentId;return!!this.includeCommentInOrder(e,t)&&!n.has(i)&&(n.add(i),!0)}return!1})).map((t=>({contentId:t.contentId??"",contentType:d(t.containerContentType)})))??[];this.filteredContentMap.set(t,r);const a={filter:e,supportsFilterUpdates:!0};this.filterMap.set(t,a);const s=this.idsInFilter.get(t);this.idsInFilter.set(t,n);const c=((t,e,n,i)=>{if(!n)return[{type:"Reload",fullContent:e,reason:It.Wq.DivergentChange}];const o=function(t,e,n,i){let o=0,r=0,a=0;const s=new Set,c=[];for(;o<t.length&&r<e.length;)t[o].contentId===e[r].contentId?(o++,r++,a++):n.has(t[o].contentId)?i.has(e[r].contentId)?s.has(e[r].contentId)?(s.delete(e[r].contentId),c.push({type:"Insert",index:a,content:e[r]}),a++,r++):(s.add(t[o].contentId),c.push({type:"Remove",index:a}),o++):(c.push({type:"Insert",index:a,content:e[r]}),r++,a++):(c.push({type:"Remove",index:a}),o++);for(;r<e.length;)c.push({type:"Insert",content:e[r],index:a}),a++,r++;for(;o<t.length;)c.push({type:"Remove",index:a}),o++;return c}(t,e,i,n);return o})(o,r,s,n);return this.wordFilterAPI.updateCurrentFilteredContent?.(n,{mentionsToCurrentUser:a.filter.mentionsToCurrentUser,resolutionStatus:a.filter.CommentThread?.resolutionStatus},c.length>0),c}onContentChanged(){this.filterMap.forEach(((t,e)=>{this.updateFilterForFilteredRangeId(e,t.filter)}))}includeCommentInOrder(t,e){if(t.CommentThread){if(e.contentId&&this.wordFilterAPI.isDraftContent?.(e.contentId))return!0;if(t.CommentThread.resolutionStatus===It.eT.ResolvedOnly&&this.wordFilterAPI.isContentActive(e))return!1;if(t.CommentThread.resolutionStatus===It.eT.ActiveOnly&&!this.wordFilterAPI.isContentActive(e))return!1}return!(t.mentionsToCurrentUser&&!this.wordFilterAPI.isCurrentUserMentioned(e))}onRibbonFilterChanged(t){this.createOrUpdateFilter(t)}createOrUpdateFilter(t){const e={mentionsToCurrentUser:t.mentionsToCurrentUser||!1,CommentThread:{resolutionStatus:t.resolutionStatus||0}};this.activeFilteredRange?this.updateFilter(e):this.createFilter(e)}updateFilter(t){this.activeFilteredRange&&(this.updateFilterForFilteredRangeId(this.activeFilteredRange,t),this.getExistingFilteredRange(this.activeFilteredRange).then((e=>{if(e){const n=e.filterId;this.onFilteredRangeUpdated.trigger({filterId:n,payload:{changes:[{type:"FilterUpdate",updatedFilter:t}]}})}})).catch((t=>{console.error(`Comment Filter Update failed: ${t}`)})))}createFilter(t){this.getFilteredRange({contentTypes:[s.cM.CommentThread],hostFilter:t,supportsFilterUpdates:!0}).then((t=>{this.setActiveFilteredRange(t.filterId)})).catch((t=>console.error(`Error creating filter: ${t}`)))}constructor(t){this.wordFilterAPI=t,this.activeFilteredRange=void 0,this.filteredContentMap=new Map,this.filterMap=new Map,this.idsInFilter=new Map,this.currentActiveFilter=void 0,this.onFilteredRangeUpdated=new Tt.ZO((()=>{})),this.onActiveFilterUpdated=new Tt.ZO((()=>{})),this.onUserFilterManagerEvent=new Tt.ZO((()=>{})),t.registerOnContentChangeCallback(this.onContentChanged.bind(this)),t.registerOnRibbonFilterChangeCallback(this.onRibbonFilterChanged.bind(this))}}var bt,xt,At,Pt;!function(t){t[t.AddContainer=0]="AddContainer",t[t.DeleteContainer=1]="DeleteContainer",t[t.FocusContainer=2]="FocusContainer",t[t.SendContainersInView=3]="SendContainersInView",t[t.UpdateViewportInfo=4]="UpdateViewportInfo",t[t.ReplaceContainerContent=5]="ReplaceContainerContent",t[t.UpdateContainersVisibility=6]="UpdateContainersVisibility",t[t.FilterApplied=7]="FilterApplied"}(bt||(bt={})),function(t){t[t.None=0]="None",t[t.Next=1]="Next",t[t.Previous=2]="Previous"}(xt||(xt={})),function(t){t[t.Keyboarding=1]="Keyboarding",t[t.HostAction=2]="HostAction"}(At||(At={})),function(t){t[t.All=0]="All",t[t.ResolvedOnly=1]="ResolvedOnly",t[t.ActiveOnly=2]="ActiveOnly"}(Pt||(Pt={}));const Ft=new class{getFCManagerInstance(t){if(void 0===this.floatingContainerManagerInstance){if(!t)throw new Error("Floating Container Manager creation arguments are missing!");t.ulsLogger&&G.Hv.setLogger(t.ulsLogger);const n={DeselectionEnabled:!!(e=t.featureGates).deselectionEnabled,FloatingContainerVirtualizationEnabled:!!e.floatingContainerVirtualizationEnabled,ImproveJumpingFixEnabled:!!e.improveJumpingFixEnabled,ShouldInitialize:!1!==e.shouldInitialize,ScrollingPerfImprovementEnabled:!!e.scrollingPerfImprovementEnabled,SynchronousContainerPositioningEnabled:!!e.synchronousContainerPositioningEnabled,TrackChangesInSidetrackEnabled:!!e.trackChangeInSidetrackEnabled,ContentNavigationApiEnabled:!!e.contentNavigationApiEnabled,ReturnToDraftFixEnabled:!!e.returnToDraftFixEnabled,RibbonCommentFilteringEnabled:!!e.ribbonCommentFilteringEnabled,CommentHorizontalShiftEnabled:!!e.commentHorizontalShiftEnabled};if(t.featureGateApiSettings&&(!0!==t.featureGates.featureGateInitializationCheckEnabled||!(0,pt.Mh)()))try{(0,pt.EV)({appSettings:t.featureGateApiSettings,mapping:Ct.i})}catch(t){G.Hv.sendTraceTag(507299534,W.n.msoulscat_Wac_Telemetry,$.k.Warning,`Failed to initialize Feature gate: ${t}`)}const i=t.isRtl?1:-1,o=t.canvasAndFcHostOffset&&t.featureGates.commentHorizontalShiftEnabled?i*(t.canvasAndFcHostOffset-1):0,r=new h(J,G.Hv,o),a={containerVirtualizationEnabled:n.FloatingContainerVirtualizationEnabled},c=new g(a),d=new ct(s.Ld,t.containerPanel,B,G.Hv,t.viewportInfo);if(t.telemetryDetails)try{(0,f.Uy)(gt.r,t.telemetryDetails)}catch(t){G.Hv.sendTraceTag(507299533,W.n.msoulscat_Wac_Telemetry,$.k.Warning,`Failed to initialize Telemetry: ${t}`)}this.trackChangesStore.loadStrings(t.uiCulture),this.floatingContainerManagerInstance=new dt(r,c,d,t.paneClosedCallback,t.paneOpenedCallback,n,t.destroyAllContainersCallback,this.trackChangesStore),t.sidetrackContentNavigationApi&&this.registerContentNavigationApi(t.sidetrackContentNavigationApi),t.contentFilterAPI&&this.registerContentFilteredRangeHostApi(t.contentFilterAPI)}var e;return this.floatingContainerManagerInstance}getTrackChangesStoreApi(){return this.trackChangesStore}getFCContentNavigationAPI(){return this.floatingContainerContentNavigationAPI}getTrackChangesStore(){return this.trackChangesStore}registerContentNavigationApi(t){(0,Z.AA)(this.initializeAndGetContentNavigationAPI(t),q.T)}initializeAndGetContentNavigationAPI(t){return this.floatingContainerContentNavigationAPI||(this.floatingContainerContentNavigationAPI=new ht(t)),this.floatingContainerContentNavigationAPI}registerContentFilteredRangeHostApi(t){(0,It.Gs)(q.T,this.initializeAndGetContentFilteredRangeHostApi(t))}initializeAndGetContentFilteredRangeHostApi(t){return this.contentFilteredRangeHostAPI||(this.contentFilteredRangeHostAPI=new yt(t)),this.contentFilteredRangeHostAPI}constructor(){const t=new vt;this.trackChangesStore=new ut(t)}},Rt=Ft},34972:function(t,e,n){var i={"./af-ZA/canvas-contextual.json":[78368,6297],"./am-ET/canvas-contextual.json":[55031,35068],"./ar-SA/canvas-contextual.json":[68149,55622],"./as-IN/canvas-contextual.json":[78183,17936],"./az-Latn-AZ/canvas-contextual.json":[1070,11153],"./be-BY/canvas-contextual.json":[10118,13695],"./bg-BG/canvas-contextual.json":[53298,33879],"./bn-BD/canvas-contextual.json":[48734,70095],"./bn-IN/canvas-contextual.json":[6884,16268],"./bs-Latn-BA/canvas-contextual.json":[18712,8991],"./ca-ES/canvas-contextual.json":[96584,13113],"./ca-Es-VALENCIA/canvas-contextual.json":[14658,48129],"./chr-Cher-US/canvas-contextual.json":[87438,17283],"./cs-CZ/canvas-contextual.json":[49087,39188],"./cy-GB/canvas-contextual.json":[95429,24638],"./da-DK/canvas-contextual.json":[44712,37005],"./de-DE/canvas-contextual.json":[36237,60327],"./el-GR/canvas-contextual.json":[93206,4895],"./en-GB/canvas-contextual.json":[64272,14109],"./en-US/canvas-contextual.json":[29657,13766],"./es-ES/canvas-contextual.json":[62084,69785],"./es-MX/canvas-contextual.json":[25285,68782],"./et-EE/canvas-contextual.json":[86873,59394],"./eu-ES/canvas-contextual.json":[99506,37179],"./fa-IR/canvas-contextual.json":[95176,65073],"./fi-FI/canvas-contextual.json":[10514,51307],"./fil-PH/canvas-contextual.json":[64437,3660],"./fr-CA/canvas-contextual.json":[53048,91517],"./fr-FR/canvas-contextual.json":[52396,70221],"./ga-IE/canvas-contextual.json":[71910,43791],"./gd-gb/canvas-contextual.json":[84784,34801],"./gl-ES/canvas-contextual.json":[78049,87250],"./gu-IN/canvas-contextual.json":[55431,57652],"./ha-Latn-NG/canvas-contextual.json":[20494,36173],"./he-IL/canvas-contextual.json":[59204,12557],"./hi-IN/canvas-contextual.json":[95858,94763],"./hr-HR/canvas-contextual.json":[51164,62025],"./hu-HU/canvas-contextual.json":[10938,93591],"./hy-AM/canvas-contextual.json":[82847,52660],"./id-ID/canvas-contextual.json":[52482,21767],"./is-IS/canvas-contextual.json":[41532,98705],"./it-IT/canvas-contextual.json":[94306,37607],"./ja-JP/canvas-contextual.json":[98529,23174],"./ka-GE/canvas-contextual.json":[17192,31061],"./kk-KZ/canvas-contextual.json":[19639,94316],"./km-KH/canvas-contextual.json":[94595,40388],"./kn-IN/canvas-contextual.json":[74856,91217],"./ko-KR/canvas-contextual.json":[2787,7024],"./kok-IN/canvas-contextual.json":[64610,10753],"./ky-KG/canvas-contextual.json":[47950,38835],"./lb-LU/canvas-contextual.json":[60817,35018],"./lo-LA/canvas-contextual.json":[30924,63317],"./lt-LT/canvas-contextual.json":[45192,61729],"./lv-LV/canvas-contextual.json":[41404,82417],"./mi-NZ/canvas-contextual.json":[51158,11119],"./mk-MK/canvas-contextual.json":[29572,14649],"./ml-IN/canvas-contextual.json":[8940,29121],"./mn-MN/canvas-contextual.json":[42958,54855],"./mr-IN/canvas-contextual.json":[20926,56903],"./ms-MY/canvas-contextual.json":[18030,57939],"./mt-MT/canvas-contextual.json":[18282,80511],"./nb-NO/canvas-contextual.json":[9311,22508],"./ne-NP/canvas-contextual.json":[10141,47858],"./nl-NL/canvas-contextual.json":[68808,57173],"./nn-NO/canvas-contextual.json":[53947,55952],"./or-IN/canvas-contextual.json":[77464,31302],"./pa-IN/canvas-contextual.json":[34626,12411],"./pl-PL/canvas-contextual.json":[86928,37641],"./prs-AF/canvas-contextual.json":[3038,15905],"./pt-BR/canvas-contextual.json":[51556,33105],"./pt-PT/canvas-contextual.json":[65168,72137],"./qps-ploc/canvas-contextual.json":[38440,79067],"./qps-ploca/canvas-contextual.json":[60441,3242],"./qps-plocm/canvas-contextual.json":[72061,33606],"./quz-PE/canvas-contextual.json":[83952,42958],"./ro-RO/canvas-contextual.json":[74114,57799],"./ru-RU/canvas-contextual.json":[69346,41403],"./sd-Arab-PK/canvas-contextual.json":[50127,65202],"./si-LK/canvas-contextual.json":[13389,27750],"./sk-SK/canvas-contextual.json":[64432,64281],"./sl-SI/canvas-contextual.json":[33729,40910],"./sq-AL/canvas-contextual.json":[75377,48334],"./sr-Cyrl-BA/canvas-contextual.json":[53351,56022],"./sr-Cyrl-RS/canvas-contextual.json":[30401,15620],"./sr-Latn-RS/canvas-contextual.json":[21036,39003],"./sv-SE/canvas-contextual.json":[50135,39776],"./sw-KE/canvas-contextual.json":[97810,84547],"./ta-IN/canvas-contextual.json":[79126,67263],"./te-IN/canvas-contextual.json":[17626,54467],"./th-TH/canvas-contextual.json":[56176,22537],"./tk-TM/canvas-contextual.json":[18780,17765],"./tr-TR/canvas-contextual.json":[91436,67305],"./tt-RU/canvas-contextual.json":[31605,89854],"./ug-CN/canvas-contextual.json":[78893,18858],"./uk-UA/canvas-contextual.json":[430,5491],"./ur-PK/canvas-contextual.json":[78788,84553],"./uz-Latn-UZ/canvas-contextual.json":[1974,9193],"./vi-VN/canvas-contextual.json":[19235,51128],"./zh-CN/canvas-contextual.json":[48039,42804],"./zh-TW/canvas-contextual.json":[19063,14356]};function o(t){if(!n.o(i,t))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=i[t],o=e[0];return n.e(e[1]).then((function(){return n.t(o,19)}))}o.keys=function(){return Object.keys(i)},o.id=34972,t.exports=o}}]);
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/floatingContainerManager.min.js.map/917a3b75e44af0140948591d7f939c73/floatingContainerManager.min.js.map