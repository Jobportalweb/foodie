(globalThis.wordOnlineChunks=globalThis.wordOnlineChunks||[]).push([[37678],{19998:function(e,t,i){"use strict";i.r(t),i.d(t,{FactoryGlobal:function(){return Ku}});var o,r,n=i(47514);!function(e){e[e.Unknown=0]="Unknown",e[e.Inference=1]="Inference"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.VoiceDictationBadge=1]="VoiceDictationBadge",e[e.VoiceDictationPhrase=2]="VoiceDictationPhrase"}(r||(r={}));var s,a,l=i(1201),c=i(24819),d=i(95270),u=i(38435),g=i(65083),p=i(68595),h=i(60453),m=i(63827),y=i(82424),b=i(97652),f=i(27687),S=i(81095),v=i(1670);!function(e){e[e.Retry=0]="Retry",e[e.ClearSearch=1]="ClearSearch"}(s||(s={})),function(e){e[e.Undefined=0]="Undefined",e[e.ClassicAttachment=1]="ClassicAttachment",e[e.OneDriveForBusiness=2]="OneDriveForBusiness",e[e.SharepointOnline=3]="SharepointOnline"}(a||(a={}));var C=i(88672),x=i(25245),k=i(43681),T=i(84838);const I=3,w=16,A={background:{resting:"#FFFFFF",hover:"#F3F2F1",pressed:"#EDEBE9",disabled:"#F3F2F1"},text:{resting:"#201F1E",disabled:"#A19F9D"},tooltip:{textColor:"#201F1E",backgroundColor:"#FFFFFF"},tag:{resting:"#201F1E"},altText:{resting:"#605E5C"},icon:{resting:"#757470",disabled:"#CCCCCC"},altIcon:{resting:"#616161",hover:"#185ABD",disabled:"#CCCCCC"},grammarText:{resting:"#3355FF"},refinementText:{resting:"#5A45B6"},rewriteText:{resting:"#5A45B6"},suggestionMenuHoverBackground:"#E1DFDD",primaryButtonBackground:{resting:"#2E6AC5",hover:"#1651AA",pressed:"#0E336A",disabled:"#F3F2F1"},primaryButtonText:{resting:"#FFFFFF",disabled:"#A19F9D"},header:"#3B3A39",subheader:"#605E5C",dialogText:"#323130",iconText:"#201F1E",contextText:"#201F1E",errorText:"red",border:"#201F1E",separator:"#E6E6E6",focusRing:"#969696",link:"#1651AA",linkPressed:"#002050",addOnFooterBackground:"#F2F6FD",addOnFooterMessage:"#11100F",addOnHeaderBackground:"#ebf3fc",premiumEmphasis:"#2E6AC5",addOnAction:"#2E6AC5",editorIcon:"#185ABD",accessibilityIcon:"#185ABD",correctionHighlight:"#D4EDD4",helpLink:{text:{resting:"#1651AA",hover:"#13458F",focused:"#1651AA",pressed:"#0E336A"},focusRing:"#323130"},badgeBackground:"#185ABD",badgeText:"#FFFFFF"},D={background:{resting:"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},text:{resting:"var(--colorNeutralForeground1)",hover:"var(--colorNeutralForeground1Hover)",pressed:"var(--colorNeutralForeground1Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},icon:{resting:"var(--colorNeutralForeground1)",hover:"var(--colorNeutralForeground1Hover)",pressed:"var(--colorNeutralForeground1Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},altIcon:{resting:"var(--colorNeutralForeground1)",hover:"var(--colorNeutralForeground2BrandHover)",disabled:"var(--colorNeutralForegroundDisabled)"},suggestionMenuHoverForeground:"var(--colorNeutralForeground1Hover)",suggestionMenuHoverBackground:"var(--colorNeutralBackground1Hover)",tag:{resting:"var(--editorTagResting)",disabled:"var(--colorNeutralForegroundDisabled)"},altText:{resting:"var(--editorAltTextResting)",disabled:"var(--colorNeutralForegroundDisabled)"},grammarText:{resting:"var(--editorGrammarTextResting)",hover:"var(--editorGrammarTextHover)",disabled:"var(--colorNeutralForegroundDisabled)"},refinementText:{resting:"var(--editorRefinementTextResting)",hover:"var(--editorRefinementTextHover)",disabled:"var(--colorNeutralForegroundDisabled)"},rewriteText:{resting:"var(--editorRewriteTextResting)",hover:"var(--editorRewriteTextHover)"},primaryButtonBackground:{resting:"var(--editorPrimaryButtonBackgroundResting)",hover:"var(--editorPrimaryButtonBackgroundHover)",pressed:"var(--editorPrimaryButtonBackgroundPressed)",disabled:"var(--editorPrimaryButtonBackgroundDisabled)"},primaryButtonText:{resting:"var(--editorPrimaryButtonTextResting)",disabled:"var(--editorPrimaryButtonTextDisabled)"},header:"var(--editorHeader)",subheader:"var(--editorSubheader)",dialogText:"var(--editorDialogText)",iconText:"var(--editorIconText)",contextText:"var(--editorContextText)",errorText:"var(--editorErrorText)",border:"var(--editorBorder)",separator:"var(--editorSeparator)",focusRing:"var(--editorFocusRing)",addOnFooterBackground:"var(--editorAddOnFooterBackground)",addOnFooterMessage:"var(--editorAddOnFooterMessage)",addOnHeaderBackground:"var(--editorAddOnHeaderBackground)",premiumEmphasis:"var(--editorPremiumEmphasis)",addOnAction:"var(--editorAddOnAction)",editorIcon:"var(--editorEditorIcon)",accessibilityIcon:"var(--editorAccessibilityIcon)",correctionHighlight:"var(--editorCorrectionHighlight)",helpLink:{text:{resting:"var(--editorHelpLinkTextResting)",hover:"var(--editorHelpLinkTextHover)",focused:"var(--editorHelpLinkTextFocused)",pressed:"var(--editorHelpLinkTextPressed)"},focusRing:"var(--editorHelpLinkFocusRing)"},badgeBackground:"var(--editorBadgeBackground)",badgeText:"var(--editorBadgeText)"},E=(x.RV.Single,k.R.Center,{x4small:7,x3small:8,xxsmall:10,xsmall:12,small:14,medium:16,large:18,xlarge:20,xxlarge:22}),M={xsmall:8,small:12,medium:16},L={paddingHorizontal:w,paddingTop:10,paddingBottom:8},R={paddingHorizontal:w,paddingBottom:8},O={paddingHorizontal:8,paddingVertical:4,gap:4},F={paddingHorizontal:12,paddingVertical:8,backgroundColor:"#EBF3FC",marginTop:4,marginBottom:-8},B={width:32,height:32},N={paddingHorizontal:8,fontSize:12},j={paddingHorizontal:w,flexibleSize:!0,borderRadius:4};function H(e){var t,i;return Object.assign(Object.assign({},e),{paddingHorizontal:null!==(t=null==e?void 0:e.paddingHorizontal)&&void 0!==t?t:8,borderRadius:null!==(i=null==e?void 0:e.borderRadius)&&void 0!==i?i:4})}function P(e){var t;return Object.assign(Object.assign({},e),{tooltipProps:null==e?void 0:e.tooltipButtonStyles,borderRadius:null!==(t=null==e?void 0:e.borderRadius)&&void 0!==t?t:4})}function z(e){var t;return Object.assign(Object.assign({},e),{borderRadius:null!==(t=null==e?void 0:e.borderRadius)&&void 0!==t?t:4})}const U={paddingHorizontal:16,paddingVertical:4,textAlign:k.R.Center,borderRadius:2},W={paddingTop:24,paddingBottom:24,marginStart:24,marginEnd:24},G={paddingTop:12},_={marginHorizontal:16,marginStart:10,paddingTop:12},q={paddingTop:12,paddingBottom:12,marginEnd:4},V={paddingVertical:2},Z={fontSize:14},K={paddingTop:16},Y={paddingHorizontal:0,paddingTop:12},Q={marginTop:14};function $(e,t){return{backgroundColor:null==t?void 0:t.background.resting,minWidth:e?e.minWidth:void 0,maxWidth:e?e.maxWidth:void 0,paddingHorizontal:16,paddingTop:6,paddingBottom:22}}function J(e){return{height:60,borderWidth:1,borderColor:e.subheader}}const X={paddingHorizontal:0,paddingVertical:0,borderThickness:0},ee={marginHorizontal:w};function te(e,t,i){return{fontWeight:x.IT.SemiBold,fontFamily:T.V,fontSize:t.xsmall,cssColor:(null==i?void 0:i.useFluentV9)?"var(--colorNeutralForeground1)":e.header}}const ie={paddingTop:20,paddingBottom:8};function oe(e,t,i){let o=t.xsmall;((null==i?void 0:i.isLargeHeader)||(null==i?void 0:i.isIconHeader))&&(o=(null==i?void 0:i.isLargeHeader)?t.xxlarge:t.xxsmall);const r=(null==i?void 0:i.isIconHeader)?e.iconText:(null==i?void 0:i.useFluentV9)?"var(--colorNeutralForeground2)":e.subheader;return{fontWeight:(null==i?void 0:i.isIconHeader)?x.IT.SemiBold:x.IT.Normal,fontFamily:T.V,fontSize:o,cssColor:r}}function re(e,t){return{cssColor:e.contextText,fontSize:t.small}}function ne(e,t){return{cssColor:e.addOnAction,fontSize:t.xlarge,fontWeight:x.IT.SemiBold,marginVertical:6}}function se(e,t){return{cssColor:e.subheader,fontSize:t.xsmall,marginVertical:6,lineHeight:16}}function ae(e,t){return{cssColor:e.subheader,fontSize:t.xsmall,lineHeight:16}}function le(e,t){return{cssColor:e.text.resting,fontSize:t.xsmall,fontWeight:x.IT.SemiBold,lineHeight:16}}function ce(e,t,i){var o;return"primary"===t&&e.primaryButtonBackground?Object.assign(Object.assign({},e.primaryButtonBackground),{focused:e.primaryButtonBackground.hover}):"dialog"===t?Object.assign(Object.assign({},e.background),{focused:e.background.hover}):i?{resting:null!==(o=e.background.hover)&&void 0!==o?o:"",disabled:void 0}:Object.assign(Object.assign({},e.background),{disabled:void 0})}function de(e,t){return"primary"===t&&e.primaryButtonText?e.primaryButtonText:"grammar"===t&&e.grammarText?e.grammarText:"refinement"===t&&e.refinementText?e.refinementText:e.text}function ue(e,t,i){var o;let r=t&&null!==(o=e.altIcon)&&void 0!==o?o:e.icon;return r=r&&Object.assign({},r),i&&(null==r?void 0:r.hover)&&(r.resting=r.hover),r}function ge(e,t,i,o){return{background:ce(e,t,o),title:de(e,t),tooltip:e.tooltip,tag:e.tag,subtitle:e.altText,icon:ue(e,i,o),border:"dialog"===t||"primary"===t?e.border:o?e.focusRing:void 0,focusRing:e.focusRing}}function pe(e,t){return Object.assign(Object.assign({},ge(e,void 0,!0,t)),{separator:e.separator})}function he(e,t){return ge(e,t?"primary":"dialog")}function me(e,t,i){return{minWidth:t?t.minWidth:void 0,maxWidth:t?t.maxWidth:void 0,minHeight:t?t.minHeight:void 0,maxHeight:t?t.maxHeight:void 0,backgroundColor:(null==i?void 0:i.useFluentV9)?"var(--colorNeutralBackground1)":e.background.resting,borderRadius:(null==t?void 0:t.hasBottomAttachment)?{topStart:8,topEnd:8}:8}}const ye={paddingHorizontal:24,paddingVertical:10};function be(e,t,i,o){return[{start:0,length:t,fontWeight:i?x.IT.Normal:x.IT.SemiBold,fontFamily:T.V,fontSize:o||e.small}]}function fe(e){return{fontFamily:T.V,fontWeight:x.IT.Normal,fontSize:e.xsmall}}function Se(e,t){return[{start:0,length:t,fontWeight:x.IT.Normal,fontFamily:T.V,fontSize:e.small}]}const ve=Se,Ce=Se;function xe(e){return{paddingHorizontal:8,borderRadius:2,iconFontSize:e.medium}}function ke(e){return{paddingHorizontal:8,borderRadius:4,iconFontSize:e.xlarge}}function Te(e,t){var i;return{paddingHorizontal:8,borderRadius:null!==(i=null==t?void 0:t.borderRadius)&&void 0!==i?i:4,iconFontSize:e.xlarge}}function Ie(e){return{borderColor:e.border}}function we(e){return{fontSize:e.xsmall}}function Ae(e){return{fontWeight:x.IT.Normal,fontSize:e.xxsmall}}function De(e,t){return{fontWeight:x.IT.SemiBold,fontSize:t.xxsmall,cssColor:e.text.resting}}function Ee(e,t,i,o){return{fontWeight:x.IT.Normal,fontFamily:T.V,fontSize:o||(t?e.xxsmall:e.xsmall),width:"100%",truncate:!!i,height:14}}function Me(e){return{paddingTop:e.small,paddingBottom:3*e.small,paddingHorizontal:e.medium,widths:["91%","96%","71%"]}}function Le(e){var t,i,o,r,n;return{color:null===(t=e.helpLink)||void 0===t?void 0:t.text.resting,hoverColor:null===(i=e.helpLink)||void 0===i?void 0:i.text.hover,focusColor:null===(o=e.helpLink)||void 0===o?void 0:o.text.focused,pressedColor:null===(r=e.helpLink)||void 0===r?void 0:r.text.pressed,focusRing:e.helpLink?null===(n=e.helpLink)||void 0===n?void 0:n.focusRing:e.focusRing}}function Re(e){return{fontSize:e.xxsmall}}const Oe={marginHorizontal:16,marginVertical:10};x.IT.SemiBold,k.R.Center;const Fe=(e,t)=>{var i;return null!==(i=e.theme)&&void 0!==i?i:t?D:A},Be={headerMarginVertical:4,itemBorderRadius:4,itemIconSize:24,menuHeight:252},Ne={flexibleSize:!0,borderRadius:4},je={width:300,maxHeight:48};x.IT.Bold;const He={width:24,height:24,minWidth:24};function Pe(e,t){var i,o,r,n,s,a,l,c,d;return{containerStyles:{paddingHorizontal:null!==(i=null==t?void 0:t.paddingHorizontal)&&void 0!==i?i:2,paddingVertical:null!==(o=null==t?void 0:t.paddingVertical)&&void 0!==o?o:6,minWidth:null!==(r=null==t?void 0:t.minWidth)&&void 0!==r?r:33,height:null!==(n=null==t?void 0:t.height)&&void 0!==n?n:18,backgroundColor:null===(s=e.tag)||void 0===s?void 0:s.background,borderRadius:null!==(a=null==t?void 0:t.borderRadius)&&void 0!==a?a:8},textStyles:{width:null!==(l=null==t?void 0:t.minWidth)&&void 0!==l?l:33,height:(null==t?void 0:t.height)?(null==t?void 0:t.height)-4:20,fontSize:null!==(c=null==t?void 0:t.fontSize)&&void 0!==c?c:10,cssColor:null===(d=e.tag)||void 0===d?void 0:d.textColor,fontFamily:"Segoe UI",fontWeight:x.IT.Bold,textAlign:"center"}}}const ze=Object.assign(Object.assign({},He),{margin:8}),Ue=(Object.assign(Object.assign({},He),{margin:8,marginRight:0}),{marginTop:6,fontSize:20}),We={paddingHorizontal:12};function Ge(e,t,i){var o,r;return{fontWeight:x.IT.SemiBold,fontFamily:T.V,fontSize:i.xsmall,paddingHorizontal:8,marginVertical:null!==(o=t.headerMarginVertical)&&void 0!==o?o:4,cssColor:e.text.resting,lineHeight:null!==(r=t.headerLineHeight)&&void 0!==r?r:20}}function _e(e,t,i){var o,r,n;return{fontWeight:x.IT.Normal,fontFamily:T.V,fontSize:i.xsmall,marginTop:0,marginBottom:null!==(o=t.headerMarginVertical)&&void 0!==o?o:4,paddingHorizontal:8,cssColor:null!==(n=null===(r=e.altText)||void 0===r?void 0:r.resting)&&void 0!==n?n:"#605e5c"}}const qe={style:{marginStart:-8,marginEnd:-12,marginTop:8,marginBottom:8,height:1}},Ve={paddingTop:12,paddingBottom:8,paddingHorizontal:12},Ze=Ve,Ke={paddingVertical:8,paddingStart:4,borderRadius:8};var Ye,Qe,$e,Je,Xe,et,tt,it;!function(e){e[e.Text=0]="Text",e[e.Icon=1]="Icon",e[e.MonochromeIcon=2]="MonochromeIcon",e[e.IconButton=3]="IconButton",e[e.IconAndTextButton=4]="IconAndTextButton",e[e.CustomImageAndText=5]="CustomImageAndText"}(Ye||(Ye={})),function(e){e[e.Classification=0]="Classification",e[e.Spelling=1]="Spelling",e[e.RepeatedWord=2]="RepeatedWord",e[e.Grammar=3]="Grammar",e[e.Refinement=4]="Refinement",e[e.NeuralRewrite=5]="NeuralRewrite",e[e.SimilarityChecker=6]="SimilarityChecker",e[e.TonalRewrite=7]="TonalRewrite",e[e.Topic=8]="Topic",e[e.DictationCorrection=9]="DictationCorrection",e[e.AccColorChecker=10]="AccColorChecker",e[e.WritersUnblock=11]="WritersUnblock",e[e.AIFeedback=12]="AIFeedback",e[e.TextPenAlternates=13]="TextPenAlternates",e[e.AltText=14]="AltText",e[e.InlineSuggestion=15]="InlineSuggestion",e[e.AddinCritique=16]="AddinCritique",e[e.MergeSplitCell=17]="MergeSplitCell",e[e.MissingTableHeader=18]="MissingTableHeader"}(Qe||(Qe={})),function(e){e[e.None=0]="None",e[e.Spelling=1]="Spelling",e[e.Grammar=2]="Grammar",e[e.Refinement=3]="Refinement",e[e.Rewrite=4]="Rewrite",e[e.SimilarityChecker=5]="SimilarityChecker",e[e.AccColorChecker=6]="AccColorChecker",e[e.Modification=7]="Modification",e[e.PremiumEmphasis=8]="PremiumEmphasis",e[e.TrackChangeContent=9]="TrackChangeContent",e[e.TrackChangePlaceholder=10]="TrackChangePlaceholder",e[e.CatchUp=11]="CatchUp"}($e||($e={})),function(e){e[e.Accept=0]="Accept",e[e.ReadAloud=1]="ReadAloud",e[e.SpellOut=2]="SpellOut",e[e.ChangeAll=3]="ChangeAll",e[e.AddToAutoCorrect=4]="AddToAutoCorrect",e[e.AutoCorrectOptions=5]="AutoCorrectOptions",e[e.IgnoreOnce=6]="IgnoreOnce",e[e.IgnoreAll=7]="IgnoreAll",e[e.IgnoreRule=8]="IgnoreRule",e[e.AddToDictionary=9]="AddToDictionary",e[e.Options=10]="Options",e[e.ShowExplanation=11]="ShowExplanation",e[e.ManageLanguages=12]="ManageLanguages",e[e.Next=13]="Next",e[e.Previous=14]="Previous",e[e.ToggleContext=15]="ToggleContext",e[e.ToggleDescription=16]="ToggleDescription",e[e.ReadContext=17]="ReadContext",e[e.ShowMenu=18]="ShowMenu",e[e.Feedback=19]="Feedback",e[e.Report=20]="Report",e[e.Dismiss=21]="Dismiss",e[e.AddOnFooterAction=22]="AddOnFooterAction",e[e.OpenEditorPane=23]="OpenEditorPane",e[e.LearnMore=24]="LearnMore",e[e.Complete=25]="Complete",e[e.IntextCitation=26]="IntextCitation",e[e.FullCitation=27]="FullCitation",e[e.Reject=28]="Reject",e[e.AcceptHoverIn=29]="AcceptHoverIn",e[e.AcceptHoverOut=30]="AcceptHoverOut",e[e.RejectHoverIn=31]="RejectHoverIn",e[e.RejectHoverOut=32]="RejectHoverOut",e[e.OpenCustomDictionary=33]="OpenCustomDictionary",e[e.MoreSources=34]="MoreSources",e[e.SourceSelected=35]="SourceSelected",e[e.Accessibility=36]="Accessibility",e[e.OpenColorPicker=37]="OpenColorPicker",e[e.TurnOffAccChecker=38]="TurnOffAccChecker",e[e.ApplyColor=39]="ApplyColor",e[e.Allow=40]="Allow",e[e.AllowAll=41]="AllowAll",e[e.FixSimilarColors=42]="FixSimilarColors",e[e.FixAllColors=43]="FixAllColors",e[e.AutoGenAltText=44]="AutoGenAltText",e[e.MissingAltText=45]="MissingAltText",e[e.UseFirstRowAsHeader=46]="UseFirstRowAsHeader",e[e.SplitCell=47]="SplitCell",e[e.MergeCells=48]="MergeCells",e[e.MarkAsDecorative=49]="MarkAsDecorative",e[e.MarkAsLayout=50]="MarkAsLayout",e[e.MoreFontColors=51]="MoreFontColors",e[e.ChangeColors=52]="ChangeColors",e[e.ResetGraphic=53]="ResetGraphic",e[e.UndoInsertSummarization=54]="UndoInsertSummarization",e[e.RefreshSummary=55]="RefreshSummary",e[e.Overflow=56]="Overflow",e[e.CatchUp=57]="CatchUp",e[e.Cancel=58]="Cancel",e[e.InsertBelow=59]="InsertBelow",e[e.Regenerate=60]="Regenerate",e[e.StopGenerating=61]="StopGenerating",e[e.ContainerHoverIn=62]="ContainerHoverIn",e[e.ContainerHoverOut=63]="ContainerHoverOut",e[e.LaunchAIRewrite=64]="LaunchAIRewrite",e[e.LaunchAIRewriteHoverIn=65]="LaunchAIRewriteHoverIn",e[e.LaunchAIRewriteHoverOut=66]="LaunchAIRewriteHoverOut"}(Je||(Je={})),function(e){e[e.Undefined=0]="Undefined",e[e.ClassicAttachment=1]="ClassicAttachment",e[e.OneDriveForBusiness=2]="OneDriveForBusiness",e[e.SharepointOnline=3]="SharepointOnline"}(Xe||(Xe={})),function(e){e[e.centered=0]="centered",e[e.rightCenter=1]="rightCenter",e[e.bottomCenter=2]="bottomCenter"}(et||(et={})),function(e){e[e.Location=0]="Location",e[e.Person=1]="Person",e[e.SatoriEntity=2]="SatoriEntity",e[e.Topic=3]="Topic",e[e.File=4]="File"}(tt||(tt={})),function(e){e[e.light=0]="light",e[e.dark=1]="dark",e[e.highContrast=2]="highContrast",e[e.custom=3]="custom",e[e.teamsLight=4]="teamsLight",e[e.teamsDark=5]="teamsDark"}(it||(it={}));var ot=i(74957),rt=i(86980),nt=i(85727),st=i(84417),at=i(22065);(0,i(81478).hN)([{rawString:".customScrollBar_cfe9a557{scrollbar-width:none}.customScrollBar_cfe9a557::-webkit-scrollbar{display:none}.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557{position:absolute;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:6px;top:4px;overflow:hidden}.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557 .scrollbarThumb_cfe9a557{position:absolute;width:3px;border-radius:6px;background:var(--thumb-color);opacity:.7}.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557 .scrollbarThumb_cfe9a557:hover{width:5px}.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557.ltr_cfe9a557{right:3px}.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557.rtl_cfe9a557{left:3px}@media screen and (-ms-high-contrast: active),(forced-colors: active){.customScrollBar_cfe9a557 .scrollbarContainer_cfe9a557 .scrollbarThumb_cfe9a557{background:highlight !important}}"}]);var lt=function(e,t,i,o){return new(i||(i=Promise))((function(r,n){function s(e){try{l(o.next(e))}catch(e){n(e)}}function a(e){try{l(o.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}l((o=o.apply(e,t||[])).next())}))};function ct(e,t,i){return dt((e=>setTimeout(e,t)),e,i)}function dt(e,t,i){let o=!1,r=!1;const n=[];let s=!1;return()=>new Promise((a=>lt(this,void 0,void 0,(function*(){if("Immediately"===i){if(!o){o=!0;try{yield t()}catch(e){}e((()=>{o=!1,a()}))}}else o?(s&&(r=!0),n.push(a)):(o=!0,e((()=>lt(this,void 0,void 0,(function*(){s=!0;try{yield t()}catch(e){}s=!1,o=!1,a();for(const e of n)e();r&&(r=!1,dt(e,t,i))})))))}))))}const ut=C.memo((e=>{var t,i,o,r;const n=!!e.alwaysShowScrollbar,[s,a]=C.useState(n),[l,c]=C.useState(20),[d,u]=C.useState((null===(t=e.style)||void 0===t?void 0:t.paddingScrollTop)?e.style.paddingScrollTop:0),[g,p]=C.useState(0),[h,m]=C.useState(!1),y=C.useRef({delta:{x:0,y:0}}),b=C.useRef(null),f=C.useRef(null),S=(null===(i=e.style)||void 0===i?void 0:i.scrollbarThumbWidth)?e.style.scrollbarThumbWidth:6,v=(null===(o=e.style)||void 0===o?void 0:o.scrollbarPaddingBottom)?e.style.scrollbarPaddingBottom:0,x=()=>{var t,i;if(b.current){const{style:o}=e,{clientHeight:r,scrollHeight:n}=b.current;return{clientHeight:r,contentHeight:n,viewableRatio:(r-(null!==(t=null==o?void 0:o.paddingTop)&&void 0!==t?t:0)-(null!==(i=null==o?void 0:o.paddingBottom)&&void 0!==i?i:0))/(n+v)}}return{clientHeight:0,contentHeight:0,viewableRatio:0}},k=(null===(r=e.style)||void 0===r?void 0:r.paddingScrollTop)?e.style.paddingScrollTop:0,T=C.useCallback((()=>{var t;if(b.current){const{viewableRatio:e}=x();u(Math.max(e*b.current.scrollTop,k))}null===(t=e.onScroll)||void 0===t||t.call(e)}),[e.onScroll]),I={scrollableContainer:{scroll:h?T:ct(T,50,"After"),mouseOver:()=>{if(!s&&gt(b,s,d,n)){const{onScrollStatusChange:t}=e;t&&t(!0),a(!0)}},mouseUp:()=>{m(!1),y.current.delta={x:0,y:0}}},scrollbarContainer:{mouseDown:e=>{if(e.preventDefault(),b.current&&f.current){const{clientHeight:t,contentHeight:i}=x(),o=e.clientY-f.current.getBoundingClientRect().top;b.current.scroll({top:o/t*i}),m(!0)}}},scrollbarThumb:{mouseDown:e=>{e.stopPropagation(),e.preventDefault(),m(!0)}}},{scrollTo:w}=e;let A;switch(C.useEffect((()=>{if(b.current){if(s)return;const t=gt(b,s,d,n);if(t!==s){const{onScrollStatusChange:i}=e;i&&i(t),a(t)}}}),[b.current,s,d,n,e.onScrollStatusChange]),C.useEffect((()=>(()=>{if(b.current&&e.scrollTo){const{top:t,bottom:i,isNewRender:o}=e.scrollTo,r=6,l=Math.max(t-r,0),c=Math.min(i+r,b.current.scrollHeight);if(l<b.current.scrollTop?b.current.scrollTo({top:l,behavior:"smooth"}):c>=b.current.scrollTop+b.current.offsetHeight&&b.current.scrollTo({top:c-b.current.offsetHeight,behavior:"smooth"}),!o&&gt(b,s,d,n)){const{onScrollStatusChange:t}=e;t&&t(!0),a(!0)}}})()),[null==w?void 0:w.top,null==w?void 0:w.bottom]),C.useEffect((()=>(()=>{if(b.current){const{clientHeight:e,viewableRatio:t}=x();c(Math.round(t*e)),p(e)}})())),C.useEffect((()=>{if(!h)return;const e=()=>m(!1);return window.addEventListener("mouseup",e,{once:!0,passive:!0}),()=>window.removeEventListener("mouseup",e)}),[h]),C.useEffect((()=>{if(!h)return;let e;const t=t=>{h&&(t.movementX||t.movementY)&&(y.current.delta.x+=t.movementX,y.current.delta.y+=t.movementY,null==e&&(e=requestAnimationFrame((()=>{if(e=void 0,b.current){const{y:e}=y.current.delta;y.current.delta={x:0,y:0};const{clientHeight:t,contentHeight:i}=x();b.current.scroll({top:b.current.scrollTop+e/t*i})}}))))};return window.addEventListener("mousemove",t,{passive:!0}),()=>window.removeEventListener("mousemove",t)}),[h]),e.scrollDirection){case"horizontal":A={overflowY:"hidden",overflowX:"auto",display:"flex",flexDirection:"row"};break;case"both":A={overflowY:"auto",overflowX:"auto",display:"block",flexDirection:"row"};break;default:A={overflowY:"auto",overflowX:"hidden",display:"block",flexDirection:"column"}}const D=C.useContext(at.q),E="horizontal"!==e.scrollDirection?C.createElement("div",{style:{height:g,opacity:e.hidden?0:1},className:"scrollbarContainer_cfe9a557 "+(D?"rtl_cfe9a557":"ltr_cfe9a557"),ref:f,onMouseDown:I.scrollbarContainer.mouseDown},s&&C.createElement("div",{style:{height:l,top:d,width:S,transition:h?void 0:"all 0.1s ease-out"},className:"scrollbarThumb_cfe9a557",onMouseDown:I.scrollbarThumb.mouseDown})):void 0;return C.createElement("div",{style:(t=>{let i=Object.assign({},t);const{style:o,theme:r}=e;if(o){if(o.paddingHorizontal)i.paddingRight=o.paddingHorizontal,i.paddingLeft=o.paddingHorizontal;else{const e=D?o.paddingEnd:o.paddingStart,t=D?o.paddingStart:o.paddingEnd;void 0!==t&&(i.paddingRight=t),void 0!==e&&(i.paddingLeft=e)}o.paddingTop&&(i.paddingTop=o.paddingTop),o.paddingBottom&&(i.paddingBottom=o.paddingBottom),o.borderRadius&&(i.borderRadius=o.borderRadius),o.width&&(i.width=o.width)}return r&&r.thumbColor&&(i=Object.assign(Object.assign({},i),{"--thumb-color":r.thumbColor})),i})(A),className:"customScrollBar_cfe9a557",ref:b,onScroll:I.scrollableContainer.scroll,onMouseUp:I.scrollableContainer.mouseUp,onMouseOver:I.scrollableContainer.mouseOver},e.children,E)}));function gt(e,t,i,o){if(e.current){const{clientHeight:r,scrollHeight:n}=e.current;return n>r&&(i>4||t||o)}return!1}var pt;ut.displayName="ScrollView",function(e){e[e.Default=0]="Default",e[e.Vertical=1]="Vertical",e[e.Horizontal=2]="Horizontal",e[e.None=3]="None"}(pt||(pt={}));var ht=i(81159),mt=i(91044),yt=i(10261),bt=i(36854);const ft=C.memo((0,C.forwardRef)(((e,t)=>{const i=C.useContext(ot.O),o=C.useRef(null),r=C.useRef(null);(0,C.useImperativeHandle)(t,(()=>({focus:n})));const n=()=>{var e,t;i?null===(e=r.current)||void 0===e||e.focus():null===(t=o.current)||void 0===t||t.focus()};return i?C.createElement(St,Object.assign({},e,{ref:r})):C.createElement(mt.R,{direction:(()=>{switch(e.direction){case pt.Horizontal:return ht.E.horizontal;case pt.Vertical:return ht.E.vertical;default:return ht.E.bidirectional}})(),componentRef:o},e.children)})));ft.displayName="FocusZone";const St=C.memo((0,C.forwardRef)(((e,t)=>{const i=C.useRef(null),{findFirstFocusable:o}=(0,yt.r)(),{children:r,disableInitialFocus:n,direction:s=pt.Default}=e;(0,C.useEffect)((()=>{n||a()}),[]),(0,C.useImperativeHandle)(t,(()=>({focus:a})));const a=()=>{var e;i.current&&(null===(e=o(i.current))||void 0===e||e.focus())},l=(0,bt.i)({circular:s===pt.Default,axis:s===pt.Default?"grid":s===pt.Horizontal?"horizontal":"vertical"}),c=s!==pt.None?l:{};return C.createElement("div",Object.assign({ref:i},c),r)})));St.displayName="FocusZoneV9";var vt=i(4447),Ct=i(89742);const xt="noSuggestions",kt="Retry",Tt="ClearSearch",It=(e,t)=>(t?"header-option":"option")+e,wt=e=>e&&"actions"in e?e.actions:[],At=e=>{if(e instanceof Array){const t=[];return e.forEach((e=>t.push(At(e)))),t}if("object"==typeof e){const t={};for(const i in e)t[i]=At(e[i]);return t}return e};var Dt=i(85654);function Et(e,t,i,o){if(i&&o)for(const r of o)switch(r.decorationType){case Dt.v.Spelling:{const o=i.substr(r.start,r.length);return t===Qe.RepeatedWord?e("contextAccessibilityLabelForRepeatedWord").replace("{0}",o).replace("{1}",i):e("contextAccessibilityLabelForSpelling").replace("{0}",o).replace("{1}",i)}case Dt.v.Grammar:{const t=i.substr(r.start,r.length);return e("contextAccessibilityLabelForGrammar").replace("{0}",t).replace("{1}",i)}case Dt.v.Refinement:{const t=i.substr(r.start,r.length);return e("contextAccessibilityLabelForRefinement").replace("{0}",t).replace("{1}",i)}case Dt.v.Modification:{const t=i.substr(r.start,r.length);return e("contextAccessibilityLabelForCorrection").replace("{0}",t).replace("{1}",i)}}}const Mt=C.memo((0,C.forwardRef)(((e,t)=>{const i=C.useContext(ot.O),o=C.useRef(null),r=C.useRef(null);(0,C.useImperativeHandle)(t,(()=>({focus:n})));const n=()=>{var e,t;i?null===(e=r.current)||void 0===e||e.focus():null===(t=o.current)||void 0===t||t.focus()};return i?C.createElement(St,Object.assign({},e,{ref:r,direction:pt.None})):C.createElement(S.Y,{disabled:e.disabled,componentRef:o,forceFocusInsideTrap:!1},e.children)})));Mt.displayName="FocusTrapZone";var Lt=i(2836);function Rt(e){var t,i,o,r;const n=C.useRef(0),s=C.useRef(0),a=()=>{if(!e.onHeaderHeightChange)return;const t=e.componentStackStyle.marginTop?e.componentStackStyle.marginTop:e.componentStackStyle.marginVertical,i=e.componentStackStyle.paddingTop?e.componentStackStyle.paddingTop:e.componentStackStyle.paddingVertical;let o=0;e.componentStackStyle.borderWidth&&(o="object"==typeof e.componentStackStyle.borderWidth?e.componentStackStyle.borderWidth.top?e.componentStackStyle.borderWidth.top:0:e.componentStackStyle.borderWidth),e.onHeaderHeightChange((t||0)+(i||0)+o+n.current+s.current)},l=e.tagText?C.createElement(nt.S,{align:st.j5.Center,justifyContent:st.Pr.Center,style:null===(t=e.tagStyles)||void 0===t?void 0:t.containerStyles},C.createElement(Lt.c,{text:e.tagText,style:null===(i=e.tagStyles)||void 0===i?void 0:i.textStyles,accessibilityHidden:!0})):void 0;return C.createElement(nt.S,{direction:e.stackDirection,style:e.componentStackStyle,align:e.stackAlignment,accessibleLive:null!==(o=e.accessibleLive)&&void 0!==o?o:st.pq.Polite,accessibilityLabel:null!==(r=e.accessibleLabel)&&void 0!==r?r:e.header,accessibilityRole:"group",accessible:!0,focusable:e.focusable},e.header&&C.createElement(nt.S,{direction:st.PR.LeftToRight,align:st.j5.Center},C.createElement(Lt.c,{onHeightChange:e=>{e!=n.current&&(n.current=e,a())},text:e.header,style:e.headerStyle,accessibilityHidden:!0}),l),e.subheader&&e.subheaderStyle?C.createElement(Lt.c,{onHeightChange:e=>{e!=s.current&&(s.current=e,a())},text:e.subheader,style:e.subheaderStyle,accessibilityRole:"text"}):C.createElement(C.Fragment,null),e.children)}var Ot=i(18440),Ft=i(72418),Bt=i(76403),Nt=i(87501);const jt=e=>{const t=C.useContext(at.q);if(!e.icon)return C.createElement(C.Fragment,null);if((0,Ot.K0)(e.icon)){const i=e.icon,o=(0,Nt.Vm)(e);let r;return r=t&&i.rtlRegular?i.rtlFilled?(0,Bt.A)(i.rtlFilled,i.rtlRegular):i.rtlRegular:i.filled?(0,Bt.A)(i.filled,i.regular):i.regular,C.createElement(r,Object.assign({},o,{pointerEvents:"none"}))}return(0,Ot.mN)(e.icon)?e.icon(e.primaryColor):C.createElement("div",{style:Object.assign({},(0,Ft.MD)(e))},e.icon)};class Ht extends C.PureComponent{render(){return C.createElement("tr",null,this.props.children)}}class Pt extends C.PureComponent{render(){return this.props.header?C.createElement("th",{style:this.getTableCellStyle(),"aria-label":this.props.accessibilityLabel},this.props.children):C.createElement("td",{style:this.getTableCellStyle(),"aria-label":this.props.accessibilityLabel},this.props.children)}getTableCellStyle(){const e={};return this.props.style&&this.props.style.paddingVertical&&(e.paddingBottom=this.props.style.paddingVertical,e.paddingTop=this.props.style.paddingVertical),this.props.style&&this.props.style.paddingHorizontal&&(e.paddingLeft=this.props.style.paddingHorizontal,e.paddingRight=this.props.style.paddingHorizontal),this.props.style&&this.props.style.paddingStart&&(e.paddingInlineStart=this.props.style.paddingStart),this.props.style&&this.props.style.paddingEnd&&(e.paddingInlineEnd=this.props.style.paddingEnd),this.props.style&&this.props.style.marginVertical&&(e.marginBottom=this.props.style.marginVertical,e.marginTop=this.props.style.marginVertical),this.props.style&&this.props.style.marginHorizontal&&(e.marginLeft=this.props.style.marginHorizontal,e.marginRight=this.props.style.marginHorizontal),this.props.style&&this.props.style.verticalAlign&&(e.verticalAlign=this.props.style.verticalAlign),this.props.style&&this.props.style.horizontalAlign&&(e.textAlign=this.props.style.horizontalAlign),e}}class zt extends C.PureComponent{render(){return C.createElement("table",{style:this.getTableStyle(),"aria-label":this.props.accessibilityLabel},this.props.children)}getTableStyle(){const e={borderCollapse:"collapse"};return this.props.style&&this.props.style.marginVertical&&(e.marginBottom=this.props.style.marginVertical,e.marginTop=this.props.style.marginVertical),e}}var Ut=i(72004),Wt=i(28046),Gt=i(77675),_t=i(54061),qt=i(81076),Vt=i(29406);const Zt={actionId:Je.Accept,icons:{regular:Ut.iNx,filled:Ut._jO}},Kt={actionId:Je.IgnoreOnce,icons:{regular:Wt.V_h,filled:Wt.LKJ}},Yt={actionId:Je.IgnoreAll,icons:{regular:Wt.jrs,filled:Wt.tXZ}},Qt={actionId:Je.AddToDictionary,icons:{regular:Gt.Rcd,filled:Gt.NVh}},$t={actionId:Je.Feedback,icons:{regular:Wt.bBX,filled:Wt.FfV}},Jt={actionId:Je.ToggleContext,icons:void 0},Xt={actionId:Je.ToggleDescription,icons:void 0},ei={actionId:Je.Options,icons:{regular:Wt.cFr,filled:Wt.YLH}},ti={actionId:Je.ManageLanguages,icons:C.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},C.createElement("path",{d:"M10.4648 5.99999C10.4883 6.5078 10.5 7.0078 10.5 7.49999C10.5 7.74999 10.498 7.99999 10.4941 8.24998C10.4902 8.49998 10.4844 8.74998 10.4766 8.99998H9V10.5H6.1289C6.16797 10.75 6.20898 11 6.25195 11.25C6.29492 11.5 6.34765 11.75 6.41015 12H4.89843C4.83593 11.75 4.78711 11.5 4.75195 11.25C4.71679 11 4.68359 10.75 4.65234 10.5H2.20313C2.35938 10.7812 2.54102 11.0469 2.74805 11.2969C2.95508 11.5469 3.17578 11.7812 3.41016 12H3L2.47266 13.0547C1.6836 12.3437 1.07422 11.5058 0.644531 10.541C0.214844 9.57616 0 8.56249 0 7.49999C0 6.81249 0.0898439 6.14843 0.269531 5.5078C0.449218 4.86718 0.701172 4.26952 1.02539 3.71484C1.34961 3.16015 1.74023 2.65429 2.19726 2.19726C2.65429 1.74023 3.16015 1.34961 3.71484 1.02539C4.26952 0.701172 4.86718 0.449218 5.5078 0.269531C6.14843 0.0898439 6.81249 0 7.49999 0C8.18748 0 8.85154 0.0898439 9.49217 0.269531C10.1328 0.449218 10.7304 0.701172 11.2851 1.02539C11.8398 1.34961 12.3457 1.74023 12.8027 2.19726C13.2597 2.65429 13.6504 3.16015 13.9746 3.71484C14.2988 4.26952 14.5508 4.86718 14.7304 5.5078C14.9101 6.14843 15 6.81249 15 7.49999C15 7.74999 14.9863 7.99999 14.959 8.24998C14.9316 8.49998 14.8945 8.74998 14.8476 8.99998H13.3945C13.5273 8.49217 13.5937 7.99217 13.5937 7.49999C13.5937 7.0078 13.5273 6.5078 13.3945 5.99999H10.4648ZM10.5 23.8828L7.04296 13.5H4.95701L1.49998 23.8828V24H3.03514L4.04296 21H7.95702L8.96484 24H10.5V23.8828ZM6 15.1172L7.46484 19.5H4.53516L6 15.1172ZM7.0957 1.59375C7.2168 1.46875 7.35156 1.40625 7.5 1.40625C7.64062 1.40625 7.76953 1.4707 7.88672 1.59961C8.00391 1.72852 8.11133 1.89258 8.20898 2.0918C8.30664 2.29101 8.39258 2.51172 8.4668 2.75391C8.54101 2.99609 8.60351 3.23047 8.6543 3.45703C8.70508 3.68359 8.74609 3.89258 8.77734 4.08398C8.80859 4.27539 8.83203 4.41406 8.84766 4.5H6.14063C6.15625 4.40625 6.17969 4.26367 6.21094 4.07226C6.24219 3.88086 6.2832 3.66992 6.33398 3.43945C6.38477 3.20898 6.44531 2.97461 6.51563 2.73633C6.58594 2.49805 6.66992 2.2793 6.76758 2.08008C6.86523 1.88086 6.97461 1.71875 7.0957 1.59375ZM4.53516 9C4.51172 8.5 4.5 8 4.5 7.5C4.5 7.00781 4.51172 6.50782 4.53516 6H1.60548C1.47266 6.50781 1.40626 7.00782 1.40626 7.5C1.40626 7.99219 1.47266 8.49218 1.60548 9H4.53516ZM4.875 3.14063C4.78125 3.59375 4.71094 4.04688 4.66407 4.5H2.20313C2.54688 3.89062 2.98243 3.35742 3.50977 2.90039C4.03712 2.44336 4.625 2.08594 5.27344 1.82813C5.10157 2.25 4.96875 2.6875 4.875 3.14063ZM8.98828 9C9.01172 8.5 9.02344 8 9.02344 7.5C9.02344 7.00781 9.01172 6.50782 8.98828 6H6.01172C5.98829 6.50781 5.97657 7.00782 5.97657 7.5C5.97657 8 5.98829 8.5 6.01172 9H8.98828ZM10.0898 3.12891C9.98828 2.67579 9.84765 2.23829 9.66797 1.81641C10.332 2.06641 10.9316 2.42383 11.4668 2.88867C12.002 3.35351 12.4453 3.89063 12.7969 4.5H10.3242C10.2695 4.03907 10.1914 3.58203 10.0898 3.12891ZM16.3008 10.418C16.3008 10.1836 16.2969 9.94535 16.2891 9.70316C16.2812 9.46097 16.25 9.2266 16.1953 9.00004C16.7344 9.00004 17.2695 9.02347 17.8008 9.07035C17.8477 9.07816 17.8965 9.08988 17.9473 9.10551C17.998 9.12113 18.0234 9.16019 18.0234 9.22269C18.0234 9.26175 18.0117 9.30863 17.9883 9.36332C17.9648 9.418 17.9453 9.46488 17.9297 9.50394C17.9141 9.55082 17.9004 9.61332 17.8887 9.69144C17.877 9.76957 17.8691 9.85355 17.8652 9.94339C17.8613 10.0332 17.8594 10.1192 17.8594 10.2012V10.3946V10.5469H21.3281C21.6562 10.5469 21.9824 10.543 22.3066 10.5352L23.2851 10.5118C23.3398 10.5118 23.3906 10.5235 23.4375 10.5469C23.4609 10.586 23.4726 10.625 23.4726 10.6641C23.4648 10.7969 23.457 10.9356 23.4492 11.0801C23.4414 11.2246 23.4375 11.3633 23.4375 11.4961V12.1758C23.4375 12.4571 23.4414 12.7403 23.4492 13.0254L23.4726 13.875C23.4726 13.8985 23.4707 13.9258 23.4668 13.9571C23.4629 13.9883 23.4531 14.0117 23.4375 14.0274C23.375 14.043 23.3242 14.0508 23.2851 14.0508C23.2461 14.0508 23.1484 14.0528 22.9922 14.0567C22.8359 14.0606 22.6758 14.0625 22.5117 14.0625C22.3633 14.0625 22.2305 14.0586 22.1133 14.0508C21.9961 14.043 21.9297 14.0313 21.9141 14.0157C21.8984 13.9532 21.8887 13.8594 21.8848 13.7344C21.8809 13.6094 21.8789 13.4688 21.8789 13.3125C21.8789 13.0547 21.8828 12.7891 21.8906 12.5157C21.8984 12.2422 21.9023 12.0391 21.9023 11.9063H12.5039V12.0762C12.5039 12.1582 12.5059 12.2559 12.5098 12.3692C12.5137 12.4825 12.5157 12.6035 12.5157 12.7325V13.125C12.5157 13.3516 12.5118 13.5567 12.5039 13.7403C12.4961 13.9239 12.4844 14.0235 12.4688 14.0391C12.4063 14.0547 12.3555 14.0625 12.3164 14.0625H11.1211C11.0352 14.0625 10.9844 14.0508 10.9688 14.0274C10.9532 14.0039 10.9453 13.9532 10.9453 13.875C10.9532 13.5625 10.9571 13.2539 10.9571 12.9492V12.0235V11.3438C10.9571 11.1172 10.9532 10.8907 10.9453 10.6641C10.9453 10.625 10.9532 10.5821 10.9688 10.5352C11.0313 10.5196 11.0821 10.5117 11.1211 10.5117L12.0996 10.5352C12.4239 10.543 12.75 10.5469 13.0782 10.5469H16.3008L16.3008 10.418ZM23.8125 17.0508C23.8125 17.0118 23.8047 16.961 23.7891 16.8985C23.7422 16.875 23.6914 16.8633 23.6367 16.8633L22.7109 16.8868C22.4062 16.8946 22.0977 16.8985 21.7852 16.8985H18.0234V16.7696C18.4687 16.4805 18.8965 16.1778 19.3066 15.8614C19.7168 15.545 20.125 15.2188 20.5312 14.8829C20.625 14.8047 20.7226 14.7227 20.8242 14.6368C20.9258 14.5508 21.0312 14.4805 21.1406 14.4258C21.2031 14.3946 21.2598 14.3575 21.3105 14.3145C21.3613 14.2715 21.3867 14.211 21.3867 14.1329C21.3867 14.0704 21.3418 13.9747 21.2519 13.8457C21.1621 13.7168 21.0586 13.5899 20.9414 13.4649C20.8242 13.3399 20.707 13.2305 20.5898 13.1368C20.4726 13.043 20.3828 12.9961 20.3203 12.9961C20.2344 12.9961 20.1367 13.0137 20.0273 13.0489C19.918 13.084 19.8008 13.1016 19.6758 13.1016H15.3047C14.9766 13.1016 14.6504 13.0977 14.3262 13.0899L13.3477 13.0665C13.3164 13.0665 13.2695 13.0743 13.207 13.0899C13.1914 13.1524 13.1836 13.1993 13.1836 13.2305V14.3438C13.1836 14.3829 13.1914 14.4258 13.207 14.4727C13.2383 14.4961 13.2852 14.5079 13.3477 14.5079L14.3262 14.4844C14.6504 14.4766 14.9766 14.4727 15.3047 14.4727H18.9141C18.6641 14.6993 18.4141 14.9219 18.1641 15.1407C17.9141 15.3594 17.6523 15.5664 17.3789 15.7618C17.3633 15.7618 17.3496 15.7598 17.3379 15.7559C17.3262 15.752 17.3125 15.75 17.2969 15.75C17.1406 15.7344 16.9863 15.7207 16.834 15.709C16.6816 15.6973 16.5273 15.6836 16.3711 15.668C16.4101 15.8711 16.4316 16.0762 16.4355 16.2832C16.4394 16.4903 16.4492 16.6954 16.4648 16.8985H12.7266C12.4141 16.8985 12.1016 16.8946 11.7891 16.8868L10.8516 16.8633C10.8125 16.8633 10.7695 16.8711 10.7226 16.8868C10.707 16.9024 10.6973 16.9278 10.6933 16.9629C10.6894 16.9981 10.6875 17.0274 10.6875 17.0508V18.1758C10.6875 18.2149 10.6953 18.2579 10.7109 18.3047C10.7422 18.3282 10.789 18.3399 10.8516 18.3399L11.7891 18.3164C12.1016 18.3086 12.4141 18.3047 12.7266 18.3047H16.4648V20.5313C16.4648 20.7344 16.416 20.8653 16.3183 20.9239C16.2207 20.9825 16.0781 21.0118 15.8906 21.0118C15.625 21.0118 15.3594 21.0059 15.0937 20.9942C14.8281 20.9825 14.5625 20.961 14.2969 20.9297C14.4062 21.1094 14.498 21.2871 14.5723 21.4629C14.6465 21.6387 14.7109 21.8282 14.7656 22.0313C14.7812 22.0703 14.8047 22.1407 14.8359 22.2422C14.8672 22.3438 14.8945 22.4063 14.918 22.4297C14.957 22.4688 15.0273 22.4903 15.1289 22.4942C15.2305 22.4981 15.3047 22.5 15.3516 22.5C15.4766 22.5 15.6465 22.4981 15.8613 22.4942C16.0762 22.4903 16.2969 22.4786 16.5234 22.459C16.75 22.4395 16.9629 22.4082 17.1621 22.3653C17.3613 22.3223 17.5156 22.2618 17.625 22.1836C17.7812 22.0743 17.8945 21.9258 17.9648 21.7383C18.0351 21.5508 18.0703 21.3633 18.0703 21.1758V21.1289C18.0547 20.7227 18.043 20.3164 18.0351 19.9102C18.0273 19.5039 18.0234 19.0977 18.0234 18.6914V18.3047H21.7851C22.0976 18.3047 22.4062 18.3086 22.7109 18.3164L23.6367 18.3399C23.6758 18.3399 23.7266 18.3321 23.7891 18.3164C23.8047 18.2539 23.8125 18.2071 23.8125 18.1758V17.0508Z",fill:"currentColor"}))},ii=(Je.ManageLanguages,C.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},C.createElement("path",{d:"M8.89711 5.43349L8.95395 5.55522L15.4408 22.4719C15.6133 22.922 15.3954 23.4295 14.9539 23.6054C14.5493 23.7668 14.0974 23.5934 13.8919 23.2168L13.8422 23.1091L12.1704 18.7492L3.90246 18.7494L3.79273 18.7423L1.98817 23.129C1.80487 23.5745 1.30196 23.7843 0.864879 23.5974C0.464234 23.4261 0.257979 22.9809 0.367564 22.5646L0.405375 22.4521L7.36329 5.53543C7.64395 4.85311 8.55664 4.82412 8.89711 5.43349ZM19.8699 0.335938C20.3129 0.335938 20.679 0.665113 20.7369 1.09221L20.7449 1.21094L20.7446 6.74794L22.7866 6.74884C23.2296 6.74884 23.5957 7.07801 23.6535 7.5051L23.6616 7.62383C23.6616 8.06681 23.3323 8.43291 22.9053 8.49084L22.7866 8.49883L20.7446 8.49794L20.7449 16.9572C20.7449 17.4002 20.4157 17.7663 19.9887 17.8242L19.8699 17.8322C19.4269 17.8322 19.0608 17.5029 19.0028 17.0759L18.9949 16.9572V1.21094C18.9949 0.727692 19.3867 0.335938 19.8699 0.335938ZM8.27955 8.20411L4.59036 16.9992H11.7186L8.27955 8.20411ZM10.5389 0.335938H16.953C17.396 0.335938 17.7621 0.665113 17.8201 1.09221L17.828 1.21094V4.71525C17.828 7.4506 15.6106 9.66807 12.8753 9.66807C12.392 9.66807 12.0003 9.27629 12.0003 8.79303C12.0003 8.30979 12.392 7.91803 12.8753 7.91803C14.5786 7.91803 15.9714 6.58835 16.0722 4.91036L16.078 4.71525V2.08594H10.5389C10.0557 2.08594 9.66396 1.69418 9.66396 1.21094C9.66396 0.767954 9.99313 0.401866 10.4203 0.343929L10.5389 0.335938H16.953H10.5389Z",fill:"currentColor"})),{actionId:Je.ShowExplanation,icons:{regular:_t.wit,filled:_t.mlX}}),oi={actionId:Je.IgnoreRule,icons:{regular:_t.cbT,filled:_t.y2B}},ri={actionId:Je.FixAllColors,icons:{regular:qt.b4K,filled:qt.nVo,rtlRegular:qt.ZDw,rtlFilled:qt.PLv}},ni={actionId:Je.TurnOffAccChecker,icons:{regular:_t.FEI,filled:_t.j2V}},si={actionId:Je.ReadAloud,icons:{regular:Wt.ew3,filled:Wt.wrJ}},ai={actionId:Je.LearnMore,icons:void 0},li={actionId:Je.Allow,icons:{regular:Wt.V_h,filled:Wt.LKJ}},ci={actionId:Je.AllowAll,icons:{regular:Wt.jrs,filled:Wt.tXZ}},di={actionId:Je.SpellOut,icons:void 0},ui=(Je.ChangeAll,Je.AddToAutoCorrect,Je.AutoCorrectOptions,{actionId:Je.Overflow,icons:{regular:_t.mmJ,filled:_t.aKh}}),gi={actionId:Je.OpenColorPicker,icons:{regular:Ut.akU,filled:Ut.MVw}},pi={actionId:Je.Dismiss,icons:{regular:Ut.BEt,filled:Ut.Z5f}},hi={actionId:Je.Accessibility,icons:{regular:Gt.vXm,filled:Gt.ZtX}},mi={actionId:Je.Previous,icons:{regular:Ut.nUb,filled:Ut.NGN,rtlRegular:Ut.Crl,rtlFilled:Ut.oAB}},yi={actionId:Je.Next,icons:{regular:Ut.Crl,filled:Ut.oAB,rtlRegular:Ut.nUb,rtlFilled:Ut.NGN}},bi={actionId:Je.MarkAsDecorative,icons:{regular:Gt.Zw6,filled:Gt.DU7}},fi={actionId:Je.MarkAsLayout,icons:{regular:Gt.Zw6,filled:Gt.DU7}},Si=(Je.OpenEditorPane,e=>C.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},C.createElement("path",{d:"M14.0469 5C14.1771 5 14.3021 5.02604 14.4219 5.07812C14.5365 5.125 14.638 5.19271 14.7266 5.28125C14.8099 5.36458 14.8776 5.46615 14.9297 5.58594C14.9766 5.70052 15 5.82292 15 5.95312V6.04688C15 6.17708 14.9766 6.30208 14.9297 6.42188C14.8776 6.53646 14.8099 6.63802 14.7266 6.72656C14.638 6.8099 14.5365 6.8776 14.4219 6.92969C14.3021 6.97656 14.1771 7 14.0469 7H8.97656L8.25 8H12C12.1406 8 12.2708 8.02604 12.3906 8.07812C12.5104 8.13021 12.6172 8.20312 12.7109 8.29688C12.7995 8.38542 12.8698 8.48958 12.9219 8.60938C12.974 8.72917 13 8.85938 13 9C13 9.14062 12.974 9.27083 12.9219 9.39062C12.8698 9.51042 12.7995 9.61719 12.7109 9.71094C12.6172 9.79948 12.5104 9.86979 12.3906 9.92188C12.2708 9.97396 12.1406 10 12 10H6.79688L6.07031 11H10C10.1406 11 10.2708 11.026 10.3906 11.0781C10.5104 11.1302 10.6172 11.2031 10.7109 11.2969C10.7995 11.3854 10.8698 11.4896 10.9219 11.6094C10.974 11.7292 11 11.8594 11 12C11 12.1406 10.974 12.2708 10.9219 12.3906C10.8698 12.5104 10.7995 12.6172 10.7109 12.7109C10.6172 12.7995 10.5104 12.8698 10.3906 12.9219C10.2708 12.974 10.1406 13 10 13H4.61719L4.14844 13.6406L1.89844 15.25C1.84635 15.276 1.79948 15.2891 1.75781 15.2891C1.70573 15.2891 1.66146 15.2786 1.625 15.2578L0.6875 15.9453C0.671875 15.9609 0.645833 15.9688 0.609375 15.9688C0.473958 15.9688 0.356771 15.9297 0.257812 15.8516C0.153646 15.7682 0.101562 15.6745 0.101562 15.5703V15.5469L0.445312 14.4219C0.377604 14.375 0.34375 14.3073 0.34375 14.2188C0.34375 14.1875 0.346354 14.1641 0.351562 14.1484L1.14844 11.5156L9.45312 0.117188C9.50521 0.0755208 9.54427 0.0494792 9.57031 0.0390625C9.59635 0.0286458 9.63542 0.0234375 9.6875 0.0234375C9.72917 0.0234375 9.8099 0.0520833 9.92969 0.109375C10.0495 0.161458 10.1927 0.234375 10.3594 0.328125C10.526 0.416667 10.7057 0.523438 10.8984 0.648438C11.0859 0.773438 11.2734 0.90625 11.4609 1.04688C11.6484 1.1875 11.8229 1.33333 11.9844 1.48438C12.1458 1.63021 12.2786 1.77604 12.3828 1.92188C12.4089 1.96354 12.4323 2 12.4531 2.03125C12.4688 2.0625 12.4766 2.09375 12.4766 2.125C12.4766 2.15104 12.4635 2.1849 12.4375 2.22656L11.8984 2.96875L10.4219 5H14.0469ZM3.4375 12.9219L10.7969 2.78906L9.44531 1.82812L2.05469 11.9609L1.46875 13.9062L1.76562 14.1094L3.4375 12.9219Z",fill:null!=e?e:"currentColor"}))),vi={actionId:Je.Complete,icons:{regular:Ut._Xk,filled:Ut.gcm}},Ci=(Je.CatchUp,Je.OpenEditorPane,Vt.kT,Je.OpenEditorPane,Vt.RT,Je.OpenEditorPane,Vt.P1,Je.OpenEditorPane,Vt.M_,{actionId:Je.IntextCitation,icons:void 0}),xi={actionId:Je.FullCitation,icons:void 0},ki={actionId:Je.MoreSources,icons:void 0};var Ti;!function(e){e[e.Exposition=0]="Exposition",e[e.Example=1]="Example"}(Ti||(Ti={}));class Ii extends C.PureComponent{componentDidMount(){const e=this.getDefinition();e&&e.explanationTitle,this.getExplanationText()}render(){const e=this.parseExplanationText(this.getExplanationText()),t=this.getDefinition(),i=t&&t.explanationTitle||"";return C.createElement(Mt,null,C.createElement(Rt,{componentStackStyle:$(this.props.style,this.props.theme),stackAlignment:st.j5.Stretch,stackDirection:st.PR.TopToBottom,header:i,headerStyle:ne(this.props.theme,this.props.fontTable)},this.renderExplanationText(e),this.renderAccessibleColorsLearningTip(),this.renderMergeSplitCellsLearningTip()))}renderAccessibleColorsLearningTip(){var e,t,i,o,r,n;if(this.props.definition.critiqueType!==Qe.AccColorChecker)return null;const s={height:16,width:16},a={type:"ErrorBadge",icon:pi.icons,primaryColor:"#E41323",style:s},l={type:"Completed",icon:vi.icons,primaryColor:"#0B6A0B",style:s},c={backgroundColor:"#CCCCCC",borderRadius:2,minHeight:24,marginVertical:4,marginStart:10,paddingHorizontal:15},d={width:"50%"};return C.createElement(nt.S,null,C.createElement(nt.S,{direction:st.PR.LeftToRight},C.createElement(nt.S,{style:d},C.createElement(Lt.c,{text:this.props.strings.critiqueExplanation("explanationTableBefore"),style:le(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0})),C.createElement(nt.S,{style:d},C.createElement(Lt.c,{text:this.props.strings.critiqueExplanation("explanationTableAfter"),style:le(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0}))),C.createElement(nt.S,{direction:st.PR.LeftToRight},C.createElement(nt.S,{style:d},C.createElement(nt.S,{direction:st.PR.LeftToRight},C.createElement(nt.S,{direction:st.PR.LeftToRight,align:st.j5.Center,style:{height:32}},C.createElement(jt,Object.assign({},a))),C.createElement(nt.S,{direction:st.PR.LeftToRight,align:st.j5.Center,style:c},C.createElement(Lt.c,{text:this.props.strings.critiqueExplanation("exampleText"),style:{cssColor:"#BECFFA",fontSize:this.props.fontTable.xsmall,fontWeight:x.IT.SemiBold},accessibilityRole:"text",accessibilityHidden:!0}))),C.createElement(nt.S,{direction:st.PR.LeftToRight},C.createElement(nt.S,{style:{width:26}}),C.createElement(Lt.c,{text:null!==(i=null===(t=(e=this.props.strings).accChecker)||void 0===t?void 0:t.call(e,"poorContrast"))&&void 0!==i?i:"",style:ae(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0}))),C.createElement(nt.S,{style:d},C.createElement(nt.S,{direction:st.PR.LeftToRight},C.createElement(nt.S,{direction:st.PR.LeftToRight,align:st.j5.Center,style:{height:32}},C.createElement(jt,Object.assign({},l))),C.createElement(nt.S,{direction:st.PR.LeftToRight,align:st.j5.Center,style:c},C.createElement(Lt.c,{text:this.props.strings.critiqueExplanation("exampleText"),style:{cssColor:"#002EA3",fontSize:this.props.fontTable.xsmall,fontWeight:x.IT.SemiBold},accessibilityRole:"text",accessibilityHidden:!0}))),C.createElement(nt.S,{direction:st.PR.LeftToRight},C.createElement(nt.S,{style:{width:26}}),C.createElement(Lt.c,{text:null!==(n=null===(r=(o=this.props.strings).accChecker)||void 0===r?void 0:r.call(o,"goodContrast"))&&void 0!==n?n:"",style:ae(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0})))))}renderMergeSplitCellsLearningTip(){const{critiqueType:e}=this.props.definition,t=this.props.strings.accChecker;return e===Qe.MergeSplitCell&&t?C.createElement(nt.S,null,["mergeSplitCellStepsTitle","mergeSplitCellStepsLine1","mergeSplitCellStepsLine2","mergeSplitCellStepsLine3","mergeSplitCellStepsLine4","mergeSplitCellStepsEnd"].map((e=>C.createElement(Lt.c,{key:e,text:null==t?void 0:t(e),style:ae(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0})))):null}getDefinition(){return this.props.definition}getExplanationText(){const e=this.getDefinition();return e&&e.explanation?e.explanation.replace("\\r\\n","\r\n"):""}parseExplanationText(e){const t=[];let i=[],o=null,r=!0,n=!1,s=0,a=0,l=0,c=this.props.strings.critiqueExplanation("explanationTableBefore"),d=this.props.strings.critiqueExplanation("explanationTableAfter");const u=e.split("\r\n");for(const e of u)if(0!==e.length)if("•"===e[0]){const t=e.indexOf(":"),u=e.substr(2,t-1),g=e.substr(t+2);r?(c=u,o=this.renderBeforeText(g,a++),r=!1,n=!0):n?(d=u,i.push(C.createElement(Ht,{key:s++},this.renderTableHeaderText(c,a++,0===i.length,!0),this.renderTableHeaderText(d,l++,0===i.length,!1))),i.push(C.createElement(Ht,{key:s++},o,this.renderAfterText(g,l++))),o=null,n=!1):(i.push(C.createElement(Ht,{key:s++},this.renderPlaceholder(a++),this.renderExampleSeparator(l++))),i.push(C.createElement(Ht,{key:s++},this.renderPlaceholder(a++),this.renderAfterText(g,l++))))}else i.length>0&&(t.push(this.renderCurrentTable(i)),i=[]),t.push(this.renderExplanationNonExampleText(e));else o=null,r=!0,n=!1;return i.length>0&&(t.push(this.renderCurrentTable(i)),i=[]),t}analyzeExampleText(e){const t={trimmedText:e,emphasisStart:-1,emphasisLength:-1},i=e.indexOf("{ul}");if(-1!==i){const o=e.indexOf("{ul 0}",i);if(-1!==o){const r=i+4,n=o-r;t.trimmedText=e.substr(0,i)+e.substr(r,n)+e.substr(o+6),t.emphasisStart=i,t.emphasisLength=n}}return t}renderTableHeaderText(e,t,i,o){const r=o?{paddingStart:0,paddingEnd:10,paddingVertical:0,marginHorizontal:0,marginVertical:0,verticalAlign:"top",horizontalAlign:"start"}:{paddingStart:10,paddingEnd:0,paddingVertical:0,marginHorizontal:0,marginVertical:0,verticalAlign:"top",horizontalAlign:"start"};return i?C.createElement(Pt,{header:!0,key:t,style:r},C.createElement(Lt.c,{text:e,style:le(this.props.theme,this.props.fontTable),accessibilityRole:"text",accessibilityHidden:!0})):C.createElement(Pt,{key:t,style:r}," ")}renderCurrentTable(e){return{explanationPartType:Ti.Example,data:e}}getDecorationType(e){switch(e){case Qe.Grammar:return $e.Grammar;case Qe.Refinement:return $e.Refinement;default:return $e.None}}renderBeforeText(e,t){return this.renderExampleText(e,t,this.getDecorationType(this.getDefinition().critiqueType),this.props.strings.critiqueExplanation("explanationTableBefore"),!0)}renderAfterText(e,t){return this.renderExampleText(e,t,$e.Modification,this.props.strings.critiqueExplanation("explanationTableAfter"),!1)}renderExampleText(e,t,i,o,r){const n=[],s=this.analyzeExampleText(e);-1!==s.emphasisStart&&-1!==s.emphasisLength&&n.push({start:s.emphasisStart,length:s.emphasisLength,decorationType:i});const a=o+" "+Et(this.props.strings.textFormatting,this.getDefinition().critiqueType,s.trimmedText,n),l=r?{paddingStart:0,paddingEnd:10,paddingVertical:0,marginHorizontal:0,marginVertical:0,verticalAlign:"top",horizontalAlign:"start"}:{paddingStart:10,paddingEnd:0,paddingVertical:0,marginHorizontal:0,marginVertical:0,verticalAlign:"top",horizontalAlign:"start"};return C.createElement(Pt,{key:t,style:l},C.createElement(Lt.c,{text:s.trimmedText,style:ae(this.props.theme,this.props.fontTable),formatting:(0,Dt.S)(e.length,this.props.theme,n),accessibilityRole:"text",accessibilityLabel:a}))}renderExampleSeparator(e){return C.createElement(Pt,{key:e,style:{paddingStart:10,paddingEnd:0,paddingVertical:0,marginHorizontal:0,marginVertical:0,verticalAlign:"top",horizontalAlign:"start"}},C.createElement(Lt.c,{text:this.props.strings.critiqueExplanation("explanationTableSeparator"),style:(t=this.props.theme,i=this.props.fontTable,{cssColor:t.text.resting,fontSize:i.xsmall,lineHeight:16,fontWeight:x.IT.SemiBold,italic:!0}),accessibilityRole:"text"}));var t,i}renderPlaceholder(e){return C.createElement(Pt,{key:e,style:{paddingStart:0,paddingEnd:10,paddingVertical:0,marginHorizontal:0,marginVertical:0,verticalAlign:"top",horizontalAlign:"start"}})}renderExplanationNonExampleText(e){return{explanationPartType:Ti.Exposition,data:[C.createElement(Lt.c,{key:0,text:e,style:se(this.props.theme,this.props.fontTable),accessibilityRole:"text"})]}}renderExplanationText(e){const t=[];for(const i of e)switch(i.explanationPartType){case Ti.Exposition:i.data[0]&&t.push(i.data[0]);break;case Ti.Example:t.push(C.createElement(zt,{style:{marginVertical:6},accessibilityLabel:this.props.strings.critiqueExplanation("explanationTableAccessibilityLabel")},i.data))}return t}}var wi=i(56925),Ai=i(44455);const Di=e=>{var t,i;return C.createElement(C.Fragment,null,C.createElement(Ai._,{src:e.uri,width:null===(t=e.style)||void 0===t?void 0:t.width,height:null===(i=e.style)||void 0===i?void 0:i.height,alt:e.altText}))},Ei={[Ye.Text]:{v8:{[it.light]:{type:"Text",textColor:"#616161"},[it.dark]:{type:"Text",textColor:"#616161"}},v9:{type:"Text",textColor:"var(--editorTextBrandingTextColor, var(--colorNeutralForeground2))"}},[Ye.Icon]:{v8:{[it.light]:{type:"Icon",iconColor:"#616161"},[it.dark]:{type:"Icon",iconColor:"#616161"}},v9:{type:"Icon",iconColor:"var(--editorIconBrandingIconColor, var(--colorNeutralForeground2))"}},[Ye.IconButton]:{v8:{[it.light]:{type:"IconButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#616161",disabled:"#BDBDBD"},focusRing:"#323130"},[it.dark]:{type:"IconButton",background:{resting:"#1b1a19",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},icon:{resting:"#82ABF1"},focusRing:"#323130"}},v9:{type:"IconButton",background:{resting:"var(--editorIconButtonBrandingBackgroundResting, var(--colorNeutralBackground1))",hover:"var(--editorIconButtonBrandingBackgroundHover, var(--colorNeutralBackground1Hover))",pressed:"var(--editorIconButtonBrandingBackgroundPressed, var(--colorNeutralBackground1Pressed))",disabled:"var(--editorIconButtonBrandingBackgroundDisabled, var(--colorNeutralBackgroundDisabled))"},icon:{resting:"var(--editorIconButtonBrandingIconResting, var(--colorNeutralForeground2))",disabled:"var(--editorIconButtonBrandingIconDisabled, var(--colorNeutralForegroundDisabled))"},focusRing:"var(--editorIconButtonBrandingFocusRing, var(--colorStrokeFocus2))"}},[Ye.IconAndTextButton]:{v8:{[it.light]:{type:"IconAndTextButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#185ABD",disabled:"#BDBDBD"},title:{resting:"#185ABD",disabled:"#BDBDBD"},tooltip:{textColor:"#201F1E"},focusRing:"#323130"},[it.dark]:{type:"IconAndTextButton",background:{resting:"#1b1a19",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},icon:{resting:"#6794D7"},title:{resting:"#6794D7"},tooltip:{textColor:"#FFFFFF"},focusRing:"#323130"}},v9:{type:"IconAndTextButton",background:{resting:"var(--editorIconAndTextButtonBrandingBackgroundResting, var(--colorNeutralBackground1))",hover:"var(--editorIconAndTextButtonBrandingBackgroundHover, var(--colorNeutralBackground1Hover))",pressed:"var(--editorIconAndTextButtonBrandingBackgroundPressed, var(--colorNeutralBackground1Pressed))",disabled:"var(--editorIconAndTextButtonBrandingBackgroundDisabled, var(--colorNeutralBackgroundDisabled))"},icon:{resting:"var(--editorIconAndTextButtonBrandingIconResting, var(--colorNeutralForeground2BrandHover))",hover:"var(--editorIconAndTextButtonBrandingIconHover, var(--colorNeutralForeground2BrandHover))",disabled:"var(--editorIconAndTextButtonBrandingIconDisabled, var(--colorNeutralForegroundDisabled))"},title:{resting:"var(--editorIconAndTextButtonBrandingIconResting, var(--colorNeutralForeground2BrandHover))",hover:"var(--editorIconAndTextButtonBrandingIconHover, var(--colorNeutralForeground2BrandHover))",disabled:"var(--editorIconAndTextButtonBrandingIconDisabled, var(--colorNeutralForegroundDisabled))"},focusRing:"var(--editorIconAndTextButtonBrandingFocusRing, var(--colorStrokeFocus2))"}}};function Mi(e,t){const i=Object.assign({},e);return t&&(null==i?void 0:i.hover)&&(i.resting=i.hover),i}const Li=(e,t)=>{var i,o;if(void 0===e)return;e===Ye.MonochromeIcon&&(e=Ye.Icon);const r=Ei[e];if(void 0===r)return;const n=null!==(i=null==t?void 0:t.themeType)&&void 0!==i?i:it.light;return(null==t?void 0:t.useFluentV9)?r.v9:null!==(o=r.v8[n])&&void 0!==o?o:r.v9};function Ri(e,t,i){const o="Text"===(null==e?void 0:e.type)?e:Li(Ye.Text,i);return{fontWeight:x.IT.SemiBold,fontFamily:T.V,fontSize:t.small,cssColor:null==o?void 0:o.textColor,userSelectable:!1}}function Oi(e,t){return("Icon"===(null==e?void 0:e.type)?e:Li(Ye.Icon,t)).iconColor}var Fi=i(38835);function Bi(e){return{oneOfManyChoiceButtonAccessibilityLabelAugment:e("oneOfManyChoiceButtonAccessibilityLabelAugment"),voiceOverSplitButton2AccessibilityHint:e("voiceOverSplitButton2AccessibilityHint")}}function Ni(e){return{defaultOverflowButtonAccessibilityLabel:e("defaultOverflowButtonAccessibilityLabel"),oneOfManyChoiceButtonAccessibilityLabelAugment:e("oneOfManyChoiceButtonAccessibilityLabelAugment"),voiceOverSplitButton2AccessibilityHint:e("voiceOverSplitButton2AccessibilityHint")}}function ji(e){return{defaultSplitButtonOverflowAccessibilityLabel:e("defaultSplitButtonOverflowAccessibilityLabel"),voiceOverSplitButton2AccessibilityHint:e("voiceOverSplitButton2AccessibilityHint")}}function Hi(e,t,i,o,r,n,s,a,l,c,d,u,g,p){const h=Ui(e),m=void 0!==a;if(void 0!==a&&(a<0||a>=h.length))return;const y=m?h[a]:void 0,b=r.filter((t=>Zi(e,t.actionId,y))).filter((t=>qi(e,i,t.actionId))).map((t=>Ji(e,i,o,t)));return!m&&Zi(e,Je.ShowMenu)&&(b.length>0&&b.push({type:"separator",key:"separator"}),b.push(Ji(e,i,o,{actionId:Je.ShowMenu,icons:void 0}))),0!==b.length?{tooltip:m||n?void 0:s,items:b,onClick:e=>{if(d){const t=parseInt(e.key,10);d(t,a)}},style:m?{}:Object.assign(Object.assign({},z(p)),{calloutStyle:null==p?void 0:p.calloutStyle}),theme:pe(t,u),itemTheme:ge(t,void 0,!0),strings:Ni(i.common),accessibilityLabel:s,automationLabelType:"CritiqueActionButton",automationId:l||"",hasKeyboardFocus:u,layerHostId:c,onHeightChange:g,shouldFocusButtonOnDismiss:e.critiqueType!==Qe.InlineSuggestion&&void 0}:void 0}function Pi(e,t,i,o,r,n,s,a,l,c,d,u,g,p,h,m,y,b,f,S,v){const x=Object.assign(Object.assign({},o.tooltipProps),{layerHostId:v||void 0}),k=Vi(i),T=void 0!==k?{type:k,filled:m}:void 0,I={onClick:()=>{null==h||h(i,void 0,s)},title:a,titleStyle:l,tooltip:c,tooltipProps:x,disabled:Ki(e,i),style:o,theme:ge(t,void 0,m,b),accessibilityLabel:_i(e,r,i),automationLabel:null!=d?d:$i(i,p),badgeProps:g,icon:T,htmlId:y,onHeightChange:S,uiAnchorId:f,hasKeyboardFocus:b,appearance:"subtle"};return C.createElement(wi.J,Object.assign({ref:u},I,{key:i.toString(),useAlternateIconColors:m,renderChildren:(0,Ot.eO)(n)}))}function zi(e,t,i,o,r,n,s){if(e.showDictationCommandUx&&!o){const o=function(e,t,i,o){const r=Wi(e,t).filter((e=>e.action===i&&e.suggestionIndex===o));return r.length>0?r[0].badgeId:void 0}(e,t,r,n);if(void 0!==o)return{text:o.toString(),theme:i,style:s}}}function Ui(e){const t=e.maximumSuggestions||I;return e.suggestions?e.suggestions.length>t?e.suggestions.slice(0,t):e.suggestions:[]}function Wi(e,t){var i;const o=Gi(e,t),r=[];let n=1;return o?o.forEach(((e,t)=>{r.push({action:e.actionId,badgeId:n++,suggestionIndex:t})})):null===(i=Ui(e))||void 0===i||i.forEach(((t,i)=>{Ki(e,Je.Accept,t)||r.push({action:Je.Accept,badgeId:n++,suggestionIndex:i})})),r}function Gi(e,t){switch(e.critiqueType){case Qe.RepeatedWord:return[Zt];case Qe.SimilarityChecker:return(Zi(e,ki.actionId)?[Ci,xi,ki]:[Ci,xi]).filter((i=>qi(e,t,i.actionId)))}if(e.isContentPending)return[]}function _i(e,t,i){switch(i){case Je.Previous:case Je.Next:if(e.wrapAroundNavigation&&void 0!==e.critiqueSetSize&&e.critiqueSetSize>1){const o=e.critiqueSetSize.toString(10);return i===Je.Previous?t.critique("previousIssueWithCount").replace("{0}",o):t.critique("nextIssueWithCount").replace("{0}",o)}return i===Je.Previous?t.critique("previousIssue"):t.critique("nextIssue")}return qi(e,t,i)}function qi(e,t,i){var o,r,n,s,a,l,c,d,u,g,p,h,m,y,b,f;switch(i){case Je.ReadAloud:return t.critique("readAloud");case Je.SpellOut:return t.critique("spellOut");case Je.ChangeAll:return t.critique("changeAll");case Je.AddToAutoCorrect:return t.critique("addToAutoCorrect");case Je.AutoCorrectOptions:return t.critique("autoCorrectOptions");case Je.IgnoreOnce:return t.critique("ignoreOnce");case Je.IgnoreAll:return t.critique("ignoreAll");case Je.IgnoreRule:return t.critique("ignoreRule");case Je.AddToDictionary:return t.critique("addToDictionary");case Je.Options:return t.critique("options");case Je.ShowExplanation:return t.critique("footerExplanationButtonAccessibilityLabel");case Je.ManageLanguages:return t.critique("manageLanguages");case Je.Next:return t.critique("nextIssue");case Je.Previous:return t.critique("previousIssue");case Je.ToggleContext:return e.showContext?t.critique("hideContext"):t.critique("showContext");case Je.ToggleDescription:return e.critiqueType===Qe.Spelling?e.showDescription?t.critique("hideSynonyms"):t.critique("showSynonyms"):e.critiqueType===Qe.NeuralRewrite?e.showDescription?t.critique("hideExplanationButtonText"):t.critique("showExplanationButtonText"):void 0;case Je.ReadContext:return t.critique("readAloudOriginalSentenceAccessibilityLabel");case Je.ShowMenu:return t.critique("showMenuButtonText");case Je.Feedback:return t.critique("giveFeedbackButtonText");case Je.Dismiss:return t.common("cancelButton");case Je.OpenEditorPane:return t.critique("accessibilityLabelForEditorButton");case Je.LearnMore:return t.critique("learnMore");case Je.IntextCitation:return t.critique("addInTextCitation");case Je.FullCitation:return t.critique("copyFullCitation");case Je.MoreSources:return t.critique("moreSources");case Je.Accessibility:return null===(o=t.accChecker)||void 0===o?void 0:o.call(t,"accAssistant");case Je.OpenColorPicker:return null===(r=t.accChecker)||void 0===r?void 0:r.call(t,"moreColors");case Je.MoreFontColors:return null===(n=t.accChecker)||void 0===n?void 0:n.call(t,"moreFontColors");case Je.ChangeColors:return null===(s=t.accChecker)||void 0===s?void 0:s.call(t,"changeColors");case Je.ResetGraphic:return null===(a=t.accChecker)||void 0===a?void 0:a.call(t,"resetGraphic");case Je.TurnOffAccChecker:return null===(l=t.accChecker)||void 0===l?void 0:l.call(t,"turnOffAccChecker");case Je.Allow:return null===(c=t.accChecker)||void 0===c?void 0:c.call(t,"allowTextColorIssue");case Je.AllowAll:return null===(d=t.accChecker)||void 0===d?void 0:d.call(t,"allowAllTextColorIssues");case Je.FixSimilarColors:return null===(u=t.accChecker)||void 0===u?void 0:u.call(t,"fixSimilarColors");case Je.FixAllColors:return null===(g=t.accChecker)||void 0===g?void 0:g.call(t,"fixAllColors");case Je.AutoGenAltText:case Je.MissingAltText:return null===(p=t.accChecker)||void 0===p?void 0:p.call(t,"altText");case Je.UseFirstRowAsHeader:return null===(h=t.accChecker)||void 0===h?void 0:h.call(t,"useFirstRowAsHeader");case Je.SplitCell:return null===(m=t.accChecker)||void 0===m?void 0:m.call(t,"splitCell");case Je.MergeCells:return null===(y=t.accChecker)||void 0===y?void 0:y.call(t,"mergeCells");case Je.MarkAsDecorative:return null===(b=t.accChecker)||void 0===b?void 0:b.call(t,"markAsDecorative");case Je.MarkAsLayout:return null===(f=t.accChecker)||void 0===f?void 0:f.call(t,"markAsLayout");case Je.Accept:case Je.Complete:case Je.AddOnFooterAction:case Je.Report:case Je.RejectHoverIn:case Je.RejectHoverOut:case Je.AcceptHoverIn:case Je.AcceptHoverOut:case Je.Reject:case Je.OpenCustomDictionary:case Je.SourceSelected:case Je.ApplyColor:case Je.RefreshSummary:case Je.UndoInsertSummarization:case Je.Overflow:case Je.InsertBelow:case Je.Regenerate:case Je.Cancel:case Je.StopGenerating:case Je.ContainerHoverIn:case Je.ContainerHoverOut:case Je.LaunchAIRewrite:case Je.LaunchAIRewriteHoverIn:case Je.LaunchAIRewriteHoverOut:case Je.CatchUp:return}}function Vi(e){switch(e){case Je.Allow:return"Ignore";case Je.AllowAll:return"IgnoreAll";case Je.IgnoreOnce:return"Ignore";case Je.IgnoreAll:return"IgnoreAll";case Je.IgnoreRule:return"IgnoreRule";case Je.FixAllColors:return"Completed";case Je.AddToDictionary:return"AddToDictionary";case Je.ShowExplanation:return"ShowExplanation";case Je.Next:return"Next";case Je.Previous:return"Previous";case Je.ReadContext:return"ReadAloud";case Je.Feedback:return"GiveFeedback";case Je.Dismiss:return"Cancel";case Je.OpenEditorPane:return"Editor";case Je.ManageLanguages:return"LocaleLanguage";case Je.Options:return"EditorSettings";case Je.IntextCitation:return"Plus";case Je.FullCitation:return"Copy";case Je.Accessibility:return"Accessibility";case Je.OpenColorPicker:case Je.MoreFontColors:case Je.ChangeColors:return"Color";case Je.TurnOffAccChecker:return"Hide";case Je.MarkAsDecorative:case Je.MarkAsLayout:return"BowTie";case Je.UseFirstRowAsHeader:return"FirstRowAsHeader";case Je.ResetGraphic:return"ArrowReset"}}function Zi(e,t,i){switch(t){case Je.Previous:case Je.Next:return Yi(e)&&Qi(e,t);case Je.ToggleContext:if(void 0===e.contextText)return!1;break;case Je.ReadContext:const i=Vi(t);if(void 0===i||!(0,Fi.Rd)({type:i}))return!1;break;case Je.IgnoreOnce:if(e.critiqueType===Qe.SimilarityChecker)return!0;break;case Je.Accessibility:case Je.OpenColorPicker:case Je.Allow:case Je.AllowAll:case Je.FixSimilarColors:case Je.FixAllColors:case Je.AutoGenAltText:case Je.MissingAltText:case Je.UseFirstRowAsHeader:case Je.SplitCell:case Je.MergeCells:case Je.MarkAsDecorative:case Je.MarkAsLayout:return!0;case Je.Feedback:case Je.TurnOffAccChecker:if(e.critiqueType===Qe.AccColorChecker||e.critiqueType===Qe.AltText||e.critiqueType===Qe.MergeSplitCell||e.critiqueType===Qe.MissingTableHeader)return!0}return Qi(e,t,i)}function Ki(e,t,i){switch(t){case Je.Next:case Je.Previous:return!Yi(e)||!Qi(e,t)||!e.wrapAroundNavigation&&(t===Je.Previous?e.critiquePosition<=0:e.critiquePosition>=e.critiqueSetSize-1);case Je.Dismiss:case Je.Accessibility:case Je.OpenColorPicker:case Je.Allow:case Je.AllowAll:case Je.FixSimilarColors:case Je.FixAllColors:case Je.Overflow:case Je.AutoGenAltText:case Je.MissingAltText:case Je.UseFirstRowAsHeader:case Je.SplitCell:case Je.MergeCells:case Je.MarkAsDecorative:case Je.MarkAsLayout:return!1;default:return!Qi(e,t,i)}}function Yi(e){return void 0!==e.critiquePosition&&void 0!==e.critiqueSetSize&&e.critiquePosition>=0&&e.critiqueSetSize>0}function Qi(e,t,i){const{actions:o}=e,r=i?i.actions:o;return!!r&&r.indexOf(t)>=0}function $i(e,t){switch(e){case Je.Previous:return`CritiqueNavButton_Left_${t}`;case Je.Next:return`CritiqueNavButton_Right_${t}`;case Je.Dismiss:return`CritiqueCloseButton_${t}`;case Je.OpenEditorPane:return`EditorPaneOpenButton_${t}`}return"undefined"}function Ji(e,t,i,o){const r=o.actionId,n=qi(e,t,r);return{type:"item",key:r.toString(),title:n,titleStyle:Ce(i,n.length),iconType:Vi(r),icons:o.icons}}function Xi(e={}){return Object.assign(Object.assign({},O),e)}const eo=e=>{const{brandingMode:t,theme:i}=e,o={useFluentV9:C.useContext(ot.O)},r=Si;switch(t){case Ye.Text:const{strings:t,fontTable:n}=e,s=t.critique("microsoftEditorBranding"),a=function(e,t,i){const o="Text"===(null==e?void 0:e.type)?e:Li(Ye.Text,i);return{fontWeight:x.IT.SemiBold,fontSize:t.xsmall,cssColor:null==o?void 0:o.textColor}}(i,n,o),l=t.critique("microsoftEditorBrandingAccessibilityLabel"),c=C.createElement(Lt.c,{text:s,accessibilityLabel:l,style:a});return to(c);case Ye.Icon:return to(C.createElement(jt,{type:"Editor",icon:r,primaryColor:Oi(i,o)}));case Ye.MonochromeIcon:return to(C.createElement(jt,{type:"EditorSingleColor",icon:r,primaryColor:Oi(i,o)}));case Ye.IconButton:return io(e,o);case Ye.IconAndTextButton:return oo(e,o);case Ye.CustomImageAndText:return no(e,o);default:return C.createElement(C.Fragment,null)}},to=e=>C.createElement(nt.S,{direction:st.PR.LeftToRight,align:st.j5.Center,style:{paddingHorizontal:6,paddingVertical:6}},e),io=(e,t)=>{const{definition:i,strings:o,theme:r,automationId:n,onAction:s,fontTable:a,htmlId:l,hasKeyboardFocus:c,isDisabled:d,showPreviewTooltipForBranding:u,layerHostId:g}=e,p=function(e,t,i){var o;const r="IconButton"===(null==e?void 0:e.type)?e:Li(Ye.IconButton,i),n=Mi(r.icon,t);return Object.assign(Object.assign({},r),{background:Object.assign(Object.assign({},r.background),{resting:t&&null!==(o=r.background.hover)&&void 0!==o?o:r.background.resting}),title:n,icon:n,border:t?r.focusRing:void 0})}(r,c,t),h=function(e){return{textAlign:k.R.Center,borderRadius:4,iconFontSize:e.xsmall}}(a),m=u?o.critique("editorButtonCiqPreviewTooltipContent"):o.critique("editorButtonTooltipContent");return C.createElement(nt.S,{direction:st.PR.LeftToRight,align:st.j5.Stretch},ro(i,p,h,o,void 0,void 0,m,n,s,l,d,c,g))},oo=(e,t)=>{const{definition:i,strings:o,theme:r,automationId:n,onAction:s,fontTable:a,htmlId:l,hasKeyboardFocus:c,isDisabled:d,showPreviewTooltipForBranding:u,layerHostId:g}=e,p=function(e,t,i){var o;const r="IconAndTextButton"===(null==e?void 0:e.type)?e:Li(Ye.IconAndTextButton,i);return Object.assign(Object.assign({},r),{background:Object.assign(Object.assign({},r.background),{resting:t&&null!==(o=r.background.hover)&&void 0!==o?o:r.background.resting}),title:Mi(r.title,t),icon:Mi(r.icon,t),border:t?r.focusRing:void 0})}(r,c,t),h=function(e){return{textAlign:k.R.Center,borderRadius:4,iconFontSize:e.xlarge,paddingHorizontal:7,paddingBottom:0,textHorizontalPadding:0,iconTextSpacing:3}}(a),m=o.critique("editorButtonText"),y=(b=a,{fontWeight:x.IT.SemiBold,fontFamily:T.V,fontSize:b.small});var b;const f=u?o.critique("editorButtonCiqPreviewTooltipContent"):o.critique("editorButtonTooltipContent");return C.createElement(nt.S,{direction:st.PR.LeftToRight,align:st.j5.Stretch},ro(i,p,h,o,m,y,f,n,s,l,d,c,g))},ro=(e,t,i,o,r,n,s,a,l,c,d,u,g)=>{const p=Vi(Je.OpenEditorPane),h=void 0!==p?{type:p}:void 0,m=Si,y={appearance:"subtle",onClick:()=>{null==l||l(Je.OpenEditorPane,void 0,void 0)},title:r,titleRootStyle:n,tooltip:s,tooltipProps:g?{layerHostId:g}:void 0,disabled:d,style:i,theme:t,accessibilityLabel:_i(e,o,Je.OpenEditorPane),automationLabel:$i(Je.OpenEditorPane,a),icon:h,htmlId:c,hasKeyboardFocus:u};return C.createElement(wi.J,Object.assign({},y,{key:Je.OpenEditorPane.toString(),renderChildren:(0,Ot.eO)(m)}))},no=(e,t)=>{const{theme:i,fontTable:o,definition:r}=e;return r.brandingImageUri&&r.brandingText?C.createElement(nt.S,{direction:st.PR.LeftToRight,align:st.j5.Center,style:{paddingHorizontal:8,paddingVertical:8}},C.createElement(C.Fragment,null,C.createElement(Di,{uri:r.brandingImageUri,style:{width:20,height:20}}),C.createElement(nt.S,{style:{paddingHorizontal:3}},C.createElement(C.Fragment,null)),C.createElement(Lt.c,{text:r.brandingText,style:Ri(i,o,t)}))):C.createElement(C.Fragment,null)};var so=i(45150);const ao=e=>e.accessibilityLabel||e.title||e.strings&&e.strings.defaultOverflowButtonAccessibilityLabel,lo=(e,t,i)=>{var o,r;const n=Object.assign({},null!==(r=null!==(o=t.buttonOnlyTheme)&&void 0!==o?o:t.theme)&&void 0!==r?r:(null==i?void 0:i.useFluentV9)?so.$C:so.G7);return e&&(n.background.hover&&(n.background=Object.assign(Object.assign({},n.background),{resting:n.background.hover})),n.title.hover&&(n.title=Object.assign(Object.assign({},n.title),{resting:n.title.hover})),n.subtitle&&n.subtitle.hover&&(n.subtitle=Object.assign(Object.assign({},n.subtitle),{resting:n.subtitle.hover})),n.icon&&n.icon.hover&&(n.icon=Object.assign(Object.assign({},n.icon),{resting:n.icon.hover}))),n},co=e=>{const t=e.style;return t&&void 0!==t.paddingHorizontal?t:Object.assign(Object.assign({},t),{paddingHorizontal:8})};var uo=i(60250),go=i(27810),po=i(99772),ho=i(65099);const mo=e=>C.createElement(nt.S,{style:e.style,align:st.j5.Stretch,onKeyDown:e.onKeyDown,handledKeys:[rt.h.Tab]},e.baseItems);const yo=e=>{const t=[];if(e.items){const i=e.items.filter((e=>"item"===e.type)),o=i.some((e=>!!e.icons));let r=1;t.push(e.items.map((t=>{var n;switch(t.type){case"item":return function(e,t,i,o,r,n,s){const{itemTheme:a,automationLabelType:l,automationId:c}=e,d=t.iconType?{type:t.iconType,filled:!0}:void 0,u=function(e,t,i){var o,r,n;const s={paddingHorizontal:8,flexibleSize:!0,iconFontSize:20,borderRadius:null!==(r=null===(o=e.style)||void 0===o?void 0:o.borderRadius)&&void 0!==r?r:4};return!t||i||(s.paddingStart=8+(0,Fi.SL)(null===(n=e.icon)||void 0===n?void 0:n.fontSize)),s}(e,n,void 0!==t.iconType||void 0!==t.icons),g=(0,Ot.eO)(t.icons);return C.createElement(wi.J,{appearance:"subtle",key:t.key,title:t.title,titleStyle:t.titleStyle,onClick:()=>i(t),disabled:t.disabled,theme:a,htmlId:s+t.key,accessibilityRole:"menuitem",automationLabel:`${l}_${t.title}_${c}`,icon:d,style:u,accessibilityPositionInSet:o,accessibilitySetSize:r,useAlternateIconColors:!0,renderChildren:g})}(e,t,e.onItemClick,r++,i.length,o,null!==(n=null==e?void 0:e.id)&&void 0!==n?n:"");case"separator":return C.createElement(ho.w,{key:t.key,color:e.theme&&e.theme.separator});default:return null}})))}return C.createElement(mo,Object.assign({},e,{baseItems:t}))};class bo extends C.PureComponent{getAccessibilityLabel(){return this.props.accessibilityLabel||this.props.title||this.props.strings&&this.props.strings.defaultOverflowButtonAccessibilityLabel}renderButton(e,t,i,o,r,n,s,a){var l,c,d,u,g;const p=Object.assign(Object.assign({},s),{layerHostId:this.props.layerHostId?this.props.layerHostId:void 0});return C.createElement(wi.J,{ref:r,key:t,htmlId:n,title:this.props.title,icon:{type:null!==(c=null===(l=this.props.icon)||void 0===l?void 0:l.type)&&void 0!==c?c:"Overflow",filled:(null===(d=this.props.icon)||void 0===d?void 0:d.filled)||i},tooltip:null!==(u=this.props.tooltip)&&void 0!==u?u:null===(g=this.props.strings)||void 0===g?void 0:g.defaultOverflowButtonAccessibilityLabel,tooltipProps:p,disabled:this.props.disabled,hidden:this.props.hidden,refusesKeyboardFocus:this.props.refusesKeyboardFocus,style:this.getStyle(),theme:this.getCompositeButtonTheme(),strings:this.props.strings,onClick:e,onHoverIn:this.props.onHoverIn,onHoverOut:this.props.onHoverOut,onFocus:this.props.onFocus,onBlur:this.props.onBlur,accessibilityLabel:this.getAccessibilityLabel(),accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilitySetSize:this.props.accessibilitySetSize,accessibilityRole:"overflow",accessibilityState:i,onAccessibilityExpandCollapse:o,automationLabel:`${this.props.automationLabelType}_${this.props.title||"OverFlow"}_${this.props.automationId}`,hasKeyboardFocus:this.props.hasKeyboardFocus,onHeightChange:this.props.onHeightChange,renderChildren:(0,Ot.eO)(null!=a?a:{regular:_t.mmJ,filled:_t.aKh})})}getCompositeButtonTheme(){return this.props.buttonOnlyTheme?this.props.buttonOnlyTheme:this.props.theme?this.props.theme:so.G7}getStyle(){const e=this.props.style;return e&&void 0!==e.paddingHorizontal?e:Object.assign(Object.assign({},e),{paddingHorizontal:8})}}class fo extends bo{componentDidUpdate(){this.props.startOpen&&this.openMenu()}openMenu(){this.state.menuOpen||(this.setState({menuOpen:!0}),this.handleMenuOpen())}focus(){var e;null===(e=this.buttonRef.current)||void 0===e||e.focus()}performAccessibilityExpandCollapse(e){this.onAccessibilityExpandCollapse(e)}renderAnchorButtonAndMaybeCallout(){var e;const t=this.renderButton(this.onButtonClick,"button",this.state.menuOpen,this.onAccessibilityExpandCollapse,this.buttonRef,this.props.id,null===(e=this.props.style)||void 0===e?void 0:e.tooltipProps,this.props.icons),i=this.state.menuOpen?this.renderCallout("callout",this.onMenuDismiss):void 0;return i?[t,i]:[t]}calculateBorderRadiusForCalloutItem(){var e,t,i,o,r;if(void 0!==(null===(e=this.props.style)||void 0===e?void 0:e.borderRadius))return"number"==typeof(null===(t=this.props.style)||void 0===t?void 0:t.borderRadius)?null===(i=this.props.style)||void 0===i?void 0:i.borderRadius:null===(r=null===(o=this.props.style)||void 0===o?void 0:o.borderRadius)||void 0===r?void 0:r.topEnd}renderCalloutItems(){return C.createElement(yo,Object.assign({},this.props,{style:Object.assign(Object.assign({},this.props.style),{borderRadius:this.calculateBorderRadiusForCalloutItem()}),onItemClick:this.onItemClick,onKeyDown:this.onKeyDown}))}getCompositeButtonTheme(){const e=Object.assign({},super.getCompositeButtonTheme());return this.state.menuOpen&&(e.background.hover&&(e.background=Object.assign(Object.assign({},e.background),{resting:e.background.hover})),e.title.hover&&(e.title=Object.assign(Object.assign({},e.title),{resting:e.title.hover})),e.subtitle&&e.subtitle.hover&&(e.subtitle=Object.assign(Object.assign({},e.subtitle),{resting:e.subtitle.hover})),e.icon&&e.icon.hover&&(e.icon=Object.assign(Object.assign({},e.icon),{resting:e.icon.hover}))),e}handleMenuOpen(){this.props.onMenuOpen&&this.props.onMenuOpen()}handleMenuDismiss(e){this.props.onMenuDismiss&&this.props.onMenuDismiss(e),this.shouldFocusButtonOnDismiss()&&this.focus()}onMenuDismiss(e){this.handleMenuDismiss(e),this.setState({menuOpen:!1})}onButtonClick(){this.setState((e=>{const t={menuOpen:!e.menuOpen};return t.menuOpen?this.handleMenuOpen():this.handleMenuDismiss(),t}))}onItemClick(e){this.props.onClick&&this.props.onClick(e),e.preventDismiss||this.onMenuDismiss()}onKeyDown(e){this.props.onTabClose&&e.key===rt.h.Tab&&this.onMenuDismiss(!0)}onAccessibilityExpandCollapse(e){"expand"===e&&this.state.menuOpen||"collapse"===e&&!this.state.menuOpen||this.onButtonClick()}constructor(e){super(e),this.state={menuOpen:!!e.startOpen},this.buttonRef=C.createRef(),this.onMenuDismiss=this.onMenuDismiss.bind(this),this.onButtonClick=this.onButtonClick.bind(this),this.onItemClick=this.onItemClick.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.onAccessibilityExpandCollapse=this.onAccessibilityExpandCollapse.bind(this)}}class So extends fo{render(){return this.context?C.createElement(vo,Object.assign({},this.props,{ref:this.props.refV9})):C.createElement("div",{ref:this.overflowButtonRef,style:{display:"flex"},role:"menu"},this.renderAnchorButtonAndMaybeCallout())}shouldFocusButtonOnDismiss(){var e;return null===(e=this.props.shouldFocusButtonOnDismiss)||void 0===e||e}renderCallout(e,t){var i,o,r,n;const s=null===(o=null===(i=this.props.style)||void 0===i?void 0:i.calloutStyle)||void 0===o?void 0:o.borderRadius;return C.createElement(b.P,{layerProps:this.props.layerHostId?{hostId:this.props.layerHostId}:void 0,styles:{beakCurtain:{borderRadius:s},calloutMain:{backgroundColor:null===(r=this.props.theme)||void 0===r?void 0:r.background.resting,borderRadius:s},root:{backgroundColor:null===(n=this.props.theme)||void 0===n?void 0:n.background.resting,borderRadius:s}},key:e,role:"menu",target:this.overflowButtonRef,isBeakVisible:!1,alignTargetEdge:!0,directionalHint:f.A.bottomLeftEdge,onDismiss:t,setInitialFocus:!0},C.createElement(mt.R,{isCircularNavigation:!0,handleTabKey:ht.l.all},this.renderCalloutItems()))}constructor(e){super(e),this.overflowButtonRef=C.createRef()}}So.contextType=ot.O;const vo=C.memo((0,C.forwardRef)(((e,t)=>{var i,o,r,n,s;const a=C.useRef(null),{menuOpen:l,button:c,buttonRef:d,focus:u,setMenuOpen:g,onAccessibilityExpandCollapse:p,onMenuOpen:h,onMenuDismiss:m,onItemClick:y,onKeyDown:b}=(e=>{const t=C.useRef(null),i=C.useRef(null),[o,r]=C.useState(!!e.startOpen),n=C.useContext(ot.O),s=()=>{var e;null===(e=t.current)||void 0===e||e.focus()},a=t=>{var o;null===(o=e.onMenuDismiss)||void 0===o||o.call(e,t),!1!==e.shouldFocusButtonOnDismiss?s():(()=>{var e;null===(e=i.current)||void 0===e||e.focus()})(),i.current=null},l=e=>{a(e),r(!1)},c=()=>{r((t=>{var i;const o=!t;return o?null===(i=e.onMenuOpen)||void 0===i||i.call(e):a(),o}))},d=e=>{"expand"===e&&o||"collapse"===e&&!o||c()},u=((e,t,i,o=!1,r,n,s,a,l)=>{var c,d,u,g,p;return C.createElement(wi.J,{appearance:"subtle",ref:n,key:i,htmlId:s,title:e.title,icon:{type:null!==(d=null===(c=e.icon)||void 0===c?void 0:c.type)&&void 0!==d?d:"Overflow",filled:(null===(u=e.icon)||void 0===u?void 0:u.filled)||o},tooltip:null!==(g=e.tooltip)&&void 0!==g?g:null===(p=e.strings)||void 0===p?void 0:p.defaultOverflowButtonAccessibilityLabel,tooltipProps:e.layerHostId?{layerHostId:e.layerHostId}:void 0,disabled:e.disabled,hidden:e.hidden,refusesKeyboardFocus:e.refusesKeyboardFocus,style:co(e),theme:lo(o,e,a),strings:e.strings,onClick:t,onHoverIn:e.onHoverIn,onHoverOut:e.onHoverOut,onFocus:e.onFocus,onBlur:e.onBlur,accessibilityLabel:ao(e),accessibilityPositionInSet:e.accessibilityPositionInSet,accessibilitySetSize:e.accessibilitySetSize,accessibilityRole:"overflow",accessibilityState:o,onAccessibilityExpandCollapse:r,automationLabel:`${e.automationLabelType}_${e.title||"OverFlow"}_${e.automationId}`,hasKeyboardFocus:e.hasKeyboardFocus,onHeightChange:e.onHeightChange,renderChildren:(0,Ot.eO)(null!=l?l:{regular:_t.mmJ,filled:_t.aKh})})})(e,c,"button",o,d,t,e.id,{useFluentV9:n},e.icons);return{menuOpen:o,button:u,buttonRef:t,focus:s,setMenuOpen:r,onAccessibilityExpandCollapse:d,onMenuOpen:t=>{var n;o||(i.current=t?document.activeElement:null,r(!0),null===(n=e.onMenuOpen)||void 0===n||n.call(e))},onMenuDismiss:l,onItemClick:t=>{var i;null===(i=e.onClick)||void 0===i||i.call(e,t),t.preventDismiss||l()},onKeyDown:t=>{e.onTabClose&&t.key===rt.h.Tab&&l(!0)}}})(Object.assign(Object.assign({},e),{shouldFocusButtonOnDismiss:null===(i=e.shouldFocusButtonOnDismiss)||void 0===i||i}));(0,C.useImperativeHandle)(t,(()=>({focus:u,openMenu:h,onAccessibilityExpandCollapse:p})));const f=(0,bt.i)({circular:!0,axis:"vertical"});return C.createElement(uo.A,{trapFocus:!0,open:l,onOpenChange:(e,t)=>{g(t.open),t.open?h():m()},closeOnScroll:!1,positioning:{position:"below",align:"start",target:null===(r=null===(o=d.current)||void 0===o?void 0:o.getElementRef())||void 0===r?void 0:r.current}},C.createElement(go.W,null,C.createElement("div",{id:e.layerHostId,role:"menu",style:{display:"flex"},ref:a,tabIndex:-1},c)),C.createElement(po.H,{style:{padding:4,borderWidth:"0px",borderRadius:null===(s=null===(n=e.style)||void 0===n?void 0:n.calloutStyle)||void 0===s?void 0:s.borderRadius}},C.createElement("div",Object.assign({style:{display:"flex",flexDirection:"column"},role:"menu",className:"ms-cc-overflow"},f),C.createElement(yo,Object.assign({},e,{style:Object.assign(Object.assign({},e.style),{borderRadius:(()=>{var t,i,o,r,n;if(void 0!==(null===(t=e.style)||void 0===t?void 0:t.borderRadius))return"number"==typeof(null===(i=e.style)||void 0===i?void 0:i.borderRadius)?null===(o=e.style)||void 0===o?void 0:o.borderRadius:null===(n=null===(r=e.style)||void 0===r?void 0:r.borderRadius)||void 0===n?void 0:n.topEnd})()}),onItemClick:y,onKeyDown:b})))))})));var Co=i(17021),xo=i(90753);function ko(e){if(e)return{paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,paddingHorizontal:e.paddingHorizontal}}const To=e=>{var t,i,o;if(e.styles&&e.styles.widths&&e.shimmerCount!==e.styles.widths.length)return null;const r=[];for(let n=0;n<e.shimmerCount;n+=1)r.push(C.createElement("div",{style:{width:null!==(o=null===(i=null===(t=e.styles)||void 0===t?void 0:t.widths)||void 0===i?void 0:i[n])&&void 0!==o?o:void 0}},C.createElement(Co.H,{style:{marginBottom:5}})));return C.createElement(nt.S,{style:ko(e.styles),direction:st.PR.TopToBottom,align:st.j5.Stretch},C.createElement(xo.E,{appearance:"translucent"},r))};class Io extends C.PureComponent{render(){var e,t,i,o;if(!this.context){const t=this.renderButton();if(this.state.calloutVisible){const i=null===(e=this.props.calloutStyle)||void 0===e?void 0:e.borderRadius,o={role:"dialog",target:"#"+this.buttonId,isBeakVisible:!1,ariaLabel:this.props.calloutAccessibilityLabel,setInitialFocus:!0,onDismiss:this.closeCallout,layerProps:this.props.layerHostId?{hostId:this.props.layerHostId}:void 0,styles:{beakCurtain:{borderRadius:i},calloutMain:{borderRadius:i},root:{borderRadius:i}}},r=C.createElement(b.P,Object.assign({},o),this.props.children);return C.createElement("div",{id:this.buttonId,style:{display:"flex"}},t,r)}return t}return C.createElement(uo.A,{trapFocus:!0,inline:!0,open:this.state.calloutVisible,onOpenChange:this.onPopoverOpenChange,closeOnScroll:!1,positioning:{position:"below",align:"start",target:null===(i=null===(t=this.buttonRef.current)||void 0===t?void 0:t.getElementRef())||void 0===i?void 0:i.current}},C.createElement(go.W,null,C.createElement("div",{role:void 0,"aria-expanded":void 0,id:this.props.layerHostId,ref:this.flyoutAnchorRef,tabIndex:-1},this.renderButton())),C.createElement(po.H,{role:"dialog","aria-lable":this.props.calloutAccessibilityLabel,style:{padding:0,borderWidth:"0px",borderRadius:null===(o=this.props.calloutStyle)||void 0===o?void 0:o.borderRadius}},this.props.children))}componentDidUpdate(){var e;this.shouldFocusButtonOnUpdate&&(null===(e=this.buttonRef.current)||void 0===e||e.focus(),this.shouldFocusButtonOnUpdate=!1)}renderButton(){const e=Object.assign(Object.assign({},this.props.buttonProps),{htmlId:this.buttonId,onClick:this.context?this.props.buttonProps.onClick:this.handleClick,accessibilityState:this.state.calloutVisible,accessibilityRole:this.props.buttonAccessibilityRole||"button",tooltipProps:this.props.layerHostId?{layerHostId:this.props.layerHostId}:void 0});return this.state.calloutVisible&&e.theme&&e.theme.background.hover&&(e.theme=Object.assign(Object.assign({},e.theme),{background:Object.assign(Object.assign({},e.theme.background),{resting:e.theme.background.hover})})),C.createElement(wi.J,Object.assign({},e,{onAccessibilityExpandCollapse:this.onAccessibilityExpandCollapse,ref:this.buttonRef}))}onPopoverOpenChange(e,t){t.open||(this.shouldFocusButtonOnUpdate=!0),this.setState((e=>Object.assign(Object.assign({},e),{calloutVisible:t.open})))}handleClick(){this.props.buttonProps.onClick&&this.props.buttonProps.onClick(),this.setState((e=>({calloutVisible:!e.calloutVisible})))}closeCallout(){this.shouldFocusButtonOnUpdate=!0,this.setState((e=>({calloutVisible:!1})))}onAccessibilityExpandCollapse(e){var t,i;"expand"===e&&this.state.calloutVisible||"collapse"===e&&!this.state.calloutVisible||(this.context?null===(i=(t=this.props.buttonProps).onClick)||void 0===i||i.call(t):this.handleClick())}constructor(e){super(e),this.shouldFocusButtonOnUpdate=!1,this.buttonRef=C.createRef(),this.flyoutAnchorRef=C.createRef(),this.buttonId="FlyoutAnchor"+Io.ids,Io.ids+=1,this.handleClick=this.handleClick.bind(this),this.closeCallout=this.closeCallout.bind(this),this.onAccessibilityExpandCollapse=this.onAccessibilityExpandCollapse.bind(this),this.onPopoverOpenChange=this.onPopoverOpenChange.bind(this),this.state={calloutVisible:!1}}}function wo(e,t){var i;return null!==(i="true"===(null==t?void 0:t[e]))&&void 0!==i&&i}function Ao(e,t){const i=Vi(e);return!wo("RenderFooterIcons",t)||!i||!(0,Fi.Rd)({type:i})}Io.contextType=ot.O,Io.ids=0;const Do=e=>"footerButton"+e.toString();class Eo extends C.Component{componentDidMount(){var e;this.props.setFooterActionIdList&&this.props.setFooterActionIdList(null!==(e=this.actionIds.current)&&void 0!==e?e:[]),this.isFirstTimeRendering.current=!1}componentDidUpdate(e,t){const{selectedButtonIndex:i}=this.props,o=e.selectedButtonIndex;i!==o&&(void 0!==o&&this.setState((e=>{if(null!==this.actionIds.current){const t=this.actionIds.current[o],i=Object.assign({},e.actionIdShowAppearFocusMap);return i[t]=!1,Object.assign(Object.assign({},this.state),{actionIdShowAppearFocusMap:i})}return e})),void 0!==i&&this.setState((e=>{if(null!==this.actionIds.current){const t=this.actionIds.current[i],o=Object.assign({},e.actionIdShowAppearFocusMap);return o[t]=!0,Object.assign(Object.assign({},this.state),{actionIdShowAppearFocusMap:o})}return e})))}render(){return C.createElement(nt.S,{direction:st.PR.LeftToRight,style:this.getFooterStyle(),align:st.j5.Stretch},this.renderIcons(),C.createElement(nt.S,{style:{flexibleSize:!0}}),this.props.definition.critiqueType===Qe.AccColorChecker||this.props.definition.critiqueType===Qe.AltText||this.props.definition.critiqueType===Qe.MergeSplitCell||this.props.definition.critiqueType===Qe.MissingTableHeader?this.renderFooterButton(Je.Accessibility,hi.icons):null,this.renderBrandingOrPrevNextButton())}focus(){var e,t;this.defaultActionButtonRef.current?this.defaultActionButtonRef.current.focus():this.context?null===(e=this.overflowMenuRefV9.current)||void 0===e||e.focus():null===(t=this.overflowMenuRef.current)||void 0===t||t.focus()}openOverflowMenu(e){var t,i;this.context?null===(t=this.overflowMenuRefV9.current)||void 0===t||t.openMenu(e):null===(i=this.overflowMenuRef.current)||void 0===i||i.openMenu()}componentWillUnmount(){this.props.setFooterActionIdList&&this.props.setFooterActionIdList([]),this.isFirstTimeRendering.current=null}renderIcons(){return this.props.definition.onlyShowFeedbackButton?this.renderFeedbackIcon():C.createElement(C.Fragment,null,this.renderDefaultActionButtons(),this.renderExplanation(),this.renderOverflowMenu())}renderFeedbackIcon(){const{definition:e,strings:t,layerHostId:i,onAction:o,automationId:r}=this.props;return Zi(e,Je.Feedback)?(this.addActionId(Je.Feedback),function(e,t,i,o,r,n,s,a,l){const c=qi(e,o,Je.Feedback);if(!c)return null;const d={type:Vi(Je.Feedback),filled:!0},u=function(e,t){var i;let o=null!==(i=e.altIcon)&&void 0!==i?i:e.icon;return o=Object.assign(Object.assign({},o),{resting:o.hover}),{background:ce(e,void 0,t),title:o,tooltip:e.tooltip,tag:e.tag,subtitle:e.altText,icon:o,border:t?e.focusRing:void 0,focusRing:e.focusRing}}(t,s),g={onClick:()=>{null==n||n(Je.Feedback,void 0,void 0)},title:c,tooltip:c,tooltipProps:{layerHostId:l},disabled:Ki(e,Je.Feedback),style:i,theme:u,accessibilityLabel:_i(e,o,Je.Feedback),automationLabel:`CritiqueActionButton_${c}_${r}`,icon:d,onHeightChange:a};return C.createElement(wi.J,Object.assign({},g,{key:Je.Feedback.toString(),useAlternateIconColors:!0,renderChildren:(0,Ot.eO)({regular:Wt.bBX,filled:Wt.FfV})}))}(e,this.getTheme(),H(this.props.footerButtonStyle),t,r,o,this.state.actionIdShowAppearFocusMap[Je.Feedback],void 0,i)):null}addActionId(e){Ki(this.props.definition,e)||this.isFirstTimeRendering.current&&(null===this.actionIds.current&&(this.actionIds.current=[]),this.actionIds.current.push(e))}renderOverflowMenu(){const{definition:e,layerHostId:t,strings:i,onAction:o,automationId:r}=this.props,{critiqueType:n,isContentPending:s}=e;if(n===Qe.NeuralRewrite&&s||n===Qe.NeuralRewrite&&wo("renderNRForAIFeedback",this.props.settings)||n===Qe.DictationCorrection)return null;const a=this.state.actionIdShowAppearFocusMap[Je.Overflow],l=Hi(e,this.getTheme(),i,this.getFontTable(),function(e,t){const{actions:i,critiqueType:o,flagType:r}=e;if(void 0===i||0===i.length)return[];const n=wo("EnableFeedback",t),s=wo("FirstActionTurnOffAccChecker",t);let a;switch(o){case Qe.Spelling:a=[Kt,Ao(Je.AddToDictionary,t)?Qt:void 0,Jt,Xt,ei,ti];break;case Qe.RepeatedWord:a=[Jt,ei];break;case Qe.Grammar:a=[Yt,oi,ii,Jt,n&&Ao(Je.Feedback,t)?$t:void 0,ei];break;case Qe.Refinement:a=[oi,Jt,n&&Ao(Je.Feedback,t)?$t:void 0,ei];break;case Qe.TonalRewrite:a=[Yt,oi,Jt,ei];break;case Qe.Topic:a=[Kt,oi,Jt,ei];break;case Qe.NeuralRewrite:a=[Jt,Xt];break;case Qe.SimilarityChecker:a=[$t,ai];break;case Qe.AccColorChecker:{const e=wo("AllowTextColorIssueEnabled",t);a=[wo("BulkFixTextColorIssuesEnabled",t)?ri:void 0,e?ci:void 0,e||!s?ni:void 0,$t];break}case Qe.AltText:case Qe.MergeSplitCell:case Qe.MissingTableHeader:a=[s?void 0:ni];break;case Qe.InlineSuggestion:if(void 0!==r)switch(r){case tt.Location:case tt.SatoriEntity:a=[oi,$t,si,ei];break;case tt.File:case tt.Person:a=[oi,Yt,si,ei];break;case tt.Topic:a=[$t,ei];break;default:a=[]}a=[oi,Yt,si,ei];break;default:a=[]}return a.filter((e=>void 0!==e&&-1!==i.indexOf(e.actionId)))}(e,this.props.settings),wo("NoTooltipForFooterOverflow",this.props.settings),i.critique("footerSeeMoreActionsAccessibilityLabel"),void 0,r,t,o,a,void 0,Object.assign(Object.assign({},this.props.overflowMenuButtonStyle),{calloutStyle:this.props.overflowMenuCalloutStyle}));return l?(this.addActionId(Je.Overflow),C.createElement(So,Object.assign({ref:this.overflowMenuRef,refV9:this.overflowMenuRefV9},l,{icons:ui.icons,icon:{type:"Overflow",filled:!0}}))):null}getTheme(e){var t;const i=null!==(t=this.props.theme)&&void 0!==t?t:this.context?D:A,o=i.altIcon;return e===Je.Accessibility&&i.accessibilityIcon?Object.assign(Object.assign({},i),{altIcon:Object.assign(Object.assign({},o),{resting:i.accessibilityIcon})}):i}getBrandingTheme(){var e,t;return null!==(t=null===(e=this.props.theme)||void 0===e?void 0:e.branding)&&void 0!==t?t:Li(this.props.definition.brandingMode,{useFluentV9:!!this.context})}getFontTable(){var e;return null!==(e=this.props.fontTable)&&void 0!==e?e:E}getFooterStyle(){var e;return null!==(e=this.props.footerContainerStyle)&&void 0!==e?e:O}renderFooterButton(e,t,i,o){var r;const{definition:n,strings:s,onAction:a,automationId:l}=this.props;if(!Zi(n,e))return null;const c=qi(n,s,e);if(!c)return null;this.addActionId(e);const d=`CritiqueActionButton_${c}_${l}`,u=Ki(n,e),g=e===Je.IgnoreOnce||e===Je.IgnoreAll?zi(n,s,this.getTheme(),u,e,void 0,{horizontalSpacing:null===(r=this.getFooterStyle())||void 0===r?void 0:r.paddingHorizontal}):void 0;if(!this.shouldRenderFooterIconActionInOverflow(e))return Pi(n,this.getTheme(e),e,H(this.props.footerButtonStyle),s,t,void 0,void 0,void 0,c,d,i?this.defaultActionButtonRef:void 0,g,l,a,!0,Do(e),this.state.actionIdShowAppearFocusMap[e],o,void 0,this.props.layerHostId);const p={appearance:"subtle",title:c,titleStyle:ve(this.getFontTable(),c.length),onClick:()=>{null==a||a(e)},style:H(this.props.footerButtonStyle),theme:ge(this.getTheme(e)),automationLabel:d,disabled:u};return C.createElement(wi.J,Object.assign({key:e,ref:this.defaultActionButtonRef},p,{renderChildren:(0,Ot.eO)(void 0)}))}renderDefaultActionButtons(){const{definition:e,strings:t,onAction:i,automationId:o}=this.props,{critiqueType:r}=e,n=function(e,t){const{actions:i,critiqueType:o,isContentPending:r,flagType:n}=e;if(void 0===i||0===i.length)return[];const s=function(e,t){switch(e){case Qe.Refinement:case Qe.RepeatedWord:case Qe.SimilarityChecker:case Qe.AccColorChecker:case Qe.TonalRewrite:case Qe.Grammar:case Qe.DictationCorrection:case Qe.TextPenAlternates:return Kt;case Qe.Spelling:case Qe.Topic:return Yt;case Qe.InlineSuggestion:switch(t){case tt.Person:case tt.File:case tt.Location:case tt.SatoriEntity:return Kt;case tt.Topic:return Yt;default:return}case Qe.AddinCritique:return Kt;case Qe.NeuralRewrite:case Qe.Classification:case Qe.WritersUnblock:default:return}}(o,n),a=wo("EnableFeedback",t),l=wo("FirstActionTurnOffAccChecker",t);let c;switch(o){case Qe.Refinement:case Qe.Topic:const i=[s];Zi(e,Je.Feedback)&&(Ao(Je.Feedback,t)&&o!==Qe.Topic||i.push($t)),c=i;break;case Qe.Spelling:c=[s,Zi(e,Je.Feedback)&&!Ao(Je.Feedback,t)?$t:void 0,Ao(Je.AddToDictionary,t)?void 0:Qt];break;case Qe.AccColorChecker:{const e=wo("AllowTextColorIssueEnabled",t),i=[];e&&i.push(li),!e&&l&&i.push(ni),i.push(gi),c=i;break}case Qe.AltText:case Qe.MissingTableHeader:case Qe.MergeSplitCell:c=[l?ni:void 0];break;case Qe.RepeatedWord:case Qe.SimilarityChecker:case Qe.DictationCorrection:case Qe.TextPenAlternates:c=[s];break;case Qe.Grammar:c=[s,a&&!Ao(Je.Feedback,t)?$t:void 0];break;case Qe.TonalRewrite:c=[s,a?$t:void 0];break;case Qe.NeuralRewrite:r&&(c=[]),c=0===Ui(e).length?[pi]:[$t];break;case Qe.InlineSuggestion:if(void 0!==n)switch(n){case tt.Location:case tt.SatoriEntity:case tt.Topic:c=[s];break;case tt.File:case tt.Person:c=[s,$t];break;default:c=[]}else c=[s,Zi(e,Je.Feedback)&&!Ao(Je.Feedback,t)?$t:void 0];break;case Qe.AddinCritique:c=[s];break;default:c=[]}return c.filter((e=>void 0!==e&&-1!==i.indexOf(e.actionId)))}(e,this.props.settings);return r!==Qe.NeuralRewrite?C.createElement(C.Fragment,null,n.map((({actionId:e,icons:t},i)=>e===Je.OpenColorPicker?this.renderFooterButton(Je.OpenColorPicker,gi.icons,0===i,"ACCF2E3E-7EC7-46DF-AB25-A1AFEDBC6B7B"):this.renderFooterButton(e,t,0===i))),r===Qe.AltText&&this.renderFooterButton(Je.MarkAsDecorative,bi.icons),r===Qe.MissingTableHeader&&this.renderFooterButton(Je.MarkAsLayout,fi.icons)):0===n.length?C.createElement(To,{shimmerCount:1,styles:(s=this.getSpacing(),{paddingHorizontal:s.xsmall,widths:[5*s.medium]})}):C.createElement(C.Fragment,null,n.map((({actionId:r,icons:n})=>r===Je.Dismiss?(this.addActionId(r),Pi(e,this.getTheme(r),Je.Dismiss,ke(this.getFontTable()),t,pi.icons,void 0,void 0,void 0,void 0,void 0,this.defaultActionButtonRef,void 0,o,i,void 0,void 0,void 0,void 0,void 0,this.props.layerHostId)):this.renderFooterButton(r,n))));var s}renderExplanation(){const{automationId:e,footerButtonStyle:t,layerHostId:i,onAction:o,overflowMenuCalloutStyle:r,strings:n,style:s}=this.props,a=Object.assign({},this.props.definition),l=this.getTheme(),c=this.getFontTable();if(!a.explanationTitle||!a.explanation)return null;const d={appearance:"subtle",onClick:()=>{null==o||o(Je.ShowExplanation)},style:Te(c,t),theme:ge(l,void 0,!0),tooltip:qi(a,n,Je.ShowExplanation),accessibilityLabel:_i(a,n,Je.ShowExplanation),automationLabel:`CritiqueExplanationButton_${e}`,icon:{type:"ShowExplanation",filled:!0},tooltipProps:{layerHostId:i},renderChildren:(0,Ot.eO)(ii.icons)};this.addActionId(Je.ShowExplanation);const u={definition:a,strings:n,style:s,theme:l,fontTable:c};return C.createElement(Io,{calloutAccessibilityLabel:n.critique("explanationFlyoutAccessibilityLabel"),calloutStyle:r,layerHostId:i,buttonAccessibilityRole:"button",buttonProps:d,showCloseButton_DONOTUSE:!0,closeButtonAccessibilityLabel_DONOTUSE:n.critique("explanationFlyoutCloseLabel")},C.createElement(Ii,Object.assign({},u)))}renderBrandingOrPrevNextButton(){const{definition:e,showPreviewTooltipForBranding:t}=this.props,{brandingMode:i}=e;if(Yi(e))return this.renderPrevNextButtons();if(void 0===i)return null;const{strings:o,automationId:r,layerHostId:n,onAction:s}=this.props,a=Ki(e,Je.OpenEditorPane);return i!==Ye.IconButton&&i!==Ye.IconAndTextButton||this.addActionId(Je.OpenEditorPane),C.createElement(eo,{strings:o,theme:this.getBrandingTheme(),fontTable:this.getFontTable(),definition:e,automationId:r,brandingMode:i,onAction:s,htmlId:Do(Je.OpenEditorPane),hasKeyboardFocus:a?void 0:this.state.actionIdShowAppearFocusMap[Je.OpenEditorPane],isDisabled:a,showPreviewTooltipForBranding:t,layerHostId:n})}renderPrevNextButtons(){if(!Zi(this.props.definition,Je.Previous)||!Zi(this.props.definition,Je.Next))return null;const e=ke(this.getFontTable()),t=!wo("NoTooltipForPrevNext",this.props.settings);return this.addActionId(Je.Previous),this.addActionId(Je.Next),C.createElement(nt.S,{direction:st.PR.LeftToRight,align:st.j5.Stretch},Pi(this.props.definition,this.getTheme(),Je.Previous,e,this.props.strings,mi.icons,void 0,void 0,void 0,t?qi(this.props.definition,this.props.strings,Je.Previous):void 0,void 0,void 0,void 0,this.props.automationId,this.props.onAction,!0,Do(Je.Previous),this.state.actionIdShowAppearFocusMap[Je.Previous],void 0,void 0,this.props.layerHostId),Pi(this.props.definition,this.getTheme(),Je.Next,e,this.props.strings,yi.icons,void 0,void 0,void 0,t?qi(this.props.definition,this.props.strings,Je.Next):void 0,void 0,void 0,void 0,this.props.automationId,this.props.onAction,!0,Do(Je.Next),this.state.actionIdShowAppearFocusMap[Je.Next],void 0,void 0,this.props.layerHostId))}shouldRenderFooterIconActionInOverflow(e){const t=Vi(e);return!wo("RenderFooterIcons",this.props.settings)||!t||!(0,Fi.Rd)({type:t})}getSpacing(){var e;return null!==(e=this.props.spacing)&&void 0!==e?e:M}constructor(e){super(e),this.defaultActionButtonRef=C.createRef(),this.overflowMenuRef=C.createRef(),this.overflowMenuRefV9=C.createRef(),this.isFirstTimeRendering=C.createRef(),this.actionIds=C.createRef(),this.state={actionIdShowAppearFocusMap:{}},this.addActionId=this.addActionId.bind(this),this.isFirstTimeRendering.current=!0}}Eo.contextType=ot.O;const Mo=({style:e})=>{var t,i,o,r;const n=null!==(t=null==e?void 0:e.itemPaddingVertical)&&void 0!==t?t:6,s=null!==(i=null==e?void 0:e.itemPaddingHorizontal)&&void 0!==i?i:12,a=null!==(o=null==e?void 0:e.textPaddingLeft)&&void 0!==o?o:8,l=null!==(r=null==e?void 0:e.personaCoinSize)&&void 0!==r?r:24;return C.createElement(xo.E,{style:{paddingTop:n,paddingBottom:n,paddingLeft:s,paddingRight:s}},C.createElement("div",{style:{display:"grid",gridTemplateColumns:"auto 1fr",gap:a,alignItems:"center"}},C.createElement(Co.H,{shape:"circle",style:{width:l,height:l}}),C.createElement("div",{style:{display:"flex",flexDirection:"column",gap:4,paddingTop:4,paddingBottom:4}},C.createElement(Co.H,{style:{height:14}}),C.createElement(Co.H,{style:{height:10,width:"80%"}}))))},Lo=({hideTitle:e,style:t})=>{var i,o;const r=null!==(i=null==t?void 0:t.itemPaddingHorizontal)&&void 0!==i?i:12,n=((null!==(o=null==t?void 0:t.titleLineHeight)&&void 0!==o?o:16)-12)/2+10;return C.createElement(nt.S,{align:st.j5.Stretch,style:{width:"100%"}},!e&&C.createElement(xo.E,{style:{paddingLeft:r,paddingRight:r}},C.createElement(Co.H,{style:{height:12,width:80,marginTop:n,marginBottom:n}})),C.createElement(Mo,{style:t}),C.createElement(Mo,{style:t}),C.createElement(Mo,{style:t}),C.createElement(Mo,{style:t}),C.createElement(Mo,{style:t}))};var Ro=i(86096);const Oo={background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#F0F0F0"},footerButtonBackground:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},altIcon:{resting:"#616161",hover:"#185ABD",pressed:"#185ABD",disabled:"#CCCCCC"},text:{resting:"#201F1E",disabled:"#707070"},altText:{resting:"#605E5C"},actionButtonForeground:{resting:"#0078D4",disabled:"#707070"},highlighting:"#F5F5F5",highlightingBorderColor:"#201f1e",shimmer:{shimmerColor:"#F3F2F1",shimmerWaveColor:"#EDEBE9"},scroll:{thumbColor:"#bdbdbd"},focusRing:"#323130",searchBox:{borderColor:{resting:"#D1D1D1",hover:"#D1D1D1"},borderBottomColor:"#464FEB",iconColor:"#424242"},tooltip:{directionHint:1},tag:{background:"#EBF3FC",textColor:"#0F6CBD"},meetingBanner:{backgroundColor:"#FAF9F8",text:"#424242",iconPrimaryColor:"#616161",borderColor:"#d1d1d1"}},Fo=(e,t)=>{var i,o;return t?Object.assign(Object.assign({},{background:{resting:"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},text:{resting:"var(--colorNeutralForeground1)",hover:"var(--colorNeutralForeground1Hover)",pressed:"var(--colorNeutralForeground1Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},altIcon:{resting:"var(--colorNeutralForeground1)",hover:"var(--colorNeutralForeground2BrandHover)",disabled:"var(--colorNeutralForegroundDisabled)"},altText:{resting:"var(--colorNeutralForeground2)",hover:"var(--colorNeutralForeground2Hover)",pressed:"var(--colorNeutralForeground2Pressed)",disabled:"var(--colorNeutralForegroundDisabled)"},highlighting:"var(--colorNeutralBackground1Hover)",highlightingBorderColor:"var(--colorStrokeFocus2)",focusRing:"var(--colorStrokeFocus2)",footerButtonBackground:{resting:"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},noSuggestions:{descriptionTextColor:"var(--colorNeutralForeground2)",item:{background:{resting:"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},text:{resting:"var(--editorNoSuggestionsTextColorResting, var(--colorNeutralForeground2BrandHover))",hover:"var(--editorNoSuggestionsTextColorHover, var(--editorNoSuggestionsTextColorResting, var(--colorNeutralForeground2BrandHover)))",disabled:"var(--colorNeutralForegroundDisabled)"},actionButtonForeground:{resting:"var(--colorNeutralBackground1)",hover:"var(--colorNeutralBackground1Hover)",pressed:"var(--colorNeutralBackground1Pressed)",disabled:"var(--colorNeutralBackgroundDisabled)"},highlighting:"var(--colorNeutralBackground1Hover)"}},actionButtonForeground:{resting:"var(--editorActionButtonForegroundResting)",hover:"var(--editorActionButtonForegroundHover)",pressed:"var(--editorActionButtonForegroundPressed)",disabled:"var(--editorActionButtonForegroundDisabled)"},shimmer:{shimmerColor:"var(--editorShimmerColor)",shimmerWaveColor:"var(--editorShimmerWaveColor)"},scroll:{thumbColor:"var(--editorScrollThumbColor)"},searchBox:{borderColor:{resting:"var(--editorSearchBoxBorderColorResting)",hover:"var(--editorSearchBoxBorderColorHover)"},borderBottomColor:"var(--editorSearchBoxBorderBottomColor)",iconColor:"var(--editorSearchBoxIconColor)"},tooltip:{directionHint:1},tag:{background:"var(--editorTagBackground)",textColor:"var(--editorTagTextColor)"},meetingBanner:{backgroundColor:"var(--editorMeetingBannerBackgroundColor)",text:"var(--editorMeetingBannerText)",iconPrimaryColor:"var(--editorMeetingBannerIconPrimaryColor)",borderColor:"var(--editorMeetingBannerBorderColor)"}}),{branding:e?null===(i=Ei[e])||void 0===i?void 0:i.v9:void 0}):Object.assign(Object.assign({},Oo),{branding:e?null===(o=Ei[e])||void 0===o?void 0:o.v8[it.light]:void 0})};function Bo(e,t){const i=Object.assign(Object.assign({},e.background),{disabled:void 0}),o=Object.assign({},e.text),r=e.altText?Object.assign({},e.altText):void 0;let n;return t&&(e.highlighting&&(i.resting=e.highlighting,n=e.highlightingBorderColor),o.hover&&(o.resting=o.hover),(null==r?void 0:r.hover)&&(r.resting=r.hover)),{background:i,title:o,subtitle:r,focusRing:"transparent",border:n,tooltip:e.tooltip,underline:e.headerUnderlineColor}}function No(e,t){const i=Object.assign(Object.assign({},e.background),{disabled:void 0});let o;return t&&e.highlighting&&(i.resting=e.highlighting,o=e.highlightingBorderColor),{background:i,title:e.actionButtonForeground,subtitle:e.altText,focusRing:"transparent",border:o}}function jo(e,t){const i=Object.assign(Object.assign({},e.background),{disabled:void 0});return t&&e.highlighting&&(i.resting=e.highlighting),{background:i,title:{resting:t?e.actionButtonForeground.resting:e.text.resting},focusRing:"transparent"}}function Ho(e){return{background:{resting:"transparent",hover:"transparent"},title:e.actionButtonForeground}}function Po(e){var t;return{focusRing:null!==(t=e.focusRing)&&void 0!==t?t:"#323130"}}function zo(e,t){var i,o,r,n;const s=null!==(i=Oo.text.disabled)&&void 0!==i?i:Oo.text.resting;return e.type===xt?null!==(r=null===(o=null==t?void 0:t.noSuggestions)||void 0===o?void 0:o.descriptionTextColor)&&void 0!==r?r:s:null!==(n=null==t?void 0:t.text.disabled)&&void 0!==n?n:s}const Uo=e=>{var t,i;if(e)return Object.assign(Object.assign({},e),{background:null!==(t=e.footerButtonBackground)&&void 0!==t?t:e.background,header:"",subheader:"",dialogText:"",iconText:"",contextText:"",errorText:"",border:"",separator:"",focusRing:null!==(i=e.focusRing)&&void 0!==i?i:"",link:"",linkPressed:"",tag:void 0})};function Wo(e,t,i,o,r,n){const s=i?null==e?void 0:e.borderThicknessInitialSelection:o?null==e?void 0:e.borderThicknessWithKeyboardFocus:void 0,a=r&&s?s:null==e?void 0:e.borderThickness;let l="number"==typeof a?a:null==a?void 0:a.start,c="number"==typeof a?a:null==a?void 0:a.end,d="number"==typeof a?a:null==a?void 0:a.top,u="number"==typeof a?a:null==a?void 0:a.bottom;(0,Ro.I)()&&(null==n?void 0:n.useFluentV9)&&(l=0===l?1:l,c=0===c?1:c,d=0===d?1:d,u=0===u?1:u);let g="";return l&&(g+=`inset ${l}px 0 0 0 ${t},`),c&&(g+=`inset -${c}px 0 0 0 ${t},`),d&&(g+=`inset 0 ${d}px 0 0 ${t},`),u&&(g+=`inset 0 -${u}px 0 0 ${t},`),g.length>0&&(g=g.substring(0,g.length-1)),{borderThickness:a,shadows:g}}function Go(e,t){if(!t)return;e=e.toLocaleLowerCase();const i=(t=t.toLocaleLowerCase()).indexOf(e);return i<0?void 0:[{start:i,length:e.length,fontWeight:x.IT.SemiBold,wrapMode:x.bd.NoWrap}]}function _o(e,t,i){if(!e)return;const o=i?null==t?void 0:t.filter((e=>e.propertyHit===i)):t,r=[];return o&&o.forEach((e=>{r.push({start:e.offset,length:e.word.length,fontWeight:x.IT.SemiBold,wrapMode:x.bd.NoWrap})})),r}const qo=({htmlId:e,theme:t,style:i,strings:o,suggestionId:r,suggestionType:n,queryString:s,title:a,titleFontSize:l,subtitle:c,subtitleFontSize:d,truncateSubtitle:u,tooltip:p,icon:h,layerHostId:m,personaCoinProps:y,isHighlighted:b,hasSelectionBeenModifiedViaKeyboard:f,showKeyboardTooltip:S,isInitialSelection:v,accessibilityRole:x,accessibilityPositionInSet:T,accessibilitySetSize:I,disableAccessibilityExpanded:w,onHeightChange:A,onHoverIn:D,onClick:M,enablePrefixHighlighting:L,hitHighlightIndexes:R,displayNewItemTag:O,newItemTagStyles:F,disableTooltips:B,enableExpandedECCScopeLayout:N,isScopeSelected:j,isDisabled:H,updateItemHeight:P})=>{var z,U,W,G,_,q,V,Z,K,Y,Q,$,J;const X=C.useContext(ot.O),ee=n===g.c.Topic,te=null!=t?t:Fo(void 0,X);let ie=k.A.rightCenter;switch(null===(z=null==te?void 0:te.tooltip)||void 0===z?void 0:z.directionHint){case et.centered:ie=void 0;break;case et.rightCenter:ie=k.A.rightCenter;break;case et.bottomCenter:ie=k.A.bottomCenter;break;default:ie=ee?k.A.rightCenter:void 0}const oe=function(e,t,i){return e===xt?function(e,t){var i,o,r;const n=null===(i=null==e?void 0:e.noSuggestions)||void 0===i?void 0:i.item;if(n){const e=Object.assign(Object.assign({},n.background),{disabled:void 0}),i=Object.assign(Object.assign({},n.text),{focused:n.text.hover});return t&&n.highlighting&&(i.resting=null!==(o=i.focused)&&void 0!==o?o:i.resting,e.resting=n.highlighting),{background:e,title:i,focusRing:"transparent"}}const s=null!=e?e:Oo,a=Object.assign(Object.assign({},s.background),{disabled:void 0}),l=Object.assign(Object.assign({},s.actionButtonForeground),{focused:s.actionButtonForeground.hover});return t&&s.highlighting&&(l.resting=null!==(r=l.focused)&&void 0!==r?r:l.resting,a.resting=s.highlighting),{background:a,title:l,focusRing:"transparent"}}(t,i):Bo(null!=t?t:Oo,i)}(n,t,b);let re=a&&c?function(e,t,i){var o;return(null!==(o=e.inlineSuggestions("combineSentences"))&&void 0!==o?o:"{0}. {1}").replace("{0}",t).replace("{1}",i)}(o,a,c):a;O&&(re=o.inlineSuggestions("combineTag").replace("{0}",null!=re?re:"").replace("{1}",o.inlineSuggestions("newTagText")));const{borderThickness:ne,shadows:se}=Wo(i,X?(0,Ro.I)()?"Highlight":null!==(U=te.focusRing)&&void 0!==U?U:"var(--colorStrokeFocus2)":null!==(W=oe.border)&&void 0!==W?W:"#000",null!=v&&v,null!=f&&f,null!=b&&b,{useFluentV9:X});return C.createElement(vt.u,{appearance:"subtle",htmlId:e,onClick:M,onHoverIn:D,accessibilityLabel:re,accessibilityRole:x,accessibilityPositionInSet:T,accessibilitySetSize:I,disableAccessibilityExpanded:w,onHeightChange:A,automationLabel:`Inline${n}Suggestion-${r}`,tooltipProps:{showBeak:null!==(_=null===(G=null==te?void 0:te.tooltip)||void 0===G?void 0:G.showBeak)&&void 0!==_?_:ee,gapSpace:null===(q=null==te?void 0:te.tooltip)||void 0===q?void 0:q.gapSpace,borderRadius:null===(V=null==te?void 0:te.tooltip)||void 0===V?void 0:V.borderRadius,calloutMaxWidth:null===(Z=null==te?void 0:te.tooltip)||void 0===Z?void 0:Z.calloutMaxWidth,paddingStart:null===(K=null==te?void 0:te.tooltip)||void 0===K?void 0:K.paddingStart,paddingEnd:null===(Y=null==te?void 0:te.tooltip)||void 0===Y?void 0:Y.paddingEnd,paddingTop:null===(Q=null==te?void 0:te.tooltip)||void 0===Q?void 0:Q.paddingTop,paddingBottom:null===($=null==te?void 0:te.tooltip)||void 0===$?void 0:$.paddingBottom,coverTarget:void 0===ie,directionHint:ie,layerHostId:m},title:a,titleStyle:be(E,a?a.length:0,!0,l),titleRootStyle:{lineHeight:20,truncate:!0},personaCoinProps:y,style:i?Object.assign(Object.assign({},i),{borderThickness:se?0:ne,boxShadow:(null!==(J=null==se?void 0:se.length)&&void 0!==J?J:0)>0?se:void 0}):void 0,subtitle:c,subtitleStyle:Ee(E,!0,u,d),theme:oe,hasKeyboardFocus:b,isSelectedByKeyboard:b&&f&&S,tooltip:B?"":p,icon:h?Object.assign(Object.assign({},h),{filled:!0}):void 0,iconShouldBeAccessible:!1,titleFormatting_DONOTUSE:s?L?_o(a,R,"title"):Go(s,a):void 0,subtitleFormatting:s?L?_o(c,R,"subTitle"):Go(s,c):void 0,disableTagAccessibility:!0,tagStyles:Pe(te,F),tagText:O?o.inlineSuggestions("newTagText"):void 0,topPanelScopeButton:N,showUnderline:j,disabled:H,updateItemHeight:P})},Vo=Object.freeze({Apps:"Apps"});function Zo(e){return e&&e in Vo?Vo[e]:e}const Ko=Object.freeze({doc:{iconType:"Word"},docx:{iconType:"Word"},dot:{iconType:"Word"},dotx:{iconType:"Word"},docm:{iconType:"Word"},docb:{iconType:"Word"},ppt:{iconType:"PowerPoint"},pptx:{iconType:"PowerPoint"},xls:{iconType:"Excel"},xlm:{iconType:"Excel"},xlsx:{iconType:"Excel"},xlsm:{iconType:"Excel"},xlsb:{iconType:"Excel"},xltx:{iconType:"Excel"},pdf:{iconType:"Pdf"},vsd:{iconType:"Visio"},vsdx:{iconType:"Visio"},loop:{iconType:"Loop"},fluid:{iconType:"Loop"},one:{iconType:"OneNoteNotebook"},wbk:{iconType:"Files"},dotm:{iconType:"Files"},xlb:{iconType:"Files"},xlc:{iconType:"Files"},xlt:{iconType:"Files"},xltm:{iconType:"Files"},xla:{iconType:"Files"},xll:{iconType:"Files"},xlam:{iconType:"Files"},xlw:{iconType:"Files"},odc:{iconType:"Files"},ods:{iconType:"Files"},pot:{iconType:"Files"},potx:{iconType:"Files"},potm:{iconType:"Files"},ppam:{iconType:"Files"},ppsx:{iconType:"Files"},ppsm:{iconType:"Files"},sldx:{iconType:"Files"},rtf:{iconType:"Files"},sldm:{iconType:"Files"},ppa:{iconType:"Files"},htm:{iconType:"Files"},html:{iconType:"Files"},odt:{iconType:"Files"},odp:{iconType:"Files"},csv:{iconType:"CsvFiles"},txt:{iconType:"TxtFiles"},folder:{iconType:"Folder"}});var Yo=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(i[o[r]]=e[o[r]])}return i};function Qo(e){return e.type===g.c.Event}function $o(e){return e.type===g.c.Message}function Jo(e){return e.type===g.c.File}function Xo(e){return e.type===g.c.People}function er(e){return e.type===g.c.Scope}function tr(e){return e.type===g.c.Chat}function ir(e){return e.type===g.c.CopilotPlugin}function or(e){return e.type===g.c.App}function rr(e){return Qo(e)?e.eventId:$o(e)?e.emailId:Jo(e)?e.fileName:Xo(e)?e.displayName:er(e)?e.id:tr(e)?e.name:ir(e)?e.previewCard.title:(or(e),e.title)}const nr=e=>e?e<20?16:e<24?20:e<28?24:e<32?28:e<36?32:e<40?36:e<48?40:e<56?48:e<64?56:e<72?64:e<96?72:e<120?96:e<128?120:128:20;const sr=C.memo((e=>{var t,i,{suggestion:o,theme:r,styles:n,newItemTagStyles:s,onItemHovered:a,onItemSelected:l,strings:c,enableExpandedECCScopeLayout:d,enableMeetingBanner:u,locale:g}=e,p=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(i[o[r]]=e[o[r]])}return i}(e,["suggestion","theme","styles","newItemTagStyles","onItemHovered","onItemSelected","strings","enableExpandedECCScopeLayout","enableMeetingBanner","locale"]);const h=C.useContext(ot.O),m=null!=r?r:Fo(void 0,h),y=C.useCallback((()=>{l(o)}),[o,l]),b=C.useCallback((()=>{null==a||a(o)}),[o,a]),f=((e,t,i,o,r,n,s)=>{var a,l,c,d,u,g,p,h,m,y,b,f,S,v,C;if(Jo(e)){const t=e.hitFileName||`${e.fileName}.${e.fileExtension}`,r=t.endsWith(`.${e.fileExtension}`),n=(null==i?void 0:i.fileItemStyles)||{},{iconStyles:s,titleFontSize:l,subtitleFontSize:c}=n,d=Yo(n,["iconStyles","titleFontSize","subtitleFontSize"]),u=function(e){var t,i;const o=e.toLocaleLowerCase();return null!==(i=null===(t=Ko[o])||void 0===t?void 0:t.iconType)&&void 0!==i?i:"UnknownFile"}(e.fileExtension),g="Files"===u,p=g?(null===(a=null==o?void 0:o.fallbackIcon)||void 0===a?void 0:a.background)||(null==s?void 0:s.backgroundColor):void 0,h=g&&!r?`.${e.fileExtension}`:"",m=g?6:void 0;return{suggestionId:e.itemId,suggestionType:e.type,title:t+h,titleFontSize:l,icon:{type:u,style:Object.assign(Object.assign({},s),{backgroundColor:p,padding:m,fontSize:16})||{backgroundColor:p}},style:d,subtitle:e.subject,subtitleFontSize:c,tooltip:t,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes}}if(Xo(e)){const t=(null==i?void 0:i.personItemStyles)||{},{personaCoinSize:r,titleFontSize:n,subtitleFontSize:s}=t,a=Yo(t,["personaCoinSize","titleFontSize","subtitleFontSize"]);return Object.assign(Object.assign({suggestionId:e.displayName,suggestionType:e.type,title:e.displayName,titleFontSize:n,personaCoinProps:{text:"",size:nr(r),imageUrl:e.imageUrl,initials:e.initials,borderColor:null==o?void 0:o.userAvatarBorderColor}},e.iconName&&{icon:{type:e.iconName}}),{style:a,subtitle:null!==(l=e.subtitleOverride)&&void 0!==l?l:e.primaryEmailAddress,subtitleFontSize:s,truncateSubtitle:!0,tooltip:e.primaryEmailAddress,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes})}if(er(e)){const t=(null==i?void 0:i.scopeItemStyles)||{},{iconStyles:o,titleFontSize:n,subtitleFontSize:s,personaCoinSize:a}=t,l=Yo(t,["iconStyles","titleFontSize","subtitleFontSize","personaCoinSize"]),d=Zo(e.iconName);return{suggestionId:e.id,suggestionType:e.type,title:e.title,titleFontSize:n,icon:void 0===d||r?void 0:{type:d,style:o||{}},personaCoinProps:!e.imageUrl&&!e.iconName||r?void 0:{text:"",size:nr(a),imageUrl:e.imageUrl,color:"neutral"},style:l,subtitle:e.subtitle,subtitleFontSize:s,tooltip:null!==(c=e.tooltip)&&void 0!==c?c:e.title,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes,displayNewItemTag:e.isNew,enableExpandedECCScopeLayout:r,isScopeSelected:e.isSelected}}if(Qo(e)){const{eventId:r,eventName:a,eventStartDateTime:l,eventEndDateTime:c,isAllDay:g,isSeries:p,hasRecording:h}=e,m=(null==i?void 0:i.eventItemStyles)||{},{iconStyles:y,titleFontSize:b,subtitleFontSize:f}=m,S=Yo(m,["iconStyles","titleFontSize","subtitleFontSize"]),v=function(e,t,i,o="en-US"){let r="";const n=Date.parse(e);if(!Number.isNaN(n)){const e=new Date(n),s=Date.parse(t);if(Number.isNaN(s))r=i?e.toLocaleString(o,{weekday:"short"})+" "+e.toLocaleDateString(o):e.toLocaleString(o,{weekday:"short"})+" "+e.toLocaleDateString(o)+" "+e.toLocaleTimeString(o,{hour:"numeric",minute:"2-digit"});else{const t=new Date(s);r=e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()?i?e.toLocaleString(o,{weekday:"short"})+" "+e.toLocaleDateString(o):e.toLocaleString(o,{weekday:"short"})+" "+e.toLocaleDateString(o)+" "+e.toLocaleTimeString(o,{hour:"numeric",minute:"2-digit"})+" - "+t.toLocaleTimeString(o,{hour:"numeric",minute:"2-digit"}):i?e.toLocaleDateString(o)+" - "+t.toLocaleDateString(o):e.toLocaleDateString(o)+" "+e.toLocaleTimeString(o,{hour:"numeric",minute:"2-digit"})+" - "+t.toLocaleDateString(o)+" "+t.toLocaleTimeString(o,{hour:"numeric",minute:"2-digit"})}}return r}(l,c,g,s),C=(null==t?void 0:t.inlineSuggestions("recordText"))||"",x=n&&h?v+" | "+C:v;return{suggestionId:r,suggestionType:e.type,title:a,titleFontSize:b,icon:{type:n&&h?"EventRecorded":p?"EventSeries":"Event",fontSize:p?16:14,style:Object.assign(Object.assign({},y),{backgroundColor:(null===(d=null==o?void 0:o.fallbackIcon)||void 0===d?void 0:d.background)||(null==y?void 0:y.backgroundColor)}),primaryColor:null===(u=null==o?void 0:o.fallbackIcon)||void 0===u?void 0:u.color},style:S,subtitle:x,subtitleFontSize:f,truncateSubtitle:!0,tooltip:a+" "+x,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes}}if($o(e)){const{subject:r,sender:n,emailId:s}=e,a=(null==i?void 0:i.emailItemStyles)||{},{iconStyles:l,titleFontSize:c,subtitleFontSize:d}=a,u=Yo(a,["iconStyles","titleFontSize","subtitleFontSize"]),y=null===(g=t.inlineSuggestions("emailSentBy"))||void 0===g?void 0:g.replace("{0}",n);return{suggestionId:s,suggestionType:e.type,title:r,titleFontSize:c,icon:{type:"Emails",fontSize:null!==(p=u.iconFontSize)&&void 0!==p?p:16,style:Object.assign(Object.assign({},l),{backgroundColor:(null===(h=null==o?void 0:o.fallbackIcon)||void 0===h?void 0:h.background)||(null==l?void 0:l.backgroundColor)}),primaryColor:null===(m=null==o?void 0:o.fallbackIcon)||void 0===m?void 0:m.color},style:u,subtitle:y,subtitleFontSize:d,truncateSubtitle:!0,tooltip:r,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes}}if(or(e)){const{title:t,imageUrl:i,collectorId:r,appType:n,subtitle:s,isMoreButton:a}=e;return{tooltip:t,suggestionId:r,suggestionType:e.type,title:t,appType:n,subtitle:s,icon:i?void 0:a?{type:"ExploreMoreCopilot",fontSize:32,style:{backgroundColor:null===(y=null==o?void 0:o.fallbackIcon)||void 0===y?void 0:y.background,height:32,width:32}}:{type:"ChatBubblesQuestion",fontSize:32,style:{backgroundColor:null===(b=null==o?void 0:o.fallbackIcon)||void 0===b?void 0:b.background,height:32,width:32}},personaCoinProps:i?{text:t,imageUrl:i,color:"neutral",size:32}:void 0,truncateSubtitle:!0,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes,disableAccessibilityExpanded:!0,style:{minWidth:260,maxWidth:260}}}if(tr(e)){const{name:t,chatMembers:r,threadId:n,lastMessageTime:s,imageUrl:a}=e,l=(null==i?void 0:i.chatItemStyles)||{},{iconStyles:c,titleFontSize:d,subtitleFontSize:u,personaCoinSize:g}=l,p=Yo(l,["iconStyles","titleFontSize","subtitleFontSize","personaCoinSize"]),h=2,m=r.length-h;let y=r.slice(0,h).map((e=>e.displayName)).join(", ");m>0&&(y+=`, +${m}`);const b=t||y,v=new Date(s),C=v.toLocaleTimeString(void 0,{hour:"numeric",minute:"numeric",hour12:!0}),x=`${v.toLocaleDateString("en-US")} ${C}`;return Object.assign({title:b,tooltip:b,subtitle:t?y:x,suggestionId:n,suggestionType:e.type,truncateSubtitle:!0,titleFontSize:d,subtitleFontSize:u,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes,style:p},a?{personaCoinProps:{text:b,imageUrl:a,size:nr(g),borderColor:null==o?void 0:o.userAvatarBorderColor}}:{icon:{type:"TeamsChat",style:Object.assign(Object.assign({},c),{backgroundColor:(null===(f=null==o?void 0:o.fallbackIcon)||void 0===f?void 0:f.background)||(null==c?void 0:c.backgroundColor)}),primaryColor:null===(S=null==o?void 0:o.fallbackIcon)||void 0===S?void 0:S.color}})}if(ir(e)){const t=(null==i?void 0:i.genericItemStyles)||{},{iconStyles:o,personaCoinSize:r,titleFontSize:n,subtitleFontSize:s}=t,a=Yo(t,["iconStyles","personaCoinSize","titleFontSize","subtitleFontSize"]),l=e.previewCard,c=null===(C=null===(v=l.images)||void 0===v?void 0:v[0])||void 0===C?void 0:C.url;return{suggestionId:l.title,suggestionType:e.type,title:l.title,titleFontSize:n,personaCoinProps:c?{text:"",size:nr(r),imageUrl:c,color:"neutral"}:void 0,style:a,subtitle:l.subtitle,subtitleFontSize:s,tooltip:l.title,displayNewItemTag:e.isNew,isHighlighted:e.isHighlighted,hitHighlightIndexes:e.hitHighlightIndexes}}const{id:x,title:k,subtitle:T,imageUrl:I,tooltip:w,type:A,isHighlighted:D}=e,E=(null==i?void 0:i.genericItemStyles)||{},{iconStyles:M,personaCoinSize:L,titleFontSize:R,subtitleFontSize:O}=E,F=Yo(E,["iconStyles","personaCoinSize","titleFontSize","subtitleFontSize"]),B=Zo(e.iconName);return{suggestionId:x,suggestionType:A,title:k,titleFontSize:R,icon:void 0!==B?{type:B,style:M}:void 0,personaCoinProps:I||B?{text:"",size:nr(L),imageUrl:I,color:"neutral"}:void 0,style:F,subtitle:T,subtitleFontSize:O,truncateSubtitle:!!w,tooltip:null!=w?w:k,isHighlighted:D,hitHighlightIndexes:e.hitHighlightIndexes,displayNewItemTag:e.isNew}})(o,c,n,m,d,u,g),S=o.type===xt&&(null===(t=null==n?void 0:n.noSuggestionsStyles)||void 0===t?void 0:t.item)?n.noSuggestionsStyles.item:f.style,v=`${f.suggestionId}-${p.queryString}`,k=C.createElement(qo,Object.assign({},p,f,{style:S,newItemTagStyles:s,strings:c,theme:r,onClick:y,onHoverIn:b,isDisabled:o.isDisabled,key:v}));if(o.noSuggestionsDescription){const e=o.type===xt?null===(i=null==n?void 0:n.noSuggestionsStyles)||void 0===i?void 0:i.description:void 0;return C.createElement(nt.S,{align:st.j5.Stretch,direction:st.PR.TopToBottom},C.createElement(nt.S,{style:null!=e?e:Ve},C.createElement(Lt.c,{text:o.noSuggestionsDescription,style:(I=zo(o,r),w=E,{fontWeight:x.IT.Normal,fontFamily:T.V,fontSize:w.small,cssColor:I,lineHeight:20})})),k)}var I,w;return k}));sr.displayName="InlineSuggestionsItem";const ar=C.memo((({group:e,htmlId:t,theme:i,style:o,styles:r,isScopableHeader:n,accessibilityPositionInSet:s,accessibilitySetSize:a,onClick:l,onGroupHovered:c,onHeightChange:d,onHeightExtraSpaceBottomChange:u,children:g,strings:p,displayNewItemTag:h,newItemTagStyles:m,hasSelectionBeenModifiedViaKeyboard:y})=>{var b,f,S,v,x,k;const T=C.useContext(ot.O),{title:I,subtitle:w,isScoped:A=!1,isHighlighted:D,addBottomBorder:M}=e,[L,R]=C.useState(!1),O=null!=i?i:Fo(void 0,T),F=null!=o?o:Be,B=Object.assign(Object.assign({},((e,t)=>{const i={backgroundColor:e.background.resting};return i})(O)),function(e){const t={};return e&&(t.borderWidth={top:0,end:0,start:0,bottom:1},t.borderStyle="solid"),t}(M)),N=C.useCallback((()=>{R(!0),null==c||c(e)}),[e,c]);if(u){let e=0;B.borderWidth&&(e="object"==typeof B.borderWidth?B.borderWidth.bottom?B.borderWidth.bottom:0:B.borderWidth),u(e)}if(n&&I){const e=null!==(b=null==r?void 0:r.titleLineHeight)&&void 0!==b?b:10,o=null!==(f=null==r?void 0:r.headerIconSize)&&void 0!==f?f:10;let c;c=(0,Ro.I)()?D?T?"CanvasText":"HighlightText":"CanvasText":(D||L)&&null!==(S=null==O?void 0:O.text.hover)&&void 0!==S?S:null==O?void 0:O.text.resting;const u={lineHeight:e+"px",display:"flex",width:A?"auto":"100%",flexDirection:A?"row-reverse":"row",justifyContent:"flex-end"},p={color:c,marginLeft:"4px",fontWeight:"600",flexGrow:A?0:1,fontSize:E.xsmall,display:"flex",alignItems:"center"},h=A?"Previous":"Next",m=Bo(O,D),{borderThickness:w,shadows:M}=Wo(r,T?(0,Ro.I)()?"Highlight":null!==(v=null==i?void 0:i.focusRing)&&void 0!==v?v:"var(--colorStrokeFocus2)":null!==(x=m.border)&&void 0!==x?x:"#000",!1,null!=y&&y,null!=D&&D,{useFluentV9:T}),F=n?"menuitem":"option",B=n&&A;return C.createElement(C.Fragment,null,C.createElement(vt.u,{appearance:"subtle",hasKeyboardFocus:D,htmlId:t,icon:{type:h},automationLabel:I,title:I,titleStyle:be(E,(null==I?void 0:I.length)||0,!0),theme:m,onClick:l,style:Object.assign(Object.assign({flexibleSize:!0,borderRadius:4},r),{borderThickness:M?0:w,boxShadow:(null!==(k=null==M?void 0:M.length)&&void 0!==k?k:0)>0?M:void 0}),onHeightChange:d,onHoverIn:N,onHoverOut:()=>R(!1),accessibilityRole:F,accessibilityPositionInSet:s,accessibilitySetSize:a,accessibilityState:B,useFullWidth:!0},C.createElement("span",{"data-is-focusable":!0,style:u},C.createElement("span",{style:p},I),C.createElement(Fi.In,{type:h,primaryColor:c,fontSize:o,style:{margin:(e-o)/2}}))),g)}const j=h?null==p?void 0:p.inlineSuggestions("combineTag").replace("{0}",null!=I?I:"").replace("{1}",null==p?void 0:p.inlineSuggestions("newTagText")):I;return C.createElement(Rt,{header:I,headerStyle:Object.assign(Object.assign(Object.assign({},Ge(O,F,E)),r),{userSelectable:!1}),subheader:w,subheaderStyle:Object.assign(Object.assign({},_e(O,F,E)),r),componentStackStyle:B,stackDirection:st.PR.TopToBottom,stackAlignment:st.j5.Stretch,accessibleLive:st.pq.Off,accessibleLabel:j,onHeaderHeightChange:d,tagStyles:Pe(O,m),tagText:h?null==p?void 0:p.inlineSuggestions("newTagText"):void 0},g)}));ar.displayName="InlineSuggestionsGroupHeader";const lr=C.memo((({theme:e,group:t,accessibilitySetSize:i,strings:o,headerHtmlId:r,isHeaderVisible:n,headerStyles:s,containerStyles:a,hasScopableHeader:l,headerAccessibilityPositionInSet:c,enablePrefixHighlighting:d,showSeparator:u,separatorProps:p,hasSelectionBeenModifiedViaKeyboard:h,showKeyboardTooltip:m,isInitialSelection:y,layerHostId:b,showPartialLoadingEntities:f,shimmerStyles:S,itemsStyles:v,newItemTagStyles:x,itemQueryString:k,onHeaderClick:T,onHeaderHeightChange:I,onSeparatorHeightChange:w,onHeightExtraSpaceBottomChange:A,onGroupHovered:D,onItemHovered:E,onItemSelected:M,onItemHeightChange:L,disableTooltips:R,enableExpandedECCScopeLayout:O,overflowIndex:F,showMeetingBanner:B,enableMeetingBanner:N,meetingBannerText:j,accessibilityRole:H="menuitem",isSmallWindow:P,updateItemHeight:z,locale:U})=>{var W,G,_,q;const V=t.suggestions;let Z=!1,K=!1;const Y=V.map(((t,r)=>{if(F&&F<=r)return;const n=c+(l?++r:r);return Z=Z||t.isNew&&t.type===g.c.Scope||!1,K=B&&t.type===g.c.Event||!1,C.createElement(cr,{styles:v,containerStyles:a,newItemTagStyles:x,strings:o,suggestion:t,key:`suggestion-item-${r}`,index:r,locale:U,htmlId:O?It(r,!0):t.type===xt?xt:It(n),theme:e,queryString:""!==k?k:void 0,accessibilityRole:H,accessibilityPositionInSet:n+1,accessibilitySetSize:i,truncateSubtitle:!0,onItemHovered:E,onItemSelected:M,onItemHeightChange:L,enablePrefixHighlighting:d,hasSelectionBeenModifiedViaKeyboard:h,showKeyboardTooltip:m&&!!t.isHighlighted,isInitialSelection:y,layerHostId:b,disableTooltips:R,enableExpandedECCScopeLayout:O,enableMeetingBanner:N,hasScopableHeader:l,updateItemHeight:z})})),Q=[];for(let e=0;e<(f||0);e++)Q.push(C.createElement(Mo,{style:S,key:`shimmer-skeleton-${e}`}));return C.createElement(C.Fragment,null,u&&C.createElement(ho.w,Object.assign({},p,{onHeightChange:w})),K&&C.createElement("div",{style:{display:"flex",width:"100%",height:P?"52px":"36px",alignItems:"center",gap:"12px",borderRadius:"6px",backgroundColor:`${null===(W=null==e?void 0:e.meetingBanner)||void 0===W?void 0:W.backgroundColor}`,padding:"6px 12px",border:`1px solid ${null===(G=null==e?void 0:e.meetingBanner)||void 0===G?void 0:G.borderColor}`,margin:"6px 0",boxSizing:"border-box"},"aria-label":j},C.createElement(Fi.In,{type:"Info",filled:!0,primaryColor:null===(_=null==e?void 0:e.meetingBanner)||void 0===_?void 0:_.iconPrimaryColor}),C.createElement("span",{style:{fontSize:"12px",fontStyle:"normal",fontWeight:400,lineHeight:"16px",padding:"1px 0px 3px 0px",color:`${null===(q=null==e?void 0:e.meetingBanner)||void 0===q?void 0:q.text}`}},j)),n?C.createElement(ar,{theme:e,styles:s,htmlId:r,group:t,isScopableHeader:l,accessibilityPositionInSet:c+1,accessibilitySetSize:i,onClick:T,onGroupHovered:D,onHeightChange:I,onHeightExtraSpaceBottomChange:A,strings:o,displayNewItemTag:Z,newItemTagStyles:x,hasSelectionBeenModifiedViaKeyboard:h},Y):Y,Q)}));lr.displayName="InlineSuggestionsGroup";const cr=e=>{var{index:t,hasScopableHeader:i,onItemHeightChange:o}=e,r=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(i[o[r]]=e[o[r]])}return i}(e,["index","hasScopableHeader","onItemHeightChange"]);const n=C.useCallback((e=>o(e,t-(i?1:0))),[t,i]);return C.createElement(sr,Object.assign({},r,{onHeightChange:n}))};const dr=C.memo((({theme:e,styles:t,strings:i,results:o,isShimmerVisible:r,enableScopedHeader:n,enablePrefixHighlighting:s,layerHostId:a,itemsCount:l,itemQueryString:c,isGroupHeaderVisible:d,hasSelectionBeenModifiedViaKeyboard:u,showKeyboardTooltip:g,isInitialSelection:p,disableTooltips:h,showMeetingBanner:m,enableMeetingBanner:y,meetingBannerText:b,isSmallWindow:f,suggestionsRef:S,locale:v,showPartialLoadingEntities:x,onGroupSelected:k,onGroupHovered:T,onItemHovered:I,onItemSelected:w,updateMenuLayout:A,updateItemHeight:D})=>{var E,M;const L=C.useContext(ot.O),R=C.useContext(ot.b),O=null!=e?e:Fo(void 0,L);let F=0;return r?C.createElement(Lo,{hideTitle:!d,style:null==t?void 0:t.shimmerStyles,inlineSuggestionsTheme:O}):C.createElement(nt.S,{ref:S,style:{marginEnd:null===(E=null==t?void 0:t.containerStyles)||void 0===E?void 0:E.marginEnd,height:null===(M=null==t?void 0:t.gptViewStyles)||void 0===M?void 0:M.height,backgroundColor:R?O.background.resting:"unset"},align:st.j5.Stretch},o.map(((e,o)=>{const r=e.suggestions,S=n&&!1!==e.isScopingEnabled&&void 0!==e.title,E=C.createElement(ur,{theme:O,styles:t,strings:i,key:`suggestion-group-${o}`,entryIndex:o,itemsCount:l,cumulativeCount:F,group:e,locale:v,layerHostId:a,accessibilitySetSize:l,headerHtmlId:It(F),headerStyles:null==t?void 0:t.headerStyles,containerStyles:null==t?void 0:t.containerStyles,headerAccessibilityPositionInSet:F,hasScopableHeader:S,enablePrefixHighlighting:s,onGroupSelected:k,onGroupHovered:T,itemsStyles:null==t?void 0:t.itemsStyles,itemQueryString:c,onItemHovered:I,onItemSelected:w,showSeparator:e.showSeparator,isHeaderVisible:d,separatorProps:e.showSeparator&&qe||void 0,hasSelectionBeenModifiedViaKeyboard:u,showKeyboardTooltip:g,isInitialSelection:p,disableTooltips:h||e.disableTooltips,showMeetingBanner:m&&0===o,enableMeetingBanner:y,meetingBannerText:b,isSmallWindow:f,updateMenuLayout:A,updateItemHeight:D,showPartialLoadingEntities:x,shimmerStyles:null==t?void 0:t.shimmerStyles});return S&&(F+=1),F+=r.length,E})))}));dr.displayName="InlineSuggestionsResultBody";const ur=e=>{var{styles:t,group:i,entryIndex:o,itemsCount:r,cumulativeCount:n,onGroupSelected:s,updateMenuLayout:a,updateItemHeight:l,showPartialLoadingEntities:c}=e,d=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(i[o[r]]=e[o[r]])}return i}(e,["styles","group","entryIndex","itemsCount","cumulativeCount","onGroupSelected","updateMenuLayout","updateItemHeight","showPartialLoadingEntities"]);const u=C.useCallback((()=>null==s?void 0:s(i)),[s,i]),g=C.useCallback((e=>a((t=>{t.groupLayouts[o]||(t.groupLayouts[o]={headerHeight:e,separatorHeight:0,extraSpaceBottomHeight:0,itemHeights:[]}),t.groupLayouts[o].headerHeight=e}))),[]),p=C.useCallback((e=>a((t=>{t.groupLayouts[o]||(t.groupLayouts[o]={headerHeight:e,separatorHeight:0,extraSpaceBottomHeight:e,itemHeights:[]}),t.groupLayouts[o].extraSpaceBottomHeight=e}))),[]),h=C.useCallback((e=>a((t=>{t.groupLayouts[o]||(t.groupLayouts[o]={headerHeight:0,separatorHeight:e,extraSpaceBottomHeight:0,itemHeights:[]}),t.groupLayouts[o].separatorHeight=e}))),[]),m=C.useCallback(((e,t)=>a((i=>{i.groupLayouts[o]||(i.groupLayouts[o]={headerHeight:0,separatorHeight:0,extraSpaceBottomHeight:0,itemHeights:[]}),i.groupLayouts[o].itemHeights[t]=e}))),[]);return C.createElement(lr,Object.assign({},d,{group:i,accessibilitySetSize:r,headerHtmlId:It(n),headerStyles:null==t?void 0:t.headerStyles,newItemTagStyles:null==t?void 0:t.newItemTagStyles,containerStyles:null==t?void 0:t.containerStyles,headerAccessibilityPositionInSet:n,onHeaderClick:u,onHeaderHeightChange:g,onHeightExtraSpaceBottomChange:p,onSeparatorHeightChange:h,itemsStyles:null==t?void 0:t.itemsStyles,onItemHeightChange:m,updateItemHeight:l,showPartialLoadingEntities:c}))},gr=(e={},t)=>{var i,o;return Object.assign({minWidth:240,maxWidth:null!==(i=null==t?void 0:t.menuMaxWidth)&&void 0!==i?i:240,maxHeight:null!==(o=null==t?void 0:t.menuHeight)&&void 0!==o?o:252,borderRadius:8,paddingTop:4,paddingBottom:4,paddingHorizontal:4},e)},pr=(e={})=>{var t,i,o,r,n,s,a;const l=null===(t=null==e?void 0:e.itemsStyles)||void 0===t?void 0:t.genericItemStyles;return Object.assign({itemPaddingVertical:null!==(i=null==l?void 0:l.paddingVertical)&&void 0!==i?i:6,itemPaddingHorizontal:null!==(o=null==l?void 0:l.paddingHorizontal)&&void 0!==o?o:12,textPaddingLeft:null!==(r=null==l?void 0:l.textPaddingStart)&&void 0!==r?r:8,personaCoinSize:null!==(n=null==l?void 0:l.personaCoinSize)&&void 0!==n?n:24,titleLineHeight:null!==(a=null===(s=null==e?void 0:e.headerStyles)||void 0===s?void 0:s.titleLineHeight)&&void 0!==a?a:16},e.shimmerStyles)},hr=(e={})=>Object.assign({},e),mr=(e={},t={},i={})=>({item:Object.assign(Object.assign(Object.assign(Object.assign({},br(i)),Ke),t),e.item),description:Object.assign(Object.assign(Object.assign(Object.assign({},br(i)),Ze),t),e.description)}),yr=(e={},t)=>({genericItemStyles:Sr(e.genericItemStyles,e.sharedItemStyles,t),personItemStyles:vr(e.personItemStyles,e.sharedItemStyles,t),fileItemStyles:Cr(e.fileItemStyles,e.sharedItemStyles,t),scopeItemStyles:xr(e.scopeItemStyles,e.sharedItemStyles,t),eventItemStyles:kr(e.eventItemStyles,e.sharedItemStyles,t),emailItemStyles:Tr(e.emailItemStyles,e.sharedItemStyles,t),chatItemStyles:wr(e.chatItemStyles,e.sharedItemStyles,t),appGptItemStyles:Ir(e.appGptItemStyles,e.sharedItemStyles,t),noSuggestionsStyles:mr(e.noSuggestionsStyles,e.sharedItemStyles,t)}),br=e=>{var t,i;return Object.assign(Object.assign({},Ne),{borderRadius:null!==(t=null==e?void 0:e.itemBorderRadius)&&void 0!==t?t:Ne.borderRadius,height:null!==(i=null==e?void 0:e.itemHeight)&&void 0!==i?i:Ne.height})},fr=e=>Object.assign(Object.assign({},He),(null==e?void 0:e.itemIconSize)?{width:e.itemIconSize,height:e.itemIconSize,minWidth:e.itemIconSize}:{}),Sr=(e={},t={},i)=>{var o;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},br(i)),{personaCoinSize:null!==(o=null==i?void 0:i.itemIconSize)&&void 0!==o?o:24}),t),e),{iconStyles:Object.assign(Object.assign({},fr(i)),null==e?void 0:e.iconStyles)})},vr=(e={},t={},i)=>{var o;return Object.assign(Object.assign(Object.assign(Object.assign({},br(i)),{personaCoinSize:null!==(o=null==i?void 0:i.itemIconSize)&&void 0!==o?o:24}),t),e)},Cr=(e={},t={},i)=>Object.assign(Object.assign(Object.assign(Object.assign({},br(i)),t),e),{iconStyles:Object.assign(Object.assign({},fr(i)),null==e?void 0:e.iconStyles)}),xr=(e={},t={},i)=>{var o;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},br(i)),{personaCoinSize:null!==(o=null==i?void 0:i.itemIconSize)&&void 0!==o?o:24}),t),e),{iconStyles:Object.assign(Object.assign({},fr(i)),null==e?void 0:e.iconStyles)})},kr=(e={},t={},i)=>{var o;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},br(i)),{personaCoinSize:null!==(o=null==i?void 0:i.itemIconSize)&&void 0!==o?o:24}),t),e),{iconStyles:Object.assign(Object.assign({},fr(i)),null==e?void 0:e.iconStyles)})},Tr=(e={},t={},i)=>{var o;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},br(i)),{personaCoinSize:null!==(o=null==i?void 0:i.itemIconSize)&&void 0!==o?o:24}),t),e),{iconStyles:Object.assign(Object.assign({},fr(i)),null==e?void 0:e.iconStyles)})},Ir=(e={},t={},i)=>{var o;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},br(i)),{personaCoinSize:null!==(o=null==i?void 0:i.itemIconSize)&&void 0!==o?o:24}),t),e),{iconStyles:Object.assign(Object.assign({},fr(i)),null==e?void 0:e.iconStyles)})},wr=(e={},t={},i)=>{var o;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},br(i)),{personaCoinSize:null!==(o=null==i?void 0:i.itemIconSize)&&void 0!==o?o:24}),t),e),{iconStyles:Object.assign({width:24,height:24,borderRadius:20},null==e?void 0:e.iconStyles)})},Ar=(e={})=>Object.assign(Object.assign(Object.assign({},O),{height:45,paddingTop:6,paddingBottom:4,paddingHorizontal:6,marginTop:-4,marginHorizontal:-4,marginBottom:4,transform:"translateY(4px)"}),e);var Dr=i(98840),Er=i(40299),Mr=i(35146);const Lr=({htmlId:e,theme:t,styles:i,accessibilityLabel:o,accessibilitySetSize:r,accessibilityPositionInSet:n,placeholder:s,disabled:a,handledKeys:l,spellCheck:c,value:d,hideDismiss:u,autoFocus:g,isSearchBoxHighlighted:p,onValueChange:h,onKeyDown:m,onClear:y})=>{var b,f,S;const v={};Dr.tO({onKeyDown:m,handledKeys:l},v);const x=C.useContext(at.q),k=(0,Er.Zq)({"& input":{color:null==t?void 0:t.textColor,"::placeholder":{color:null==t?void 0:t.placeholderTextColor}}}),T=(0,Er.Zq)({backgroundColor:null===(b=null==t?void 0:t.clearButton)||void 0===b?void 0:b.resting,":hover":{backgroundColor:null===(f=null==t?void 0:t.clearButton)||void 0===f?void 0:f.hover}}),I=C.useRef(null);return C.useEffect((()=>{var e;p&&(null===(e=I.current)||void 0===e||e.focus())}),[p]),C.useEffect((()=>{var e;g&&(null===(e=I.current)||void 0===e||e.focus())}),[]),C.createElement(Mr.G,{ref:I,className:k,style:{background:null==t?void 0:t.background,borderColor:null===(S=null==t?void 0:t.borderColor)||void 0===S?void 0:S.resting,borderRadius:null==i?void 0:i.borderRadius,borderBottom:null==i?void 0:i.borderBottom,width:null==i?void 0:i.width,marginTop:null==i?void 0:i.marginTop,marginBottom:null==i?void 0:i.marginBottom,marginLeft:x?null==i?void 0:i.marginEnd:null==i?void 0:i.marginStart,marginRight:x?null==i?void 0:i.marginStart:null==i?void 0:i.marginEnd},autoComplete:"off",placeholder:s,onChange:(e,t)=>null==h?void 0:h(t.value),id:e,"aria-label":o,"aria-posinset":n,"aria-setsize":r,disabled:a,defaultValue:d,onKeyDown:v.onKeyDown,dismiss:u?null:C.createElement(Ut.BEt,{color:null==t?void 0:t.textColor,className:T,onClick:y}),spellCheck:c,contentBefore:C.createElement(Wt.vMY,{color:null==t?void 0:t.iconColor})})};const Rr=C.memo((e=>{var t,i,o,r,n,s,a,l,c,d,u,g,p,h,{style:m,theme:y}=e,b=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(i[o[r]]=e[o[r]])}return i}(e,["style","theme"]);return C.createElement(C.Fragment,null,C.createElement(nt.S,{style:{marginBottom:null!==(t=null==m?void 0:m.marginBottom)&&void 0!==t?t:8,marginTop:null!==(i=null==m?void 0:m.marginTop)&&void 0!==i?i:8,marginStart:null!==(o=null==m?void 0:m.marginStart)&&void 0!==o?o:0,marginEnd:null!==(r=null==m?void 0:m.marginEnd)&&void 0!==r?r:12,width:"100%",minWidth:0}},C.createElement(Lr,Object.assign({},b,{autoComplete:!1,spellCheck:!1,accessibilityLabel:"InlineSuggestionsSearchBox",styles:{borderRadius:4,width:"100%",borderBottom:`${null===(n=null==y?void 0:y.searchBox)||void 0===n?void 0:n.borderBottomColor} solid 1px`},theme:{background:null==y?void 0:y.background.resting,textColor:null===(s=null==y?void 0:y.text)||void 0===s?void 0:s.resting,placeholderTextColor:null===(a=null==y?void 0:y.text)||void 0===a?void 0:a.disabled,clearButton:{hover:null===(l=null==y?void 0:y.background)||void 0===l?void 0:l.hover,resting:null===(c=null==y?void 0:y.background)||void 0===c?void 0:c.resting},iconColor:null===(d=null==y?void 0:y.searchBox)||void 0===d?void 0:d.iconColor,borderColor:{hover:null===(g=null===(u=null==y?void 0:y.searchBox)||void 0===u?void 0:u.borderColor)||void 0===g?void 0:g.hover,resting:null===(h=null===(p=null==y?void 0:y.searchBox)||void 0===p?void 0:p.borderColor)||void 0===h?void 0:h.resting}}}))))}));Rr.displayName="InlineSuggestionsSearchBox";const Or=C.memo((e=>{var{strings:t,theme:i,browseThisComputerButtonLabel:o,isBrowseThisComputerEnabled:r,onClickBrowseThisComputer:n,hasSelectionBeenModifiedViaKeyboard:s}=e,a=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(i[o[r]]=e[o[r]])}return i}(e,["strings","theme","browseThisComputerButtonLabel","isBrowseThisComputerEnabled","onClickBrowseThisComputer","hasSelectionBeenModifiedViaKeyboard"]);return C.createElement(nt.S,{direction:st.PR.LeftToRight,align:st.j5.Stretch},C.createElement(vt.u,Object.assign({},a,{style:je,accessibilityRole:"option",automationLabel:"InlineSuggestionsBrowseThisComputer",title:o,icon:{type:"Laptop",style:ze},onClick:n,hasKeyboardFocus:r,theme:i,isSelectedByKeyboard:r&&s})))}));Or.displayName="InlineSuggestionsBrowseThisComputer";const Fr=e=>C.createElement(nt.S,{direction:st.PR.LeftToRight,style:F},C.createElement(Fi.In,{type:"ForwardSlashPromo",style:B}),C.createElement(Lt.c,{text:e.strings.inlineSuggestions("discoveryPromoFooterText"),style:N}));var Br=function(e,t){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(i[o[r]]=e[o[r]])}return i};const Nr=({definition:e,theme:t,style:i,styles:o,strings:r,layerHostId:n,queryString:a,results:l,isError:c,isLoading:d,menuType:u,enableScopedHeader:p,enablePrefixHighlighting:h,enableStickyFooter:m,keyboardHandlerTarget:y,showMoreEntitiesConfig:b,browseThisComputerConfig:f,showDiscoveryPromoFooter:S,listID:v,noSuggestionsHeaderInfo:x,disableTooltips:k,moveSelectionOnHover:T,locale:I,showMeetingBanner:A,enableMeetingBanner:D,meetingBannerText:E,isUnsupported:M,showPartialLoadingEntities:L,onGroupSelected:R,onAction:O,onItemSelected:F,onFocus:B,onFooterAction:N,onAfterUpdate:j,appGptConfig:H})=>{var P,z,U;const W=C.useContext(ot.O),G=l.every((e=>{var t;return!(null===(t=e.suggestions)||void 0===t?void 0:t.length)||e.alwaysDisplay})),[_,q]=C.useState({type:"item",groupIndex:0,itemIndex:0}),V=C.useCallback((e=>{var t;e.type===xt?e.id===kt?null==O||O(s.Retry):e.id===Tt&&(ye(""),null==O||O(s.ClearSearch)):e.type===g.c.App&&void 0===e.AppType?null===(t=null==H?void 0:H.onClickExploreMoreCopilots)||void 0===t||t.call(H):F(e)}),[O,F]),Z=null!=i?i:Be,K=C.useMemo((()=>((e={},t)=>Object.assign(Object.assign({},e),{containerStyles:gr(e.containerStyles,t),shimmerStyles:pr(e),headerStyles:hr(e.headerStyles),itemsStyles:yr(e.itemsStyles,t),footerStyles:Ar(e.footerStyles)}))(o,Z)),[o,Z]),Y={RenderFooterIcons:"true"},Q=C.useRef(null),$=C.createRef(),J=C.useRef({groupLayouts:[]}),[X,ee]=C.useState(0),[te,ie]=C.useState(!1),[oe,re]=C.useState(void 0),[ne,se]=C.useState([]),ae=C.useCallback((e=>{se(e)}),[se]),[le,ce]=C.useState(!1),[de,ue]=C.useState(),[ge,pe]=C.useState(!1),[he,ye]=C.useState(""),[be,fe]=C.useState(!1),[Se,ve]=C.useState(!1),[Ce,xe]=C.useState(!1),[ke,Te]=C.useState(!0),Ie=C.useRef(null),{baseInlineSuggestionsGroups:we,isScopedHeaderEnabled:Ae,itemsCount:De,itemsAndGroupHeadingCount:Ee,isGptMenu:Me}=C.useMemo((()=>{var e,t;let i=!1;if(null==H?void 0:H.enableAppGpt){l[0]||(l[0]={suggestions:[]}),i=null===(e=l[0].suggestions)||void 0===e?void 0:e.every((e=>e.type===g.c.App));const o=null===(t=l[0].suggestions)||void 0===t?void 0:t.some((e=>e.isMoreButton));if((null==H?void 0:H.onClickExploreMoreCopilots)&&i&&!o){const e={type:g.c.App,title:(null==H?void 0:H.moreCopilotsStringOverride)||"Get Copilot extensions",isMoreButton:!0};l[0].suggestions.push(e)}}const o=((e=!1,t,i,o,r,n,s)=>{if(e&&i)return[];const a=At(r);if(t)return[Object.assign(Object.assign({},n),{disableTooltips:!0,suggestions:[{id:kt,type:xt,title:o.inlineSuggestions("tryAgainLabel"),noSuggestionsDescription:o.inlineSuggestions("somethingWentWrongLabel")}]}),...a.filter((e=>e.alwaysDisplay))];if(i||s){const e=i?"clearSearchLabel":"showAvailableSuggestionsLabel";return[Object.assign(Object.assign({},n),{disableTooltips:!0,suggestions:[{id:Tt,type:xt,title:o.inlineSuggestions(e),noSuggestionsDescription:o.common("suggestionsGroupNoSuggestionsText")}]}),...a.filter((e=>e.alwaysDisplay))]}return a})(d,c,G,r,l,x,M),n=o.filter((e=>!1!==e.isScopingEnabled&&!!e.title)).length,s=p&&!ge&&n>0&&!i,a=o.reduce(((e,t)=>t.suggestions.length+e),0);return{baseInlineSuggestionsGroups:o,isScopedHeaderEnabled:s,itemsCount:a,itemsAndGroupHeadingCount:s?a+n:a,isGptMenu:i}}),[d,c,G,r,l,x]),Le=C.useRef(),Re=C.useMemo((()=>void 0===_?we:"group"===_.type?we.map(((e,t)=>t===_.groupIndex?Object.assign(Object.assign({},e),{isHighlighted:!0}):e)):we.map(((e,t)=>t===_.groupIndex?Object.assign(Object.assign({},e),{suggestions:e.suggestions.map(((e,t)=>t===_.itemIndex?Object.assign(Object.assign({},e),{isHighlighted:!0}):e))}):e))),[_,we]),Oe=!!(Fe=u)&&("InlineSuggestionsResultsUserInitiatedMenuType"===Fe.menuType?void 0!==Fe.brandingMode:"InlineSuggestionsResultsFlagMenuType"===Fe.menuType);var Fe;const Ne=u&&"brandingMode"in u&&void 0!==u.brandingMode?u.brandingMode:void 0,je=u&&"flag"in u?u.critiquePosition:void 0,He=u&&"flag"in u?u.critiqueSetSize:void 0,Pe=null!=t?t:Fo(Ne,W);C.useEffect((()=>{ue({top:0,bottom:0,isNewRender:!0})}),[a]),C.useEffect((()=>{if(d)return;let e=Ae&&we.length>0&&we[0].title?1:0;ge&&(null==f?void 0:f.isBrowseThisComputerEnabled)&&(e=-1,ue({top:0,bottom:0,isNewRender:!0}),ie(!0)),qe(e,1===e),ee(e)}),[d,ge,we]);const ze=we.length;C.useEffect((()=>{Q.current&&(clearTimeout(Q.current),Q.current=null),d?ze?Q.current=setTimeout((()=>ce(!0)),2e3):ce(!0):ce(!1)}),[d,ze]),C.useEffect((()=>{j&&e&&j(e)}));const Ge=C.useCallback((e=>{e(J.current)}),[]),_e=C.useCallback(((e,t)=>{t.type===xt?t.id===kt?null==B||B({focusedItemHtmlId:xt,selection:{type:"retryButton"}}):t.id===Tt&&(null==B||B({focusedItemHtmlId:xt,selection:{type:"clearSearchButton"}})):null==B||B({focusedItemHtmlId:It(e),selection:{type:"item",item:t,positionInSet:e,setSize:Ee}})}),[Ee,B]),qe=C.useCallback(((e,t)=>{var i,o,r,n,s;if(void 0===e)return q(void 0),-1;e%=Ee;let a=0;const l={top:0,bottom:0};for(let c=0;c<we.length;c++){const d=we[c];if(l.top=l.bottom+(null===(i=J.current.groupLayouts[c])||void 0===i?void 0:i.separatorHeight),l.bottom=l.top+(null===(o=J.current.groupLayouts[c])||void 0===o?void 0:o.headerHeight),Ae&&!1!==d.isScopingEnabled&&d.title){if(e===a)return ue(Object.assign(Object.assign({},l),{isNewRender:!!t})),null==B||B({focusedItemHtmlId:It(e),selection:{type:"group",group:d,positionInSet:e,setSize:Ee}}),c<we.length&&q({type:"group",groupIndex:c}),e;a++}for(let i=0;i<d.suggestions.length;i++){const o=d.suggestions[i];if(0!==i&&(l.top=l.bottom),l.bottom=l.bottom+(null!==(n=null===(r=J.current.groupLayouts[c])||void 0===r?void 0:r.itemHeights[i])&&void 0!==n?n:0),i===d.suggestions.length-1&&(l.bottom+=null===(s=J.current.groupLayouts[c])||void 0===s?void 0:s.extraSpaceBottomHeight),e===a)return ue(Object.assign(Object.assign({},l),{isNewRender:!!t})),_e(e,o),c<we.length&&i<we[c].suggestions.length&&q({type:"item",groupIndex:c,itemIndex:i}),e;a++}}return e}),[we]),Ve=C.useCallback((e=>{re(e),null==B||B({focusedItemHtmlId:Do(ne[e]),selection:{type:"action",action:ne[e],positionInSet:e,setSize:ne.length}})}),[ne,B,re]),Ze=C.useRef(!0),Ke=C.useCallback((e=>{T?(Te(!1),ee(qe(e))):Ze.current&&(ee(e),qe(void 0))}),[T,we,qe]),Ye=C.useCallback((e=>{const t=rr(e);if(!t)return;const i=(()=>{let i=0;for(const o of we){Ae&&!1!==o.isScopingEnabled&&o.title&&i++;for(const r of o.suggestions){if(r.type===e.type&&rr(r)===t)return i;i++}}return i})();Ke(i)}),[Ke]),$e=C.useCallback((e=>{const t=(()=>{let t=0;for(const i of we){if(Ae&&!1!==i.isScopingEnabled&&i.title){if(e.title===i.title&&e.subtitle===i.subtitle)return t;t++}t+=i.suggestions.length}return t})();Ke(t)}),[Ke]);var Xe;Xe=()=>{Ze.current=!0},C.useEffect((()=>(window.addEventListener("mousemove",Xe,{capture:!0,passive:!0}),()=>window.removeEventListener("mousemove",Xe,{capture:!0}))),[]);const et=e=>{var t;switch(e){case rt.h.ArrowDown:void 0===oe?(Ve(0),q(void 0),ue({top:1e4,bottom:1e4,isNewRender:!1})):oe<ne.length-1?(Ve(oe+1),ue({top:1e4,bottom:1e4,isNewRender:!1})):ge&&(null==f?void 0:f.isBrowseThisComputerEnabled)?lt(e):(ee(qe(0)),re(void 0));break;case rt.h.ArrowUp:0===oe?(re(void 0),(null==b?void 0:b.isShowMoreEntitiesEnabled)&&!ge?(q(void 0),fe(!0),ue({top:1e4,bottom:1e4,isNewRender:!1})):ee(qe(Ee-1))):void 0!==oe&&oe>0?(Ve(oe-1),ue({top:1e4,bottom:1e4,isNewRender:!1})):(qe(void 0,!1),Ve(ne.length-1),ue({top:1e4,bottom:1e4,isNewRender:!1}));break;case rt.h.Enter:case rt.h.Tab:if(void 0===oe)break;ne[oe]===Je.Overflow?null===(t=$.current)||void 0===t||t.openOverflowMenu(!0):null==N||N(ne[oe])}},it=()=>{var e;Le.current=Re[0],pe(!0),fe(!1),null===(e=null==b?void 0:b.onClickShowMoreEntities)||void 0===e||e.call(b,!0),ee(void 0)},at=e=>{switch(e){case rt.h.ArrowDown:be?ne.length>0?(fe(!1),re(0)):(fe(!1),ee(qe(0))):(qe(X,!1),fe(!0),ue({top:1e4,bottom:1e4,isNewRender:!1}));break;case rt.h.ArrowUp:be?(fe(!1),ee(qe(Ee-1))):(qe(X,!1),re(void 0),fe(!0),ue({top:1e4,bottom:1e4,isNewRender:!1}));break;case rt.h.Enter:case rt.h.Tab:it()}},lt=e=>{var t;const i=De-1===X;switch(e){case rt.h.ArrowDown:if(Oe&&oe===ne.length-1)re(void 0),ee(qe(void 0)),ie(!0);else{const e=!Oe&&i&&!te;ie(e),ee(e?void 0:qe((null!=X?X:-1)+1))}break;case rt.h.ArrowUp:te?(ie(!1),Oe&&void 0===oe?et(e):ee(qe(Ee-1))):(qe(X,!1),ee(void 0),ie(!0));break;case rt.h.Enter:case rt.h.Tab:null===(t=null==f?void 0:f.onClickBrowseThisComputer)||void 0===t||t.call(f)}},ct=e=>{if(e!==rt.h.ArrowDown&&e!==rt.h.ArrowUp&&e!==rt.h.Enter&&e!==rt.h.Tab&&e!==rt.h.Home&&e!==rt.h.End)return!1;switch(e){case rt.h.ArrowDown:if(ve(!0),xe(!1),Te(!1),Ze.current=!1,void 0!==oe||X===Ee-1||be)!(null==b?void 0:b.isShowMoreEntitiesEnabled)||ge||void 0!==oe&&!be?ne.length>0?et(e):(null==f?void 0:f.isBrowseThisComputerEnabled)&&!Me?lt(e):ee(qe(0)):at(e);else if(!(null==f?void 0:f.isBrowseThisComputerEnabled)||Me){const e=qe((null!=X?X:-1)+1);ee(e)}else lt(e);break;case rt.h.ArrowUp:ve(!0),xe(!1),Te(!1),Ze.current=!1,te&&ge?lt(e):0===X&&ge?(null==f?void 0:f.isBrowseThisComputerEnabled)?lt(e):Oe?et(e):ee(qe(Ee-1)):void 0!==oe||0===X||be?(0===X||void 0!==oe)&&ne.length>0&&!be?et(e):be||0===X&&(null==b?void 0:b.isShowMoreEntitiesEnabled)&&!ge&&(0===oe||void 0===oe)?at(e):ee(qe(Ee-1)):ee(qe((null!=X?X:-1)-1));break;case rt.h.Home:ve(!0),xe(!1),Te(!1),ee(qe(0)),Ze.current=!1;break;case rt.h.End:ve(!0),xe(!1),Te(!1),ee(qe(Ee-1)),Ze.current=!1;break;case rt.h.Enter:case rt.h.Tab:{if(be){at(e);break}if(void 0!==oe){et(e);break}if(te){lt(e);break}let t=0;we.forEach((e=>{Ae&&!1!==e.isScopingEnabled&&e.title&&(X===t&&(null==R||R(e)),t++),void 0!==X&&X>=t&&X<t+e.suggestions.length&&V(e.suggestions[X-t]),t+=e.suggestions.length}));break}default:return!1}return!0},dt=e=>{y||ct(e.key)};C.useEffect((()=>(null==y||y.setKeyPressHandler(ct),()=>{null==y||y.setKeyPressHandler(void 0)})));const gt=C.useRef(),pt=()=>{gt.current&&clearTimeout(gt.current),gt.current=setTimeout((()=>{clearTimeout(gt.current),gt.current=void 0,xe(!0)}),50)};C.useEffect(pt,[de]);const ht=K.containerStyles||{},{paddingStart:mt,paddingEnd:yt,paddingHorizontal:bt,paddingTop:St,paddingBottom:Dt,paddingVertical:Et,paddingScrollTop:Mt,scrollbarThumbWidth:Lt,scrollbarPaddingBottom:Rt}=ht,Ot=Br(ht,["paddingStart","paddingEnd","paddingHorizontal","paddingTop","paddingBottom","paddingVertical","paddingScrollTop","scrollbarThumbWidth","scrollbarPaddingBottom"]),[Ft,Bt]=C.useState(null!==(z=null===(P=K.gptViewStyles)||void 0===P?void 0:P.defaultContainerHeight)&&void 0!==z?z:250),{maxHeight:Nt}=Ot,jt=Br(Ot,["maxHeight"]),Ht=(null==H?void 0:H.enableAppGpt)&&Me?Object.assign(Object.assign({},jt),{minWidth:260,maxWidth:260,maxHeight:Ft,height:Ft}):Ot,Pt=null!=mt?mt:bt,zt=null!=yt?yt:bt,Ut=S&&u&&"flag"in u&&u.flag===tt.File,Wt=()=>C.createElement(Fr,{strings:{inlineSuggestions:r.inlineSuggestions}}),Gt=()=>{var e,t;return!Oe||(null==H?void 0:H.enableAppGpt)?C.createElement(C.Fragment,null):C.createElement(Eo,{ref:$,theme:Uo(Pe),definition:{critiqueType:Qe.InlineSuggestion,flagType:u&&"flag"in u?u.flag:void 0,brandingMode:Ne,onlyShowFeedbackButton:m,actions:wt(u),critiquePosition:je,critiqueSetSize:He},layerHostId:n,strings:r,settings:Y,onAction:N,overflowMenuCalloutStyle:null===(e=null==K?void 0:K.footerStyles)||void 0===e?void 0:e.overflowMenuCalloutStyles,footerContainerStyle:K.footerStyles,footerButtonStyle:K.footerStyles.buttonStyles,overflowMenuButtonStyle:null!==(t=K.footerStyles.buttonStyles)&&void 0!==t?t:K.footerStyles.overFlowButtonStyles,setFooterActionIdList:ae,selectedButtonIndex:oe,showPreviewTooltipForBranding:!0})},_t=(null==b?void 0:b.isShowMoreEntitiesEnabled)&&!ge&&!(c||G||M);return C.createElement(nt.S,{style:Object.assign(Object.assign(Object.assign({},me(Pe,void 0,{useFluentV9:W})),Ht),{hideFocusBox:!0}),align:st.j5.Stretch,focusable:!0,onKeyDown:dt,handledKeys:[rt.h.ArrowDown,rt.h.ArrowUp,rt.h.Enter,rt.h.Tab,rt.h.Home,rt.h.End],accessibilityRole:le||c||G||M?void 0:"group",accessible:!0,accessibilityLabel:r.inlineSuggestions("suggestionsGroupSearchResultAccessibilityLabel"),nativeID:v},C.createElement(ut,{scrollDirection:"vertical",style:{paddingStart:Pt,paddingEnd:zt,paddingTop:St,paddingBottom:Dt,paddingVertical:Et,paddingScrollTop:Mt,scrollbarThumbWidth:Lt,scrollbarPaddingBottom:Rt,borderRadius:Ot.borderRadius},theme:{thumbColor:null===(U=null==Pe?void 0:Pe.scroll)||void 0===U?void 0:U.thumbColor},onScroll:pt,onScrollStatusChange:e=>{e&&Te(!1)},scrollTo:de,hidden:le,alwaysShowScrollbar:(null==H?void 0:H.enableAppGpt)&&Me},C.createElement(ft,{disableInitialFocus:!0},C.createElement(nt.S,{align:st.j5.Stretch,accessible:!0,accessibilityRole:"menu",accessibilityLabel:r.inlineSuggestions("suggestionsGroupSearchResultAccessibilityLabel")},ge&&C.createElement(C.Fragment,null,(null==b?void 0:b.displayGroupHeaderDuringSearch)&&Le.current?C.createElement(ar,{theme:Pe,styles:null==K?void 0:K.headerStyles,group:Le.current,isScopableHeader:!1,onHeightChange:e=>{J.current.groupLayouts[0]||(J.current.groupLayouts[0]={headerHeight:e,separatorHeight:0,extraSpaceBottomHeight:0,itemHeights:[]}),J.current.groupLayouts[0].headerHeight=e},onHeightExtraSpaceBottomChange:e=>{J.current.groupLayouts[0]||(J.current.groupLayouts[0]={headerHeight:e,separatorHeight:0,extraSpaceBottomHeight:e,itemHeights:[]}),J.current.groupLayouts[0].extraSpaceBottomHeight=e},strings:r,displayNewItemTag:!1}):void 0,C.createElement(nt.S,{direction:st.PR.LeftToRight},!0!==(null==b?void 0:b.shouldOnlyShowSearchBox)?C.createElement("span",{style:{flexGrow:0,flexShrink:0}},C.createElement(vt.u,{appearance:"subtle",style:We,automationLabel:"InlineSuggestionBackButton",onClick:()=>{var e;pe(!1),null===(e=null==b?void 0:b.onCloseShowMoreEntities)||void 0===e||e.call(b,!1),ee(0)},theme:Ho(Pe),icon:{type:"Previous",style:Ue}})):void 0,C.createElement(Rr,{theme:Pe,style:null==K?void 0:K.searchBoxStyles,htmlId:null==b?void 0:b.searchBoxHtmlId,autoFocus:!0,handledKeys:[rt.h.ArrowDown,rt.h.ArrowUp,rt.h.Enter,rt.h.Tab,rt.h.Home,rt.h.End],onKeyDown:e=>{ct(e.key)},placeholder:(null==b?void 0:b.searchBoxPlaceHolder)||"",value:he,onValueChange:e=>{var t;ye(e),null===(t=null==b?void 0:b.onSearchChange)||void 0===t||t.call(b,e)},onClear:()=>{var e;ye(""),null===(e=null==b?void 0:b.onSearchClear)||void 0===e||e.call(b)}}))),(null==f?void 0:f.isBrowseThisComputerEnabled)&&ge&&C.createElement(Or,{handledKeys:[rt.h.ArrowDown,rt.h.ArrowUp,rt.h.Enter,rt.h.Tab,rt.h.Home,rt.h.End],onKeyDown:dt,strings:r,browseThisComputerButtonLabel:null==f?void 0:f.browseThisComputerButtonLabel,isBrowseThisComputerEnabled:te,hasSelectionBeenModifiedViaKeyboard:Se,browseThisComputerHtmlId:null==f?void 0:f.browseThisComputerHtmlId,onClickBrowseThisComputer:null==f?void 0:f.onClickBrowseThisComputer,theme:jo(Pe,te)}),C.createElement(dr,{suggestionsRef:Ie,theme:Pe,styles:K,strings:r,locale:I,results:Re,isShimmerVisible:le,enableScopedHeader:Ae,itemsCount:Ee,itemQueryString:a,onGroupSelected:R,onGroupHovered:$e,onItemHovered:Ye,onItemSelected:V,enablePrefixHighlighting:h,isGroupHeaderVisible:!ge&&!Me,hasSelectionBeenModifiedViaKeyboard:Se,showKeyboardTooltip:Ce,isInitialSelection:ke,layerHostId:n,disableTooltips:k,updateMenuLayout:Ge,updateItemHeight:e=>{var t,i;const o=Math.min(null!==(i=null===(t=l[0])||void 0===t?void 0:t.suggestions.length)&&void 0!==i?i:1,5);Bt(e*o+(null!=St?St:0)+(null!=Dt?Dt:0))},showMeetingBanner:A,enableMeetingBanner:D,meetingBannerText:E,showPartialLoadingEntities:L}),_t&&C.createElement(vt.u,{appearance:"subtle",automationLabel:"InlineSuggestionMoreEntitiesButton",title:b.showMoreEntitiesButtonLabel,useFullWidth:!0,accessibilityRole:"option",theme:No(Pe,be),onClick:it}))),u&&"flag"in u&&u.flag===tt.SatoriEntity&&C.createElement(nt.S,{style:{paddingHorizontal:w}},C.createElement(Ct.R,{url:(qt=a,"https://www.bing.com/q="+qt),text:r.inlineSuggestions("seeMoreHyperLinkLabel"),theme:Po(Pe),style:{fontSize:12,fontWeight:600},inline:!1})),!m&&Gt(),!m&&Ut&&Wt()),m&&Gt(),m&&Ut&&Wt());var qt};var jr;!function(e){e[e.Undo=0]="Undo",e[e.Ignore=1]="Ignore",e[e.Feedback=2]="Feedback"}(jr||(jr={}));class Hr extends C.Component{render(){return this.renderUndoButton()}renderUndoButton(){const e={icon:{type:"Undo"},onClick:()=>{this.props.onAction&&this.props.onAction(jr.Undo)},style:(t=E,{paddingHorizontal:8,borderRadius:2,iconFontSize:t.medium}),theme:ge(A),accessibilityLabel:this.props.strings.undoAccessibilityLabel,automationLabel:"undefined",tooltip:this.props.originalText};var t;return C.createElement(vt.u,Object.assign({},e))}}var Pr,zr,Ur,Wr,Gr,_r,qr,Vr,Zr=i(15185),Kr=i(89744);!function(e){e[e.None=0]="None",e[e.Offer=1]="Offer",e[e.See=2]="See",e[e.Try=3]="Try",e[e.Keep=4]="Keep"}(Pr||(Pr={})),function(e){e[e.SessionStart=0]="SessionStart",e[e.SessionEnd=1]="SessionEnd",e[e.Apply=2]="Apply",e[e.Preview=3]="Preview",e[e.BlurPreview=4]="BlurPreview",e[e.DrillIn=5]="DrillIn",e[e.Search=6]="Search",e[e.Created=7]="Created",e[e.Accepted=8]="Accepted",e[e.Resolved=9]="Resolved",e[e.Presented=10]="Presented",e[e.Modified=11]="Modified",e[e.Deleted=12]="Deleted",e[e.Rejected=13]="Rejected",e[e.Replied=14]="Replied",e[e.Back=15]="Back",e[e.Next=16]="Next",e[e.Previous=17]="Previous",e[e.IgnoreOnce=18]="IgnoreOnce",e[e.IgnoreAll=19]="IgnoreAll",e[e.Options=20]="Options",e[e.Toggle=21]="Toggle",e[e.Report=22]="Report",e[e.LearnMore=23]="LearnMore",e[e.SnoozeSuggestionGroupForSession=25]="SnoozeSuggestionGroupForSession",e[e.SnoozeSuggestionTypeForSession=26]="SnoozeSuggestionTypeForSession",e[e.Delete=27]="Delete",e[e.InvokeOnAddOnFooter=28]="InvokeOnAddOnFooter",e[e.GiveFeedback=29]="GiveFeedback",e[e.OpenEditorPane=30]="OpenEditorPane",e[e.AcceptAll=31]="AcceptAll",e[e.RejectAll=32]="RejectAll",e[e.Undo=33]="Undo",e[e.ShowExplanation=34]="ShowExplanation",e[e.SelectSource=35]="SelectSource",e[e.OpenDesignerPane=36]="OpenDesignerPane",e[e.AddToDictionary=37]="AddToDictionary",e[e.ViewOriginal=38]="ViewOriginal",e[e.SnoozeAll=39]="SnoozeAll",e[e.Retry=40]="Retry",e[e.ClearSearch=41]="ClearSearch",e[e.ShowMore=42]="ShowMore",e[e.ShowHideContext=43]="ShowHideContext",e[e.RevealSuggestions=44]="RevealSuggestions",e[e.LaunchAIRewrite=47]="LaunchAIRewrite",e[e.LaunchAIRewriteHoverIn=48]="LaunchAIRewriteHoverIn",e[e.LaunchAIRewriteHoverOut=49]="LaunchAIRewriteHoverOut"}(zr||(zr={})),(Wr=Ur||(Ur={}))[Wr.Normal=5]="Normal",Wr[Wr.Bold=8]="Bold",(_r=Gr||(Gr={}))[_r.None=0]="None",_r[_r.Single=1]="Single",_r[_r.Double=2]="Double",_r[_r.SpellingSquiggle=3]="SpellingSquiggle",_r[_r.GrammarSquiggle=4]="GrammarSquiggle",_r[_r.CritiqueSquiggle=5]="CritiqueSquiggle",function(e){e[e.None=0]="None",e[e.Spelling=1]="Spelling",e[e.Grammar=2]="Grammar",e[e.Refinement=3]="Refinement",e[e.Rewrite=4]="Rewrite",e[e.SimilarityChecker=5]="SimilarityChecker",e[e.Modification=6]="Modification",e[e.PremiumEmphasis=7]="PremiumEmphasis",e[e.TrackChangeContent=8]="TrackChangeContent",e[e.TrackChangePlaceholder=9]="TrackChangePlaceholder"}(qr||(qr={})),function(e){e[e.None=0]="None",e[e.HideFromReviewCard=1]="HideFromReviewCard",e[e.HideFromReviewCardAndRibbon=2]="HideFromReviewCardAndRibbon"}(Vr||(Vr={})),Gr.None;var Yr=i(95275);class Qr{async loadStrings(e){return i(91501)(`./${e}/canvas-contextual.json`).then((async e=>e)).catch((t=>(c.Hv.sendTraceTag(595727971,d.n.msoulscat_Wac_Telemetry,u.k.Error,`Canvas contextual failed to load resources for locale '${e}'. Error: ${JSON.stringify({message:t.message,stack:t.stack})})}`),Yr.CB)))}}const $r={selectors:{[Er.up]:{outline:"1px solid Highlight",color:"Highlight"}}},Jr='"Segoe UI", "Segoe UI Web", "Segoe UI Web (West European)", -apple-system, BlinkMacSystemFont, Helvetica Neue, sans-serif';var Xr=i(51146),en=i(60905);const tn={themeDarker:"#185abd",themeDark:"#185abd",themeDarkAlt:"#185abd",themePrimary:"#185abd",themeSecondary:"#185abd",themeTertiary:"#185abd",themeLight:"#d2e0f4",themeLighter:"#d2e0f4",themeLighterAlt:"#eff6fc",black:"#242424",neutralDark:"#242424",neutralPrimary:"#242424",neutralPrimaryAlt:"#242424",neutralSecondary:"#424242",neutralSecondaryAlt:"#616161",neutralTertiary:"#bdbdbd",neutralTertiaryAlt:"#bdbdbd",neutralQuaternary:"#e0e0e0",neutralQuaternaryAlt:"#e0e0e0",neutralLight:"#e0e0e0",neutralLighter:"#e0e0e0",neutralLighterAlt:"#f5f5f5",white:"#ffffff",blue:"#3355ff",purple:"#5a4ebc",greenLight:"#d4edd4",greenDark:"#0b6a0b",orange:"#da3b01",blueDark:"#ebf3fc"},on={red:"red",white:"white",neuralRewriteTextDecorationColor_HACK:"#5A45B6"},rn=(nn=tn,sn={themeDarker:"#82abf1",themeDark:"#82abf1",themeDarkAlt:"#82abf1",themePrimary:"#82abf1",themeSecondary:"#296FE6",themeTertiary:"#296FE6",themeLight:"#0c2145",themeLighter:"#071225",themeLighterAlt:"#071225",black:"#ffffff",neutralDark:"#ffffff",neutralPrimary:"#ffffff",neutralPrimaryAlt:"#ffffff",neutralSecondary:"#d6d6d6",neutralSecondaryAlt:"#adadad",neutralTertiary:"#858585",neutralTertiaryAlt:"#858585",neutralQuaternary:"#666666",neutralQuaternaryAlt:"#5c5c5c",neutralLight:"#141414",neutralLighter:"#1f1f1f",neutralLighterAlt:"#3d3d3d",white:"#292929",blue:"#92a4f4",purple:"#a79cf1",greenLight:"#094609",greenDark:"#4fd34f",orange:"#ff6a49",blueDark:"#0c2145"},{[en.bx.Light]:(0,Xr.a)({palette:nn}),[en.bx.Dark]:(0,Xr.a)({palette:sn}),[en.bx.HighContrast]:(0,Xr.a)({palette:sn})});var nn,sn;function an(){return rn[en.o3.getInstance().getThemeMode()]}class ln{constructor(e){this.isRightToLeft=e,this.themeColors=an().palette,this.overflowButtonStyles={root:{display:"block",minHeight:"18px",padding:"11px",width:"100%",maxWidth:"100%",backgroundColor:"transparent",borderWidth:"0px",borderRadius:"0px"},iconHovered:{fontSize:14,color:this.themeColors.neutralSecondary,margin:"0px"},rootHovered:{backgroundColor:this.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:this.themeColors.neutralLighter},rootFocused:{...$r},flexContainer:{alignItems:"center"},textContainer:{textAlign:this.isRightToLeft?"right":"left"}},this.overflowMenuStyles={root:{direction:this.isRightToLeft?"rtl":"ltr",borderRadius:"2px",boxShadow:"0px 1px 3px 0px rgba(0,0,0,0.2)",backgroundColor:this.themeColors.white,width:"auto",borderWidth:"0px",outline:"transparent solid 1px",alignContent:"center"},beakCurtain:{borderRadius:"2px"},calloutMain:{backgroundColor:this.themeColors.white,borderRadius:"2px"}},this.iconStyles={root:{fontSize:14,color:this.themeColors.neutralSecondary,margin:"0px"}},this.overflowIconName="More"}}class cn extends ln{constructor(){super(...arguments),this.overflowButtonStyles={root:{marginTop:"6px",marginBottom:"6px",paddingTop:"6px",paddingBottom:"6px",backgroundColor:this.themeColors.white,borderWidth:"0px",borderRadius:"2px"},icon:{paddingTop:"5px"},iconHovered:{color:this.themeColors.neutralSecondary},rootFocused:{...$r},rootHovered:{backgroundColor:this.themeColors.neutralLighterAlt,[Er.up]:{outline:"1px solid Highlight",color:"ButtonText",backgroundColor:"Button"}},rootPressed:{backgroundColor:this.themeColors.neutralLighter},flexContainer:{outline:"transparent solid 1px"},label:{color:this.themeColors.neutralSecondary}}}}class dn{get suggestionGroupStyles(){return{width:"288px",display:"flex",flexDirection:"column",borderRadius:4}}get headerStyles(){return{display:"flex",justifyContent:"space-between",margin:"14px 16px 8px 16px",fontSize:12,minHeight:16,textAlign:this.isRightToLeft?"right":"left",color:this.themeColors.neutralSecondary,fontFamily:Jr}}get footerStyles(){return{display:"flex",height:44,margin:"2px 4px"}}constructor(e){this.isRightToLeft=e,this.themeColors=an().palette,this.suggestionStyles={display:"flex",flexDirection:"column"},this.previewHeaderStyles={display:"block",fontSize:10,margin:"4px 7px 4px 7px",paddingLeft:"7px",paddingRight:"7px",borderRadius:"12px",height:"14px",textAlign:this.isRightToLeft?"right":"left",color:this.themeColors.black,fontFamily:Jr,fontWeight:600,backgroundColor:this.themeColors.neutralLight},this.suggestionButtonStyles={root:{display:"block",border:"transparent solid 1px",padding:"8px",width:"100%",maxWidth:"100%",backgroundColor:this.themeColors.white},rootHovered:{backgroundColor:this.themeColors.neutralLighterAlt,borderColor:this.themeColors.white},rootPressed:{backgroundColor:this.themeColors.neutralLighter},rootFocused:{...$r},flexContainer:{alignItems:"center"},textContainer:{margin:"4px 12px 0px 12px",textAlign:this.isRightToLeft?"right":"left"},label:{fontSize:14,height:20,marginBottom:0,color:this.themeColors.neutralDark,fontFamily:Jr,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},description:{fontSize:12,height:16,color:this.themeColors.neutralSecondary,fontFamily:Jr,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}},this.suggestionButtonIconStyles={root:{margin:"4px 0px 0px 0px",fontSize:32,height:32,width:32}},this.footerButtonStyles={root:{backgroundColor:this.themeColors.white,border:"transparent solid 1px",padding:"5px 9px 8px",height:44,borderRadius:0},rootHovered:{backgroundColor:this.themeColors.neutralLighterAlt,borderColor:this.themeColors.white},rootPressed:{backgroundColor:this.themeColors.neutralLighter},rootFocused:{...$r},textContainer:{margin:"5px 6px",textAlign:this.isRightToLeft?"right":"left"},label:{margin:0,fontSize:14,height:19,color:this.themeColors.neutralSecondaryAlt,fontFamily:Jr,lineHeight:"inherit",fontWeight:"normal"},labelDisabled:{color:this.themeColors.neutralTertiaryAlt}},this.footerIconStyles={root:{margin:"0px 8px 0px 0px",fontSize:18,color:this.themeColors.themeDarkAlt}},this.suggestionOverflowMenuStyleProvider=new ln(this.isRightToLeft),this.bottomAlignedOverflowMenuStyleProvider=new cn(this.isRightToLeft),this.suggestionOverflowButtonStyles={root:{padding:"8px",backgroundColor:this.themeColors.white,borderWidth:"0px",minHeight:"18px"},rootHovered:{backgroundColor:this.themeColors.neutralLighterAlt},rootDisabled:{backgroundColor:this.themeColors.white},flexContainer:{outline:"transparent solid 1px"},textContainer:{margin:"4px 4px 0px 4px",textAlign:this.isRightToLeft?"right":"left"},label:{fontSize:14,height:"20px",marginBottom:"0px",fontFamily:Jr,fontWeight:600,color:this.themeColors.neutralPrimaryAlt},labelDisabled:{color:this.themeColors.neutralQuaternaryAlt}},this.overflowActionButtonRootStyles={margin:"0px",padding:"8px 12px",backgroundColor:this.themeColors.white,borderWidth:"0px",minHeight:"36px",height:"36px"},this.overflowActionButtonStyles={root:{...this.overflowActionButtonRootStyles,width:"186px"},rootHovered:{backgroundColor:this.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:this.themeColors.neutralLighter},rootDisabled:{backgroundColor:this.themeColors.white},rootFocused:{...$r},flexContainer:{outline:"transparent solid 1px",alignItems:"center",height:"20px"},label:{fontSize:14,color:this.themeColors.neutralSecondaryAlt,fontFamily:Jr,fontWeight:"normal",margin:"0px"},labelDisabled:{color:this.themeColors.neutralTertiaryAlt},textContainer:{textAlign:this.isRightToLeft?"right":"left"}},this.footerOverflowContainerStyles={minWidth:"140px",display:"flex",flexDirection:"column",marginTop:"4px",marginBottom:"4px"},this.onboardingHeadingStyles={color:this.themeColors.neutralSecondary,fontWeight:"bold",margin:"10px 14px 0px 14px"},this.onboardingContentStyles={color:this.themeColors.neutralSecondary,margin:"4px 14px 0px 14px"},this.onboardingLearnMoreStyles={margin:"14px 14px 8px 14px"},this.onboardingLearnMoreLinkStyles={color:this.themeColors.neutralSecondary}}}class un extends dn{get suggestionGroupStyles(){return{minWidth:"186px",display:"flex",flexDirection:"column",borderRadius:"4px",outline:"transparent solid 1px"}}compoundButtonIconName(e){switch(e.type){case"InsertPlaceholderItem":return"ReminderTime";case"MarkCompleteItem":case"MarkCompleteKeepTextItem":case"MarkCompleteRemoveTextItem":return"CheckMark";case"OpenNavPaneItem":return"BulletedList2";default:return}}constructor(){super(...arguments),this.suggestionButtonStyles={root:{display:"block",border:"none",padding:"10px 16px 9px 16px",width:"100%",maxWidth:"100%",minHeight:"38px",maxHeight:"38px",backgroundColor:this.themeColors.white},rootHovered:{backgroundColor:this.themeColors.neutralLighter,borderColor:this.themeColors.white},flexContainer:{maxHeight:"38px"},textContainer:{textAlign:this.isRightToLeft?"right":"left",margin:"0px 8px 0px 8px"},label:{fontSize:14,height:"19px",color:this.themeColors.neutralDark,margin:"0px",fontFamily:Jr,whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"}},this.suggestionButtonIconStyles={root:{margin:"0px",fontSize:16,height:"16px",width:"16px"}}}}class gn extends ln{constructor(){super(...arguments),this.overflowButtonStyles={root:{marginTop:"6px",marginBottom:"6px",paddingTop:"6px",paddingBottom:"6px",paddingLeft:"8px",paddingRight:"8px",backgroundColor:this.themeColors.white,borderWidth:"0px",borderRadius:"2px"},iconHovered:{color:this.themeColors.neutralSecondary},rootFocused:{...$r},rootHovered:{backgroundColor:this.themeColors.neutralLighterAlt,[Er.up]:{outline:"1px solid Highlight",color:"ButtonText",backgroundColor:"Button"}},rootPressed:{backgroundColor:this.themeColors.neutralLighter},flexContainer:{flexDirection:"row-reverse",outline:"transparent solid 1px"},label:{color:this.themeColors.neutralSecondary}},this.iconStyles={root:{fontSize:10,color:this.themeColors.neutralSecondary,margin:this.isRightToLeft?"0px 4px 0px 0px":"0px 0px 0px 4px",paddingTop:"5px"}}}}class pn extends dn{constructor(){super(...arguments),this.themeColors=an().palette,this.contextStyles={style:{color:this.themeColors.neutralSecondaryAlt,display:"block",margin:mn.critiqueMargin,fontFamily:Jr}},this.disabledFooterIconStyles={root:{fontSize:10,color:this.themeColors.neutralQuaternaryAlt,background:"transparent",padding:"5px 0px 0px 0px",margin:"0px"}},this.footerRightIconName="ChevronRight",this.footerLeftIconName="ChevronLeft",this.footerButtonStyles={root:{marginTop:"6px",marginBottom:"6px",paddingLeft:"8px",paddingRight:"8px",paddingBottom:"6px",paddingTop:"6px",backgroundColor:this.themeColors.white,borderWidth:"0px",minHeight:"18px",selectors:{[Er.up]:{color:"ButtonText",backgroundColor:"Button"}}},rootHovered:{backgroundColor:this.themeColors.neutralLighterAlt,[Er.up]:{outline:"1px solid Highlight",color:"ButtonText",backgroundColor:"Button"}},rootPressed:{backgroundColor:this.themeColors.neutralLighter},rootDisabled:{backgroundColor:this.themeColors.white},rootFocused:{...$r},flexContainer:{alignItems:"center",outline:"transparent solid 1px"},label:{fontSize:14,color:this.themeColors.neutralSecondaryAlt,fontFamily:Jr,fontWeight:"normal",margin:"0px"},labelDisabled:{color:this.themeColors.neutralTertiaryAlt}},this.footerIconStyles={root:{fontSize:10,color:this.themeColors.neutralSecondary,background:"transparent",padding:"5px 0px 0px 0px",margin:"0px"}},this.tooltipHostStyles={root:{display:"inline-block"}}}}function hn(){const{themeDarker:e,themeDark:t,themeDarkAlt:i,themePrimary:o,themeSecondary:r,neutralDark:n,neutralPrimary:s,neutralSecondaryAlt:a,neutralTertiary:l,neutralTertiaryAlt:c,neutralLight:d,neutralLighter:u,neutralLighterAlt:g,black:p,white:h,blue:m,purple:y,greenLight:b,blueDark:f}=an().palette;return{background:{resting:h,hover:g,pressed:u,disabled:g},text:{resting:n,disabled:l},tag:{resting:n},altText:{resting:a},icon:{resting:a,disabled:c},grammarText:{resting:m},refinementText:{resting:y},rewriteText:{resting:y},suggestionMenuHoverBackground:d,primaryButtonBackground:{resting:r,hover:r,pressed:r,disabled:g},primaryButtonText:{resting:on.white,disabled:l},header:s,subheader:a,dialogText:s,iconText:n,contextText:n,errorText:on.red,border:n,separator:u,focusRing:a,link:i,linkPressed:e,branding:{type:"IconAndTextButton",background:{resting:h,hover:g,pressed:u,disabled:h},icon:{resting:o,disabled:l},title:{resting:o,disabled:l},tooltip:{textColor:n},focusRing:a},addOnFooterBackground:g,addOnHeaderBackground:f,addOnFooterMessage:p,premiumEmphasis:o,addOnAction:o,editorIcon:o,correctionHighlight:b,helpLink:{text:{resting:i,hover:t,focused:i,pressed:e},focusRing:s},badgeBackground:r,badgeText:on.white}}pn.critiqueMargin=16;class mn extends pn{get headerStyles(){return this.defaultHeaderStyles}get suggestionGroupStyles(){return{backgroundColor:this.themeColors.white,display:"flex",minWidth:"248px",maxWidth:"380px",flexDirection:"column",outline:"transparent solid 1px"}}get footerStyles(){return{margin:"2px 8px 2px 8px",display:"flex",justifyContent:"space-between",height:"44px"}}constructor(){super(...arguments),this.defaultTitleStyles={fontSize:14,fontFamily:Jr,fontWeight:400},this.citationFeedbackContainerStyles={backgroundColor:this.themeColors.neutralLighterAlt,color:this.themeColors.neutralDark,marginLeft:"8px",marginRight:"8px",marginTop:"8px",marginBottom:"12px"},this.defaultHeaderStyles={display:"block",marginTop:"14px",marginBottom:"8px",marginRight:mn.critiqueMargin,marginLeft:mn.critiqueMargin,fontSize:12,color:this.themeColors.neutralSecondary,fontFamily:Jr},this.largeHeaderStyles={fontSize:22},this.subheaderStyles={marginTop:"9px",color:this.themeColors.neutralPrimary},this.twoLineContextStyles={style:{display:"block",margin:mn.critiqueMargin,fontFamily:Jr,overflow:"hidden",maxHeight:"38px",fontSize:12,color:this.themeColors.neutralSecondaryAlt}},this.webkitTwoLineContextStyles={style:{display:"-webkit-box",margin:mn.critiqueMargin,fontFamily:Jr,overflow:"hidden",textOverflow:"ellipsis",WebkitLineClamp:2,WebkitBoxOrient:"vertical",fontSize:12,color:this.themeColors.neutralSecondaryAlt}},this.suggestionGroupFeedbackStyles={display:"flex",minWidth:"248px",maxWidth:"600px",flexDirection:"column",outline:"transparent solid 1px"},this.suggestionStyles={display:"flex",flexDirection:"column"},this.suggestionTitleStyles={style:{...this.defaultTitleStyles,color:this.themeColors.neutralDark,wordBreak:"break-word"}},this.noSuggestionStyles={style:{display:"flex",fontWeight:600,margin:"8px 16px 8px 16px"}},this.disabledSuggestionTitleStyles={style:{...this.defaultTitleStyles,color:this.themeColors.neutralTertiary,wordBreak:"break-word"}},this.suggestionDescriptionStyles={style:{fontSize:12,height:"16px",color:this.themeColors.neutralSecondaryAlt,fontFamily:Jr}},this.suggestionButtonStyles={root:{display:"block",minHeight:"18px",paddingTop:"9px",paddingBottom:"10px",paddingRight:mn.critiqueMargin,paddingLeft:mn.critiqueMargin,backgroundColor:"transparent",borderWidth:"0px",borderRadius:"0px",width:"100%",maxWidth:"100%"},rootHovered:{backgroundColor:this.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:this.themeColors.neutralLighter},rootFocused:{...$r},rootDisabled:{backgroundColor:"transparent"},flexContainer:{justifyContent:"flex-start",display:"flex",flexDirection:"column",textAlign:this.isRightToLeft?"right":"left",outline:"transparent solid 1px",alignItems:"initial"}},this.suggestionContainerStyles={display:"flex",flexDirection:"row"},this.hoveredSuggestionContainerStyles={...this.suggestionContainerStyles,backgroundColor:this.themeColors.neutralLighterAlt},this.disabledSuggestionContainerStyles={...this.suggestionContainerStyles,backgroundColor:this.themeColors.neutralLighterAlt},this.suggestionChoiceGroupStyles={display:"flex",flexDirection:"row",paddingTop:"6px",paddingBottom:"10px",paddingRight:mn.critiqueMargin,paddingLeft:mn.critiqueMargin},this.suggestionChoiceItemStyles={display:"flex",paddingBottom:"12px"},this.suggestionShimmerTitleStyles={root:{paddingBottom:"3px"}},this.suggestionShimmerDescriptionStyles={root:{paddingBottom:"3px"}},this.suggestionShimmerFlexStyles={padding:"6px"},this.footerDialogStyles={...this.footerStyles,flexDirection:"column",height:"auto"},this.footerDialogButtonGroupStyles={display:"flex",flexDirection:"row",justifyContent:"flex-end",height:"44px"},this.footerDefaultActionStyles={display:"flex"},this.similarityHeaderStyles={color:this.themeColors.neutralPrimary,fontSize:10,fontWeight:600,fontFamily:Jr},this.similarityHeaderFeedbackStyles={...this.similarityHeaderStyles,fontSize:20,color:this.themeColors.neutralPrimary},this.similaritySourceTitleStyles={display:"block",marginTop:"6px",marginBottom:"1px",marginRight:mn.critiqueMargin,marginLeft:mn.critiqueMargin,fontSize:12,fontWeight:600,color:this.themeColors.neutralSecondary,fontFamily:Jr},this.similaritySourceUrlStyles={display:"flex",justifyContent:"space-between",height:"16px",marginTop:"1px",marginBottom:"6px",marginRight:mn.critiqueMargin,marginLeft:mn.critiqueMargin,textAlign:this.isRightToLeft?"right":"left",fontFamily:Jr,fontSize:10,color:this.themeColors.neutralSecondaryAlt,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},this.chooseSourceHeaderStyles={color:this.themeColors.neutralSecondaryAlt,fontSize:12,fontFamily:Jr},this.chooseSourceSourceSnippetStyles={style:{display:"block",marginLeft:this.isRightToLeft?mn.critiqueMargin:"0px",marginTop:mn.critiqueMargin,marginBottom:mn.critiqueMargin,marginRight:this.isRightToLeft?"0px":mn.critiqueMargin,fontFamily:Jr,overflow:"hidden",maxHeight:"38px",fontSize:12,color:this.themeColors.neutralSecondaryAlt}},this.webkitChooseSourceSourceSnippetStyles={style:{display:"-webkit-box",marginLeft:this.isRightToLeft?mn.critiqueMargin:"0px",marginTop:mn.critiqueMargin,marginBottom:mn.critiqueMargin,marginRight:this.isRightToLeft?"0px":mn.critiqueMargin,fontFamily:Jr,overflow:"hidden",textOverflow:"ellipsis",WebkitLineClamp:2,WebkitBoxOrient:"vertical",fontSize:12,color:this.themeColors.neutralSecondaryAlt}},this.chooseSourceSourceTitleStyles={display:"block",marginBottom:"1px",marginRight:this.isRightToLeft?"0px":mn.critiqueMargin,marginLeft:this.isRightToLeft?mn.critiqueMargin:"0px",fontSize:14,fontWeight:600,color:this.themeColors.neutralSecondaryAlt,fontFamily:Jr},this.chooseSourceSourceUrlStyles={display:"flex",justifyContent:"space-between",height:"16px",marginTop:"1px",marginBottom:"6px",marginRight:this.isRightToLeft?"0px":mn.critiqueMargin,marginLeft:this.isRightToLeft?mn.critiqueMargin:"0px",textAlign:this.isRightToLeft?"right":"left",fontFamily:Jr,fontSize:12,color:this.themeColors.neutralSecondaryAlt,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},this.similaritySourcesStyles={root:{display:"flex",paddingLeft:"12px",paddingRight:"12px",fontSize:"12px",backgroundColor:"transparent",color:this.themeColors.themePrimary,border:"solid 1px transparent",width:"100%",selectors:{[Er.up]:{outline:"1px solid Highlight",color:"ButtonText",backgroundColor:"Button"}}},rootHovered:{backgroundColor:this.themeColors.neutralLighterAlt,color:this.themeColors.themePrimary,border:"solid 1px transparent"},rootFocused:{...$r,border:`solid 1px ${this.themeColors.themeDarkAlt}`,borderRadius:"0px"}},this.similaritySourceBackButtonStyles={root:{display:"flex",paddingLeft:"3px",paddingRight:"3px",marginBottom:"5px",minWidth:"30px",fontSize:"12px",backgroundColor:"transparent",color:this.themeColors.themePrimary,border:"solid 1px transparent",selectors:{[Er.up]:{outline:"1px solid Highlight",color:"ButtonText",backgroundColor:"Button"}}},rootHovered:{backgroundColor:this.themeColors.neutralLighterAlt,color:this.themeColors.themePrimary,border:"solid 1px transparent"},rootPressed:{backgroundColor:this.themeColors.neutralLighter,color:this.themeColors.themePrimary,border:"solid 1px transparent"},rootFocused:{...$r,border:`solid 1px ${this.themeColors.themeDarkAlt}`,borderRadius:"0px"}},this.similaritySourceChoiceStyle={display:"flex",textAlign:this.isRightToLeft?"right":"left"},this.footerNextPrevStyles={display:"flex"},this.footerDialogButtonStyle={root:{marginLeft:"6px",marginRight:"6px"}},this.footerDialogDefaultButtonStyle={root:{marginLeft:"6px",marginRight:"6px",backgroundColor:this.themeColors.themeSecondary,color:on.white},rootHovered:{backgroundColor:this.themeColors.themeSecondary,color:on.white},rootPressed:{backgroundColor:this.themeColors.themeSecondary,color:on.white}},this.footerRightIconName="ChevronRight",this.footerLeftIconName="ChevronLeft",this.linkStyle={root:{fontSize:"12px",width:"100%",marginLeft:"8px",marginRight:"8px",marginBottom:"16px",color:this.themeColors.themeDarkAlt,":hover":{color:this.themeColors.themeDark},":focus":{color:this.themeColors.themeDarkAlt},":press":{color:this.themeColors.themeDarker}}},this.privacyStatementStyle={style:{fontSize:"12px",marginLeft:"8px",marginRight:"8px",marginBottom:"2px"}},this.rewriteReportedSuggestionButtonStyles={...this.suggestionButtonStyles,icon:{fontSize:"18px",height:"auto",margin:"4px"},label:{margin:"4px"},flexContainer:{alignItems:"center"}},this.rewriteCommentsBoxStyles={description:{},errorMessage:{},field:{backgroundColor:this.themeColors.white,color:this.themeColors.neutralPrimary,border:`1px solid ${this.themeColors.neutralSecondaryAlt}`,"::placeholder":{color:this.themeColors.neutralSecondaryAlt},":disabled":{backgroundColor:this.themeColors.neutralLighterAlt,borderColor:this.themeColors.neutralLighterAlt,"::placeholder":{color:this.themeColors.neutralTertiaryAlt}}},fieldGroup:{border:"0px",outline:"0px"},icon:{},prefix:{},root:{marginTop:"7px",marginBottom:"16px",marginLeft:"8px",marginRight:"8px"},subComponentStyles:{label:{}},suffix:{},wrapper:{},revealButton:{},revealIcon:{},revealSpan:{}},this.includeCitedContentOptionStyles={...this.rewriteCommentsBoxStyles,root:{marginTop:"24px",marginBottom:"8px",marginLeft:"8px",marginRight:"8px"}},this.citationSourceLineStyles={display:"flex",justifyContent:"space-between",height:"16px",marginTop:"1px",marginBottom:"6px",marginRight:mn.critiqueMargin,marginLeft:mn.critiqueMargin,textAlign:this.isRightToLeft?"right":"left",fontFamily:Jr},this.poweredByBingStyles={marginTop:"1px",marginLeft:this.isRightToLeft?"0px":"8px",marginRight:this.isRightToLeft?"8px":"0px",fontSize:10,color:this.themeColors.neutralSecondaryAlt,whiteSpace:"nowrap"},this.citationLinkStyles={display:"block",fontSize:12,fontWeight:600,color:this.themeColors.neutralSecondary,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},this.citationLinkFeedbackStyles={...this.citationLinkStyles,fontWeight:0,color:this.themeColors.neutralDark},this.citationDropdownIconName="ChevronDown",this.citationCheckmarkIconName="CheckMark",this.citationCheckmarkIconStyles={root:{fontSize:16,color:this.themeColors.neutralSecondary,background:"transparent",padding:"0px",margin:this.isRightToLeft?"0px 0px 0px 8px":"0px 8px 0px 0px"}},this.citationOverflowActionButtonStyles={...this.overflowActionButtonStyles,root:{...this.overflowActionButtonRootStyles,width:"140px"}},this.citationNoIconOverflowActionButtonStyles={...this.overflowActionButtonStyles,root:{...this.overflowActionButtonRootStyles,padding:this.isRightToLeft?"8px 36px 8px 12px":"8px 12px 8px 36px",width:"140px"}},this.citationFooterOverflowMenuStyleProvider=new gn(this.isRightToLeft),this.deleteIconName="Delete",this.deleteIconStyles={root:{paddingRight:"8px",fontSize:16,color:this.themeColors.neutralDark}},this.copyCitationIconName="Copy",this.copyCitationIconStyles={root:{paddingRight:"8px",fontSize:16,color:this.themeColors.neutralDark}},this.inTextCitationIconName="Add",this.inTextCitationIconStyles={root:{paddingRight:"8px",fontSize:16,color:this.themeColors.neutralDark}},this.feedbackIconStyles={root:{fontSize:16,color:this.themeColors.neutralSecondaryAlt,margin:"0px"}},this.feedbackIconProps={iconName:"Feedback",styles:this.feedbackIconStyles}}}class yn extends mn{get suggestionGroupStyles(){return{backgroundColor:this.themeColors.white,display:"flex",minWidth:"370px",maxWidth:"380px",flexDirection:"column",outline:"transparent solid 1px"}}get headerStyles(){return{...this.defaultHeaderStyles,display:"flex",justifyContent:"space-between"}}constructor(){super(...arguments),this.suggestionTitleStyles={style:{...this.defaultTitleStyles,marginBottom:"0px",color:this.themeColors.neutralDark}}}}class bn extends mn{get headerStyles(){return{...this.defaultHeaderStyles,display:"flex",justifyContent:"space-between"}}}class fn{constructor(e){this.styleProviderOptions=e,this.themeColors=an().palette,this.contextualMenuStyles={root:{direction:this.styleProviderOptions.isRightToLeft?"rtl":"ltr",borderRadius:4,boxShadow:"0px 8px 24px 0px rgba(0, 0, 0, 0.1), 0px 8px 16px 0px rgba(0, 0, 0, 0.12)",backgroundColor:this.themeColors.white,width:"auto",borderWidth:0,outline:"transparent solid 1px",marginLeft:this.styleProviderOptions.alignInnerTextWithAnchor?this.styleProviderOptions.isRightToLeft?mn.critiqueMargin:-mn.critiqueMargin:void 0,marginTop:4,marginBottom:4},beakCurtain:{borderRadius:4},calloutMain:{borderRadius:4}},this.focusTrapStyles={backgroundColor:this.themeColors.white},this.styleProviderOptions.allowContentOverflow?this.contextualMenuStyles.calloutMain={...this.contextualMenuStyles.calloutMain,overflow:"inherit"}:this.focusTrapStyles={...this.focusTrapStyles,overflow:"hidden"},this.styleProviderOptions.customScrollbarUsed&&(this.contextualMenuStyles.calloutMain={...this.contextualMenuStyles.calloutMain,overflow:"hidden"}),this.styleProviderOptions.disableCardAnimation&&(this.contextualMenuStyles.root={...this.contextualMenuStyles.root,animation:"none"})}}var Sn=i(78435);const vn={":after":{outline:"none !important",border:`1px solid ${an().palette.neutralPrimaryAlt} !important`,borderRadius:"4px",boxShadow:"none !important"},":hover":{border:"none !important"}},Cn={selectors:{[Er.up]:{background:"Highlight",boxShadow:"none !important"}}};class xn extends ln{constructor(){super(...arguments),this.overflowButtonStyles={root:{minHeight:"32px",minWidth:"32px",height:"32px",width:"32px",border:"none",margin:"0px",padding:"0px",backgroundColor:"transparent",...vn},rootHovered:{borderRadius:"2px",backgroundColor:this.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:this.themeColors.neutralLighter},flexContainer:{width:"32px",outline:"transparent solid 1px"},rootFocused:{...$r}}}}class kn extends pn{get cardWidth(){return 250}get suggestionGroupStyles(){return{width:`${this.cardWidth}px`,display:"flex",flexDirection:"column",borderRadius:4}}get headerStyles(){return{display:"flex",flexDirection:"column",padding:"2px 0px 0px",position:"static",width:this.cardWidth-32+"px",minHeight:"17px",flex:"none",order:0,flexGrow:0,margin:"10px 16px 6px 16px",fontFamily:Jr,fontSize:"12px",lineHeight:"16px",color:this.themeColors.neutralPrimaryAlt}}get footerStyles(){return{display:"flex",flexDirection:"column",width:`${this.cardWidth}px`,height:"44px"}}constructor(){super(...arguments),this.contextStyles={style:{display:"block",margin:"2px 16px 8px 16px",fontSize:12,minHeight:16,color:this.themeColors.neutralSecondaryAlt,fontFamily:Jr}},this.bottomAlignedOverflowMenuStyleProvider=new xn(!1),this.footerActionsStyleWrapper={display:"flex"},this.footerActionsLeftStyle={marginTop:"6px",marginLeft:this.isRightToLeft?"0px":"6px",marginRight:this.isRightToLeft?"6px":"0px",display:"flex"},this.footerActionsRightStyle={display:"flex",marginLeft:this.isRightToLeft?"6px":"auto",marginRight:this.isRightToLeft?"auto":"6px",marginTop:"6px",alignItems:"stretch"},this.footerButtonStyles={root:{minHeight:"32px",height:"32px",width:"32px",border:"none",padding:"0px",backgroundColor:"transparent",...vn},rootHovered:{backgroundColor:this.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:this.themeColors.neutralLighter},flexContainer:{width:"32px",outline:"transparent solid 1px",minHeight:"32px"},rootDisabled:{backgroundColor:this.themeColors.white},rootFocused:{...$r},label:{fontSize:14,color:this.themeColors.neutralSecondaryAlt,fontFamily:Jr,fontWeight:"normal",margin:"0px"},labelDisabled:{color:this.themeColors.neutralTertiaryAlt}},this.footerIconStyles={root:{fontSize:16,color:this.themeColors.neutralSecondary,background:"transparent",padding:"8px 0px 0px 0px",margin:"0px"}},this.disabledFooterIconStyles={root:{fontSize:16,color:this.themeColors.neutralQuaternaryAlt,background:"transparent",padding:"8px 0px 0px 0px",margin:"0px"}},this.actionButtonStyles={root:{minHeight:"32px",height:"32px",width:"32px",border:"none",margin:"0px",padding:"0px",backgroundColor:"transparent",...vn},rootHovered:{borderRadius:"2px",backgroundColor:this.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:this.themeColors.neutralLighter},flexContainer:{width:"16px",height:"16px",outline:"transparent solid 1px"},rootFocused:{...$r},rootDisabled:{backgroundColor:"transparent"},menuIcon:{height:"16px",width:"16px"}},this.nextButtonStyles={root:{minHeight:"24px",height:"24px",minWidth:"45px",border:"none",margin:"4px 2px 0px 10px",padding:"0px",background:this.themeColors.themePrimary,borderRadius:"4px"},rootHovered:{backgroundColor:this.themeColors.themeDarkAlt},rootPressed:{backgroundColor:this.themeColors.themeDarker},label:{fontSize:"12px",fontWeight:"normal",lineHeight:"16px"},rootFocused:{...Cn}},this.viewOriginalButtonFocusSelectorStyle={":after":{outline:"none !important",border:"none !important",boxShadow:`0 0 0 1px ${this.themeColors.themePrimary} inset !important`,inset:"0px !important"},":hover":{border:"none !important"}},this.viewOriginalButtonStyles=(0,Sn.J9)(((e=!1)=>e?{root:{minHeight:"32px",height:"32px",width:"32px",margin:"0px",padding:"0px",border:"none",backgroundColor:this.themeColors.themeLight,...this.viewOriginalButtonFocusSelectorStyle},rootHovered:{backgroundColor:this.themeColors.themeLighter},rootPressed:{backgroundColor:this.themeColors.themeLighter},flexContainer:{width:"16px",height:"16px",outline:"transparent solid 1px"},rootFocused:{...$r},menuIcon:{height:"16px",width:"16px"}}:this.actionButtonStyles)),this.defaultIconStyles={root:{background:"transparent",fontSize:"14px",height:"14px",width:"14px",margin:"0px",padding:"1px"}},this.acceptIconStyles=(0,Sn.J9)(((e=!1)=>({root:{...this.defaultIconStyles.root,color:e?this.themeColors.neutralTertiaryAlt:this.themeColors.greenDark}}))),this.rejectIconStyles=(0,Sn.J9)(((e=!1)=>({root:{...this.defaultIconStyles.root,color:e?this.themeColors.neutralTertiaryAlt:this.themeColors.orange}}))),this.viewOriginalIconStyles=(0,Sn.J9)(((e=!1)=>({root:{background:"transparent",fontSize:"16px",height:"16px",width:"16px",margin:"0px",color:e?this.themeColors.themePrimary:void 0}}))),this.giveFeedbackIconStyles={root:{background:"transparent",fontSize:"16px",height:"16px",width:"16px",margin:"0px",color:this.themeColors.neutralSecondaryAlt}},this.overflowActionIconStyles={root:{background:"transparent",fontSize:"16px",height:"16px",width:"16px"}},this.overflowActionButtonStyles={root:{margin:"0px 4px",padding:"8px 8px 8px 2px",backgroundColor:"transparent",borderWidth:"0px",minHeight:"36px",height:"36px",minWidth:"130px",width:"max-content"},rootHovered:{backgroundColor:this.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:this.themeColors.neutralLighter},rootDisabled:{backgroundColor:this.themeColors.white},rootFocused:{...$r},flexContainer:{outline:"transparent solid 1px",alignItems:"center",height:"20px"},label:{fontSize:14,color:this.themeColors.neutralSecondaryAlt,fontFamily:Jr,fontWeight:"normal",margin:"0px"},labelDisabled:{color:this.themeColors.neutralTertiaryAlt},textContainer:{textAlign:this.isRightToLeft?"right":"left"}},this.openPaneIconStyle={root:{fontSize:"18px",background:"transparent",padding:"0px 6px",margin:"0px"}},this.openPaneButtonStyle={root:{minHeight:"32px",height:"32px",minWidth:"32px",border:"none",margin:"0px",padding:"0px",backgroundColor:"transparent",...vn},rootHovered:{borderRadius:"2px",backgroundColor:this.themeColors.neutralLighterAlt},rootPressed:{backgroundColor:this.themeColors.neutralLighter},flexContainer:{minWidth:"32px",alignItems:"center",outline:"transparent solid 1px"},rootFocused:{...$r},label:{fontWeight:600,fontFamily:Jr,fontSize:"14px",lineHeight:"20px",color:this.themeColors.themePrimary,whiteSpace:"normal",overflowWrap:"anywhere",padding:"6px 0px",paddingRight:"6px",margin:"0px"}},this.externalWrapperStyles={display:"flex",flexDirection:"column",height:"auto",width:"max-content"},this.promptStyles={display:"flex",flexDirection:"column",padding:"8px 16px 12px 16px",textAlign:"left",color:this.themeColors.neutralPrimary,fontFamily:Jr,fontSize:12,minHeight:16,backgroundColor:this.themeColors.themeLighterAlt,width:this.cardWidth-32+"px"},this.promptIconStyleWrapper={width:"20px",marginRight:"6px"},this.promptIconStyle={root:{background:"transparent",width:"20px",height:"20px"}},this.promptBodyIconStyle={root:{background:"transparent",width:"14px",height:"14px"}},this.promptStyleWrapper={display:"flex"},this.promptTextStyleWrapper={display:"flex",flexDirection:"column"},this.promptTextHeadingStyle={fontWeight:600,paddingBottom:"4px"},this.promptTextBodyStyle={fontWeight:400}}}const Tn={":after":{outline:"none !important",border:`1px solid ${an().palette.neutralPrimaryAlt} !important`,borderRadius:"4px",boxShadow:"none !important"},":hover":{border:"none !important"}},In={":after":{border:`4px solid ${an().palette.neutralLighter} !important`,borderRadius:"4px",outline:"none !important",boxShadow:"none",marginTop:"1px"},":hover":{outline:"none !important"}},wn={selectors:{[Er.up]:{color:"windowText !important",":hover":{color:"Highlight !important",border:"none !important",outline:"none !important"},":focus-within":{color:"Highlight !important"},":active":{color:"Highlight !important"}}}},An={selectors:{[Er.up]:{border:"4px solid windowText !important",borderRadius:"2px",background:"transparent",color:"windowText !important",":hover":{background:"transparent",outline:"none !important"},":after":{outline:"none !important",border:"1px solid Highlight !important",borderRadius:"4px",boxShadow:"none !important",margin:"0px"},":focus-within":{background:"transparent !important",color:"Highlight !important"},":active":{background:"transparent"}}}},Dn={selectors:{[Er.up]:{color:"windowText !important",":hover":{background:"transparent",border:"none !important",outline:"none !important",color:"Highlight !important"},":after":{outline:"none !important",background:"transparent !important",border:"1px solid Highlight !important",borderRadius:"4px",boxShadow:"none !important"},":focus-within":{background:"transparent !important",color:"Highlight !important"}}}},En={":active":{backgroundColor:tn.neutralLighter},":hover":{backgroundColor:tn.neutralLighterAlt}},Mn={position:"absolute",height:"100%",width:"calc(100% - 12px)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"};class Ln extends kn{constructor(){super(...arguments),this.triageButtonStyles={root:{display:"block",margin:"4px 16px 4px 16px",height:"32px",maxHeight:"32px",padding:"0px",border:"none",backgroundColor:tn.white},rootHovered:{backgroundColor:tn.neutralLighterAlt},rootExpanded:{backgroundColor:tn.neutralLighterAlt},rootPressed:{backgroundColor:tn.neutralLighter},rootDisabled:{backgroundColor:tn.neutralLighterAlt},flexContainer:{justifyContent:this.isRightToLeft?"right":"left",border:`1px solid ${this.themeColors.neutralQuaternary}`,boxSizing:"border-box",borderRadius:"4px"},textContainer:{flexGrow:0,textAlign:this.isRightToLeft?"right":"left",width:"186px",height:"32px"},menuIcon:{fontSize:14,height:"14px",width:"14px",padding:"1px",margin:"8px",color:tn.neutralSecondaryAlt},rootFocused:{...$r}},this.triageCalloutStyles={root:{width:"206px",marginLeft:this.isRightToLeft?"0px":"6px",marginRight:this.isRightToLeft?"6px":"0px",marginTop:"32px",background:this.themeColors.white,borderRadius:"4px !important",boxShadow:"0px 14px 28.8px rgba(0, 0, 0, 0.24), 0px 0px 8px rgba(0, 0, 0, 0.2)",selectors:{"div::-webkit-scrollbar":{width:"7px",height:"107px",minWidth:"7px !important"},"div::-webkit-scrollbar-thumb":{borderRadius:"100px",border:`1px solid ${this.themeColors.white} !important`,background:this.themeColors.neutralQuaternaryAlt}}},calloutMain:{borderRadius:"4px !important",maxHeight:"236px !important"}},this.triageContextualMenuStyles={root:{borderRadius:"4px",minWidth:"161px"}},this.triageContextualMenuSelectedItemStyles={item:{position:"static",height:"40px",backgroundColor:tn.white,selectors:En},label:{...wn},root:{display:"flex",textAlign:this.isRightToLeft?"right":"left",border:`4px solid ${tn.neutralLighter} !important`,height:"40px",...In,...An}},this.triageContextualMenuItemStyles={item:{height:"40px",backgroundColor:tn.white,selectors:En},label:{...wn},root:{display:"flex",textAlign:this.isRightToLeft?"right":"left",borderRadius:"4px",backgroundColor:"transparent",...Tn,...Dn},divider:{margin:"1px 0"}},this.menuItemSpanStyles={...Mn,marginLeft:this.isRightToLeft?"0px":"6px",marginRight:this.isRightToLeft?"6px":"0px"},this.menuSelectedItemSpanStyles={...Mn,marginLeft:this.isRightToLeft?"0px":"4px",marginRight:this.isRightToLeft?"4px":"0px"}}}class Rn extends kn{get cardWidth(){return 0===this.columnCount?250:212+186*(this.columnCount-1)}constructor(){super(...arguments),this.columnCount=1,this.showMoreLinkClassName=(0,Er.Zq)({font:"Segoe UI",fontSize:"12",color:this.themeColors.themePrimary,lineHeight:16}),this.imageSuggestionGalleryClassName=(0,Er.Zq)({padding:"6px 14px 0px 14px"}),this.galleryButtonRootStyles=(0,Sn.J9)((e=>({height:54,width:180,marginBottom:6,marginLeft:e?0:6,marginRight:0,padding:0,border:"2px solid transparent !important"}))),this.galleryButtonStyles=(0,Sn.J9)((e=>({root:this.galleryButtonRootStyles(0===e),rootFocused:{border:`2px solid ${this.themeColors.black} !important`},rootHovered:{border:`2px solid ${this.themeColors.themePrimary} !important`},rootPressed:{border:`4px solid ${this.themeColors.themePrimary} !important`},rootChecked:{border:`4px solid ${this.themeColors.themePrimary} !important`}}))),this.externalWrapperStyles={display:"flex",flexDirection:"row",width:"auto"},this.promptStyles={display:"flex",flexDirection:"column",padding:"16px 12px",textAlign:"left",width:"130px",color:this.themeColors.neutralPrimary,fontFamily:Jr,fontSize:12,minHeight:16,backgroundColor:this.themeColors.themeLighterAlt},this.promptIconStyleWrapper={width:"20px",marginBottom:"6px"},this.promptStyleWrapper={display:"flex",flexDirection:"column"}}}class On extends dn{get headerStyles(){return this.defaultHeaderStyles}get suggestionGroupStyles(){return{minWidth:"199px",height:"241px",display:"flex",flexDirection:"column",outline:"#E0E0E0 solid 1px",outlineOffset:"-4px",borderRadius:"4px",backgroundColor:this.themeColors.white}}compoundButtonIconName(e){}constructor(){super(...arguments),this.defaultHeaderStyles={display:"block",marginTop:"8px",marginRight:"16px",marginLeft:"16px",height:"32px",fontSize:14,color:this.themeColors.neutralDark,fontFamily:Jr,fontWeight:600},this.suggestionButtonStyles={root:{display:"block",border:"none",padding:"0px 0px 0px 0px",width:"183px",maxWidth:"183px",minHeight:"32px",maxHeight:"32px",backgroundColor:this.themeColors.white,marginLeft:"16px",marginRight:"8px"},rootHovered:{backgroundColor:this.themeColors.white,borderColor:this.themeColors.white},rootPressed:{backgroundColor:this.themeColors.white,borderColor:this.themeColors.white},flexContainer:{height:"32px",justifyContent:this.isRightToLeft?"right":"left",boxSizing:"border-box"},textContainer:{flexGrow:0,padding:"6px 0px 6px 0px",textAlign:this.isRightToLeft?"right":"left",width:"183px",height:"32px"},label:{fontSize:14,color:this.themeColors.neutralDark,fontFamily:Jr,margin:"0px",fontWeight:400,whiteSpace:"nowrap"}}}}function Fn(){const e=an().palette;return{background:{resting:e.white,hover:e.neutralLighterAlt,pressed:e.neutralLighter,disabled:e.neutralLighterAlt},text:{resting:e.neutralDark,disabled:e.neutralTertiary},altText:{resting:e.neutralSecondaryAlt},actionButtonForeground:{resting:e.themePrimary},highlighting:e.neutralLighterAlt,branding:{type:"IconAndTextButton",background:{resting:e.white,hover:e.neutralLighterAlt,pressed:e.neutralLighter,disabled:e.white},icon:{resting:e.themePrimary,disabled:e.neutralTertiary},title:{resting:e.themePrimary,disabled:e.neutralTertiary},tooltip:{textColor:e.neutralDark},focusRing:e.neutralSecondaryAlt},scroll:{thumbColor:e.neutralTertiary},tooltip:{backgroundColor:e.white,textColor:e.neutralDark,showBeak:!0,directionHint:et.rightCenter},noSuggestions:{descriptionTextColor:e.neutralSecondaryAlt,item:{background:{resting:e.white,hover:e.neutralLighterAlt,pressed:e.neutralLighter,disabled:e.neutralLighterAlt},text:{resting:e.themePrimary},actionButtonForeground:{resting:e.themePrimary},highlighting:e.neutralLighterAlt}}}}var Bn=i(41014);class Nn extends C.PureComponent{enableButton(){this.setState((()=>({disabled:!1})))}disabledButton(){this.setState((()=>({disabled:!0})))}focusButton(){this.buttonRef.current&&this.buttonRef.current.focus()}openMenu(){this.setState((()=>({menuOpen:!0}))),this.props.onShow&&this.props.onShow()}closeMenu(e){this.setState((()=>({menuOpen:!1}))),e&&this.focusButton(),this.props.onDismiss&&this.props.onDismiss()}render(){return this.state.menuOpen?C.createElement("div",null,this.renderOverflowMenuButton(),this.renderOverflowMenuCallout()):C.createElement("div",null,this.renderOverflowMenuButton())}onButtonClick(){this.state.menuOpen?this.closeMenu(!0):this.openMenu()}renderOverflowMenuButton(){const e={text:this.props.text?this.props.text:void 0,id:this.buttonId,ariaLabel:this.props.ariaLabel?this.props.ariaLabel:this.props.resources.OverflowButtonAccessibilityLabel,role:this.props.role?this.props.role:"button",styles:this.props.styleProvider.overflowButtonStyles,onClick:this.onButtonClick,iconProps:{iconName:this.props.iconName?this.props.iconName:this.props.styleProvider.overflowIconName,styles:this.props.styleProvider.iconStyles},componentRef:this.buttonRef,disabled:this.state.disabled};return C.createElement(Bn.z,{...e,"data-automation-id":`OverflowMenu_Automation_${Nn.ids}`})}renderOverflowMenuCallout(){const e={role:"menu",styles:this.props.styleProvider.overflowMenuStyles,target:"#"+this.buttonId,isBeakVisible:!1,directionalHint:this.props.styleProvider.isRightToLeft?f.A.bottomRightEdge:f.A.bottomLeftEdge,onDismiss:this.closeMenu,setInitialFocus:!0},t={isCircularNavigation:!0,handleTabKey:ht.l.all};return C.createElement(b.P,{...e},C.createElement(mt.R,{...t},this.props.children))}constructor(e){super(e),this.state={menuOpen:!1,disabled:!1},this.buttonId="OverflowMenu"+Nn.ids,Nn.ids+=1,this.onButtonClick=this.onButtonClick.bind(this),this.closeMenu=this.closeMenu.bind(this),this.buttonRef=C.createRef()}}Nn.ids=0;const jn="Context",Hn="Description",Pn="SharedSpellingCritique",zn="SharedRepeatedWordCritique",Un="SharedGrammarCritique",Wn="SharedSuggestionCritique",Gn="SharedRewriteCritique",_n="SharedDictationCorrectionCritique",qn="SharedAddinCritique",Vn="Type-AIFeedbackRewrite";class Zn extends C.Component{render(){const e=this.renderHeader();return C.createElement("div",{style:this.props.styleProvider.suggestionGroupStyles,...this.rootAttributes(!!e)},e,this.renderSuggestions(),this.renderFooter())}maximumSuggestions(){return 3}headerId(){return Zn.createHeaderId(this.props.group.type)}static createHeaderId(e){return`header-${e}`}rootAttributes(e){const t={};return this.props.parameters.definition&&this.props.parameters.definition.suggestionGroups&&this.props.parameters.definition.suggestionGroups.length>1&&(t.role="listitem"),e?t["aria-labelledby"]=this.headerId():t["aria-label"]=this.headerText(),t}renderHeader(){return C.createElement("div",{id:this.headerId(),role:"note","aria-label":this.headerText(),style:this.props.styleProvider.headerStyles},this.headerText())}getSuggestionsToRender(){return this.props.group.suggestions}getSuggestionsRole(){return this.maximumSuggestions()>1?"list":"group"}getSuggestionItemRole(){return this.maximumSuggestions()>1?"listitem":null}renderSuggestions(){const e=this.getSuggestionsToRender();if(e){const t=this.maximumSuggestions(),i=e.filter((e=>!!e)).map(((e,t)=>this.renderSuggestionItem(e,t))).filter(((e,i)=>!!e&&i<t));if(i.length>0){const e=this.getSuggestionsRole();return C.createElement(mt.R,{componentRef:this.suggestionsFocusZoneRef},C.createElement("div",{style:this.props.styleProvider.suggestionStyles,role:e,"aria-label":this.suggestionListDescription()},i))}}return null}renderSuggestionItem(e,t){const i=this.renderSuggestion(e,t);if(!i)return null;const o=this.getSuggestionItemRole();return C.createElement("div",{key:e.id,role:o||void 0},i)}renderSuggestion(e,t){return null}renderFooter(){return null}renderProactivePrompt(){return null}renderOverflowActions(){return[]}renderOverflowMenu(){const e=this.renderOverflowActions();if(0===e.length)return null;const t={styleProvider:this.props.styleProvider.bottomAlignedOverflowMenuStyleProvider,resources:this.props.resources,ref:this.footerOpenOverflowMenuRef};return C.createElement(Nn,{...t,key:"overflow-menu"},C.createElement("div",{style:this.props.styleProvider.footerOverflowContainerStyles},e))}renderPreviewPillbox(){return C.createElement("div",{style:this.props.styleProvider.previewHeaderStyles},this.props.resources.PreviewHeaderLabel)}restoreFocus(){this.props.hostElementRef&&this.props.hostElementRef.current&&this.props.hostElementRef.current.focus()}shouldDismissOnAction(e){return![zr.GiveFeedback,zr.Report,zr.ShowExplanation,zr.Toggle,zr.LaunchAIRewriteHoverIn,zr.LaunchAIRewriteHoverOut,zr.AddToDictionary].includes(e)}executeDefaultAction(){const e=this.getSuggestionsToRender();if(e){const t=e[0];t&&this.onAction(null,zr.Apply,Pr.Try,this.props.group,t,void 0)}}executeActionFromString(e){const t=e.toLowerCase(),i={actionSourceId:r.VoiceDictationPhrase};switch(t){case"ignore":case"ignore once":return void this.onAction(null,zr.IgnoreOnce,Pr.Try,this.props.group,void 0,void 0,void 0,i);case"ignore all":return void this.onAction(null,zr.IgnoreAll,Pr.Try,this.props.group,void 0,void 0,void 0,i);default:const e=this.getSuggestionsToRender();let o=e?.find((e=>e?.title?.toLowerCase()===t));return o||this.props.group?.type!==zn||1!==e?.length||"delete"!==t||(o=e[0]),void(o?this.onAction(null,zr.Apply,Pr.Try,this.props.group,o,void 0,void 0,i):this.props.dismiss?this.props.dismiss(i):c.Hv.sendTraceTag(526513923,d.n.msoulscat_Wac_Telemetry,u.k.Warning,"Unknown command and unable to dismiss"))}}invokeBadgeId(e){}onAction(e,t,i,o,n,s,a,l){if(!this.props.parameters.onAction)return;const c=this.props.parameters.definition,d=n?n.telemetryData:null,u=o.telemetryData,g={actionType:t,engagement:i,objectName:o?o.type:"Unknown",objectId:o?o.id:"Unknown",objectFulfillment:s||(n?n.type:"Unknown"),contentReference:{range:o?o.contentDescriptor:void 0,contentId:c?c.contentId:void 0,contentHash:c?c.contentHash:void 0},data:d||u,suggestionGroup:o,suggestion:n,descriptorData:a},p=l??{actionSourceId:r.Unknown};this.props.dependencies.actionLogger.logAction(g,p),this.props.parameters.onAction(g)&&(e&&(e.preventDefault(),e.stopPropagation()),this.shouldDismissOnAction(t)&&this.props.dismiss(p))}constructor(e){super(e),this.suggestionsFocusZoneRef=C.createRef(),this.onAction=this.onAction.bind(this),this.restoreFocus=this.restoreFocus.bind(this),this.footerOpenOverflowMenuRef=C.createRef()}}var Kn=i(89351);class Yn extends Zn{headerText(){return""}maximumSuggestions(){return 5}suggestionListDescription(){return""}renderHeader(){return null}renderSuggestion(e,t){const i={allowDisabledFocus:!0,text:e.title,styles:this.props.styleProvider.suggestionButtonStyles,iconProps:{iconName:this.props.styleProvider.compoundButtonIconName(e),styles:this.props.styleProvider.suggestionButtonIconStyles},onClick:t=>this.onAction(t,zr.Apply,Pr.Try,this.props.group,e)};return C.createElement(Kn._,{key:e.id,...i})}}Yn.id="ActionSet";const Qn="Intent-TrackChange",$n="Intent-AutoReplace",Jn="Intent-ContextIQUserInit",Xn="Intent-ContextIQFlags";var es=i(14844);class ts extends C.PureComponent{renderBold(e,t){switch(t){case Ur.Normal:e.fontWeight="normal";break;case Ur.Bold:e.fontWeight="bold"}}renderHidden(e){e.position="absolute",e.height="1px",e.width="1px",e.overflow="hidden",e.clip="rect(1px 1px 1px 1px)"}renderUnderline(e,t){let i=!1;switch(t){case Gr.Single:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjNweCIgdmlld0JveD0iMCAwIDUgMSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTUuMiAoNzgxODEpIC0gaHR0cHM6Ly9za2V0Y2hhcHAuY29tIC0tPgogICAgPHRpdGxlPmxpbmU8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibGluZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIj4KICAgICAgICA8ZyBpZD0iVGlsZS1Db3B5IiBzdHJva2U9IiMwMDAwMDAiPgogICAgICAgICAgICA8cGF0aCBkPSJNMCwwLjUgTDUsMC41IiBpZD0iTGluZS0yLUNvcHktMTAiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==')",i=!0;break;case Gr.Double:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjNweCIgdmlld0JveD0iMCAwIDUgMyIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTUuMiAoNzgxODEpIC0gaHR0cHM6Ly9za2V0Y2hhcHAuY29tIC0tPgogICAgPHRpdGxlPmRvdWJsZV9saW5lPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImRvdWJsZV9saW5lIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBzdHJva2UtbGluZWNhcD0icm91bmQiPgogICAgICAgIDxnIGlkPSJUaWxlLUNvcHkiIHN0cm9rZT0iIzAwMDAwMCI+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAuNSBMNSwwLjUiIGlkPSJMaW5lLTItQ29weS0xMCI+PC9wYXRoPgogICAgICAgICAgICA8cGF0aCBkPSJNMCwyLjUgTDUsMi41IiBpZD0iTGluZS0yLUNvcHktMTEiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==')",i=!0;break;case Gr.SpellingSquiggle:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjRweCIgdmlld0JveD0iMCAwIDUgNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTYuMiAoODE2NzIpIC0gaHR0cHM6Ly9za2V0Y2guY29tIC0tPgogICAgPHRpdGxlPnNwZWxsaW5nX3NxdWlnZ2xlPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IkZsYWdzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTAxMC4wMDAwMDAsIC0yOTYuMDAwMDAwKSIgaWQ9InNwZWxsaW5nX3NxdWlnZ2xlIj4KICAgICAgICAgICAgPGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTAxMC4wMDAwMDAsIDI5Ni4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDMgQzEuMjUsMyAxLjI1LDEgMi41LDEgQzMuNzUsMSAzLjc1LDMgNSwzIiBpZD0iUGF0aCIgc3Ryb2tlPSIjRUIwMDAwIiBzdHJva2Utd2lkdGg9IjEiPjwvcGF0aD4KICAgICAgICAgICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUiIHg9IjAiIHk9IjAiIHdpZHRoPSI1IiBoZWlnaHQ9IjQiPjwvcmVjdD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+')",i=!0;break;case Gr.GrammarSquiggle:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjNweCIgdmlld0JveD0iMCAwIDUgMyIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTUuMiAoNzgxODEpIC0gaHR0cHM6Ly9za2V0Y2hhcHAuY29tIC0tPgogICAgPHRpdGxlPmdyYW1tYXJfZG91YmxlX2xpbmU8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZ3JhbW1hcl9kb3VibGVfbGluZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIj4KICAgICAgICA8ZyBpZD0iR3JhbW1hci1UaWxlLUNvcHkiIHN0cm9rZT0iIzMzNTVGRiI+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAuNSBMNSwwLjUiIGlkPSJMaW5lLTItQ29weS0xMCI+PC9wYXRoPgogICAgICAgICAgICA8cGF0aCBkPSJNMCwyLjUgTDUsMi41IiBpZD0iTGluZS0yLUNvcHktMTEiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==')",i=!0;break;case Gr.CritiqueSquiggle:e.backgroundImage="url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTBweCIgaGVpZ2h0PSIycHgiIHZpZXdCb3g9IjAgMCAxMCAyIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgogICAgPCEtLSBHZW5lcmF0b3I6IFNrZXRjaCA1Ny4xICg4MzA4OCkgLSBodHRwczovL3NrZXRjaC5jb20gLS0+CiAgICA8dGl0bGU+aW5zaWdodF90ZXh0dXJlPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9Imluc2lnaHRfdGV4dHVyZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Ikdyb3VwLTItQ29weSI+CiAgICAgICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUiIHg9IjAiIHk9IjAiIHdpZHRoPSIxMCIgaGVpZ2h0PSIyIj48L3JlY3Q+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xLDEgTDUsMSIgaWQ9IkxpbmUtNCIgc3Ryb2tlPSIjNzE2MEU4IiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+PC9wYXRoPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+')",i=!0}i&&(e.backgroundRepeat="repeat-x",e.backgroundPosition="bottom left",e.borderBottom="solid 1px transparent")}getRunText(e,t){const i=this.props.text.length,o=Math.max(0,Math.min(i,e)),r=Math.max(0,Math.min(i,t));return o<r?this.props.text.substr(o,r-o):(c.Hv.sendTraceTag(595683267,d.n.msoulscat_Wac_Telemetry,u.k.Warning,`Canvas contextual trying to fetch invalid substring (start '${e}', end '${t}', length '${i}')`),"")}renderTextRun(e,t,i){const o={};return i&&(this.renderBold(o,i.fontWeight),this.renderUnderline(o,i.underlineType),i.hidden&&this.renderHidden(o),i.italic&&(o.fontStyle="italic"),i.cssColor&&(o.color=i.cssColor)),C.createElement("span",{key:e,style:o},this.getRunText(e,t))}render(){const e=[];if(this.props.formatting&&this.props.formatting.length>0){let t=0,i=0;const o=this.props.text.length;for(;t<o;)if(i<this.props.formatting.length){const r=this.props.formatting[i];if(r){const n=r.start,s=n+r.length,a=Math.max(t,Math.min(o,n)),l=Math.max(t,Math.min(o,s));if(a>=l){i+=1;continue}t<a&&(e.push(this.renderTextRun(t,a)),t=a),t<l&&(e.push(this.renderTextRun(t,l,r)),t=l)}i+=1}else t<o&&(e.push(this.renderTextRun(t,o)),t=o)}return C.createElement("span",{"aria-label":this.props.ariaLabel,role:this.props.ariaRole,"aria-level":this.props.ariaLevel,style:this.props.style?this.props.style.style:{}},0!==e.length?e:this.props.text)}}var is=i(69804),os=i(73570),rs=i(34906),ns=i(69671),ss=i(88694),as=i(41618);class ls extends Zn{suggestionListDescription(){return this.props.resources.CritiqueSuggestionListDefaultAccessibilityLabel}shouldHideActionButton(e,t){return!this.hasActionType(e,t)}getActionButtonIconProps(e){}shouldDisableActionButton(e,t){return!1}getActionButtonToRender(e,t){return C.createElement(Kn._,{...t})}renderActionButton(e,t,i,o,r,n){if(this.shouldHideActionButton(e,i))return null;let s;if(!r&&(s=this.getActionString(e),!s))return null;const a={iconProps:this.getActionButtonIconProps(e),text:s,styles:t,disabled:this.shouldDisableActionButton(e,i),role:o||"button",onClick:t=>this.onAction(t,e,Pr.Try,this.props.group,i,void 0,n)};return this.getActionButtonToRender(e,{...a,key:e.toString(),"data-automation-id":`CritiqueActionButton_${s}_${this.props.group.id}`})}showingSnippet(){return!(!this.props.group.snippet||!this.state.showingContext)}renderShowHideContextButton(){if(!this.allowShowHideContextButton())return null;const e=this.state.showingContext?this.props.resources.HideContextButtonText:this.props.resources.ShowContextButtonText,t={iconProps:this.getActionButtonIconProps(zr.ShowHideContext),text:e,styles:this.props.styleProvider.overflowActionButtonStyles,onClick:e=>this.onShowHideContext(e)};return C.createElement(Kn._,{role:"menuitem",key:"ShowHideContext",...t,"data-automation-id":`CritiqueActionButton_${e}_${this.props.group.id}`})}renderSnippet(e,t,i){return this.showingSnippet()?C.createElement(ts,{text:t??this.props.group.snippet,ariaLabel:t??this.props.group.snippet,ariaRole:"heading",ariaLevel:2,formatting:i??this.props.group.snippetFormatting,style:e??this.props.styleProvider.contextStyles}):null}renderNextPrev(){return this.props.parameters.definition.setSize>0?[this.renderNavigationButton(!1),this.renderNavigationButton(!0)]:[]}renderHeader(){return C.createElement("div",null,super.renderHeader(),this.renderSnippet())}renderNavigationButton(e){const t=this.props.isRightToLeft?!e:e,i=t?zr.Next:zr.Previous,o=e?this.props.parameters.definition.positionInSet>=this.props.parameters.definition.setSize-1:this.props.parameters.definition.positionInSet<=0,r={disabled:o,styles:this.props.styleProvider.footerButtonStyles,iconProps:{iconName:t?this.props.styleProvider.footerRightIconName:this.props.styleProvider.footerLeftIconName,styles:o?this.props.styleProvider.disabledFooterIconStyles:this.props.styleProvider.footerIconStyles},ariaLabel:this.getAriaLabel(i),onClick:e=>this.onAction(e,i,Pr.Try,this.props.group,void 0,void 0)},n=`CritiqueNavButton_${t?"Right":"Left"}_${this.props.group.id}`;return C.createElement(Kn._,{key:i.toString(),...r,"data-automation-id":n})}getAriaLabel(e){switch(e){case zr.Next:return this.props.resources.NextButtonText;case zr.Previous:return this.props.resources.PreviousButtonText}}getActionString(e){switch(e){case zr.IgnoreOnce:return this.props.resources.IgnoreButtonText;case zr.IgnoreAll:return this.props.resources.IgnoreAllButtonText;case zr.Options:return this.props.resources.OptionsButtonText;case zr.Deleted:return this.props.resources.DeleteButtonText;case zr.LearnMore:return this.getActionStringForLearnMore();case zr.Accepted:return this.props.resources.AcceptButton;case zr.Rejected:return this.props.resources.RejectButton;case zr.AcceptAll:return this.props.resources.AcceptAllButton;case zr.RejectAll:return this.props.resources.RejectAllButton;case zr.Next:return this.props.resources.NextButton;case zr.Previous:return this.props.resources.PreviousButton;case zr.Undo:return this.props.resources.UndoButton;case zr.GiveFeedback:return this.props.resources.GiveFeedbackButtonText}}hasActionType(e,t){return t?!!t.supportedActions&&-1!==t.supportedActions.findIndex((t=>t===e)):!!this.props.group.supportedActions&&-1!==this.props.group.supportedActions.findIndex((t=>t===e))}getActionStringForLearnMore(){return this.props.resources.LearnMoreButtonText}onAction(e,t,i,o,r,n,s){this.dismissFooterOverflow(),super.onAction(e,t,i,o,r,n,s)}onShowHideContext(e){this.setState((e=>({showingContext:!e.showingContext}))),this.onAction(e,zr.Toggle,Pr.Try,this.props.group,void 0,jn)}allowShowHideContextButton(){return!(!this.props.group.snippet||!this.props.group.snippetFormatting)}dismissFooterOverflow(){this.footerOpenOverflowMenuRef.current&&this.footerOpenOverflowMenuRef.current.closeMenu(!0)}constructor(e){super(e),this.dismissFooterOverflow=this.dismissFooterOverflow.bind(this),this.onShowHideContext=this.onShowHideContext.bind(this)}}var cs,ds,us=i(64341),gs=i(31408);!function(e){e[e.Default=0]="Default",e[e.ReportRewriteSuggestions=1]="ReportRewriteSuggestions",e[e.DisplayingFeedbackOptions=2]="DisplayingFeedbackOptions",e[e.Confirmation=3]="Confirmation"}(cs||(cs={})),function(e){e[e.Default=0]="Default",e[e.DisplayingFeedbackOptions=1]="DisplayingFeedbackOptions",e[e.Confirmation=2]="Confirmation",e[e.DisplayingSimilarSources=3]="DisplayingSimilarSources"}(ds||(ds={}));class ps extends ls{componentDidUpdate({},e){if(this.props.group.type===ps.neuralRewrite&&e.rewriteState!==this.state.rewriteState)switch(this.state.rewriteState){case cs.ReportRewriteSuggestions:this.rewriteReportSuggestionsChoiceGroupRef.current&&this.rewriteReportSuggestionsChoiceGroupRef.current.focus();break;case cs.DisplayingFeedbackOptions:this.rewriteFeedbackOptionChoiceGroupRef.current&&this.rewriteFeedbackOptionChoiceGroupRef.current.focus();break;case cs.Confirmation:this.rewriteReportDoneButtonRef.current&&this.rewriteReportDoneButtonRef.current.focus();break;default:this.suggestionsFocusZoneRef.current&&this.suggestionsFocusZoneRef.current.focus()}else if(this.props.group.type===ps.similarity&&e.similarityState!==this.state.similarityState)switch(this.state.similarityState){case ds.DisplayingFeedbackOptions:this.similarityFeedbackOptionChoiceGroupRef.current&&this.similarityFeedbackOptionChoiceGroupRef.current.focus();break;case ds.Confirmation:this.similarityFeedbackReportOkayButtonRef.current&&this.similarityFeedbackReportOkayButtonRef.current.focus();break;default:this.suggestionsFocusZoneRef.current&&this.suggestionsFocusZoneRef.current.focus()}}hasNoSuggestions(){return!this.props.group.suggestions||0===this.props.group.suggestions.length}render(){return this.props.group.type===ps.neuralRewrite&&this.hasNoSuggestions()?this.renderEmptyNeuralRewrite():this.isSimilarityFeedbackCard()?this.renderFeedbackCard():super.render()}isSimilarityFeedbackCard(){return this.props.group.type===ps.similarity&&this.state.similarityState===ds.DisplayingFeedbackOptions}renderFeedbackCard(){const e=this.renderHeader();return C.createElement("div",{style:this.props.styleProvider.suggestionGroupFeedbackStyles,...this.rootAttributes(!!e),role:"alert"},e,this.renderSuggestions(),this.renderFooter(),this.renderProactivePrompt())}headerText(){switch(this.props.group.type){case ps.neuralRewrite:if(this.props.group.isContentPending)return this.props.resources.SuggestionsGroupLoadingSuggestionsText;switch(this.state.rewriteState){case cs.Default:return this.props.resources.NeuralRewriteHeaderLabel;case cs.ReportRewriteSuggestions:return this.props.resources.NeuralRewriteFeedbackDialogChooseSuggestionTitle;case cs.DisplayingFeedbackOptions:return this.props.resources.NeuralRewriteFeedbackDialogChooseOptionTitle;case cs.Confirmation:return this.props.resources.NeuralRewriteFeedbackConfirmationDialogTitle;default:return"<unknown>"}case ps.similarity:switch(this.state.similarityState){case ds.Default:return this.props.resources.PlagiarismHeaderLabel;case ds.DisplayingFeedbackOptions:return this.props.resources.ProvideFeedbackHeaderText;case ds.Confirmation:return this.props.resources.NeuralRewriteFeedbackConfirmationDialogTitle;case ds.DisplayingSimilarSources:return this.props.resources.SelectSourceHeaderText;default:return"<unknown>"}case ps.sensitiveContent:return this.props.resources.SensitiveContentHeaderLabel;default:return this.props.group.title?this.props.group.title:"<unknown>"}}showingSnippet(){return this.props.group.type===ps.similarity?this.state.similarityState===ds.DisplayingSimilarSources||!(!this.props.group.snippet||!this.state.showingSimilarText):(this.props.group.type!==ps.neuralRewrite||this.state.rewriteState===cs.Default)&&super.showingSnippet()}renderSnippet(e,t,i){const o=this.props.group.type===ps.similarity&&this.state.similarityState===ds.DisplayingSimilarSources;let r=this.props.group.type===ps.similarity?window.CSS&&window.CSS.supports&&window.CSS.supports("display","-webkit-box")?this.props.styleProvider.webkitTwoLineContextStyles:this.props.styleProvider.twoLineContextStyles:this.props.styleProvider.contextStyles;return o&&(r=window.CSS&&window.CSS.supports&&window.CSS.supports("display","-webkit-box")?this.props.styleProvider.webkitChooseSourceSourceSnippetStyles:this.props.styleProvider.chooseSourceSourceSnippetStyles),super.renderSnippet(r,t,i)}renderSnippetForFeedback(){return C.createElement("div",{style:this.props.styleProvider.citationFeedbackContainerStyles},this.props.group.snippet?.substr(0,ps.characterLimitForUserTextToSend))}renderNeuralRewriteHeader(){const e=this.state.rewriteState===cs.Confirmation,t=this.state.rewriteState===cs.DisplayingFeedbackOptions,i=this.state.rewriteState===cs.Confirmation,o=this.state.rewriteState===cs.Default;return C.createElement("div",{style:this.props.styleProvider.headerStyles},C.createElement("div",null,C.createElement("div",{id:this.headerId(),role:"heading",style:e?this.props.styleProvider.largeHeaderStyles:void 0},this.headerText()),t||i?C.createElement("div",{style:this.props.styleProvider.subheaderStyles},t?this.props.resources.NeuralRewriteFeedbackDialogDescription:this.props.resources.NeuralRewriteFeedbackConfirmationDialogSubTitle):null),o?this.renderPreviewPillbox():null)}getSimilarityHeaderLabel(){return this.props.resources.SimilarityFormatHeaderLabel.replace("{0}",this.props.resources.PlagiarismHeaderLabel).replace("{1}",this.props.resources.PoweredByBingHeaderLabel)}getSimilarityHeaderStyle(){return this.state.similarityState===ds.Confirmation?this.props.styleProvider.largeHeaderStyles:this.state.similarityState===ds.DisplayingSimilarSources?this.props.styleProvider.chooseSourceHeaderStyles:this.state.similarityState===ds.DisplayingFeedbackOptions?this.props.styleProvider.similarityHeaderFeedbackStyles:this.props.styleProvider.similarityHeaderStyles}renderSimilarityHeader(){const e=this.state.similarityState===ds.DisplayingFeedbackOptions,t=this.state.similarityState===ds.Confirmation,i=this.state.similarityState===ds.Default;return C.createElement("div",{style:this.props.styleProvider.headerStyles},C.createElement("div",{"aria-live":"polite"},C.createElement("div",{id:this.headerId(),role:"heading","aria-level":1,style:this.getSimilarityHeaderStyle()},this.headerText()),e||t?C.createElement("div",{style:this.props.styleProvider.subheaderStyles},e?this.props.resources.SimilarityFeedbackDialogChooseOptionTitle:this.props.resources.NeuralRewriteFeedbackConfirmationDialogSubTitle):null),i?this.renderPreviewPillbox():null)}renderSimilaritySourceTitle(e){const t=this.state.similarityState===ds.DisplayingSimilarSources;return C.createElement("span",{style:t?this.props.styleProvider.chooseSourceSourceTitleStyles:this.props.styleProvider.similaritySourceTitleStyles},e)}getDomainFromUrl(e){if(e)try{return new URL(e).hostname}catch(e){}return e}renderCitationToBeShared(){return C.createElement("div",{style:this.props.styleProvider.citationFeedbackContainerStyles},C.createElement("div",{style:this.props.styleProvider.citationLinkFeedbackStyles},this.getDomainFromUrl(this.props.group.url)))}renderSimilaritySourceUrl(e,t){const i=this.state.similarityState===ds.DisplayingSimilarSources;return C.createElement("div",{style:i?this.props.styleProvider.chooseSourceSourceUrlStyles:this.props.styleProvider.similaritySourceUrlStyles},this.getDomainFromUrl(e),t?C.createElement("div",{style:this.props.styleProvider.poweredByBingStyles,"aria-hidden":"true"},this.props.resources.PoweredByBingHeaderLabel):null)}renderHeader(){switch(this.props.group.type){case ps.similarity:switch(this.state.similarityState){case ds.DisplayingFeedbackOptions:case ds.Confirmation:case ds.DisplayingSimilarSources:return this.renderSimilarityHeader();case ds.Default:return C.createElement("div",{"aria-label":this.getSimilarityHeaderLabel(),role:"group"},this.renderSimilarityHeader(),this.renderSnippet(void 0,this.props.group.snippet,this.props.group.snippetFormatting),this.renderSimilaritySourceTitle(this.props.group.description),this.renderSimilaritySourceUrl(this.props.group.url,!0))}case ps.neuralRewrite:return C.createElement("div",null,this.renderNeuralRewriteHeader(),this.renderSnippet(void 0,this.props.group.snippet,this.props.group.snippetFormatting));default:return super.renderHeader()}}suggestionListDescription(){switch(this.props.group.type){case ps.neuralRewrite:case ps.similarity:return this.headerText();default:return super.suggestionListDescription()}}handleSuggestionFocus(e){this.setState((()=>({focusedSuggestionId:e})))}handleSuggestionBlur(){this.setState((()=>({focusedSuggestionId:null})))}handleSuggestionHoverOn(e){this.setState((()=>({hoveredSuggestionId:e})))}handleSuggestionHoverOff(e){this.state.hoveredSuggestionId===e&&this.setState((()=>({hoveredSuggestionId:null})))}isSuggestionAlreadyReported(e){return this.props.group.type===ps.neuralRewrite&&ps.neuralRewriteReportedSuggestions.indexOf(e)>=0}isSuggestionDisabled(e){return this.props.group.type===ps.neuralRewrite&&ps.neuralRewriteDisabledSuggestions.indexOf(e)>=0}showingDescription(){return(this.props.group.type!==ps.neuralRewrite||this.state.rewriteState===cs.Default)&&this.state.showingDescription}getSuggestionStyle(e){return e?this.props.styleProvider.disabledSuggestionTitleStyles:this.props.styleProvider.suggestionTitleStyles}getSuggestionContainerStyle(e,t){return e?this.props.styleProvider.disabledSuggestionContainerStyles:t?this.props.styleProvider.hoveredSuggestionContainerStyles:this.props.styleProvider.suggestionContainerStyles}suggestionHasActionType(e,t){return!!e.supportedActions&&-1!==e.supportedActions.findIndex((e=>e===t))}suggestionGroupHasActionType(e,t){return!!e.supportedActions&&-1!==e.supportedActions.findIndex((e=>e===t))}getSuggestionsRole(){return"menu"}getSuggestionItemRole(){return null}getSuggestionTitle(e){if(this.props.group.type===ps.similarity)switch(e.id){case ps.similarityBlockQuoteSuggestion:return this.props.resources.BlockQuotationButtonText;case ps.similarityFullCitationSuggestions:return this.props.resources.FullCitationButtonText;case ps.similarityInlineCitationSuggestions:return this.props.resources.InlineCitationButtonText}return this.props.group.type===ps.sensitiveContent?this.props.resources.RemoveButtonText:e.title?e.title:void 0}renderSuggestionIcon(e){switch(this.props.group.type){case ps.sensitiveContent:return C.createElement(is.I,{iconName:this.props.styleProvider.deleteIconName,styles:this.props.styleProvider.deleteIconStyles});case ps.similarity:switch(e.id){case ps.similarityFullCitationSuggestions:return C.createElement(is.I,{iconName:this.props.styleProvider.copyCitationIconName,styles:this.props.styleProvider.copyCitationIconStyles});case ps.similarityInlineCitationSuggestions:return C.createElement(is.I,{iconName:this.props.styleProvider.inTextCitationIconName,styles:this.props.styleProvider.inTextCitationIconStyles});case ps.similarityBlockQuoteSuggestion:default:return null}default:return null}}renderSuggestionContents(e,t,i){return C.createElement("div",null,this.renderSuggestionIcon(e),C.createElement(ts,{text:t,formatting:i?void 0:e.titleFormatting,style:this.getSuggestionStyle(i)}),e.description&&this.showingDescription()?C.createElement("div",null,C.createElement(ts,{text:e.description,style:this.props.styleProvider.suggestionDescriptionStyles})):null)}getObjectFulfillment(e){if(this.props.group.type===ps.similarity&&null!==e.id)return e.id}getDescriptorData(e){if(this.props.group.type===ps.similarity)return e?parseInt(e,10):parseInt(this.state.similaritySelectedSource,10)}renderSuggestion(e,t){const i=this.getSuggestionTitle(e);if(!i)return null;if(this.props.group.isContentPending)return C.createElement("div",{style:this.props.styleProvider.suggestionShimmerFlexStyles,"aria-hidden":!0},C.createElement(os.W,{styles:this.props.styleProvider.suggestionShimmerTitleStyles}));const o=!this.suggestionHasActionType(e,zr.Apply)||this.isSuggestionDisabled(i);let r=this.maximumSuggestions();this.props.group.suggestions&&this.props.group.suggestions.length<r&&(r=this.props.group.suggestions.length);const n={allowDisabledFocus:!0,disabled:o,role:"menuitem","aria-posinset":t+1,"aria-setsize":r,onClick:t=>this.onAction(t,zr.Apply,Pr.Try,this.props.group,e,this.getObjectFulfillment(e),this.getDescriptorData())};if(this.props.group.type===ps.neuralRewrite&&o){const e={...n,styles:this.props.styleProvider.rewriteReportedSuggestionButtonStyles,text:this.props.resources.NeuralRewriteReportedSuggestionTitle,iconProps:{iconName:"Info"}};return C.createElement("div",{style:this.getSuggestionContainerStyle(!1,!1)},C.createElement(Kn._,{...e}))}const s={...n,styles:this.props.styleProvider.suggestionButtonStyles,onFocus:()=>this.handleSuggestionFocus(e.id)},a=this.state.hoveredSuggestionId===e.id,l=this.state.openSuggestionOverflowId===e.id,c={onMouseEnter:()=>this.handleSuggestionHoverOn(e.id),onMouseLeave:()=>this.handleSuggestionHoverOff(e.id),onFocus:()=>this.handleSuggestionFocus(e.id),onBlur:this.handleSuggestionBlur,style:this.getSuggestionContainerStyle(o,a||l)};return C.createElement("div",{...c},C.createElement(Kn._,{...s,"data-automation-id":`CritiqueSuggestionButton_${e.id}`},this.renderSuggestionContents(e,i,o)))}renderEmptyNeuralRewrite(){return C.createElement("div",{style:this.props.styleProvider.suggestionGroupStyles},C.createElement("div",{style:this.props.styleProvider.suggestionStyles,role:"group",...this.rootAttributes(!1)},C.createElement("div",{id:"header-emptyNeuralRewrite",role:"heading","aria-level":1,style:this.props.styleProvider.headerStyles},this.props.resources.CritiqueNoSuggestionsHeader),C.createElement("div",{style:this.props.styleProvider.suggestionContainerStyles},C.createElement(ts,{ariaLabel:this.props.resources.NeuralRewriteNoSuggestionsText,ariaRole:"document",text:this.props.group.errorMessage?this.props.group.errorMessage:this.props.resources.NeuralRewriteNoSuggestionsText,style:this.props.styleProvider.noSuggestionStyles})),this.renderCloseButtonFooter()))}onRewriteSelectFeedbackSuggestion(e,t){t&&this.setState({rewriteReportedSuggestionId:t.key,rewriteChoiceGroupSelected:!0})}renderNeuralRewriteReportSuggestions(){const e=this.getSuggestionsToRender();if(!e)return null;const t=this.maximumSuggestions(),i=e.filter((e=>!!e&&!!e.id&&!!this.getSuggestionTitle(e))).map((e=>{const t=e,i=t.id,o=this.getSuggestionTitle(t);if(this.isSuggestionDisabled(o))return{key:i,disabled:!0,text:this.props.resources.NeuralRewriteReportedSuggestionTitle,onRenderField:(e,t)=>C.createElement("div",{style:this.props.styleProvider.suggestionChoiceItemStyles},t(e))};const r=this.isSuggestionAlreadyReported(o);return{key:i,disabled:r,text:"",ariaLabel:o,onRenderField:(e,i)=>C.createElement("div",{style:this.props.styleProvider.suggestionChoiceItemStyles},i(e),this.renderSuggestionContents(t,o,r))}})).filter(((e,i)=>i<t));return 0===i.length?null:C.createElement(rs.n,{"aria-label":this.props.resources.NeuralRewriteFeedbackDialogChooseSuggestionTitle,onChange:this.onRewriteSelectFeedbackSuggestion,style:this.props.styleProvider.suggestionChoiceGroupStyles,options:i,componentRef:this.rewriteReportSuggestionsChoiceGroupRef})}onRewriteSelectFeedbackOption(e,t){t&&this.setState({rewriteChoiceGroupSelected:!0})}renderNeuralRewriteFeedbackOptions(){return C.createElement(rs.n,{"aria-label":this.props.resources.NeuralRewriteFeedbackDialogChooseOptionTitle,componentRef:this.rewriteFeedbackOptionChoiceGroupRef,onChange:this.onRewriteSelectFeedbackOption,style:this.props.styleProvider.suggestionChoiceGroupStyles,options:[{key:ps.neuralRewriteFeedbackOptionHelpful,text:this.props.resources.SuggestionFeedbackHelpfulLabel},{key:ps.neuralRewriteFeedbackOptionWrong,text:this.props.resources.SuggestionFeedbackWrongLabel},{key:ps.neuralRewriteFeedbackOptionOffensive,text:this.props.resources.SuggestionFeedbackOffensiveLabel},{key:ps.neuralRewriteFeedbackOptionOther,text:this.props.resources.SuggestionFeedbackOtherLabel}]})}static rewriteFeedbackOptionShouldDisableSuggestion(e){return e!==ps.neuralRewriteFeedbackOptionHelpful}getSensitiveContentSuggestion(){return[{type:"CritiqueItem",id:"Remove",supportedActions:[zr.Apply]}]}getSuggestionsToRender(){return this.props.group.type===ps.sensitiveContent?this.getSensitiveContentSuggestion():super.getSuggestionsToRender()}renderSuggestions(){if(this.props.group.type===ps.neuralRewrite)switch(this.state.rewriteState){case cs.ReportRewriteSuggestions:return this.renderNeuralRewriteReportSuggestions();case cs.DisplayingFeedbackOptions:return this.renderNeuralRewriteFeedbackOptions();case cs.Confirmation:return null}else if(this.props.group.type===ps.similarity)switch(this.state.similarityState){case ds.DisplayingFeedbackOptions:return this.renderSimilarityFeedbackOptions();case ds.DisplayingSimilarSources:return this.renderSimilaritySourceOptions();case ds.Confirmation:return null}return super.renderSuggestions()}getActionStringForLearnMore(){return this.props.group.type===ps.neuralRewrite?this.props.resources.AboutSuggestionsButtonText:super.getActionStringForLearnMore()}shouldDismissOnAction(e){return(this.props.group.type!==ps.similarity||e!==zr.GiveFeedback)&&(this.props.group.type!==ps.similarity||e!==zr.SelectSource)&&super.shouldDismissOnAction(e)}shouldHideActionButton(e,t){return(this.props.group.type!==ps.similarity||e!==zr.IgnoreOnce)&&super.shouldHideActionButton(e,t)}shouldDisableActionButton(e,t){return this.props.group.type===ps.similarity&&e===zr.IgnoreOnce&&!this.hasActionType(e,t)}renderNeuralRewriteFeedbackButton(){if(this.props.group.isContentPending)return null;const e={text:this.props.resources.GiveFeedbackButtonText,styles:this.props.styleProvider.footerButtonStyles,onClick:()=>this.setState({rewriteState:cs.ReportRewriteSuggestions,rewriteReportedSuggestionId:null,rewriteChoiceGroupSelected:!1})};return C.createElement(Kn._,{key:"GiveFeedback",...e,"data-automation-id":`CritiqueActionButton_GiveFeedback_${this.props.group.id}`})}renderCloseButton(){const e={styles:this.props.styleProvider.footerButtonStyles,iconProps:{iconName:"Cancel",styles:this.props.styleProvider.footerIconStyles,ariaLabel:this.props.resources.CloseButtonLabel},onClick:()=>this.props.dismiss({actionSourceId:r.Unknown})};return C.createElement(Kn._,{key:"CloseButton",...e,"data-automation-id":`CritiqueCloseButton_${this.props.group.id}`})}onShowHideDescription(e){this.setState((e=>({showingDescription:!e.showingDescription}))),this.onAction(e,zr.Toggle,Pr.Try,this.props.group,void 0,Hn)}allowDescriptionToggleButton(){if(this.props.group.suggestions)for(const e of this.props.group.suggestions)if(e&&e.description)return!0;return!1}renderShowHideDescriptionButton(){if(!this.allowDescriptionToggleButton())return null;let e=null;e=this.props.group.type===ps.neuralRewrite?this.state.showingDescription?this.props.resources.HideExplanationButtonText:this.props.resources.ShowExplanationButtonText:this.state.showingDescription?this.props.resources.HideSynonymsButtonText:this.props.resources.ShowSynonymsButtonText;const t={text:e,styles:this.props.styleProvider.overflowActionButtonStyles,onClick:this.onShowHideDescription};return C.createElement(Kn._,{role:"menuitem",key:"ShowHideDescription",...t,"data-automation-id":`CritiqueActionButton_${e}_${this.props.group.id}`})}renderDefaultAction(){switch(this.props.group.type){case ps.similarity:case ps.sensitiveContent:return this.renderActionButton(zr.IgnoreOnce,this.props.styleProvider.footerButtonStyles);case ps.neuralRewrite:return this.renderNeuralRewriteFeedbackButton();default:return null}}getCitationSourceButtonTitle(e){switch(e){case"APA":return this.props.resources.CitationApaTitle;case"MLA":return this.props.resources.CitationMlaTitle;case"Chicago":return this.props.resources.CitationChicagoTitle;default:return}}renderCitationSourceButton(e,t,i){const o=this.getCitationSourceButtonTitle(e);if(!o)return null;const r={text:o,role:"option","aria-selected":this.state.selectedCitationStyle===e,"aria-posinset":t+1,"aria-setsize":i.length,styles:this.state.selectedCitationStyle!==e?this.props.styleProvider.citationNoIconOverflowActionButtonStyles:this.props.styleProvider.citationOverflowActionButtonStyles,iconProps:this.state.selectedCitationStyle!==e?void 0:{iconName:this.props.styleProvider.citationCheckmarkIconName,styles:this.props.styleProvider.citationCheckmarkIconStyles},onClick:t=>{this.setState({selectedCitationStyle:e}),this.onAction(t,zr.Toggle,Pr.Try,this.props.group,void 0,e)}};return C.createElement(Kn._,{key:e,...r,"data-automation-id":`CritiqueActionButton_${o}_${this.props.group.id}`})}onSimilaritySelectFeedbackOption(e,t){t&&this.setState({similarityChoiceGroupSelected:!0})}onSimilarityFeedbackCancel(e){this.setState({similarityState:ds.Default,similarityChoiceGroupSelected:!1})}onSimilarityFeedbackOkay(e){this.setState({similarityState:ds.Default,similarityChoiceGroupSelected:!1})}onSimilaritySourceDone(e){this.props.group.sources&&(this.props.group.description=this.props.group.sources[e]?.description,this.props.group.url=this.props.group.sources[e]?.url,this.props.group.snippet=this.props.group.sources[e]?.snippet,this.setState({similaritySelectedSource:e.toString(),similarityState:ds.Default}))}onSimilaritySourceCancel(e){this.setState({similarityState:ds.Default})}onSimilarityShareCitedContentCheckbox(e){const t=this.state.similarityShareCitedContentCheckbox;this.onAction(null,zr.Toggle,Pr.None,this.props.group,void 0,jn),this.setState({similarityShareCitedContentCheckbox:!t})}renderSimilarityFeedbackOptions(){return C.createElement(rs.n,{"aria-label":this.headerText(),componentRef:this.similarityFeedbackOptionChoiceGroupRef,onChange:this.onSimilaritySelectFeedbackOption,style:this.props.styleProvider.suggestionChoiceGroupStyles,options:[{key:ps.similarityFeedbackHelpfulLabel,text:this.props.resources.SimilarityFeedbackHelpfulLabel},{key:ps.similarityFeedbackWrongSourceLabel,text:this.props.resources.SimilarityFeedbackWrongSourceLabel},{key:ps.similarityFeedbackOriginalContentLabel,text:this.props.resources.SimilarityFeedbackOriginalContentLabel},{key:ps.similarityFeedbackOffensiveLabel,text:this.props.resources.SimilarityFeedbackOffensiveContentLabel},{key:ps.similarityFeedbackOtherLabel,text:this.props.resources.SimilarityFeedbackOtherLabel}]})}renderSimilaritySourceOverflowActions(e,t){if(this.props.group.type!==ps.similarity)return null;const i={styleProvider:this.props.styleProvider.bottomAlignedOverflowMenuStyleProvider,resources:this.props.resources,ref:this.similaritySourceOptionRef[e],ariaLabel:this.props.resources.DefaultSplitButtonOverflowAccessibilityLabel.replace("{0}",t)};return C.createElement(Nn,{...i},this.renderSimilarityFeedbackButton(),C.createElement("div",null,this.renderNavigateToSourceButton(e.toString())))}renderSimilaritySourceOption(e,t){if(!this.props.group.sources)return null;const i=this.props.group.sources.length,o=t+1,r={role:"menuitem","aria-posinset":o,"aria-setsize":i,styles:this.props.styleProvider.suggestionButtonStyles,onClick:()=>this.onSimilaritySourceDone(t),onFocus:()=>this.handleSuggestionFocus(e.id)},n=this.state.hoveredSuggestionId===e.id,s=this.state.openSuggestionOverflowId===e.id,a={onMouseEnter:()=>{this.handleSuggestionHoverOn(e.id),this.similaritySourceOptionRef[t]?.current?.enableButton()},onMouseLeave:()=>{this.handleSuggestionHoverOff(e.id),this.state.focusedSuggestionId!==e.id&&this.similaritySourceOptionRef[t]?.current?.disabledButton()},onFocus:()=>{this.handleSuggestionFocus(e.id);for(let e=0;e<i;e++)e===t?this.similaritySourceOptionRef[e]?.current?.enableButton():this.similaritySourceOptionRef[e]?.current?.disabledButton()},onBlur:this.handleSuggestionBlur,style:this.getSuggestionContainerStyle(!1,n||s)},l=this.props.resources.SimilaritySourceOptionLabel.replace("{0}",o.toString()),c=this.renderSimilaritySourceOverflowActions(t,l);return C.createElement("div",{...a},C.createElement(Kn._,{...r,"data-automation-id":`SimilaritySourceButton_${e.id}`},C.createElement("div",{style:this.props.styleProvider.similaritySourceChoiceStyle},C.createElement("div",{"aria-label":l,role:"group"},this.renderSimilaritySourceTitle(e.description),this.renderSimilaritySourceUrl(e.url,!1),this.renderSnippet(void 0,e.snippet,e.snippetFormatting)))),c)}renderSimilaritySourceOptions(){if(!this.props.group.sources)return null;const e=this.props.group.sources.filter((e=>!!e)).map(((e,t)=>this.renderSimilaritySourceOption(e,t))).filter((e=>!!e));return C.createElement(mt.R,{componentRef:this.suggestionsFocusZoneRef},C.createElement("div",{style:this.props.styleProvider.suggestionStyles,role:"menu","aria-label":this.props.resources.SimilaritySourceOptionsLabel},e))}renderSimilarityFeedbackButton(){if(this.props.group.type!==ps.similarity||this.props.group.isContentPending)return null;if(!this.suggestionGroupHasActionType(this.props.group,zr.Report))return null;const e={text:this.props.resources.GiveFeedbackButtonText,styles:this.props.styleProvider.overflowActionButtonStyles,onClick:e=>{this.onAction(e,zr.GiveFeedback,Pr.None,this.props.group),this.setState({similarityState:ds.DisplayingFeedbackOptions})}};return C.createElement(Kn._,{key:"GiveFeedback",...e,"data-automation-id":`CritiqueActionButton_GiveFeedback_${this.props.group.id}`})}renderSimilarityFeedbackIconButton(){if(this.props.group.type!==ps.similarity||this.props.group.isContentPending)return null;if(!this.suggestionGroupHasActionType(this.props.group,zr.Report))return null;const e={ariaLabel:this.props.resources.GiveFeedbackButtonText,iconProps:this.props.styleProvider.feedbackIconProps,styles:this.props.styleProvider.footerButtonStyles,onClick:e=>{this.onAction(e,zr.GiveFeedback,Pr.None,this.props.group),this.setState({similarityState:ds.DisplayingFeedbackOptions})}};return C.createElement(Kn._,{key:"GiveFeedback",...e,"data-automation-id":`CritiqueActionButton_GiveFeedback_${this.props.group.id}`})}renderNavigateToSourceButton(e){const t={text:this.props.resources.NavigateToSourceButton,styles:this.props.styleProvider.overflowActionButtonStyles,role:"menuitem",onClick:()=>{this.props.group.sources?window.open(this.props.group.sources[parseInt(e,10)]?.url??void 0):window.open(this.props.group.url?this.props.group.url:void 0)}};return C.createElement(Kn._,{...t})}renderOverflowActions(){let e=[];switch(this.props.group.type){case ps.similarity:e=[this.renderShowHideSimilarTextButton(),this.renderNavigateToSourceButton(this.state.similaritySelectedSource),this.renderActionButton(zr.LearnMore,this.props.styleProvider.overflowActionButtonStyles,void 0,"menuitem")];break;case ps.sensitiveContent:e=[this.renderShowHideContextButton()];break;case ps.neuralRewrite:e=[this.renderShowHideContextButton(),this.renderShowHideDescriptionButton(),this.renderActionButton(zr.LearnMore,this.props.styleProvider.overflowActionButtonStyles,void 0,"menuitem")]}return e.filter((e=>!!e))}renderShowHideSimilarTextButton(){if(!this.allowShowHideSimilarTextButton())return null;const e=this.state.showingSimilarText?this.props.resources.HideSimilarTextButton:this.props.resources.ShowSimilarTextButton,t={text:e,styles:this.props.styleProvider.overflowActionButtonStyles,onClick:e=>this.onShowHideSimilarText(e)};return C.createElement(Kn._,{role:"menuitem",key:"ShowHideSimilarText",...t,"data-automation-id":`CritiqueActionButton_${e}_${this.props.group.id}`})}allowShowHideSimilarTextButton(){return!!this.props.group.snippet}onShowHideSimilarText(e){this.setState((e=>({showingSimilarText:!e.showingSimilarText}))),this.onAction(e,zr.Toggle,Pr.None,this.props.group,void 0,jn)}renderCitationStyleOptions(){if(this.props.group.type!==ps.similarity)return null;const e=this.state.selectedCitationStyle?this.state.selectedCitationStyle:this.props.resources.CitationMlaTitle,t={text:e,iconName:this.props.styleProvider.citationDropdownIconName,styleProvider:this.props.styleProvider.citationFooterOverflowMenuStyleProvider,resources:this.props.resources,ref:this.footerOpenOverflowMenuRef,ariaLabel:this.props.resources.SimilarityCitationStyleLabel.replace("{0}",e),role:"menu"},i=[this.props.resources.CitationMlaTitle,this.props.resources.CitationApaTitle,this.props.resources.CitationChicagoTitle].filter((e=>!!e)).map(((e,t,i)=>this.renderCitationSourceButton(e,t,i)));return C.createElement(Nn,{...t},C.createElement("div",{style:this.props.styleProvider.footerOverflowContainerStyles},i))}onRewriteReportSuggestionCancel(e){this.setState({rewriteState:cs.Default,rewriteReportedSuggestionId:null,rewriteChoiceGroupSelected:!1})}onRewriteReportSuggestionNext(e){this.setState({rewriteState:cs.DisplayingFeedbackOptions,rewriteChoiceGroupSelected:!1})}onRewriteReportSuggestionSend(e){if(!this.state.rewriteReportedSuggestionId||!this.props.group.suggestions)return void c.Hv.sendTraceTag(594911240,d.n.msoulscat_Wac_Telemetry,u.k.Warning,"Unable to send feedback because we don't know what was reported, or we don't have any suggestions");if(!this.rewriteFeedbackOptionChoiceGroupRef.current||!this.rewriteFeedbackOptionChoiceGroupRef.current.checkedOption)return void c.Hv.sendTraceTag(594871319,d.n.msoulscat_Wac_Telemetry,u.k.Warning,"Unable to send feedback because apparently no option radio was selected");let t=null;const i=this.state.rewriteReportedSuggestionId;for(const e of this.props.group.suggestions)if(e&&e.id===i){t=e;break}if(!t||!this.getSuggestionTitle(t))return void c.Hv.sendTraceTag(594871320,d.n.msoulscat_Wac_Telemetry,u.k.Warning,"Unable to send feedback because we couldn't find the reported suggestion, or could grab the text on it");const o=this.getSuggestionTitle(t),r=this.rewriteFeedbackOptionChoiceGroupRef.current.checkedOption.key,n={option:r,comments:this.rewriteCommentsTextBoxRef.current&&this.rewriteCommentsTextBoxRef.current.value?this.rewriteCommentsTextBoxRef.current.value:void 0};this.onAction(null,zr.Report,Pr.Try,this.props.group,t,void 0,JSON.stringify(n)),this.isSuggestionAlreadyReported(o)||ps.neuralRewriteReportedSuggestions.push(o),ps.rewriteFeedbackOptionShouldDisableSuggestion(r)&&!this.isSuggestionDisabled(o)&&ps.neuralRewriteDisabledSuggestions.push(o),this.setState({rewriteState:cs.Confirmation,rewriteReportedSuggestionId:null,rewriteChoiceGroupSelected:!1})}onRewriteReportSuggestionDone(e){this.setState({rewriteState:cs.Default,rewriteReportedSuggestionId:null,rewriteChoiceGroupSelected:!1})}renderCloseButtonFooter(){const e=this.renderCloseButton();return C.createElement("div",{key:"footer",style:this.props.styleProvider.footerStyles},C.createElement("div",{style:this.props.styleProvider.footerDefaultActionStyles},e))}renderShowSources(){if(this.props.group.type!==ps.similarity||!this.props.group.sources||this.props.group.sources.length<=1)return null;const e={text:this.props.resources.SimilaritySourcesLabel,styles:this.props.styleProvider.similaritySourcesStyles,onClick:e=>{this.onAction(e,zr.SelectSource,Pr.None,this.props.group),this.setState({similarityState:ds.DisplayingSimilarSources})}};return C.createElement(ns.j,{...e})}renderDefaultFooter(){const e=this.renderDefaultAction(),t=this.renderCitationStyleOptions(),i=this.renderSimilarityFeedbackIconButton(),o=this.renderOverflowMenu(),r=this.renderNextPrev(),n=this.renderShowSources();return null!=e||null!=o||r.length>0?[C.createElement("div",{key:"footer"},n,C.createElement("div",{key:"footer",style:this.props.styleProvider.footerStyles},C.createElement("div",{style:this.props.styleProvider.footerDefaultActionStyles},e,t,i,o),C.createElement("div",{style:this.props.styleProvider.footerNextPrevStyles},r)))]:null}renderRewriteFooter(){switch(this.state.rewriteState){case cs.Default:return this.props.group.isContentPending?null:this.renderDefaultFooter();case cs.ReportRewriteSuggestions:case cs.DisplayingFeedbackOptions:case cs.Confirmation:const e=this.state.rewriteState===cs.DisplayingFeedbackOptions,t=this.state.rewriteState!==cs.Confirmation,i=this.state.rewriteState===cs.ReportRewriteSuggestions,o=this.state.rewriteState===cs.DisplayingFeedbackOptions,r=this.state.rewriteState===cs.Confirmation;return C.createElement("div",{key:"footer",style:this.props.styleProvider.footerDialogStyles},e?C.createElement(gs.g,{id:"commentsBox",type:"AppInputProps",ref:this.rewriteCommentsTextBoxRef,label:this.props.resources.NeuralRewriteFeedbackDialogTextBoxPlaceholder,hideLabel:!0,placeholder:this.props.resources.NeuralRewriteFeedbackDialogTextBoxPlaceholder,styles:this.props.styleProvider.rewriteCommentsBoxStyles,multiline:!0,resizable:!1}):null,e?this.renderPrivacyStatement():null,C.createElement("div",{style:this.props.styleProvider.footerDialogButtonGroupStyles},t?C.createElement(ss.Y,{text:this.props.resources.CancelButton,onClick:this.onRewriteReportSuggestionCancel}):null,i?C.createElement(ns.j,{text:this.props.resources.NextButton,styles:this.props.styleProvider.footerDialogDefaultButtonStyle,onClick:this.onRewriteReportSuggestionNext,disabled:!this.state.rewriteChoiceGroupSelected}):null,o?C.createElement(ns.j,{text:this.props.resources.SendButton,styles:this.props.styleProvider.footerDialogDefaultButtonStyle,onClick:this.onRewriteReportSuggestionSend,disabled:!this.state.rewriteChoiceGroupSelected}):null,r?C.createElement(ns.j,{text:this.props.resources.DoneButton,styles:this.props.styleProvider.footerDialogDefaultButtonStyle,onClick:this.onRewriteReportSuggestionDone,componentRef:this.rewriteReportDoneButtonRef}):null));default:return null}}renderPrivacyStatement(){return C.createElement(C.Fragment,null,C.createElement(ts,{ariaLabel:this.privacyStatementLabel,style:this.props.styleProvider.privacyStatementStyle,text:this.privacyStatementLabel}),C.createElement(as.N,{target:"_blank",href:this.props.resources.NeuralRewriteFeedbackDialogPrivacyStatementURL,styles:this.props.styleProvider.linkStyle,underline:!0},this.props.resources.NeuralRewriteFeedbackDialogPrivacyStatementLabel))}getUserTextToSend(){return this.props.group.snippet?.substr(0,ps.characterLimitForUserTextToSend)}onSimilarityFeedbackSubmit(e){if(!this.props.group.suggestions)return void c.Hv.sendTraceTag(590136729,d.n.msoulscat_Wac_Telemetry,u.k.Warning,"Unable to send feedback because we don't know what was reported, or we don't have any suggestions");if(!this.similarityFeedbackOptionChoiceGroupRef.current||!this.similarityFeedbackOptionChoiceGroupRef.current.checkedOption)return void c.Hv.sendTraceTag(590136730,d.n.msoulscat_Wac_Telemetry,u.k.Warning,"Unable to send feedback because apparently no option radio was selected");const t=this.similarityFeedbackOptionChoiceGroupRef.current.checkedOption.key,i=this.similarityCommentsTextBoxRef.current&&this.similarityCommentsTextBoxRef.current.value?this.similarityCommentsTextBoxRef.current.value:void 0,o=this.state.similarityShareCitedContentCheckbox?this.getUserTextToSend():void 0,r=this.state.similarityShareCitedContentCheckbox?this.getDomainFromUrl(this.props.group.url):void 0;this.onAction(null,zr.Report,Pr.Try,this.props.group,void 0,void 0,JSON.stringify({option:t,comments:i,snippet:o,url:r})),this.setState({similarityState:ds.Confirmation})}renderSimilarSourcesFooter(){return C.createElement("div",{key:"footer",style:this.props.styleProvider.footerDialogStyles},C.createElement("div",null,C.createElement(ss.Y,{text:this.props.resources.BackButton,styles:this.props.styleProvider.similaritySourceBackButtonStyles,onClick:this.onSimilaritySourceCancel})))}renderSimilarityFooter(){switch(this.state.similarityState){case ds.Default:return this.renderDefaultFooter();case ds.DisplayingSimilarSources:return this.renderSimilarSourcesFooter();case ds.DisplayingFeedbackOptions:case ds.Confirmation:const e=this.state.similarityState===ds.DisplayingFeedbackOptions,t=this.state.similarityState===ds.DisplayingFeedbackOptions,i=this.state.similarityState===ds.DisplayingFeedbackOptions,o=this.state.similarityState!==ds.Confirmation,r=this.state.similarityState===ds.DisplayingFeedbackOptions,n=this.state.similarityState===ds.Confirmation;return C.createElement("div",{key:"footer",style:this.props.styleProvider.footerDialogStyles},e?C.createElement(gs.g,{ref:this.similarityCommentsTextBoxRef,id:"commentsBox",type:"AppInputProps",label:this.props.resources.NeuralRewriteFeedbackDialogTextBoxPlaceholder,hideLabel:!0,placeholder:this.props.resources.NeuralRewriteFeedbackDialogTextBoxPlaceholder,styles:this.props.styleProvider.rewriteCommentsBoxStyles,multiline:!0,resizable:!1,disabled:!this.state.similarityChoiceGroupSelected}):null,t?C.createElement(C.Fragment,null,C.createElement(es.S,{label:this.props.resources.SimilarityFeedbackIncludeDocumentTextAndSourceUrl,checked:this.state.similarityShareCitedContentCheckbox,styles:this.props.styleProvider.includeCitedContentOptionStyles,onChange:this.onSimilarityShareCitedContentCheckbox}),C.createElement("div",{style:this.props.styleProvider.citationFeedbackContainerStyles},this.renderSnippetForFeedback(),this.renderCitationToBeShared())):null,i?this.renderPrivacyStatement():null,C.createElement("div",{style:this.props.styleProvider.footerDialogButtonGroupStyles},o?C.createElement(ss.Y,{text:this.props.resources.CancelButton,onClick:this.onSimilarityFeedbackCancel}):null,r?C.createElement(ns.j,{text:this.props.resources.SubmitButton,styles:this.props.styleProvider.footerDialogDefaultButtonStyle,onClick:this.onSimilarityFeedbackSubmit,disabled:!this.state.similarityChoiceGroupSelected}):null,n?C.createElement(ns.j,{text:this.props.resources.DoneButton,styles:this.props.styleProvider.footerDialogDefaultButtonStyle,onClick:this.onSimilarityFeedbackOkay,componentRef:this.similarityFeedbackReportOkayButtonRef}):null));default:return null}}renderFooter(){switch(this.props.group.type){case ps.neuralRewrite:return this.renderRewriteFooter();case ps.similarity:return this.renderSimilarityFooter();default:return this.renderDefaultFooter()}}onAction(e,t,i,o,r,n,s){super.onAction(e,t,i,o,r,n,s)}constructor(e){super(e),this.privacyStatementLabel=(0,us.G7)("IsO365CommercialHost")?this.props.resources.SuggestionFeedbackCommercialPrivacyNotice:this.props.resources.SuggestionFeedbackConsumerPrivacyNotice,this.handleSuggestionFocus=this.handleSuggestionFocus.bind(this),this.handleSuggestionBlur=this.handleSuggestionBlur.bind(this),this.onRewriteSelectFeedbackSuggestion=this.onRewriteSelectFeedbackSuggestion.bind(this),this.onRewriteSelectFeedbackOption=this.onRewriteSelectFeedbackOption.bind(this),this.onShowHideDescription=this.onShowHideDescription.bind(this),this.onShowHideSimilarText=this.onShowHideSimilarText.bind(this),this.onRewriteReportSuggestionCancel=this.onRewriteReportSuggestionCancel.bind(this),this.onRewriteReportSuggestionNext=this.onRewriteReportSuggestionNext.bind(this),this.onRewriteReportSuggestionSend=this.onRewriteReportSuggestionSend.bind(this),this.onRewriteReportSuggestionDone=this.onRewriteReportSuggestionDone.bind(this),this.onSimilaritySelectFeedbackOption=this.onSimilaritySelectFeedbackOption.bind(this),this.onSimilarityFeedbackCancel=this.onSimilarityFeedbackCancel.bind(this),this.onSimilarityFeedbackSubmit=this.onSimilarityFeedbackSubmit.bind(this),this.onSimilarityFeedbackOkay=this.onSimilarityFeedbackOkay.bind(this),this.onSimilarityShareCitedContentCheckbox=this.onSimilarityShareCitedContentCheckbox.bind(this),this.onSimilaritySourceDone=this.onSimilaritySourceDone.bind(this),this.onSimilaritySourceCancel=this.onSimilaritySourceCancel.bind(this),this.rewriteReportSuggestionsChoiceGroupRef=C.createRef(),this.rewriteFeedbackOptionChoiceGroupRef=C.createRef(),this.rewriteCommentsTextBoxRef=C.createRef(),this.rewriteReportDoneButtonRef=C.createRef(),this.similarityCommentsTextBoxRef=C.createRef(),this.similarityFeedbackOptionChoiceGroupRef=C.createRef(),this.similarityFeedbackReportOkayButtonRef=C.createRef(),this.similaritySourceOptionRef=Array.from({length:this.props.group.sources?.length??0},(()=>C.createRef())),this.state={showingContext:this.props.parameters.showSnippet,showingDescription:this.props.parameters.showDescription,hoveredSuggestionId:null,focusedSuggestionId:null,openSuggestionOverflowId:null,rewriteState:cs.Default,rewriteReportedSuggestionId:null,rewriteChoiceGroupSelected:!1,selectedCitationStyle:this.props.parameters.citationStyle?this.props.parameters.citationStyle:"MLA",similarityChoiceGroupSelected:!1,similarityState:ds.Default,similarityShareCitedContentCheckbox:!1,showingSimilarText:!1,similaritySelectedSource:"0"}}}ps.neuralRewrite="NeuralRewriteCritique",ps.similarity="PlagiarismCritique",ps.sensitiveContent="SensitiveContent",ps.neuralRewriteFeedbackOptionHelpful="Helpful",ps.neuralRewriteFeedbackOptionWrong="Wrong",ps.neuralRewriteFeedbackOptionOffensive="Offensive",ps.neuralRewriteFeedbackOptionOther="Other",ps.characterLimitForUserTextToSend=150,ps.neuralRewriteReportedSuggestions=[],ps.neuralRewriteDisabledSuggestions=[],ps.similarityFeedbackHelpfulLabel="Helpful",ps.similarityFeedbackWrongSourceLabel="WrongSource",ps.similarityFeedbackOffensiveLabel="Offensive",ps.similarityFeedbackOriginalContentLabel="OriginalContent",ps.similarityFeedbackOtherLabel="Other",ps.similarityBlockQuoteSuggestion="BlockQuotation",ps.similarityFullCitationSuggestions="FullCitation",ps.similarityInlineCitationSuggestions="InlineCitation";var hs=i(98264),ms=i(70898);const ys={fontFamily:T.V,fontSize:20,fontWeight:x.IT.SemiBold,lineHeight:28},bs={fontFamily:T.V,fontSize:12,fontWeight:x.IT.Normal,lineHeight:16},fs={fontFamily:T.V,fontSize:12,fontWeight:x.IT.Normal,lineHeight:16},Ss={fontFamily:T.V,fontSize:12,fontWeight:x.IT.SemiBold,lineHeight:16};var vs=i(68857);const Cs=e=>Object.assign(Object.assign({},ys),{fontFamily:vs.L.fontFamilyBase,cssColor:vs.L.colorNeutralForeground1}),xs=e=>Object.assign(Object.assign({},fs),{fontFamily:vs.L.fontFamilyBase,cssColor:vs.L.colorNeutralForeground1}),ks=e=>Object.assign(Object.assign({},Ss),{fontFamily:vs.L.fontFamilyBase,cssColor:vs.L.colorNeutralForeground1}),Ts=e=>Object.assign(Object.assign({},bs),{fontFamily:vs.L.fontFamilyBase,cssColor:vs.L.colorNeutralForeground1});function Is(e){return{color:vs.L.colorBrandForegroundLink,focusRing:e.focusRing}}function ws(e,t){return t<0||e.length<=t?e:e.substring(0,t).concat("…")}function As(e){const t=(e=(e=e.replace(/https:\/\//i,"")).replace(/http:\/\//i,"")).indexOf("/");return t>0?e.substring(0,t):e}function Ds(e){switch(e){case 9:case 10:case 11:case 13:case 32:case 160:case 8197:case 12288:case 65532:return!0}return!1}var Es=i(6842),Ms=i(8569),Ls=i(52324),Rs=i(50422),Os=i(60832),Fs=i(53001),Bs=i(55907),Ns=i(78266),js=i(24781),Hs=i(36769),Ps=i(29477),zs=i(41834);const Us=(0,Ps.X)({root:{mc9l5x:"f22iagw",Bt984gj:"f6jr5hl"},vertical:{Beiy3e4:"f1vx9l62"}},{d:[".f22iagw{display:flex;}",".f6jr5hl{align-items:flex-start;}",".f1vx9l62{flex-direction:column;}"]});var Ws=i(89705);const Gs=C.forwardRef(((e,t)=>{const i=((e,t)=>{e=(0,Os.c)(e);const i=(0,Fs.Bi)("radiogroup-"),{name:o=i,value:r,defaultValue:n,disabled:s,layout:a="vertical",onChange:l,required:c}=e;return{layout:a,name:o,value:r,defaultValue:n,disabled:s,required:c,components:{root:"div"},root:{ref:t,role:"radiogroup",...Bs.Gk((0,Ns.g)("div",e,["onChange","name"]),{elementType:"div"}),onChange:(0,js.D)((e=>{l&&(0,Hs.s)(e.target,{constructorName:"HTMLInputElement"})&&"radio"===e.target.type&&l(e,{value:e.target.value})}))}}})(e,t),o=(e=>{const{name:t,value:i,defaultValue:o,disabled:r,layout:n,required:s}=e,a=e.root["aria-describedby"];return{radioGroup:C.useMemo((()=>({name:t,value:i,defaultValue:o,disabled:r,layout:n,required:s,"aria-describedby":a})),[t,i,o,r,n,s,a])}})(i);return(e=>{const t=Us();e.root.className=(0,zs.z)("fui-RadioGroup",t.root,"vertical"===e.layout&&t.vertical,e.root.className)})(i),(0,Ws.$e)("useRadioGroupStyles_unstable")(i),((e,t)=>((0,Ls.C)(e),(0,Ms.Y)(Rs._5.Provider,{value:t.radioGroup,children:(0,Ms.Y)(e.root,{})})))(i,o)}));Gs.displayName="RadioGroup";var _s=i(19937);const qs=C.memo((0,C.forwardRef)(((e,t)=>{var i,o,r,n,s,a;const l=C.useRef(null),{findFirstFocusable:c}=(0,yt.r)();(0,C.useImperativeHandle)(t,(()=>({focus:d})));const d=()=>{var e;l.current&&(null===(e=c(l.current))||void 0===e||e.focus())},u=(0,Er.Zq)({paddingTop:null===(i=e.styles)||void 0===i?void 0:i.paddingTop,paddingBottom:null===(o=e.styles)||void 0===o?void 0:o.paddingBottom,paddingLeft:null===(r=e.styles)||void 0===r?void 0:r.paddingHorizontal,paddingRight:null===(n=e.styles)||void 0===n?void 0:n.paddingHorizontal,width:null===(s=e.styles)||void 0===s?void 0:s.width}),g=C.createElement(Gs,{ref:l,className:u,"aria-label":e.accessibilityLabel,onChange:(t,i)=>{const o=e.options.find((e=>e.key===i.value));e.onChange(o)},defaultValue:null===(a=e.defaultSelectedKey)||void 0===a?void 0:a.toString()},e.options.map((t=>(t=>{const i=!!e.radioChoiceTextStyles,o=C.createElement(nt.S,{direction:st.PR.LeftToRight,align:st.j5.Stretch},C.createElement(Lt.c,{text:t.text,style:e.radioChoiceTextStyles}));return C.createElement(Es.s,{key:t.key,value:t.key,disabled:t.disabled,id:t.key,"aria-label":t.accessibilityLabel||t.text,label:{children:i&&t?o:t.text}})})(t))));return e.label?C.createElement(_s.D,{label:e.label},g):g})));function Vs(e){return{background:{resting:e,disabled:"transparent"},border:"#D1D1D1",focusRing:"black",title:{resting:"transparent"}}}function Zs(e){return{background:{resting:e,disabled:"transparent"},border:"#D1D1D1",title:{resting:"transparent"}}}qs.displayName="RadioGroup";const Ks={marginHorizontal:16,marginTop:0,marginBottom:0},Ys={marginHorizontal:0,marginTop:2,marginBottom:0};k.R.Center;var Qs=i(68663),$s=i(35723);const Js=C.forwardRef(((e,t)=>{const i=C.useRef(null),o=C.useRef(null);C.useImperativeHandle(t,(()=>({focus:r})));const r=()=>{var t,r;e.multiline?null===(t=i.current)||void 0===t||t.focus():null===(r=o.current)||void 0===r||r.focus()},n={marginTop:e.styles.marginTop,marginBottom:e.styles.marginBottom,marginLeft:e.styles.marginLeft,marginRight:e.styles.marginRight,width:e.styles.width,borderRadius:`${e.styles.borderRadius}px !important`,borderWidth:`${e.styles.borderWidth}px !important`,borderColor:`${e.styles.borderColor}px !important`},s=(0,Er.Zq)(Object.assign(Object.assign({},n),{"& textarea":{minHeight:e.styles.height,height:e.styles.height}})),a=(0,Er.Zq)(Object.assign(Object.assign({},n),{"& input":{minHeight:e.styles.height,height:e.styles.height}}));return e.multiline?C.createElement(Qs.T,{ref:i,"aria-label":e.accessibilityLabel,className:s,placeholder:e.placeholder,onChange:(t,i)=>{var o;null===(o=e.onChange)||void 0===o||o.call(e,i.value)},resize:"none",disabled:e.disabled,defaultValue:e.defaultValue}):C.createElement($s.p,{className:a,"aria-label":e.accessibilityLabel,placeholder:e.placeholder,onChange:(t,i)=>{var o;null===(o=e.onChange)||void 0===o||o.call(e,i.value)},disabled:e.disabled,defaultValue:e.defaultValue,ref:o})}));Js.displayName="TextField";var Xs=i(7080);const ea=C.memo((e=>{var t,i,o,r;const{title:n,defaultChecked:s,onChange:a}=e,l=(0,Er.Zq)({"& label":{fontSize:null===(t=e.styles)||void 0===t?void 0:t.fontSize,fontFamily:null===(i=e.styles)||void 0===i?void 0:i.fontFamily,fontWeight:null===(o=e.styles)||void 0===o?void 0:o.fontWeight,cssColor:null===(r=e.styles)||void 0===r?void 0:r.cssColor}});return C.createElement(Xs.S,{label:n,className:l,defaultChecked:s,onChange:(e,t)=>{"boolean"==typeof t.checked&&(null==a||a(t.checked))}})}));var ta;ea.displayName="Checkbox",function(e){e[e.DisplayingFeedbackOptions=0]="DisplayingFeedbackOptions",e[e.Confirmation=1]="Confirmation"}(ta||(ta={}));class ia extends C.PureComponent{componentDidUpdate(e,t){if(e.definition!==this.props.definition&&this.setState({definition:this.props.definition}),t.feedbackState!==this.state.feedbackState)switch(this.state.feedbackState){case ta.DisplayingFeedbackOptions:this.feedbackOptionRadioGroupRef.current&&this.feedbackOptionRadioGroupRef.current.focus();break;case ta.Confirmation:this.reportDoneButtonRef.current&&this.reportDoneButtonRef.current.focus()}}render(){if(!this.getDefinition())return null;switch(this.state.feedbackState){case ta.DisplayingFeedbackOptions:return this.renderFeedback();case ta.Confirmation:return this.renderConfirmation()}}renderFeedback(){const e=this.getTheme(),t=this.getFontTable();return C.createElement(Mt,{disabled:this.props.disableInitialFocus},C.createElement(nt.S,{onKeyDown:this.onKeyDown,handledKeys:[rt.h.Escape]},C.createElement(Rt,{header:this.getHeaderText(),headerStyle:Cs(),componentStackStyle:this.props.style?{paddingHorizontal:this.props.style.paddingHorizontal,paddingVertical:this.props.style.paddingVertical,marginHorizontal:this.props.style.marginHorizontal,marginVertical:this.props.style.marginVertical}:W,stackDirection:st.PR.TopToBottom,stackAlignment:st.j5.Start},C.createElement(nt.S,{style:ie},C.createElement(Lt.c,{style:xs(),text:this.getSubHeaderText(),accessibilityRole:"text"})),C.createElement(nt.S,{align:st.j5.Stretch,accessibilityLabel:this.props.strings.feedback("similarityfeedbackOptionsAccessibilityLabel"),accessible:!0},this.renderFeedbackOptions()),C.createElement(nt.S,{justifyContent:st.Pr.SpaceBetween,style:Object.assign(Object.assign({},G),{width:this.props.style?this.props.style.minWidth:"100%"}),align:st.j5.Stretch},C.createElement(Js,{accessibilityLabel:this.props.strings.feedback("neuralRewriteFeedbackDialogTextBoxPlaceholder"),placeholder:this.props.strings.feedback("neuralRewriteFeedbackDialogTextBoxPlaceholder"),styles:J(this.getTheme()),theme:Ie(this.getTheme()),multiline:!0,onChange:this.onCommentChange}),C.createElement(nt.S,{justifyContent:st.Pr.SpaceBetween,style:V,align:st.j5.Stretch},this.props.showCheckbox&&C.createElement(ea,{title:this.getCheckboxLabel(),defaultChecked:this.state.includeCustomerContentData,onChange:this.onCheckboxClicked,styles:Z})),!this.props.hideSnippet&&C.createElement(nt.S,{justifyContent:st.Pr.SpaceBetween,style:(this.getTheme(),{paddingHorizontal:20,paddingVertical:16,backgroundColor:vs.L.colorNeutralBackground3}),align:st.j5.Stretch},this.renderSnippet(e,t)),C.createElement(nt.S,{justifyContent:st.Pr.SpaceBetween,style:q,align:st.j5.Stretch},C.createElement(Lt.c,{style:(this.getTheme(),Object.assign(Object.assign({},bs),{cssColor:vs.L.colorNeutralForeground3,marginEnd:2})),text:this.props.strings.feedback("suggestionFeedbackConsumerPrivacyNotice"),accessibilityRole:"text"}),C.createElement(Ct.R,{url:this.props.strings.feedback("neuralRewriteFeedbackDialogPrivacyStatementURL"),theme:Is(this.getTheme()),style:we(this.getFontTable()),text:this.props.strings.feedback("neuralRewriteFeedbackDialogPrivacyStatementLabel")})),this.renderFooterButtonOptions()))))}renderFooterButtonOptions(){switch(this.getDefinition().critiqueType){case Qe.NeuralRewrite:case Qe.Grammar:case Qe.Refinement:case Qe.WritersUnblock:return C.createElement(nt.S,{direction:st.PR.LeftToRight,justifyContent:st.Pr.SpaceBetween,style:Y},C.createElement(nt.S,{direction:st.PR.LeftToRight,justifyContent:st.Pr.Start},this.renderFooterButton(this.props.strings.common("backButton"),this.onBackToSelectionSuggestionReport)),C.createElement(nt.S,{direction:st.PR.LeftToRight,justifyContent:st.Pr.End},this.renderFooterButton(this.props.strings.common("cancelButton"),this.onFeedbackReportSuggestionCancel),C.createElement(nt.S,{style:{minWidth:this.getSpacing().xsmall}}),this.renderFooterButton(this.props.strings.common("submitButton"),this.onFeedbackReportSuggestionSend,this.shouldDisableSubmitButton(),!0)));case Qe.SimilarityChecker:case Qe.AccColorChecker:case Qe.AIFeedback:return C.createElement(nt.S,{direction:st.PR.LeftToRight,justifyContent:st.Pr.End,style:Y,align:st.j5.Stretch},this.renderFooterButton(this.props.strings.common("cancelButton"),this.onFeedbackReportSuggestionCancel),C.createElement(nt.S,{style:{minWidth:this.getSpacing().small}}),this.renderFooterButton(this.props.strings.common("submitButton"),this.onFeedbackReportSuggestionSend,!this.state.feedbackChoiceGroupSelected,!0));default:return}}renderConfirmation(){const e=this.getTheme(),t=this.getFontTable();return C.createElement(Rt,{header:this.getHeaderText(),componentStackStyle:this.props.style?{paddingHorizontal:this.props.style.paddingHorizontal,paddingVertical:this.props.style.paddingVertical,marginHorizontal:this.props.style.marginHorizontal,marginVertical:this.props.style.marginVertical}:ye,stackDirection:st.PR.TopToBottom,stackAlignment:st.j5.Stretch},C.createElement(Lt.c,{style:oe(e,t,{useFluentV9:!!this.context}),text:this.props.strings.feedback("similarityFeedbackConfirmationDialogSubTitle"),accessibilityRole:"text"}),C.createElement(nt.S,{direction:st.PR.LeftToRight,justifyContent:st.Pr.End,align:st.j5.Stretch},this.renderFooterButton(this.props.strings.common("doneButton"),this.onFeedbackReportSuggestionDone,!1,!0,this.reportDoneButtonRef)))}generateButtonProps(e,t){return{hoverRing:!1,style:{width:32,height:32,borderRadius:2,marginEnd:8,borderThickness:2},theme:Zs(e),tooltip:t,automationLabel:"ColorPickerButton"}}renderSnippet(e,t){const i=this.getDefinition();switch(i.critiqueType){case Qe.AccColorChecker:const o=(i.suggestions||[]).map((e=>C.createElement(vt.u,Object.assign({key:e.id},this.generateButtonProps(e.title,e.subtitle)))));return C.createElement(nt.S,{direction:st.PR.LeftToRight,align:st.j5.Start,justifyContent:st.Pr.Start,style:Ys},o);case Qe.SimilarityChecker:const r=oe(e,t,{useFluentV9:!!this.context});return C.createElement(nt.S,{direction:st.PR.TopToBottom,justifyContent:st.Pr.SpaceBetween,align:st.j5.Stretch},this.props.definition.sourceSnippet?C.createElement(Lt.c,{style:r,text:ws(this.props.definition.sources&&this.props.sourceIndex?this.props.definition.sources[this.props.sourceIndex].sourceSnippet:this.props.definition.sourceSnippet,ia.snippetMaxLength),accessibilityRole:"text"}):null,this.props.definition.sourceUrl?C.createElement(Lt.c,{style:r,text:As(this.props.definition.sources&&this.props.sourceIndex?this.props.definition.sources[this.props.sourceIndex].sourceUrl:this.props.definition.sourceUrl),accessibilityRole:"text"}):null);case Qe.NeuralRewrite:case Qe.Grammar:case Qe.Refinement:case Qe.AIFeedback:const n=this.props.strings.feedback("originalSentenceLabel"),s=i.contextText,a=this.getSuggestionLabel(),l=this.getReportedSuggestionText(this.props.reportedSuggestionIndex);return C.createElement(nt.S,{direction:st.PR.TopToBottom,justifyContent:st.Pr.SpaceBetween,align:st.j5.Stretch},n&&C.createElement(Lt.c,{style:ks(),text:ws(n,ia.snippetMaxLength),accessibilityRole:"text"}),s&&C.createElement(Lt.c,{style:Ts(),text:ws(s,ia.snippetMaxLength),accessibilityRole:"text"}),a&&C.createElement(nt.S,{style:K},C.createElement(Lt.c,{style:ks(),text:a,accessibilityRole:"text"})),l&&C.createElement(Lt.c,{style:Ts(),text:l.title,accessibilityRole:"text"}));default:return C.createElement(C.Fragment,null)}}getFeedbackOptions(){switch(this.getDefinition().critiqueType){case Qe.AccColorChecker:return[{key:ia.FeedbackOptionHelpful,text:this.props.strings.feedback("accColorsFeedbackHelpfulLabel")},{key:ia.FeedbackOptionNotHelpful,text:this.props.strings.feedback("accColorsFeedbackNotHelpfulLabel")},{key:ia.FeedbackOptionOther,text:this.props.strings.feedback("accColorsFeedbackOtherLabel")}];case Qe.SimilarityChecker:return[{key:ia.FeedbackOptionHelpful,text:this.props.strings.feedback("similarityFeedbackHelpfulLabel")},{key:ia.FeedbackOptionWrongSource,text:this.props.strings.feedback("similarityFeedbackWrongSourceLabel")},{key:ia.FeedbackOptionOriginal,text:this.props.strings.feedback("similarityFeedbackOriginalContentLabel")},{key:ia.FeedbackOptionOffensive,text:this.props.strings.feedback("similarityFeedbackOffensiveContentLabel")},{key:ia.FeedbackOptionOther,text:this.props.strings.feedback("similarityFeedbackOtherLabel")}];case Qe.NeuralRewrite:case Qe.Refinement:case Qe.Grammar:case Qe.AIFeedback:return[{key:ia.FeedbackOptionHelpful,text:this.props.strings.feedback("suggestionFeedbackHelpfulLabel")},{key:ia.FeedbackOptionWrong,text:this.props.strings.feedback("suggestionFeedbackWrongLabel")},{key:ia.FeedbackOptionOffensive,text:this.props.strings.feedback("suggestionFeedbackOffensiveLabel")}];case Qe.WritersUnblock:return[{key:ia.FeedbackOptionHelpful,text:this.props.strings.feedback("suggestionFeedbackHelpfulLabel")},{key:ia.FeedbackOptionFactuallyIncorrect,text:this.props.strings.feedback("suggestionFeedbackFactuallyIncorrectLabel")},{key:ia.FeedbackOptionOffensive,text:this.props.strings.feedback("suggestionFeedbackOffensiveLabel")}];default:return[]}}renderFeedbackOptions(){return C.createElement(qs,{ref:this.feedbackOptionRadioGroupRef,onChange:this.onSelectFeedbackOption,options:this.getFeedbackOptions()})}renderFooterButton(e,t,i,o,r){return C.createElement(vt.u,{title:e,titleStyle:ve(this.getFontTable(),e.length),onClick:t,theme:he(this.getTheme(),o),disabled:i,style:U,ref:r,automationLabel:`CritiqueActionButton_${e}`})}getCheckboxLabel(){switch(this.getDefinition().critiqueType){case Qe.SimilarityChecker:return this.props.strings.feedback("similarityFeedbackIncludeDocumentTextAndSourceUrl");case Qe.NeuralRewrite:case Qe.Refinement:case Qe.AIFeedback:return this.props.strings.feedback("neuralRewriteFeedbackDialogCheckboxLabel");case Qe.Grammar:return this.props.strings.feedback("grammarFeedbackDialogCheckboxLabel");case Qe.WritersUnblock:return this.props.strings.feedback("writersUnblockDialogCheckboxLabel");default:return"unknown"}}getFeedbackHeaderLabel(){switch(this.getDefinition().critiqueType){case Qe.AccColorChecker:return this.props.strings.feedback("provideAccColorsFeedbackHeaderText");case Qe.SimilarityChecker:return this.props.strings.feedback("provideFeedbackHeaderText");case Qe.NeuralRewrite:case Qe.Refinement:case Qe.AIFeedback:return this.props.strings.feedback("neuralRewriteFeedbackDialogChooseOptionTitle");case Qe.Grammar:return this.props.strings.feedback("grammarFeedbackDialogChooseOptionTitle");case Qe.WritersUnblock:return this.props.strings.feedback("writersUnblockFeedbackDialogChooseOptionTitle");default:return"unknown"}}getConfirmationHeaderLabel(){switch(this.getDefinition().critiqueType){case Qe.AccColorChecker:case Qe.SimilarityChecker:return this.props.strings.feedback("similarityFeedbackConfirmationDialogTitle");case Qe.NeuralRewrite:case Qe.Refinement:case Qe.AIFeedback:return this.props.strings.feedback("neuralRewriteFeedbackConfirmationDialogTitle");case Qe.Grammar:return this.props.strings.feedback("grammarFeedbackConfirmationDialogTitle");case Qe.WritersUnblock:return this.props.strings.feedback("writersUnblockFeedbackConfirmationDialogTitle");default:return"unknown"}}getSubHeaderLabel(){switch(this.getDefinition().critiqueType){case Qe.AccColorChecker:return this.props.strings.feedback("accColorsFeedbackDialogChooseOptionTitle");case Qe.SimilarityChecker:return this.props.strings.feedback("similarityFeedbackDialogChooseOptionTitle");case Qe.NeuralRewrite:case Qe.Refinement:case Qe.AIFeedback:return this.props.strings.feedback("neuralRewriteFeedbackDialogDescription");case Qe.Grammar:return this.props.strings.feedback("grammarFeedbackDialogDescription");case Qe.WritersUnblock:return this.props.strings.feedback("writersUnblockFeedbackDialogDescription");default:return"unknown"}}getSuggestionLabel(){switch(this.getDefinition().critiqueType){case Qe.NeuralRewrite:case Qe.Refinement:case Qe.AIFeedback:return ws(this.props.strings.feedback("rewriteSuggestionLabel"),ia.snippetMaxLength);case Qe.Grammar:return ws(this.props.strings.feedback("grammarSuggestionLabel"),ia.snippetMaxLength);default:return"unknown"}}getSubHeaderConfirmationLabel(){switch(this.getDefinition().critiqueType){case Qe.SimilarityChecker:return this.props.strings.feedback("similarityFeedbackConfirmationDialogSubTitle");case Qe.NeuralRewrite:case Qe.Refinement:case Qe.AIFeedback:return this.props.strings.feedback("neuralRewriteFeedbackDialogDescription");case Qe.Grammar:return this.props.strings.feedback("grammarFeedbackDialogDescription");case Qe.WritersUnblock:return this.props.strings.feedback("writersUnblockFeedbackConfirmationDialogSubTitle");default:return"unknown"}}getHeaderText(){switch(this.state.feedbackState){case ta.DisplayingFeedbackOptions:return this.getFeedbackHeaderLabel();case ta.Confirmation:return this.getConfirmationHeaderLabel()}}getSubHeaderText(){switch(this.state.feedbackState){case ta.DisplayingFeedbackOptions:return this.getSubHeaderLabel();case ta.Confirmation:return this.getSubHeaderConfirmationLabel()}}onSelectFeedbackOption(e){e&&this.setState({feedbackId:e.key,feedbackChoiceGroupSelected:!0})}onFeedbackReportSuggestionDone(){this.setState({feedbackChoiceGroupSelected:!1}),this.props.onDismiss&&this.props.onDismiss()}onFeedbackReportSuggestionCancel(){this.onFeedbackReportSuggestionDone()}onCommentChange(e){this.commentText=e||""}onCheckboxClicked(e){this.setState({includeCustomerContentData:e})}getPayload(){const e=this.getDefinition(),t=this.state.includeCustomerContentData;switch(e.critiqueType){case Qe.SimilarityChecker:return[this.commentText||"undefined",this.state.feedbackId||"undefined",t&&this.props.definition.sourceSnippet?As(this.props.definition.sourceSnippet):"undefined",t&&this.props.definition.sourceUrl?As(this.props.definition.sourceUrl):"undefined",this.state.feedbackId||"undefined"];case Qe.NeuralRewrite:case Qe.Refinement:case Qe.Grammar:case Qe.AIFeedback:const i=this.props.reportedSuggestionIndex,o=e.suggestions&&void 0!==i&&-1!==i?e.suggestions[i]:void 0;return[this.commentText||"",this.state.feedbackId||"",t&&e.contextText?e.contextText:"",t&&o?o.title:""];case Qe.WritersUnblock:return[this.commentText||"undefined",this.state.feedbackId||"undefined",t&&this.props.definition.sourceSnippet||"undefined",t&&this.props.definition.contextText||"undefined",this.state.feedbackId||"undefined"];case Qe.AccColorChecker:return[this.commentText||"undefined",this.state.feedbackId||"undefined"];default:return[]}}onFeedbackReportSuggestionSend(){if(this.state.feedbackId){if(this.props.onReport){const e=this.getPayload();this.props.onReport({action:"feedback",option:this.state.feedbackId,type:this.state.definition.critiqueType,payload:{comment:e}},0)}this.setState({feedbackState:ta.Confirmation,feedbackChoiceGroupSelected:!1})}}onBackToSelectionSuggestionReport(){this.props.onBack&&this.props.onBack()}onKeyDown(e){e.key===rt.h.Escape&&this.props.onBack&&this.props.onBack()}getDefinition(){return this.state.definition}getTheme(){var e;return null!==(e=this.props.theme)&&void 0!==e?e:this.context?D:A}getFontTable(){return this.props.fontTable?this.props.fontTable:E}getSpacing(){return this.props.spacing?this.props.spacing:M}getReportedSuggestionText(e){const t=this.props.definition;return t.suggestions&&void 0!==e&&-1!==e?t.suggestions[e]:void 0}shouldDisableSubmitButton(){switch(this.getDefinition().critiqueType){case Qe.NeuralRewrite:case Qe.Grammar:case Qe.Refinement:case Qe.AIFeedback:return!this.state.feedbackChoiceGroupSelected||this.state.feedbackId!==ia.FeedbackOptionHelpful&&!this.state.includeCustomerContentData;case Qe.SimilarityChecker:case Qe.WritersUnblock:default:return!this.state.feedbackChoiceGroupSelected}}constructor(e){super(e),this.feedbackOptionRadioGroupRef=C.createRef(),this.reportDoneButtonRef=C.createRef(),this.onSelectFeedbackOption=this.onSelectFeedbackOption.bind(this),this.onCheckboxClicked=this.onCheckboxClicked.bind(this),this.onBackToSelectionSuggestionReport=this.onBackToSelectionSuggestionReport.bind(this),this.onFeedbackReportSuggestionCancel=this.onFeedbackReportSuggestionCancel.bind(this),this.onFeedbackReportSuggestionSend=this.onFeedbackReportSuggestionSend.bind(this),this.onFeedbackReportSuggestionDone=this.onFeedbackReportSuggestionDone.bind(this),this.onCommentChange=this.onCommentChange.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.state={definition:e.definition,feedbackState:ta.DisplayingFeedbackOptions,feedbackId:void 0,feedbackChoiceGroupSelected:!1,includeCustomerContentData:!1}}}function oa(e,t){return e.hover?t?Object.assign(Object.assign({},e),{resting:e.hover}):Object.assign(Object.assign({},e),{hover:void 0}):e}function ra(e,t){return Object.assign(Object.assign({},e),{resting:t,hover:void 0})}function na(e,t,i,o){return Object.assign(Object.assign({},e),{background:t&&t.splitMenuHoverBackground&&i&&o?ra(e.background,t.splitMenuHoverBackground):oa(e.background,i),title:t&&t.splitMenuHoverForeground&&i&&o?ra(e.title,t.splitMenuHoverForeground):oa(e.title,i),icon:t&&t.splitMenuHoverForeground&&i&&o?ra(e.icon,t.splitMenuHoverForeground):e.icon&&oa(e.icon,i)})}function sa(e){var t;return null!==(t=null==e?void 0:e.borderThickness)&&void 0!==t?t:1}function aa(e){var t;return null!==(t=null==e?void 0:e.borderRadius)&&void 0!==t?t:0}function la(e){return!(!e.menuProps||!e.menuProps.items)&&e.menuProps.items.length>0}ia.snippetMaxLength=150,ia.FeedbackOptionHelpful="Helpful",ia.FeedbackOptionNotHelpful="NotHelpful",ia.FeedbackOptionWrong="Wrong",ia.FeedbackOptionFactuallyIncorrect="Hallucination",ia.FeedbackOptionWrongSource="WrongSource",ia.FeedbackOptionOriginal="Original",ia.FeedbackOptionOffensive="Offensive",ia.FeedbackOptionOther="Other",ia.contextType=ot.O;class ca extends C.PureComponent{static shouldShowHighlight(e,t){return e.buttonHover||e.overflowHover||e.menuOpened||!t&&void 0!==e.highlightTimeout}static shouldSetHighlightTimerForEvent(e){return"buttonHover"===e||"overflowHover"===e}static shouldShowOverflow(e,t){return e.buttonHover||e.buttonFocus||e.overflowHover||e.overflowFocus||e.menuOpened||!t&&void 0!==e.overflowTimeout}static isSplitButtonEntered(e){return e.buttonHover||e.buttonFocus||e.overflowHover||e.overflowFocus||e.menuOpened}static setTimerHighlightedInstance(e){this.timerHighlightedInstance!==e&&(void 0!==e&&void 0!==this.timerHighlightedInstance&&void 0!==this.timerHighlightedInstance.state.highlightTimeout&&this.timerHighlightedInstance.cancelUnhighlightTimer(!1),this.timerHighlightedInstance=e)}render(){var e,t;const i=this.props.style,o={marginHorizontal:null==i?void 0:i.marginHorizontal,marginVertical:null==i?void 0:i.marginVertical,flexibleSize:null==i?void 0:i.flexibleSize,height:null==i?void 0:i.height,minHeight:null==i?void 0:i.minHeight,maxHeight:null==i?void 0:i.maxHeight},r=this.context;if(this.drawBorderOnRoot()&&!r){const i=null!==(e=this.props.buttonProps.theme)&&void 0!==e?e:so.G7;o.borderColor=null!==(t=i.border)&&void 0!==t?t:ca.shouldShowHighlight(this.state)?i.background.hover:i.background.resting,o.borderStyle="solid",o.borderWidth=sa(this.props.style),o.borderRadius=aa(this.props.style)}return C.createElement(nt.S,{direction:st.PR.LeftToRight,align:st.j5.Stretch,style:o},C.createElement(vt.u,Object.assign({ref:this.buttonRef},this.computeButtonProps())),la(this.props)?C.createElement(So,Object.assign({},this.computeOverflowMenuProps())):null)}focus(){this.buttonRef.current&&this.buttonRef.current.focus()}componentWillUnmount(){ca.timerHighlightedInstance===this&&ca.setTimerHighlightedInstance(void 0),this.cancelOverflowTimer(!1),this.cancelUnhighlightTimer(!1),super.componentWillUnmount&&super.componentWillUnmount()}cancelOverflowTimer(e){void 0!==this.state.overflowTimeout&&(clearTimeout(this.state.overflowTimeout),e||this.setState({overflowTimeout:void 0}))}cancelUnhighlightTimer(e){void 0!==this.state.highlightTimeout&&(clearTimeout(this.state.highlightTimeout),e||this.setState({highlightTimeout:void 0}))}computeButtonProps(){var e;const t=this.context,i=sa(this.props.style),o=aa(this.props.style),r=Object.assign(Object.assign({},this.props.style),{paddingEnd:i,borderRadius:{topStart:o,bottomStart:o}});la(this.props)||(r.borderRadius={topStart:o,topEnd:o,bottomStart:o,bottomEnd:o}),this.drawBorderOnRoot()||t?r.borderThickness=0:r.borderThickness={start:i,top:i,bottom:i},this.props.menuProps||delete r.paddingEnd,delete r.marginHorizontal,delete r.marginVertical,delete r.height,delete r.minHeight,delete r.maxHeight;const n=this.props.buttonProps,s=(null==n?void 0:n.icon)?null==n?void 0:n.icon:void 0,a=function(e,t){return Object.assign(Object.assign({},e),{background:oa(e.background,t),title:oa(e.title,t),subtitle:e.subtitle&&oa(e.subtitle,t),icon:e.icon&&oa(e.icon,t)})}(null!==(e=n.theme)&&void 0!==e?e:t?so.$C:so.G7,ca.shouldShowHighlight(this.state)),l=function(e,t){if(null!=e)return e.map((e=>{const i=Object.assign({},e);return t&&i.cssColorHover&&(i.cssColor=i.cssColorHover),i}))}(n.titleStyle,ca.shouldShowHighlight(this.state));return Object.assign(Object.assign({},n),{titleStyle:l,appearance:"subtle",icon:s,style:r,theme:a,tooltipProps:this.props.layerHostId?{layerHostId:this.props.layerHostId}:void 0,onHoverIn:this.onButtonHoverIn,onHoverOut:this.onButtonHoverOut,onFocus:this.onButtonFocus,onBlur:this.onButtonBlur,accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilitySetSize:this.props.accessibilitySetSize})}computeOverflowMenuProps(){var e;const t=sa(this.props.style),i=aa(this.props.style),o={paddingStart:t,borderRadius:{topEnd:i,bottomEnd:i}},r=this.context;this.drawBorderOnRoot()||r?o.borderThickness=0:o.borderThickness={top:t,end:t,bottom:t};const n=this.props.menuProps,s=null!==(e=n.theme)&&void 0!==e?e:r?so.$C:so.G7;return Object.assign(Object.assign({},n),{icon:{type:"Overflow",filled:!0},icons:{regular:_t.mmJ,filled:_t.aKh},hidden:!ca.shouldShowOverflow(this.state),style:o,theme:na(s,this.props.theme,ca.shouldShowHighlight(this.state),this.state.overflowHover||this.state.menuOpened),accessibilityLabel:(a=this.props,a.menuProps&&a.menuProps.accessibilityLabel?a.menuProps.accessibilityLabel:a.buttonProps.title&&a.strings&&a.strings.defaultSplitButtonOverflowAccessibilityLabel?a.strings.defaultSplitButtonOverflowAccessibilityLabel.replace("{0}",a.buttonProps.title):void 0),accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilitySetSize:this.props.accessibilitySetSize,layerHostId:this.props.layerHostId,onHoverIn:this.onOverflowHoverIn,onHoverOut:this.onOverflowHoverOut,onFocus:this.onOverflowFocus,onBlur:this.onOverflowBlur,onMenuOpen:this.onMenuOpened,onMenuDismiss:this.onMenuDismissed});var a}setOverflowTimer(){if(!(ca.hideOverflowLagInMs<=0))return this.cancelOverflowTimer(!0),setTimeout((()=>{this.setState({overflowTimeout:void 0})}),ca.hideOverflowLagInMs)}setUnhighlightTimer(){if(!(ca.unhoverLagInMs<=0))return this.cancelUnhighlightTimer(!0),setTimeout((()=>{ca.timerHighlightedInstance===this&&ca.setTimerHighlightedInstance(void 0),this.setState({highlightTimeout:void 0})}),ca.unhoverLagInMs)}handleEvent(e,t){ca.shouldSetHighlightTimerForEvent(e)&&t&&ca.setTimerHighlightedInstance(this),this.setState((i=>{var o,r,n,s;if(i[e]===t)return;const a=Object.assign({},i);a[e]=t,t&&("overflowHover"===e&&(a.buttonHover=!1),"buttonHover"===e&&(a.overflowHover=!1)),a.highlightTimeout=ca.shouldShowHighlight(i)&&!ca.shouldShowHighlight(a)?this.setUnhighlightTimer():void 0,a.overflowTimeout=ca.shouldShowOverflow(i)&&!ca.shouldShowOverflow(a)?this.setOverflowTimer():void 0;const l=ca.isSplitButtonEntered(i),c=ca.isSplitButtonEntered(a);return!l&&c?null===(r=(o=this.props.buttonProps).onSplitButtonIn)||void 0===r||r.call(o):l&&!c&&(null===(s=(n=this.props.buttonProps).onSplitButtonOut)||void 0===s||s.call(n)),a}))}drawBorderOnRoot(){return!this.props.menuProps||!ca.shouldShowOverflow(this.state)}constructor(e){super(e),this.state={buttonHover:!1,buttonFocus:!1,overflowHover:!1,overflowFocus:!1,menuOpened:!1,overflowTimeout:void 0,highlightTimeout:void 0},this.buttonRef=C.createRef(),this.onButtonHoverIn=this.handleEvent.bind(this,"buttonHover",!0),this.onButtonHoverOut=this.handleEvent.bind(this,"buttonHover",!1),this.onButtonFocus=this.handleEvent.bind(this,"buttonFocus",!0),this.onButtonBlur=this.handleEvent.bind(this,"buttonFocus",!1),this.onOverflowHoverIn=this.handleEvent.bind(this,"overflowHover",!0),this.onOverflowHoverOut=this.handleEvent.bind(this,"overflowHover",!1),this.onOverflowFocus=this.handleEvent.bind(this,"overflowFocus",!0),this.onOverflowBlur=this.handleEvent.bind(this,"overflowFocus",!1),this.onMenuOpened=this.handleEvent.bind(this,"menuOpened",!0),this.onMenuDismissed=this.handleEvent.bind(this,"menuOpened",!1)}}function da(e){return function(e,t){return!!e.settings&&"true"===e.settings.RefactorToGetRewriteNudgeInCritiqueV2}(e)}ca.hideOverflowLagInMs=5,ca.unhoverLagInMs=5,ca.timerHighlightedInstance=void 0,ca.contextType=ot.O;const ua=(e,t,i,o,r,n,s)=>{const a=e.suggestionKind?e.suggestionKind(t):void 0,l=e.definition,c=t.title,d=c.length,u=Ki(l,o,t),g=zi(l,e.strings,r,u,o,i),p=void 0!==n?{type:n}:void 0,h={title:c,titleStyle:void 0!==a&&o!==Je.MoreSources?be(e.fontTable||E,d):(0,Dt.S)(d,r,t.titleDecorations),tag:t.tag,tagStyle:fe(e.fontTable||E),icon:p,disabled:u,onClick:()=>{var t;null===(t=e.onAction)||void 0===t||t.call(e,o,i)},theme:ge(r,a),strings:Bi(e.strings.common),accessibilityRole:"menuitem",accessibilityLabel:e.suggestionAccessibilityLabel&&e.suggestionAccessibilityLabel(t),automationLabel:"CritiqueSuggestionButton_"+t.id,badgeProps:g,uiAnchorId:s};return((e,t)=>!!(Qi(e,Je.Accept,t)&&e.showDescription&&t.subtitle&&t.subtitle.length>0))(e.definition,t)&&(h.subtitle=t.subtitle,h.subtitleStyle=Ee(e.fontTable||E)),h},ga=(e,t,i,o,r,n,s,a)=>C.createElement(ca,{key:i,ref:t,buttonProps:o,menuProps:n,style:j,theme:{splitMenuHoverBackground:r.suggestionMenuHoverBackground,splitMenuHoverForeground:r.suggestionMenuHoverForeground},strings:ji(e.strings.common),accessibilityPositionInSet:void 0!==s?s:1,accessibilitySetSize:void 0!==a?a:1,layerHostId:e.layerHostId});function pa(e,t,i,o,r){const n=Ui(i);return n.map(((s,a)=>{const l=ga(e,0===a?t:void 0,a,ua(e,s,a,Je.Accept,o,e.suggestionIcon?e.suggestionIcon(s):void 0),o,Hi(i,o,e.strings,e.fontTable||E,e.suggestionOverflowActions||[],!(!e.settings||"true"!==e.settings.NoTooltipForFooterOverflow),void 0,a,e.automationId,e.layerHostId,e.onAction),a+1,n.length+(null!=r?r:0));return a>0&&s.tag!==n[a-1].tag?C.createElement(C.Fragment,null,C.createElement(ho.w,{key:a,color:e.theme&&e.theme.separator,style:ee}),l):l}))}const ha=(e,t,i,o,r,n,s,a,l,c,d)=>ga(e,0===i?t:void 0,i,ua(e,{title:o,actions:s?[]:[r]},i,r,n,a,d),n,void 0,l,c),ma=C.forwardRef(((e,t)=>{const i=e.definition,o=C.useContext(ot.O),r=Fe(e,o),n=pa(e,t,i,r);return 0===n.length?ha(e,t,0,e.noSuggestionsLabel||e.strings.common("suggestionsGroupNoSuggestionsText"),Je.Accept,r,!0):C.createElement(C.Fragment,null,n)}));ma.displayName="Suggestions";const ya=C.forwardRef(((e,t)=>{const i=e.suggestionsGroupAriaLabel;let o;o=da(e)?e.getCustomSuggestions&&t?e.getCustomSuggestions(e,t):void 0:e.customSuggestions;const r=null!=o?o:C.createElement(ma,Object.assign({},e,{ref:t}));return C.createElement(nt.S,{align:st.j5.Stretch,accessible:!0,accessibilityRole:"menu",accessibilityLabel:i},r)}));ya.displayName="BodySuggestions";const ba=(e,t)=>({suggestionKind:e=>{if(!(e.titleDecorations&&e.titleDecorations.length>0))return"suggestion"},suggestionOverflowActions:[],suggestionsGroupAriaLabel:e.strings.critique("suggestionsGroupAccessibilityLabel"),suggestionAccessibilityLabel:t=>{const i=e.definition,o=t.tagAccessibilityLabel||t.tag||"";return i.showDescription&&t.subtitle&&0!==t.subtitle.trim().length?e.strings.critique("neuralRewriteSuggestionAccessibilityLabel").replace("{0}",t.title).replace("{1}",t.subtitle):o?e.strings.critique("suggestionWithTagAccessibilityLabel").replace("{0}",o).replace("{1}",t.title):""},customBody:e.definition.isContentPending?C.createElement(ft,null,C.createElement(To,{key:0,shimmerCount:3,styles:Me(e.spacing||M),render:()=>ha(e,void 0,0,e.strings.common("suggestionsGroupLoadingSuggestionsText"),Je.Accept,Fe(e,!!(null==t?void 0:t.useFluentV9)),!0)})):void 0}),fa=C.forwardRef(((e,t)=>{var i;const o=e.definition,r=C.useContext(ot.O),n=Fe(e,r),s=pa(e,t,o,n,1);let a=s.length+1;return 0===s.length&&(s.push(ha(e,t,0,e.noSuggestionsLabel||e.strings.common("suggestionsGroupNoSuggestionsText"),Je.Accept,n,!0)),a-=1),s.push(((e,t,i,o,r,n,s)=>{const a={title:o,actions:[Je.LaunchAIRewrite]},l={title:o,titleStyle:be(e.fontTable||E,o.length),tag:void 0,tagStyle:fe(e.fontTable||E),icon:{type:"ColorfulCopilot"},disabled:!1,onClick:()=>{var t;null===(t=e.onAction)||void 0===t||t.call(e,Je.LaunchAIRewrite,i)},onSplitButtonIn:()=>{var t;null===(t=e.onAction)||void 0===t||t.call(e,Je.LaunchAIRewriteHoverIn,i)},onSplitButtonOut:()=>{var t;null===(t=e.onAction)||void 0===t||t.call(e,Je.LaunchAIRewriteHoverOut,i)},theme:ge(r,"suggestion"),strings:Bi(e.strings.common),accessibilityRole:"menuitem",accessibilityLabel:e.suggestionAccessibilityLabel&&e.suggestionAccessibilityLabel(a),automationLabel:"CritiqueSuggestionButton_"+a.id};return C.createElement(ca,{key:i,ref:t,buttonProps:l,menuProps:void 0,style:j,theme:{splitMenuHoverBackground:r.suggestionMenuHoverBackground,splitMenuHoverForeground:r.suggestionMenuHoverForeground},strings:ji(e.strings.common),accessibilityPositionInSet:void 0!==n?n:1,accessibilitySetSize:void 0!==s?s:1,layerHostId:e.layerHostId})})(e,0===s.length?t:void 0,s.length,null!==(i=o.aIRewriteButtonText)&&void 0!==i?i:e.strings.critique("defaultCritiqueAIRewriteText"),n,a,a)),C.createElement(C.Fragment,null,s)}));function Sa(e){return null!=e.showAIRewriteNudgeForCritiqueType&&e.showAIRewriteNudgeForCritiqueType.length>0&&e.showAIRewriteNudgeForCritiqueType.includes(e.critiqueType)}function va(e,t){var i;return C.createElement(fa,Object.assign({},e,{ref:null!==(i=e.firstSuggestionRef)&&void 0!==i?i:t}))}function Ca(e,t){var i;const r=Object.assign(Object.assign(Object.assign({},e),ba(e,t)),{definition:Object.assign(Object.assign({},e.definition),{header:e.strings.critique("grammarCardHeader")}),suggestionOverflowActions:[Zt,si,di],suggestionKind:()=>"grammar",suggestionIcon:()=>e.critiqueSource===o.Inference?"Cloud":void 0});if(da(e))r.getCustomSuggestions=Sa(e.definition)?va:void 0;else{const t=C.createRef(),o=null!=e.definition.showAIRewriteNudgeForCritiqueType&&e.definition.showAIRewriteNudgeForCritiqueType.length>0&&e.definition.showAIRewriteNudgeForCritiqueType.includes(e.definition.critiqueType);r.customSuggestions=o?C.createElement(fa,Object.assign({},r,{ref:null!==(i=r.firstSuggestionRef)&&void 0!==i?i:t})):void 0}return r}function xa(e,t){var i;const o=Object.assign(Object.assign(Object.assign({},e),ba(e,t)),{suggestionOverflowActions:[Zt,si,di],suggestionKind:()=>"refinement"});if(da(e))o.getCustomSuggestions=Sa(e.definition)?va:void 0;else{const t=C.createRef(),r=null!=e.definition.showAIRewriteNudgeForCritiqueType&&e.definition.showAIRewriteNudgeForCritiqueType.length>0&&e.definition.showAIRewriteNudgeForCritiqueType.includes(e.definition.critiqueType);o.customSuggestions=r?C.createElement(fa,Object.assign({},o,{ref:null!==(i=o.firstSuggestionRef)&&void 0!==i?i:t})):void 0}return o}fa.displayName="AIRewriteSuggestions";const ka=e=>C.createElement(nt.S,{direction:st.PR.LeftToRight,style:Oe,align:st.j5.Stretch},C.createElement(Ct.R,{text:e.text,url:e.url,theme:Le(e.theme),style:Re(e.fontTable)}));function Ta(e){return{paddingHorizontal:w,paddingVertical:9,backgroundColor:e.addOnFooterBackground}}function Ia(e,t,i){return{fontSize:t.xxsmall,fontFamily:T.V,cssColor:i?e.addOnAction:e.addOnFooterMessage,underlineType:i?x.RV.Single:x.RV.None,wrapMode:i?x.bd.NoWrap:x.bd.Normal}}function wa(e){return{background:{resting:"transparent"},title:{resting:e.addOnAction||e.background.resting}}}function Aa(e){return e.xsmall}function Da(e){return e.premiumEmphasis}const Ea=e=>{const t=C.useContext(ot.O);if(!e.addOnFooterData)return null;const{addOnFooterData:i}=e,o={onClick:()=>{var t;null===(t=e.onAction)||void 0===t||t.call(e,Je.AddOnFooterAction)},style:X,theme:wa(e.theme),automationLabel:`AddonFooterButton_${i.actionText}_${e.automationId}`};return C.createElement(nt.S,{style:Ta(e.theme),direction:st.PR.LeftToRight,align:st.j5.Center,accessible:!0,accessibilityLabel:i.message},i.icon&&C.createElement(C.Fragment,null,C.createElement(Fi.In,{type:i.icon,primaryColor:t?"var(--editorPremiumEmphasis)":Da(e.theme),fontSize:Aa(e.fontTable)}),C.createElement(nt.S,{style:{width:8}})),Ma(e),C.createElement(nt.S,{style:{width:4}}),t?C.createElement("div",{style:{paddingBottom:5}},C.createElement(Ct.R,{text:i.actionText,style:(r=e.fontTable,{fontSize:r.xxsmall,fontWeight:x.IT.Normal,underlineType:x.RV.Single}),onClick:()=>{var t;null===(t=e.onAction)||void 0===t||t.call(e,Je.AddOnFooterAction)}})):C.createElement(vt.u,Object.assign({},o),C.createElement(Lt.c,{text:i.actionText,style:Ia(e.theme,e.fontTable,!0)})));var r},Ma=e=>{if(!e.addOnFooterData)return;const{addOnFooterData:t}=e;return C.createElement(Lt.c,{text:t.message,style:Ia(e.theme,e.fontTable,!1),formatting:t.footerDecorations?(0,Dt.S)(t.message.length,e.theme,t.footerDecorations):void 0})},La=e=>{const t=e.definition,i=Et(e.strings.textFormatting,t.critiqueType,t.contextText,t.contextDecorations),o=Zi(t,Je.ReadContext),r=o?Object.assign(Object.assign({},Q),{flexibleSize:!0}):Q,n=C.createElement(nt.S,{style:r,accessibleLive:st.pq.Polite},t.contextText&&C.createElement(Lt.c,{text:ws(t.contextText,120),style:re(e.theme,e.fontTable),formatting:(0,Dt.S)(t.contextText.length,e.theme,t.contextDecorations),accessibilityLabel:i}));if(!o)return n;const s=e.settings&&"true"===e.settings.NoTooltipForReadContext?void 0:qi(t,e.strings,Je.ReadContext);return C.createElement(nt.S,{direction:st.PR.LeftToRight,align:st.j5.Center},n,Pi(t,e.theme,Je.ReadContext,xe(e.fontTable),e.strings,{regular:Wt.ew3,filled:Wt.wrJ},{action:"readcontext",context:i||t.contextText},void 0,void 0,s,void 0,void 0,void 0,e.automationId,e.onAction))},Ra=e=>C.createElement(Lt.c,{text:e.strings.critique("previewHeaderLabel"),style:De(e.theme,e.fontTable)}),Oa=e=>{const t=!!C.useContext(ot.O),i=e.definition,o=e.renderPreviewMarker?C.createElement(Ra,{definition:i,theme:e.theme,fontTable:e.fontTable,strings:e.strings}):void 0,r=i.header,n=r?C.createElement(Lt.c,{text:r,style:te(e.theme,e.fontTable,{useFluentV9:t}),accessibilityRole:"heading"}):null,s=n?i.showPremiumIcon?C.createElement(nt.S,{direction:st.PR.LeftToRight},C.createElement(Fi.In,{type:"PremiumDiamond",primaryColor:e.theme.header}),C.createElement(nt.S,{style:{minWidth:6}}),n):n:null;return e.renderPreviewMarker?C.createElement(nt.S,{align:st.j5.Stretch,direction:st.PR.LeftToRight},s,C.createElement(nt.S,{style:{flexibleSize:!0,minWidth:16}}),o):s},Fa=e=>{const t=e.definition.subheader,i=C.useContext(ot.O);return t?C.createElement(Lt.c,{text:t,style:oe(e.theme,e.fontTable,{useFluentV9:!!i}),accessibilityRole:"heading"}):null},Ba=e=>{const t=e.definition;return C.createElement(nt.S,{style:L,align:st.j5.Stretch},C.createElement(Oa,{definition:t,theme:e.theme,fontTable:e.fontTable,strings:e.strings,renderPreviewMarker:e.renderPreviewHeader}),C.createElement(Fa,{definition:t,theme:e.theme,fontTable:e.fontTable}),t.showContext&&t.contextText&&t.contextText.length&&C.createElement(La,{definition:t,theme:e.theme,fontTable:e.fontTable,automationId:"HeaderContext",strings:e.strings,onAction:e.onAction,settings:e.settings}))};class Na extends C.Component{setDefinition(e){this.setState({definition:e})}componentDidMount(){var e,t;null===(t=(e=this.props).onAfterUpdate)||void 0===t||t.call(e,this.state.definition)}componentDidUpdate(e,t){this.props.onAfterUpdate&&t.definition!==this.state.definition&&this.props.onAfterUpdate(this.state.definition),e.definition!==this.props.definition&&this.setState({definition:this.props.definition})}render(){const e=me(this.getTheme(),this.props.style,{useFluentV9:!!this.context});return C.createElement(nt.S,{style:e,align:st.j5.Stretch},C.createElement(Ba,{definition:this.getDefinition(),theme:this.getTheme(),fontTable:this.getFontTable(),strings:this.props.strings,renderPreviewHeader:!!this.props.renderPreviewMarker,onAction:this.props.onAction}),this.renderBody(),this.props.customLowerBody,this.renderFooter(),this.props.addOnFooterData&&C.createElement(Ea,{addOnFooterData:this.props.addOnFooterData,theme:this.getTheme(),fontTable:this.getFontTable(),automationId:this.props.automationId}))}focus(){var e;if(this.props.customBody&&this.props.focusCustomBody&&this.props.focusCustomBody())return;const t=this.props.definition.suggestions?this.props.definition.suggestions.length:0;this.props.firstSuggestionRef&&this.props.firstSuggestionRef.current&&t>0?this.props.firstSuggestionRef.current.focus():this.firstSuggestionRef.current&&t>0?this.firstSuggestionRef.current.focus():null===(e=this.footerRef.current)||void 0===e||e.focus()}executeBadgedAction(e){if(!this.props.onAction)return;const t=Wi(this.getDefinition(),this.props.strings),i={actionSourceId:r.VoiceDictationBadge,maxBadgeId:t.reduce(((e,t)=>Math.max(e,t.badgeId)),0)},o=t.filter((t=>t.badgeId===e));o.length>0?(i.executedBadgeId=o[0].badgeId,this.props.onAction(o[0].action,o[0].suggestionIndex,void 0,i)):this.props.onAction(Je.Dismiss,void 0,void 0,i)}getDefinition(){return this.state.definition}renderBody(){var e,t,i;const o=this.getDefinition();return C.createElement(nt.S,{align:st.j5.Stretch},this.props.customUpperBody,this.props.customBody?this.props.customBody:C.createElement(ft,null,C.createElement(ya,Object.assign({},this.props,{ref:null!==(e=this.props.firstSuggestionRef)&&void 0!==e?e:this.firstSuggestionRef}))),o.helpLink&&C.createElement(ka,{text:null===(t=o.helpLink)||void 0===t?void 0:t.text,url:null===(i=o.helpLink)||void 0===i?void 0:i.url,theme:this.getTheme(),fontTable:this.getFontTable()}))}renderFooter(){var e,t,i,o;const{automationId:r,fontTable:n,layerHostId:s,onAction:a,settings:l,spacing:c,strings:d,style:u,theme:g}=this.props;return null!==(e=this.props.customFooter)&&void 0!==e?e:C.createElement(Eo,{automationId:r,layerHostId:s,definition:this.state.definition,theme:g,fontTable:n,spacing:c,style:u,strings:d,settings:l,onAction:a,overflowMenuCalloutStyle:null===(t=null==u?void 0:u.footerStyle)||void 0===t?void 0:t.overflowMenuCalloutStyle,footerContainerStyle:Xi(null==u?void 0:u.footerStyle),footerButtonStyle:null===(i=null==u?void 0:u.footerStyle)||void 0===i?void 0:i.buttonStyles,overflowMenuButtonStyle:null===(o=null==u?void 0:u.footerStyle)||void 0===o?void 0:o.buttonStyles,ref:this.footerRef})}getTheme(){var e;return null!==(e=this.props.theme)&&void 0!==e?e:this.context?D:A}getFontTable(){return this.props.fontTable?this.props.fontTable:E}constructor(e){super(e),this.firstSuggestionRef=C.createRef(),this.footerRef=C.createRef(),this.state={definition:e.definition}}}var ja;Na.contextType=ot.O,function(e){e[e.Default=0]="Default",e[e.ReportRewriteSuggestions=1]="ReportRewriteSuggestions",e[e.Feedback=2]="Feedback"}(ja||(ja={}));class Ha extends C.Component{static isRewriteFeedbackNegative(e){return e!==ia.FeedbackOptionHelpful}setDefinition(e){this.setState({definition:e})}executeBadgedAction(e){this.innerCritiqueRef.current&&this.innerCritiqueRef.current.executeBadgedAction(e)}componentDidUpdate(e,t){e.definition!==this.props.definition&&this.setState({definition:this.props.definition}),t.rewriteState!==this.state.rewriteState&&(this.state.rewriteState===ja.ReportRewriteSuggestions?this.reportSuggestionsRadioGroupRef.current&&this.reportSuggestionsRadioGroupRef.current.focus():this.innerCritiqueRef.current&&this.innerCritiqueRef.current.focus())}focus(){this.innerCritiqueRef.current&&this.innerCritiqueRef.current.focus()}render(){const e=this.getDefinition();if(!e||!e.suggestions)return null;switch(this.state.rewriteState){case ja.Default:const t=e.suggestions.map((t=>{if(this.isSuggestionReportedNegative(t.title))return Object.assign(Object.assign({},t),{actions:t.actions.filter((e=>e!==Je.Accept)),title:this.props.strings.neuralRewrite("neuralRewriteReportedSuggestionTitle"),subtitle:void 0,titleDecorations:void 0});if(void 0===t.titleDecorations&&e.contextText){const{commonPrefixLength:i,commonSuffixLength:o}=function(e,t){const i=t.length,o=function(e,t){const i=e.length,o=t.length;let r=0,n=0;for(let s=0;s<Math.min(i,o)&&e.charAt(s)===t.charAt(s);s++)r++,Ds(e.charCodeAt(s))&&(n=r);return n}(e,t),r=Math.min(function(e,t){const i=e.length,o=t.length;let r=0,n=0;for(let s=0;s<Math.min(i,o)&&e.charAt(i-s-1)===t.charAt(o-s-1);s++)r++,Ds(e.charCodeAt(i-s-1))&&(n=r);return n}(e,t),Math.min(i,e.length)-o),n=o+r,s=i-n,a=Math.min(130,s),l=Math.min(150-a,n),c=Math.min(l,o),d=Math.min(l,r),{actualLeftContextLength:u,actualRightContextLength:g}=function(e,t,i){let o,r;const n=e/2;return t<n&&i<n?(o=t,r=i):t<n?(o=t,r=Math.min(i,e-o)):i<n?(r=i,o=Math.min(t,e-r)):(o=n,r=n),{actualLeftContextLength:o,actualRightContextLength:r}}(l,c,d),p=t.substring(o-u,o),h=t.substring(o,i-r),m=t.substring(i-r,i-r+g);let y=p,b=h,f=m;if(o>u){const e=Pa(p,0,p.length,!0);y="..."+p.substring(e,p.length)}if(h.length>a){const e=Pa(h,0,a/2,!1),t=Pa(h,a/2,h.length,!0);b=h.substring(0,e)+"..."+h.substring(t,h.length)}if(r>g){const e=Pa(m,0,m.length,!1);f=m.substring(0,e)+"..."}return{truncatedPrefix:y,truncatedSubstring:b,truncatedSuffix:f,target:h,commonPrefixLength:o,commonSuffixLength:r}}(e.contextText,t.title);return Object.assign(Object.assign({},t),{titleDecorations:[{start:i,length:t.title.length-i-o,decorationType:$e.Rewrite}]})}return t})),i=function(e,t){const i=xa(e),o=ba(e,void 0);return Qe.Grammar===e.definition.critiqueType?Object.assign(Object.assign({},i),Ca(e)):Qe.Refinement===e.definition.critiqueType?Object.assign(Object.assign(Object.assign({},i),xa(e)),{suggestionKind:o.suggestionKind}):e.settings&&"true"===e.settings.renderNRForAIFeedback?Object.assign(Object.assign(Object.assign({},i),xa(e)),{suggestionKind:o.suggestionKind,definition:Object.assign(Object.assign({},i.definition),{header:void 0,subheader:e.strings.critique("aIFeedbackCardSubHeader")})}):(i.definition.header=e.strings.critique("neuralRewriteCardHeader"),i.definition.subheader=e.strings.critique("neuralRewriteCardSubheader"),i.suggestionKind=o.suggestionKind,i.suggestionAccessibilityLabel=o.suggestionAccessibilityLabel,i.suggestionIcon=t=>Qi(e.definition,Je.Accept,t)?void 0:"Info",i.noSuggestionsLabel=i.strings.critique("neuralRewriteNoSuggestionsText"),i.renderPreviewMarker=e.definition.critiqueType===Qe.NeuralRewrite,i)}(Object.assign(Object.assign({},this.props),{definition:Object.assign(Object.assign({},e),{suggestions:t}),onAction:this.onCritiqueCardClick}));return C.createElement(Na,Object.assign({},i,{ref:this.innerCritiqueRef}));case ja.Feedback:return this.renderFeedback();case ja.ReportRewriteSuggestions:const o=me(this.getTheme(),this.props.style,{useFluentV9:!!this.context});return C.createElement(nt.S,{direction:st.PR.TopToBottom,style:Object.assign(Object.assign({},o),{paddingHorizontal:24,paddingVertical:24}),align:st.j5.Stretch},this.renderHeader(),this.renderReportSuggestions(),this.renderFooter())}}getDefinition(){return this.state.definition}getTheme(){var e;return null!==(e=this.props.theme)&&void 0!==e?e:this.context?D:A}getFontTable(){return this.props.fontTable||E}getSpacing(){return this.props.spacing||M}onCritiqueCardClick(e,t){e===Je.Feedback&&this.setState({rewriteState:ja.ReportRewriteSuggestions,rewriteReportedSuggestionId:void 0,rewriteOption:void 0,rewriteChoiceGroupSelected:!1}),this.props.onAction&&this.props.onAction(e,t)}onFeedbackCardDismiss(){this.setState({rewriteState:ja.Default})}onFeedbackCardBack(){this.setState({rewriteState:ja.ReportRewriteSuggestions,rewriteChoiceGroupSelected:!0})}renderFeedback(){const e=this.getDefinition(),t=this.getIndexOfReportedSuggestion(),i=Object.assign(Object.assign({},this.props),{style:void 0,reportedSuggestionIndex:t,showCheckbox:!0,definition:e,onBack:this.onFeedbackCardBack,onDismiss:this.onFeedbackCardDismiss,onReport:this.onFeedbackCardReport});return C.createElement(ia,Object.assign({},i))}isSuggestionReportedNegative(e){return Ha.suggestionsReportedNegative.indexOf(e)>=0}isSuggestionAlreadyReported(e){return Ha.reportedSuggestions.indexOf(e)>=0}renderReportSuggestions(){const e=this.getDefinition();if(!e||!e.suggestions)return null;const t=e.suggestions.filter((t=>!(!t||!t.id&&e.critiqueType!==Qe.Grammar||!t.title))).map((t=>{var i;const o=t,r=o.title,n=this.isSuggestionReportedNegative(r),s=this.isSuggestionAlreadyReported(r);return e.critiqueType===Qe.Grammar&&(o.id=null===(i=e.suggestions)||void 0===i?void 0:i.indexOf(o).toString()),{key:o.id,disabled:s,text:n?this.props.strings.neuralRewrite("neuralRewriteReportedSuggestionTitle"):r}})).filter(((e,t)=>t<I));return 0===t.length?null:C.createElement(qs,{onChange:this.onRewriteSelectFeedbackSuggestion,options:t,ref:this.reportSuggestionsRadioGroupRef,defaultSelectedKey:this.state.rewriteReportedSuggestionId,accessibilityLabel:this.props.strings.feedback("neuralRewriteFeedbackDialogChooseSuggestionTitle")})}onRewriteSelectFeedbackSuggestion(e){e&&this.setState({rewriteReportedSuggestionId:e.key,rewriteChoiceGroupSelected:!0})}renderHeader(){this.getTheme();const e=this.props.definition.critiqueType===Qe.Grammar?this.props.strings.feedback("grammarFeedbackDialogChooseSuggestionTitle"):this.props.strings.feedback("neuralRewriteFeedbackDialogChooseSuggestionTitle");return C.createElement(nt.S,{direction:st.PR.TopToBottom,align:st.j5.Stretch,accessibleLive:st.pq.Polite},C.createElement(Lt.c,{text:e,style:Cs(),accessibilityRole:"heading"}),C.createElement(nt.S,{style:ie},C.createElement(Lt.c,{text:this.props.strings.feedback("neuralRewriteFeedbackDialogChooseSuggestionDescription"),style:xs(),accessibilityRole:"text"})))}renderFooterButton(e,t,i,o,r){return C.createElement(vt.u,{title:e,titleStyle:ve(this.getFontTable(),e.length),onClick:t,theme:he(this.getTheme(),o),disabled:i,style:U,ref:r,automationLabel:`CritiqueActionButton_${e}_${this.props.automationId}`})}renderFooter(){return C.createElement(nt.S,{direction:st.PR.TopToBottom,justifyContent:st.Pr.SpaceBetween,style:_,align:st.j5.Stretch},C.createElement(nt.S,{direction:st.PR.LeftToRight,justifyContent:st.Pr.End,align:st.j5.Stretch},this.renderFooterButton(this.props.strings.common("cancelButton"),this.onRewriteReportSuggestionCancel),C.createElement(nt.S,{style:{minWidth:this.getSpacing().small}}),this.renderFooterButton(this.props.strings.common("nextButton"),this.onRewriteReportSuggestionNext,!this.state.rewriteChoiceGroupSelected,!0)))}onRewriteReportSuggestionCancel(){this.setState({rewriteState:ja.Default,rewriteReportedSuggestionId:void 0,rewriteChoiceGroupSelected:!1})}onRewriteReportSuggestionNext(){this.setState({rewriteState:ja.Feedback,rewriteChoiceGroupSelected:!1})}getIndexOfReportedSuggestion(){const e=this.state.rewriteReportedSuggestionId,t=this.getDefinition();if(t.suggestions)for(let i=0;i<t.suggestions.length;i++){const o=t.suggestions[i];if(o&&o.id===e)return o&&o.title?i:-1}}onFeedbackCardReport(e,t){const i=this.getDefinition();if(!this.state.rewriteReportedSuggestionId||!i.suggestions)return;const o=this.getIndexOfReportedSuggestion();if(void 0===o)return;const r=i.suggestions[o].title;this.props.onAction&&this.props.onAction(Je.Report,o,{action:"feedback",type:i.critiqueType,option:e.option,comments:e.comments,payload:e.payload}),this.isSuggestionAlreadyReported(r)||i.critiqueType===Qe.Grammar||Ha.reportedSuggestions.push(r),void 0!==e.option&&Ha.isRewriteFeedbackNegative(e.option)&&!this.isSuggestionReportedNegative(r)&&i.critiqueType!==Qe.Grammar&&Ha.suggestionsReportedNegative.push(r),this.setState({rewriteReportedSuggestionId:void 0,rewriteChoiceGroupSelected:!1})}constructor(e){super(e),this.reportSuggestionsRadioGroupRef=C.createRef(),this.innerCritiqueRef=C.createRef(),this.onRewriteSelectFeedbackSuggestion=this.onRewriteSelectFeedbackSuggestion.bind(this),this.onRewriteReportSuggestionCancel=this.onRewriteReportSuggestionCancel.bind(this),this.onRewriteReportSuggestionNext=this.onRewriteReportSuggestionNext.bind(this),this.onCritiqueCardClick=this.onCritiqueCardClick.bind(this),this.onFeedbackCardBack=this.onFeedbackCardBack.bind(this),this.onFeedbackCardDismiss=this.onFeedbackCardDismiss.bind(this),this.onFeedbackCardReport=this.onFeedbackCardReport.bind(this),this.state={definition:e.definition,rewriteState:ja.Default,rewriteReportedSuggestionId:void 0,rewriteOption:void 0,rewriteChoiceGroupSelected:!1}}}function Pa(e,t,i,o){if(o){for(;!Ds(e.charCodeAt(t))&&t<i;)++t;return t}{const o=i;for(;!Ds(e.charCodeAt(i))&&i>t;)--i;return i+1<=o&&++i,i}}Ha.reportedSuggestions=[],Ha.suggestionsReportedNegative=[],Ha.contextType=ot.O;class za extends C.Component{setDefinition(e){this.setState({definition:e})}componentDidMount(){var e,t;null===(t=(e=this.props).onAfterUpdate)||void 0===t||t.call(e,this.state.definition)}componentDidUpdate(e,t){this.props.onAfterUpdate&&t.definition!==this.state.definition&&this.props.onAfterUpdate(this.state.definition),e.definition!==this.props.definition&&this.setState({definition:this.props.definition})}render(){var e,t,i;const{automationId:o,fontTable:r,layerHostId:n,onAction:s,settings:a,spacing:l,strings:c,style:d,theme:u}=this.props,g=me(this.getTheme(),this.props.style,{useFluentV9:!!this.context});return C.createElement(nt.S,{style:g,align:st.j5.Stretch},this.renderHeader(),this.renderBody(),this.renderFooterTitle(),C.createElement(Eo,{automationId:o,layerHostId:n,definition:this.state.definition,theme:u,fontTable:r,spacing:l,style:d,strings:c,settings:a,onAction:s,overflowMenuCalloutStyle:null===(e=null==d?void 0:d.footerStyle)||void 0===e?void 0:e.overflowMenuCalloutStyle,footerContainerStyle:Xi(null==d?void 0:d.footerStyle),footerButtonStyle:P(null===(t=null==d?void 0:d.footerStyle)||void 0===t?void 0:t.buttonStyles),overflowMenuButtonStyle:P(null===(i=null==d?void 0:d.footerStyle)||void 0===i?void 0:i.buttonStyles),ref:this.footerRef}),this.renderAddOnFooter())}focus(){var e;this.firstSuggestionRef.current?this.firstSuggestionRef.current.focus():this.firstSuggestionButtonRef.current?this.firstSuggestionButtonRef.current.focus():null===(e=this.footerRef.current)||void 0===e||e.focus()}executeBadgedAction(e){if(!this.props.onAction)return;const t=Wi(this.getDefinition(),this.props.strings),i={actionSourceId:r.VoiceDictationBadge,maxBadgeId:t.reduce(((e,t)=>Math.max(e,t.badgeId)),0)},o=t.filter((t=>t.badgeId===e));o.length>0?(i.executedBadgeId=o[0].badgeId,this.props.onAction(o[0].action,o[0].suggestionIndex,void 0,i)):this.props.onAction(Je.Dismiss,void 0,void 0,i)}getBooleanSetting(e){return!!this.props.settings&&"true"===this.props.settings[e]}getDefinition(){return this.state.definition}renderContext(e){if(!e.showContext||!e.contextText||!e.contextText.length)return null;const t=Et(this.props.strings.textFormatting,e.critiqueType,e.contextText,e.contextDecorations),i=Zi(e,Je.ReadContext),o=i?Object.assign(Object.assign({},Q),{flexibleSize:!0}):Q,r=C.createElement(nt.S,{style:o,accessibleLive:st.pq.Polite},C.createElement(Lt.c,{text:ws(e.contextText,za.contextMaxLength),style:re(this.getTheme(),this.getFontTable()),formatting:(0,Dt.S)(e.contextText.length,this.getTheme(),e.contextDecorations),accessibilityLabel:t}));if(!i)return r;const n=this.getBooleanSetting("NoTooltipForReadContext")?void 0:qi(e,this.props.strings,Je.ReadContext);return C.createElement(nt.S,{direction:st.PR.LeftToRight,align:st.j5.Center},r,Pi(this.getDefinition(),this.getTheme(),Je.ReadContext,xe(this.getFontTable()),this.props.strings,{regular:Wt.ew3,filled:Wt.wrJ},{action:"readcontext",context:t||e.contextText},void 0,void 0,n,void 0,void 0,void 0,this.props.automationId,this.props.onAction,void 0,void 0,void 0,void 0,void 0,this.props.layerHostId))}getCardHeaderText(){var e,t,i,o;const r=this.getDefinition();let n;switch(r.critiqueType){case Qe.Classification:n=this.props.strings.critique("sensitiveContentCardHeader");break;case Qe.Spelling:case Qe.RepeatedWord:n=this.props.strings.critique("spellingCardHeader");break;case Qe.Grammar:n=this.props.strings.critique("grammarCardHeader");break;case Qe.NeuralRewrite:n=this.getBooleanSetting("renderNRForAIFeedback")?void 0:this.props.strings.critique("neuralRewriteCardHeader");break;case Qe.SimilarityChecker:n=this.props.strings.critique("similarityCheckerCardHeader");break;case Qe.TonalRewrite:n=this.props.strings.critique("tonalRewriteCardHeader");break;case Qe.AccColorChecker:n=null===(t=(e=this.props.strings).accChecker)||void 0===t?void 0:t.call(e,"accColorCheckerCardHeader");break;case Qe.TextPenAlternates:n=null===(o=(i=this.props.strings).textPenAlternates)||void 0===o?void 0:o.call(i,"textPenAlternatesGroupTitle");break;default:n=this.props.definition.header}return r.showDictationCommandUx&&!n&&(n=this.props.strings.critique("dictationCorrectionsGroupTitle")),n}getCardSubheaderText(){var e,t;const i=this.getDefinition();let o;switch(i.critiqueType){case Qe.Spelling:o=void 0;break;case Qe.RepeatedWord:o=this.props.strings.critique("repeatedWordCardSubheader");break;case Qe.NeuralRewrite:o=this.getBooleanSetting("renderNRForAIFeedback")?this.props.strings.critique("aIFeedbackCardSubHeader"):this.props.strings.critique("neuralRewriteCardSubheader");break;case Qe.SimilarityChecker:o=this.props.strings.critique("similarityCheckerCardSubheader");break;case Qe.AccColorChecker:o=null===(t=(e=this.props.strings).accChecker)||void 0===t?void 0:t.call(e,"accColorCheckerCardSubheader");break;default:o=i.subheader}return i.showDictationCommandUx&&!o&&(o=this.props.strings.critique("dictationCorrectionCommandCardTitle")),o}renderPreviewMarker(){return C.createElement(Lt.c,{text:this.props.strings.critique("previewHeaderLabel"),style:De(this.getTheme(),this.getFontTable())})}renderCardHeader(e){const t=e.critiqueType===Qe.NeuralRewrite||e.critiqueType===Qe.SimilarityChecker||e.critiqueType===Qe.TonalRewrite?this.renderPreviewMarker():void 0,i=this.getCardHeaderText(),o=i?C.createElement(Lt.c,{text:i,style:te(this.getTheme(),this.getFontTable(),{useFluentV9:!!this.context}),accessibilityRole:"heading"}):null,r=o?this.getDefinition().showPremiumIcon?C.createElement(nt.S,{direction:st.PR.LeftToRight},C.createElement(jt,{type:"PremiumDiamond",icon:{regular:Wt.Kh4},primaryColor:this.getTheme().header}),C.createElement(nt.S,{style:{minWidth:6}}),o):o:null;return t?C.createElement(nt.S,{align:st.j5.Stretch,direction:st.PR.LeftToRight},r,C.createElement(nt.S,{style:{flexibleSize:!0,minWidth:16}}),t):r}renderCardFooterTitle(e){return e.showDictationCommandUx&&this.props.strings.critique("dictationSpelloutCommandCardTitle"),null}renderCardSubheader(){const e=this.getCardSubheaderText();return e?C.createElement(Lt.c,{text:e,style:oe(this.getTheme(),this.getFontTable(),{useFluentV9:!!this.context}),accessibilityRole:"heading"}):null}renderHeader(){const e=this.getDefinition();return C.createElement(nt.S,{style:L,align:st.j5.Stretch},this.renderCardHeader(e),this.renderCardSubheader(),this.renderContext(e))}shouldShowSuggestionDescription(e){return Qi(this.getDefinition(),Je.Accept,e)&&this.getDefinition().showDescription&&e.subtitle&&e.subtitle.length>0}getSuggestionButtonProps(e,t,i,o,r){const n=this.getDefinition(),s=this.getSuggestionButtonKind(n.critiqueType,e),a=n.critiqueType===Qe.Topic?`#${e.title}`:e.title,l=a.length,c=Ki(n,i,e),d=zi(n,this.props.strings,this.getTheme(),c,i,t),u=n.critiqueType===Qe.RepeatedWord,g=void 0!==o?{type:o,filled:u}:void 0;(0,Ot.K0)(r)&&!u&&(r.filled=void 0);const p={title:a,titleStyle:void 0!==s&&i!==Je.MoreSources?be(this.getFontTable(),l):(0,Dt.S)(l,this.getTheme(),e.titleDecorations),tag:e.tag,tagStyle:fe(this.getFontTable()),icon:g,disabled:c,onClick:()=>{var e,o;null===(o=(e=this.props).onAction)||void 0===o||o.call(e,i,t)},theme:n.critiqueType===Qe.RepeatedWord?ge(this.getTheme(),s,!0):ge(this.getTheme(),s),strings:Bi(this.props.strings.common),accessibilityRole:"menuitem",accessibilityLabel:this.getSuggestionAccessibilityLabel(e),automationLabel:"CritiqueSuggestionButton_"+e.id,badgeProps:d,renderChildren:(0,Ot.eO)(r)};return this.shouldShowSuggestionDescription(e)&&(p.subtitle=e.subtitle,p.subtitleStyle=Ee(this.getFontTable())),p}getSuggestionButtonKind(e,t){if(!(t.titleDecorations&&t.titleDecorations.length>0))switch(e){case Qe.Grammar:return"grammar";case Qe.Refinement:case Qe.Topic:return"refinement";default:return"suggestion"}}getSuggestionAccessibilityLabel(e){const t=this.getDefinition(),i=e.tagAccessibilityLabel||e.tag||"";return t.critiqueType!==Qe.Spelling&&t.critiqueType!==Qe.NeuralRewrite||!t.showDescription||!e.subtitle||0===e.subtitle.trim().length?i?this.props.strings.critique("suggestionWithTagAccessibilityLabel").replace("{0}",i).replace("{1}",e.title):void 0:i&&t.critiqueType===Qe.Spelling?this.props.strings.critique("spellingSuggestionTagAndDescriptionAccessibilityLabel").replace("{0}",i).replace("{1}",e.title).replace("{2}",e.subtitle):(t.critiqueType===Qe.Spelling?this.props.strings.critique("spellingSuggestionDescriptionAccessibilityLabel"):this.props.strings.critique("neuralRewriteSuggestionAccessibilityLabel")).replace("{0}",e.title).replace("{1}",e.subtitle)}renderButtonSuggestion(e,t,i,o,r){return C.createElement(wi.J,Object.assign({key:e,ref:t},i,{style:j,strings:ji(this.props.strings.common),accessibilityPositionInSet:void 0!==o?o:1,accessibilitySetSize:void 0!==r?r:1}))}renderSingleSuggestion(e,t,i,o,r,n,s,a,l){return[this.renderButtonSuggestion(e,i,this.getSuggestionButtonProps({title:t,actions:r?[]:[o]},e,o,n,s),a,l)]}renderActionListAsSuggestions(e){const t=this.getDefinition();return e.filter((e=>qi(t,this.props.strings,e.actionId))).map(((e,i,o)=>this.renderSingleSuggestion(i,qi(t,this.props.strings,e.actionId),0===i?this.firstSuggestionRef:void 0,e.actionId,void 0,Vi(e.actionId),e.icons,i+1,o.length)[0]))}renderSpecialSuggestions(e,t){return e.critiqueType===Qe.RepeatedWord?this.renderSingleSuggestion(0,this.props.strings.critique("deleteRepeatedWord"),this.firstSuggestionRef,t[0].actionId,!1,"Delete",this.getBundledSuggestionIcon("Delete")):e.critiqueType===Qe.SimilarityChecker?this.renderActionListAsSuggestions(t):[C.createElement(To,{key:0,shimmerCount:3,styles:Me(this.getSpacing()),render:()=>{const e=this.renderSingleSuggestion(0,this.props.strings.common("suggestionsGroupLoadingSuggestionsText"),void 0,Je.Accept,!0);return e.length>0?e[0]:null}})]}renderSuggestions(){const e=this.getDefinition(),t=Gi(e,this.props.strings);if(t)return this.renderSpecialSuggestions(e,t);const i=Ui(e),o=i.map(((t,o)=>{const r=this.getSuggestionIcon(e.critiqueType,t,i.length),n=this.getBundledSuggestionIcon(r),s=this.renderButtonSuggestion(o,0===o?this.firstSuggestionRef:void 0,this.getSuggestionButtonProps(t,o,Je.Accept,r,n),o+1,i.length);return o>0&&t.tag!==i[o-1].tag?C.createElement(C.Fragment,null,C.createElement(ho.w,{key:o,color:this.props.theme&&this.props.theme.separator,style:ee}),s):s}));return 0===o.length?this.renderSingleSuggestion(0,e.critiqueType===Qe.NeuralRewrite?this.props.strings.critique("neuralRewriteNoSuggestionsText"):this.props.strings.common("suggestionsGroupNoSuggestionsText"),void 0,Je.Accept,!0):o}getSuggestionIcon(e,t,i){return e===Qe.Classification&&1===i?"Delete":e===Qe.Grammar&&this.props.critiqueSource===o.Inference?"Cloud":e!==Qe.NeuralRewrite||Qi(this.getDefinition(),Je.Accept,t)?void 0:"Info"}getBundledSuggestionIcon(e){switch(e){case"Delete":return{regular:Ut.y7H,filled:Ut.Sz$};case"Cloud":return{regular:Ut.wSM,filled:Ut._B};case"Info":return{regular:_t.BFD,filled:_t.N_H}}}renderSourceUrlAsHyperlink(e,t){return C.createElement(Ct.R,{url:e,theme:(o=this.getTheme(),{color:o.subheader,hoverColor:o.link,pressedColor:o.linkPressed,focusRing:o.focusRing}),style:(i=this.getFontTable(),{fontSize:i.xsmall,fontWeight:x.IT.SemiBold}),text:t});var i,o}renderSourceUrlAsText(e){return C.createElement(Lt.c,{text:e,style:(t=this.getTheme(),i=this.getFontTable(),{cssColor:t.subheader,fontSize:i.xsmall,fontWeight:x.IT.SemiBold})});var t,i}renderSource(){const e=this.getDefinition(),t=this.props.sourceIndex||0;if(!e.sources)return;const i=e.sources[t].sourceUrl,o=e.sources[t].sourceTitle;if(!i||!o)return;const r=As(i);return C.createElement(nt.S,{style:R,align:st.j5.Stretch},C.createElement(Lt.c,{text:o,style:(n=this.getFontTable(),s=this.getTheme(),{fontWeight:x.IT.Normal,fontSize:n.xsmall,cssColor:s.subheader})}),C.createElement(nt.S,{direction:st.PR.LeftToRight,align:st.j5.Baseline},C.createElement(nt.S,{direction:st.PR.LeftToRight,align:st.j5.Baseline,style:{flexibleSize:!0}},e.sourceUrlClickable?this.renderSourceUrlAsHyperlink(i,r):this.renderSourceUrlAsText(r)),C.createElement(Lt.c,{text:this.props.strings.critique("poweredByBing"),style:Ae(this.getFontTable())})));var n,s}generateButtonProps(e,t,i){return{onClick:()=>{this.props.onAction&&this.props.onAction(Je.ApplyColor,i)},hoverRing:!0,style:{width:32,height:32,borderRadius:2,marginEnd:8,borderThickness:2},theme:Vs(e),automationLabel:`ColorPickerButton_${this.props.automationId}`,tooltip:t,tooltipProps:{layerHostId:this.props.layerHostId}}}renderColors(){var e,t,i;const o=(this.getDefinition().suggestions||[]).map(((e,t)=>C.createElement(wi.J,Object.assign({key:e.id,ref:0===t?this.firstSuggestionButtonRef:void 0},this.generateButtonProps(e.title,e.subtitle,t),{renderChildren:(0,Ot.eO)(void 0)}))));return C.createElement(nt.S,{align:st.j5.Start,justifyContent:st.Pr.Start,style:Ks},C.createElement(Lt.c,{text:null!==(i=null===(t=(e=this.props.strings).accChecker)||void 0===t?void 0:t.call(e,"accColorCheckerSecondCardSubheader"))&&void 0!==i?i:"",style:(r=this.getTheme(),n=this.getFontTable(),{fontWeight:x.IT.SemiBold,fontFamily:T.V,fontSize:n.xsmall,cssColor:r.subheader}),accessibilityRole:"heading"}),C.createElement(nt.S,{direction:st.PR.LeftToRight,align:st.j5.Start,justifyContent:st.Pr.Start,style:Ys},o));var r,n}renderHelpLink(){const e=this.getDefinition();if(e.helpLink)return C.createElement(nt.S,{direction:st.PR.LeftToRight,style:Oe,align:st.j5.Stretch},C.createElement(Ct.R,{text:e.helpLink.text,url:e.helpLink.url,theme:Le(this.getTheme()),style:Re(this.getFontTable())}))}getCustomSuggestions(){return da(this.props)?this.props.getCustomSuggestions?this.props.getCustomSuggestions(this.props,void 0):void 0:this.props.customSuggestions?this.props.customSuggestions:this.props.definition.critiqueType===Qe.Grammar?Ca(this.props).customSuggestions:this.props.definition.critiqueType===Qe.Refinement?xa(this.props).customSuggestions:this.props.customSuggestions}renderBodySuggestions(){const e=this.getDefinition(),t=this.getCustomSuggestions(),i=e.critiqueType!==Qe.SimilarityChecker?this.props.strings.critique("suggestionsGroupAccessibilityLabel"):void 0,o=null!=t?t:this.renderSuggestions();return C.createElement(nt.S,{align:st.j5.Stretch,accessible:!0,accessibilityRole:"menu",accessibilityLabel:i},o)}renderBody(){const e=this.getDefinition();return C.createElement(nt.S,{align:st.j5.Stretch},e.critiqueType===Qe.SimilarityChecker?this.renderSource():void 0,C.createElement(ft,{disableInitialFocus:!0},e.critiqueType===Qe.AccColorChecker?this.renderColors():this.renderBodySuggestions()),this.renderHelpLink())}renderFooterTitle(){const e=this.getDefinition(),t=this.renderCardFooterTitle(e);return t?C.createElement(nt.S,{style:L,align:st.j5.Stretch},t):null}renderAddOnFooter(){if(!this.props.addOnFooterData)return null;const{addOnFooterData:e}=this.props,t={onClick:()=>{var e,t;null===(t=(e=this.props).onAction)||void 0===t||t.call(e,Je.AddOnFooterAction)},style:X,theme:wa(this.getTheme()),automationLabel:`AddonFooterButton_${e.actionText}_${this.props.automationId}`};return C.createElement(nt.S,{style:Ta(this.getTheme()),direction:st.PR.LeftToRight,align:st.j5.Center,accessible:!0,accessibilityLabel:e.message},e.icon&&C.createElement(C.Fragment,null,C.createElement(jt,{type:e.icon,icon:this.props.addOnFooterIcon,primaryColor:Da(this.getTheme()),fontSize:Aa(this.getFontTable())}),C.createElement(nt.S,{style:{width:8}})),this.getAddOnFooterFormattedText(),C.createElement(nt.S,{style:{width:4}}),C.createElement(wi.J,Object.assign({},t,{renderChildren:(0,Ot.eO)(void 0)}),C.createElement(Lt.c,{text:e.actionText,style:Ia(this.getTheme(),this.getFontTable(),!0)})))}getAddOnFooterFormattedText(){if(!this.props.addOnFooterData)return;const{addOnFooterData:e}=this.props;return C.createElement(Lt.c,{text:e.message,style:Ia(this.getTheme(),this.getFontTable(),!1),formatting:e.footerDecorations?(0,Dt.S)(e.message.length,this.getTheme(),e.footerDecorations):void 0})}getTheme(){var e;return null!==(e=this.props.theme)&&void 0!==e?e:this.context?D:A}getFontTable(){return this.props.fontTable?this.props.fontTable:E}getSpacing(){return this.props.spacing?this.props.spacing:M}constructor(e){super(e),this.firstSuggestionRef=C.createRef(),this.firstSuggestionButtonRef=C.createRef(),this.footerRef=C.createRef(),this.state={definition:e.definition}}}za.contextMaxLength=120,za.contextType=ot.O;const Ua={backButton:"BackButton",cancelButton:"CancelButton",closeButton:"CloseButton",defaultOverflowButtonAccessibilityLabel:"defaultOverflowButtonAccessibilityLabel",defaultSplitButtonOverflowAccessibilityLabel:"DefaultSplitButtonOverflowAccessibilityLabel",doneButton:"DoneButton",nextButton:"NextButton",oneOfManyChoiceButtonAccessibilityLabelAugment:"OneOfManyChoiceButtonAccessibilityLabelAugment",submitButton:"SubmitButton",suggestionsGroupLoadingSuggestionsText:"SuggestionsGroupLoadingSuggestionsText",suggestionsGroupNoSuggestionsText:"SuggestionsGroupNoSuggestionsText",voiceOverSplitButton2AccessibilityHint:"VoiceOverSplitButton2AccessibilityHint"},Wa={accAssistant:"AccAssistant",accColorCheckerCardHeader:"AccColorCheckerCardHeader",accColorCheckerCardSubheader:"AccColorCheckerCardSubheader",accColorCheckerSecondCardSubheader:"AccColorCheckerSecondCardSubheader",accessibilityLabelForEditorButton:"AccessibilityLabelForEditorButton",addInTextCitation:"InlineCitationButtonText",addToAutoCorrect:"addToAutoCorrect",addToDictionary:"addToDictionary",allowAccIssue:"AllowAccIssue",allowAllAccIssues:"AllowAllAccIssues",autoCorrectOptions:"autoCorrectOptions",changeAll:"changeAll",copyFullCitation:"FullCitationButtonText",deleteRepeatedWord:"DeleteRepeatedWord",dictationCorrectionCommandCardTitle:"DictationCorrectionCommandCardTitle",dictationCorrectionsGroupTitle:"DictationCorrectionsGroupTitle",dictationSpelloutCommandCardTitle:"DictationSpelloutCommandCardTitle",editorButtonText:"EditorButtonText",editorButtonCiqPreviewTooltipContent:"EditorButtonCiqPreviewTooltipContent",editorButtonTooltipContent:"EditorButtonTooltipContent",explanationFlyoutAccessibilityLabel:"ExplanationFlyoutAccessibilityLabel",footerExplanationButtonAccessibilityLabel:"FooterExplanationButtonAccessibilityLabel",footerSeeMoreActionsAccessibilityLabel:"OverflowButtonAccessibilityLabel",giveFeedbackButtonText:"GiveFeedbackButtonText",grammarCardHeader:"GrammarCardHeader",hideContext:"HideContextButtonText",hideExplanationButtonText:"HideExplanationButtonText",hideSynonyms:"HideSynonymsButtonText",ignoreAll:"IgnoreAllButtonText",ignoreOnce:"IgnoreButtonText",ignoreRule:"ignoreRule",learnMore:"LearnMoreButtonText",microsoftEditorBranding:"MicrosoftEditorBranding",microsoftEditorBrandingAccessibilityLabel:"MicrosoftEditorBrandingAccessibilityLabel",moreColors:"MoreColors",moreSources:"MoreSources",neuralRewriteCardHeader:"NeuralRewriteCardHeader",neuralRewriteCardSubheader:"NeuralRewriteCardSubheader",neuralRewriteNoSuggestionsText:"NeuralRewriteNoSuggestionsText",neuralRewriteSuggestionAccessibilityLabel:"NeuralRewriteSuggestionAccessibilityLabel",nextIssue:"NextButtonText",nextIssueWithCount:"NextIssueWithCount",options:"OptionsButtonText",poweredByBing:"PoweredByBing",previewHeaderLabel:"PreviewHeaderLabel",previousIssue:"PreviousButtonText",previousIssueWithCount:"PreviousIssueWithCount",readAloud:"",readAloudOriginalSentenceAccessibilityLabel:"",repeatedWordCardSubheader:"RepeatedWordCardSubheader",sensitiveContentCardHeader:"SensitiveContentCardHeader",showContext:"ShowContextButtonText",showExplanationButtonText:"ShowExplanationButtonText",showMenuButtonText:"ShowMenuButtonText",showSynonyms:"ShowSynonymsButtonText",similarityCheckerCardHeader:"SimilarityCheckerCardHeader",similarityCheckerCardSubheader:"SimilarityCheckerCardSubheader",spellOut:"spellOut",spellingCardHeader:"SpellingCardHeader",spellingSuggestionDescriptionAccessibilityLabel:"spellingSuggestionDescriptionAccessibilityLabel",spellingSuggestionTagAndDescriptionAccessibilityLabel:"SpellingSuggestionTagAndDescriptionAccessibilityLabel",suggestionWithTagAccessibilityLabel:"SuggestionWithTagAccessibilityLabel",suggestionsGroupAccessibilityLabel:"suggestionsGroupAccessibilityLabel",tonalRewriteCardHeader:"TonalRewriteCardHeader",turnOffAccChecker:"TurnOffAccChecker"},Ga={exampleText:"ExampleText",explanationTableAccessibilityLabel:"ExplanationTableAccessibilityLabel",explanationTableAfter:"ExplanationTableAfter",explanationTableBefore:"ExplanationTableBefore",explanationTableSeparator:"ExplanationTableSeparator"},_a={accColorsFeedbackDialogChooseOptionTitle:"AccColorsFeedbackDialogChooseOptionTitle",accColorsFeedbackHelpfulLabel:"AccColorsFeedbackHelpfulLabel",accColorsFeedbackNotHelpfulLabel:"AccColorsFeedbackNotHelpfulLabel",accColorsFeedbackOtherLabel:"AccColorsFeedbackOtherLabel",grammarFeedbackConfirmationDialogTitle:"NeuralRewriteFeedbackConfirmationDialogTitle",grammarFeedbackDialogCheckboxLabel:"GrammarFeedbackDialogCheckboxLabel",grammarFeedbackDialogChooseOptionTitle:"GrammarFeedbackDialogChooseOptionTitle",grammarFeedbackDialogChooseSuggestionTitle:"GrammarFeedbackDialogChooseSuggestionTitle",grammarFeedbackDialogDescription:"GrammarFeedbackDialogDescription",grammarSuggestionLabel:"GrammarSuggestionLabel",neuralRewriteFeedbackConfirmationDialogSubTitle:"NeuralRewriteFeedbackConfirmationDialogSubTitle",neuralRewriteFeedbackConfirmationDialogTitle:"NeuralRewriteFeedbackConfirmationDialogTitle",neuralRewriteFeedbackDialogCheckboxLabel:"NeuralRewriteFeedbackDialogCheckboxLabel",neuralRewriteFeedbackDialogChooseOptionTitle:"NeuralRewriteFeedbackDialogChooseOptionTitle",neuralRewriteFeedbackDialogChooseSuggestionDescription:"NeuralRewriteFeedbackDialogChooseSuggestionDescription",neuralRewriteFeedbackDialogChooseSuggestionTitle:"NeuralRewriteFeedbackDialogChooseSuggestionTitle",neuralRewriteFeedbackDialogDescription:"NeuralRewriteFeedbackDialogDescription",neuralRewriteFeedbackDialogPrivacyStatementLabel:"NeuralRewriteFeedbackDialogPrivacyStatementLabel",neuralRewriteFeedbackDialogPrivacyStatementURL:"NeuralRewriteFeedbackDialogPrivacyStatementURL",neuralRewriteFeedbackDialogTextBoxPlaceholder:"NeuralRewriteFeedbackDialogTextBoxPlaceholder",originalSentenceLabel:"OriginalSentenceLabel",provideAccColorsFeedbackHeaderText:"ProvideAccColorsFeedbackHeaderText",provideFeedbackHeaderText:"ProvideFeedbackHeaderText",rewriteSuggestionLabel:"RewriteSuggestionLabel",similarityFeedbackConfirmationDialogSubTitle:"SimilarityFeedbackConfirmationDialogSubTitle",similarityFeedbackConfirmationDialogTitle:"SimilarityFeedbackConfirmationDialogTitle",similarityFeedbackDialogChooseOptionTitle:"SimilarityFeedbackDialogChooseOptionTitle",similarityFeedbackHelpfulLabel:"SimilarityFeedbackHelpfulLabel",similarityFeedbackIncludeDocumentTextAndSourceUrl:"SimilarityFeedbackIncludeDocumentTextAndSourceUrl",similarityFeedbackOffensiveContentLabel:"SimilarityFeedbackOffensiveContentLabel",similarityFeedbackOriginalContentLabel:"SimilarityFeedbackOriginalContentLabel",similarityFeedbackOtherLabel:"SimilarityFeedbackOtherLabel",similarityFeedbackWrongSourceLabel:"SimilarityFeedbackWrongSourceLabel",similarityfeedbackOptionsAccessibilityLabel:"SimilarityfeedbackOptionsAccessibilityLabel",suggestionFeedbackConsumerPrivacyNotice:"SuggestionFeedbackConsumerPrivacyNotice",suggestionFeedbackHelpfulLabel:"SuggestionFeedbackHelpfulLabel",suggestionFeedbackOffensiveLabel:"SuggestionFeedbackOffensiveLabel",suggestionFeedbackOtherLabel:"SuggestionFeedbackOtherLabel",suggestionFeedbackWrongLabel:"SuggestionFeedbackWrongLabel"},qa={neuralRewriteReportedSuggestionTitle:"NeuralRewriteReportedSuggestionTitle"},Va={contextAccessibilityLabelForCorrection:"ContextAccessibilityLabelForCorrection",contextAccessibilityLabelForGrammar:"ContextAccessibilityLabelForGrammar",contextAccessibilityLabelForRefinement:"ContextAccessibilityLabelForRefinement",contextAccessibilityLabelForRepeatedWord:"ContextAccessibilityLabelForRepeatedWord",contextAccessibilityLabelForSpelling:"ContextAccessibilityLabelForSpelling"},Za={clearSearchLabel:"ClearSearchLabel",somethingWentWrongLabel:"SomethingWentWrongLabel",tryAgainLabel:"TryAgainLabel",seeMoreHyperLinkLabel:"SeeMoreHyperLinkLabel"};function Ka(e){return{common:t=>e[Ua[t]],critique:t=>e[Wa[t]],critiqueExplanation:t=>e[Ga[t]],feedback:t=>"suggestionFeedbackFactuallyIncorrectLabel"===t||"writersUnblockDialogCheckboxLabel"===t||"writersUnblockFeedbackConfirmationDialogSubTitle"===t||"writersUnblockFeedbackConfirmationDialogTitle"===t||"writersUnblockFeedbackDialogChooseOptionTitle"===t||"writersUnblockFeedbackDialogDescription"===t?"":e[_a[t]],neuralRewrite:t=>e[qa[t]],textFormatting:t=>e[Va[t]],inlineSuggestions:t=>"suggestionsGroupSearchResultAccessibilityLabel"===t?"":e[Za[t]]}}function Ya(e,t){if(t&&e&&e.length)return e.map((e=>e?{start:e.start,length:e.length,decorationType:tl(e)}:void 0)).filter((e=>!!e))}function Qa(e,t,i,o){if(o===Vn){const t=[Je.Accept];return Ja(e,zr.Report)&&t.push(Je.Feedback),t}let r=[Je.Accept,Je.Feedback,Je.IgnoreOnce,Je.Next,Je.Previous,Je.ToggleContext,Je.ToggleDescription];return t===Qe.Spelling&&Ja(e,zr.AddToDictionary)&&r.push(Je.AddToDictionary),t===Qe.Grammar||t===Qe.Refinement?Ja(e,zr.Options)&&r.push(Je.Options):r.push(Je.IgnoreAll),(Ja(e,zr.OpenEditorPane)||i)&&r.push(Je.OpenEditorPane),t===Qe.Refinement&&"b1634cf9-5f68-42f4-82ca-e668f893d28f"!==o&&(r=r.filter((e=>e!==Je.Feedback))),t===Qe.DictationCorrection&&(r=$a(e)),t===Qe.AddinCritique&&(r=[Je.IgnoreOnce]),r}function $a(e){return e?e.map((e=>function(e){switch(e){case zr.Apply:case zr.Accepted:return Je.Accept;case zr.IgnoreOnce:return Je.IgnoreOnce;case zr.IgnoreAll:return Je.IgnoreAll;case zr.Options:return Je.Options;case zr.Next:return Je.Next;case zr.Back:return Je.Previous;case zr.OpenEditorPane:return Je.OpenEditorPane;case zr.InvokeOnAddOnFooter:return Je.AddOnFooterAction;case zr.ShowExplanation:return Je.ShowExplanation;case zr.AddToDictionary:return Je.AddToDictionary}return null}(e))).filter((e=>null!=e)):[]}function Ja(e,t){return!!e&&t&&-1!==e.findIndex((e=>e===t))}function Xa(e){switch(e){case Je.Accept:return zr.Apply;case Je.IgnoreOnce:return zr.IgnoreOnce;case Je.IgnoreAll:return zr.IgnoreAll;case Je.Options:return zr.Options;case Je.Next:return zr.Next;case Je.Previous:return zr.Previous;case Je.ToggleContext:case Je.ToggleDescription:return zr.Toggle;case Je.Report:return zr.Report;case Je.OpenEditorPane:return zr.OpenEditorPane;case Je.AddOnFooterAction:return zr.InvokeOnAddOnFooter;case Je.ShowExplanation:return zr.ShowExplanation;case Je.AddToDictionary:return zr.AddToDictionary;case Je.Feedback:return zr.GiveFeedback;case Je.LaunchAIRewriteHoverIn:return zr.LaunchAIRewriteHoverIn;case Je.LaunchAIRewriteHoverOut:return zr.LaunchAIRewriteHoverOut;case Je.LaunchAIRewrite:return zr.LaunchAIRewrite}return null}function el(e){if(e&&e.actionText&&e.labelText)return{message:e.labelText,actionText:e.actionText}}function tl(e){switch(e.underlineType){case Gr.SpellingSquiggle:return $e.Spelling;case Gr.GrammarSquiggle:return $e.Grammar;case Gr.CritiqueSquiggle:return $e.Refinement}return e.cssColor===on.neuralRewriteTextDecorationColor_HACK?$e.Rewrite:$e.None}function il(e){if(e?.url&&e?.text)return{url:e.url,text:e.text}}var ol=i(27191);const rl=()=>C.createElement("img",{style:{marginRight:"7px"},src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTEiIHZpZXdCb3g9IjAgMCAxNCAxMSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTAuMTQ2NDQ3IDQuODUzNTVDLTAuMDQ4ODE1NSA0LjY1ODI5IC0wLjA0ODgxNTUgNC4zNDE3MSAwLjE0NjQ0NyA0LjE0NjQ1TDQuMTQ2NDUgMC4xNDY0NDZDNC4zNDE3MSAtMC4wNDg4MTU1IDQuNjU4MjkgLTAuMDQ4ODE1NSA0Ljg1MzU1IDAuMTQ2NDQ2TDguODUzNTUgNC4xNDY0NUM5LjA0ODgyIDQuMzQxNzEgOS4wNDg4MiA0LjY1ODI5IDguODUzNTUgNC44NTM1NUM4LjY1ODI5IDUuMDQ4ODIgOC4zNDE3MSA1LjA0ODgyIDguMTQ2NDUgNC44NTM1NUw1IDEuNzA3MTFWOEM1IDkuMTA0NTcgNS44OTU0MyAxMCA3IDEwTDEzLjUgMTBDMTMuNzc2MSAxMCAxNCAxMC4yMjM5IDE0IDEwLjVDMTQgMTAuNzc2MSAxMy43NzYxIDExIDEzLjUgMTFMNyAxMUM1LjM0MzE1IDExIDQgOS42NTY4NSA0IDhMNCAxLjcwNzExTDAuODUzNTUzIDQuODUzNTVDMC42NTgyOTEgNS4wNDg4MiAwLjM0MTcwOSA1LjA0ODgyIDAuMTQ2NDQ3IDQuODUzNTVaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K"}),nl=()=>C.createElement("svg",{viewBox:"0 0 16 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},C.createElement("g",{clipPath:"url(#clip0_2770_459598)"},C.createElement("path",{d:"M6.19594 0.921875L1.49974 3.63385C0.571684 4.16979 0 5.16009 0 6.23178V11.7682C0 12.8398 0.571643 13.8301 1.49965 14.366L3.76712 15.6756L3.99007 15L8.23734 12.4567L6.49965 11.4531C5.57164 10.9172 5 9.9269 5 8.85525V7.27344L5.46563 6.67953L6.99999 5.49176V2L6.32422 1.01172L5.58517 1.53879C5.75624 1.30668 5.96137 1.09837 6.19594 0.921875Z",fill:"url(#paint0_linear_2770_459598)"}),C.createElement("path",{d:"M6.19594 0.921875L1.49974 3.63385C0.571684 4.16979 0 5.16009 0 6.23178V11.7682C0 12.8398 0.571643 13.8301 1.49965 14.366L3.76712 15.6756L3.99007 15L8.23734 12.4567L6.49965 11.4531C5.57164 10.9172 5 9.9269 5 8.85525V7.27344L5.46563 6.67953L6.99999 5.49176V2L6.32422 1.01172L5.58517 1.53879C5.75624 1.30668 5.96137 1.09837 6.19594 0.921875Z",fill:"url(#paint1_linear_2770_459598)"}),C.createElement("path",{d:"M10.9988 6.61523V8.85594C10.9988 9.92759 10.4271 10.9179 9.49914 11.4538L4.49914 14.3415C3.57076 14.8776 2.42682 14.8776 1.49844 14.3415L1.19531 14.1664C1.29151 14.2387 1.39266 14.3057 1.49844 14.3668L6.49844 17.2545C7.42682 17.7906 8.57076 17.7906 9.49914 17.2545L14.4991 14.3668C15.4271 13.8309 15.9988 12.8406 15.9988 11.769V9.68789L10.9988 6.61523Z",fill:"url(#paint2_radial_2770_459598)"}),C.createElement("path",{d:"M10.9988 6.61523V8.85594C10.9988 9.92759 10.4271 10.9179 9.49914 11.4538L4.49914 14.3415C3.57076 14.8776 2.42682 14.8776 1.49844 14.3415L1.19531 14.1664C1.29151 14.2387 1.39266 14.3057 1.49844 14.3668L6.49844 17.2545C7.42682 17.7906 8.57076 17.7906 9.49914 17.2545L14.4991 14.3668C15.4271 13.8309 15.9988 12.8406 15.9988 11.769V9.68789L10.9988 6.61523Z",fill:"url(#paint3_linear_2770_459598)"}),C.createElement("path",{d:"M6.19524 0.921668L6.49974 0.745824C7.42807 0.209725 8.57193 0.209726 9.50026 0.745825L14.5003 3.63324C15.4283 4.16918 16 5.15948 16 6.23117V11.7675C16 11.7881 15.9998 11.8087 15.9994 11.8293C15.9779 10.7814 15.4105 9.8187 14.5003 9.29307L9.50026 6.40565C8.57193 5.86955 7.42807 5.86954 6.49974 6.40564L5 7.27172V3.31815C5 2.36919 5.44824 1.48405 6.19524 0.921668Z",fill:"url(#paint4_radial_2770_459598)"}),C.createElement("path",{d:"M6.19524 0.921668L6.49974 0.745824C7.42807 0.209725 8.57193 0.209726 9.50026 0.745825L14.5003 3.63324C15.4283 4.16918 16 5.15948 16 6.23117V11.7675C16 11.7881 15.9998 11.8087 15.9994 11.8293C15.9779 10.7814 15.4105 9.8187 14.5003 9.29307L9.50026 6.40565C8.57193 5.86955 7.42807 5.86954 6.49974 6.40564L5 7.27172V3.31815C5 2.36919 5.44824 1.48405 6.19524 0.921668Z",fill:"url(#paint5_linear_2770_459598)"})),C.createElement("defs",null,C.createElement("linearGradient",{id:"paint0_linear_2770_459598",x1:"7.09324",y1:"4.8282",x2:"2.74492",y2:"17.4869",gradientUnits:"userSpaceOnUse"},C.createElement("stop",{stopColor:"#AE7FE2"}),C.createElement("stop",{offset:"1",stopColor:"#0078D4"})),C.createElement("linearGradient",{id:"paint1_linear_2770_459598",x1:"5.44306",y1:"14.2211",x2:"4.6907",y2:"12.8939",gradientUnits:"userSpaceOnUse"},C.createElement("stop",{offset:"0.9999",stopColor:"#114A8B"}),C.createElement("stop",{offset:"1",stopColor:"#0078D4",stopOpacity:"0"})),C.createElement("radialGradient",{id:"paint2_radial_2770_459598",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(3.14608 13.7577) rotate(-13.0688) scale(12.7772 9.84272)"},C.createElement("stop",{offset:"0.140029",stopColor:"#D59DFF"}),C.createElement("stop",{offset:"1",stopColor:"#5E438F"})),C.createElement("linearGradient",{id:"paint3_linear_2770_459598",x1:"13.826",y1:"8.8471",x2:"13.1058",y2:"10.0024",gradientUnits:"userSpaceOnUse"},C.createElement("stop",{offset:"0.9999",stopColor:"#493474"}),C.createElement("stop",{offset:"1",stopColor:"#8C66BA",stopOpacity:"0"})),C.createElement("radialGradient",{id:"paint4_radial_2770_459598",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(14.5411 9.31795) rotate(-143.083) scale(11.412)"},C.createElement("stop",{stopColor:"#50E6FF"}),C.createElement("stop",{offset:"1",stopColor:"#436DCD"})),C.createElement("linearGradient",{id:"paint5_linear_2770_459598",x1:"5.0174",y1:"4.56496",x2:"6.18205",y2:"4.56496",gradientUnits:"userSpaceOnUse"},C.createElement("stop",{offset:"0.9999",stopColor:"#114A8B"}),C.createElement("stop",{offset:"1",stopColor:"#0078D4",stopOpacity:"0"})),C.createElement("clipPath",{id:"clip0_2770_459598"},C.createElement("rect",{width:"16",height:"18",fill:"white"})))),sl={fontFamily:"Segoe UI",fontStyle:"normal",fontWeight:"600",fontSize:"12px",lineHeight:"16px",verticalAlign:"middle",padding:"0px 12px 0px 6px"},al={display:"flex",height:"16px",padding:"4px"},ll={root:{height:"24px",width:"24px",fontSize:"12px",lineHeight:"16px",borderRadius:"4px",marginLeft:"3px",padding:"0px",border:"0px solid transparent",minWidth:"24px",background:"transparent"},menuIcon:{display:"none"}},cl=e=>({root:{height:"24px",width:"82px",fontSize:"12px",lineHeight:"16px",borderRadius:"4px",marginRight:"3px",background:e.primaryButtonBackground?.resting}}),dl={width:"auto",display:"flex",justifyContent:"space-between",padding:"12px"};var ul,gl=i(96872);!function(e){e[e.ModelQualityError=0]="ModelQualityError",e[e.ServiceQualityError=1]="ServiceQualityError"}(ul||(ul={}));const pl=e=>{const t=e.definition,i=()=>e.theme?e.theme:A,o=()=>e.fontTable?e.fontTable:E;let r=!1,n=!1,s="";e.settings&&e.settings.ErrorType?(r=!0,e.settings.ErrorType===ul[ul.ModelQualityError]?s=e.resources.AIFeedbackCardModelQualityError:(n=!0,s=e.resources.AIFeedbackCardServiceQualityError)):t.suggestions&&0!==t.suggestions.length||(r=!0,n=!0,s=e.resources.AIFeedbackCardServiceQualityError);const a=C.createElement(nt.S,{style:L,align:st.j5.Stretch},C.createElement(Lt.c,{text:e.definition.isContentPending||r?e.resources.AIFeedbackCardLoadingSubHeader:e.resources.AIFeedbackCardSubHeader,style:oe(i(),o()),accessibilityRole:"heading"})),l=C.createElement(To,{key:0,shimmerCount:3,styles:Me(e.spacing||{xsmall:8,small:12,medium:16})});if(e.definition.isContentPending)return C.createElement(nt.S,{style:me(i(),{...e.style,minWidth:500,maxWidth:728}),align:st.j5.Stretch},[a,l]);const c=(t,r,n,s)=>({title:t.title,titleStyle:s?be(o(),t.title.length):(0,Dt.S)(t.title.length,i(),t.titleDecorations),tag:t.tag,tagStyle:fe(o()),icon:void 0,disabled:s,onClick:()=>{e.onAction?.(n,r)},theme:ge(i(),void 0),strings:Bi(e.strings.common),accessibilityRole:"menuitem",accessibilityLabel:t.title,automationLabel:"AIFeedbackSuggestion_"+t.id}),d=(t,o,r,n,s,a)=>[C.createElement(ca,{key:t,ref:r,buttonProps:c({title:o,actions:[n],titleDecorations:s},0,n,a),menuProps:void 0,style:j,theme:{splitMenuHoverBackground:i().suggestionMenuHoverBackground,splitMenuHoverForeground:i().suggestionMenuHoverForeground},strings:ji(e.strings.common),accessibilityPositionInSet:1,accessibilitySetSize:1})],u=C.createElement(nt.S,{align:st.j5.Stretch},C.createElement(ft,null,C.createElement(nt.S,{align:st.j5.Stretch,accessible:!0,accessibilityRole:"menu"},r?d(1,s,void 0,Je.Accept,[],!0):d(1,t.suggestions[0].title,void 0,t.suggestions[0].actions[0],t.suggestions[0].titleDecorations,!1))));if(r){const t={title:e.resources.AIFeedbackCardRetryLabel,onClick:()=>{e.onAction?.(Je.Options,0)}},o=n?C.createElement("div",{style:dl},C.createElement(nt.S,{direction:st.PR.LeftToRight,align:st.j5.Stretch},C.createElement(ns.j,{styles:(g=i(),{root:{height:"24px",width:"82px",fontSize:"12px",lineHeight:"16px",borderRadius:"4px",marginRight:"3px",padding:"5px",background:g.primaryButtonBackground?.resting,justifyContent:"start",display:"flex"}}),...t},C.createElement(Fi.In,{type:"Repeat",fontSize:18,style:{margin:8}}),e.resources.AIFeedbackCardRetryLabel))):null;return C.createElement(nt.S,{style:me(i(),{...e.style,minHeight:120,minWidth:500,maxWidth:728}),align:st.j5.Stretch},[a,u,o])}var g;const p={title:e.resources.AIFeedbackCardReplaceLabel,onClick:()=>{e.onAction?.(Je.Accept,0)}},h={style:(m=o(),{paddingBottom:0,paddingVertical:0,marginStart:5,borderRadius:2,iconFontSize:m.xlarge}),theme:ge(i(),void 0,!0),tooltip:e.resources.AIFeedbackCardFactCheckLabel,accessibilityLabel:e.resources.AIFeedbackCardFactCheckLabel,automationLabel:`FactCheckButton_${e.automationId}`,icon:{type:"ShowExplanation",filled:!0}};var m;const y={onDismiss:e=>{e&&"shiftKey"in e&&e.preventDefault()},items:[{key:"GiveFeedback",text:e.resources.AIFeedbackCardGiveFeedbackLabel,iconProps:{iconName:"Feedback"},onRenderIcon:()=>C.createElement(gl.tNe,{color:i().header,style:{padding:"8px 4px"}}),onClick:()=>{e.onAction?.(Je.Feedback)}}],directionalHintFixed:!0},b={title:e.resources.AIFeedbackCardMoreLabel,menuProps:y,menuIconProps:{iconName:void 0}},S=C.createElement("div",{style:dl},C.createElement(nt.S,{direction:st.PR.LeftToRight,align:st.j5.Stretch},C.createElement(ns.j,{styles:cl(i()),...p},C.createElement(rl,null),e.resources.AIFeedbackCardReplaceLabel),t.explanation&&C.createElement(Io,{calloutAccessibilityLabel:e.strings.critique(e.resources.AIFeedbackCardFactCheckCalloutAccessibilityLabel),buttonProps:h},C.createElement(nt.S,{direction:st.PR.TopToBottom,style:$(e.style,i()),align:st.j5.Stretch},C.createElement(Lt.c,{text:e.resources.AIFeedbackCardFactCheckLabel,style:ne(i(),o()),accessibilityRole:"heading"}),C.createElement(Lt.c,{text:t.explanation,style:se(i(),o()),accessibilityRole:"text"}))),C.createElement(ss.Y,{styles:ll,...b},C.createElement(Fi.In,{type:"Overflow"}))),C.createElement(ol.S,{calloutProps:{isBeakVisible:!1,gapSpace:12},directionalHint:f.A.bottomCenter,content:e.resources.raiTooltip,id:"raitooltip"},C.createElement("div",{style:al},C.createElement(nl,null),C.createElement("span",{style:sl},e.resources.copilot))));return C.createElement(nt.S,{style:me(i(),{...e.style,maxWidth:728}),align:st.j5.Stretch},[a,u,S])};var hl;!function(e){e[e.Default=0]="Default",e[e.Feedback=1]="Feedback"}(hl||(hl={}));class ml extends C.Component{static isRewriteFeedbackNegative(e){return e!==ia.FeedbackOptionHelpful}setDefinition(e){this.setState({definition:e})}componentDidUpdate(e){e.definition!==this.props.definition&&this.setState({definition:this.props.definition})}focus(){}render(){const e=this.getDefinition();if(!e||!e.suggestions)return null;switch(this.state.rewriteState){case hl.Default:const t=e.suggestions.map((t=>{if(this.isSuggestionReportedNegative(t.title))return{...t,actions:t.actions.filter((e=>e!==Je.Accept)),title:this.props.strings.neuralRewrite("neuralRewriteReportedSuggestionTitle"),subtitle:void 0,titleDecorations:void 0};if(void 0===t.titleDecorations&&e.contextText){const{commonPrefixLength:i,commonSuffixLength:o}=function(e,t){const i=t.length,o=function(e,t){const i=e.length,o=t.length;let r=0,n=0;for(let s=0;s<Math.min(i,o)&&e.charAt(s)===t.charAt(s);s++)r++,Ds(e.charCodeAt(s))&&(n=r);return n}(e,t),r=Math.min(function(e,t){const i=e.length,o=t.length;let r=0,n=0;for(let s=0;s<Math.min(i,o)&&e.charAt(i-s-1)===t.charAt(o-s-1);s++)r++,Ds(e.charCodeAt(i-s-1))&&(n=r);return n}(e,t),Math.min(i,e.length)-o),n=o+r,s=i-n,a=Math.min(130,s),l=Math.min(150-a,n),c=Math.min(l,o),d=Math.min(l,r),{actualLeftContextLength:u,actualRightContextLength:g}=function(e,t,i){let o,r;const n=e/2;return t<n&&i<n?(o=t,r=i):t<n?(o=t,r=Math.min(i,e-o)):i<n?(r=i,o=Math.min(t,e-r)):(o=n,r=n),{actualLeftContextLength:o,actualRightContextLength:r}}(l,c,d),p=t.substring(o-u,o),h=t.substring(o,i-r),m=t.substring(i-r,i-r+g);let y=p,b=h,f=m;if(o>u){const e=yl(p,0,p.length,!0);y="..."+p.substring(e,p.length)}if(h.length>a){const e=yl(h,0,a/2,!1),t=yl(h,a/2,h.length,!0);b=h.substring(0,e)+"..."+h.substring(t,h.length)}if(r>g){const e=yl(m,0,m.length,!1);f=m.substring(0,e)+"..."}return{truncatedPrefix:y,truncatedSubstring:b,truncatedSuffix:f,target:h,commonPrefixLength:o,commonSuffixLength:r}}(e.contextText,t.title);return{...t,titleDecorations:[{start:i,length:t.title.length-i-o,decorationType:$e.Rewrite}]}}return t})),i={...this.props,definition:{...e,suggestions:t},onAction:this.onCritiqueCardClick};return C.createElement(pl,{...i});case hl.Feedback:return this.renderFeedback()}}getDefinition(){return this.state.definition}onCritiqueCardClick(e,t){e===Je.Feedback&&this.setState({rewriteState:hl.Feedback,rewriteReportedSuggestionId:this.props.definition.suggestions[0].id,rewriteOption:this.props.definition.suggestions[0].id,rewriteChoiceGroupSelected:!0}),this.props.onAction&&this.props.onAction(e,t)}onFeedbackCardDismiss(){this.setState({rewriteState:hl.Default})}onFeedbackCardBack(){this.setState({rewriteState:hl.Default,rewriteChoiceGroupSelected:!0})}renderFeedback(){const e=this.getDefinition(),t=this.getIndexOfReportedSuggestion(),i={...this.props,style:void 0,reportedSuggestionIndex:t,showCheckbox:!0,definition:e,onBack:this.onFeedbackCardBack,onDismiss:this.onFeedbackCardDismiss,onReport:this.onFeedbackCardReport};return C.createElement(nt.S,{style:me(this.props.theme||A,this.props.style)},C.createElement(ia,{...i,theme:this.props.theme}))}isSuggestionReportedNegative(e){return ml.suggestionsReportedNegative.indexOf(e)>=0}isSuggestionAlreadyReported(e){return ml.reportedSuggestions.indexOf(e)>=0}onRewriteSelectFeedbackSuggestion(e){e&&this.setState({rewriteReportedSuggestionId:e.key,rewriteChoiceGroupSelected:!0})}onRewriteReportSuggestionCancel(){this.setState({rewriteState:hl.Default,rewriteReportedSuggestionId:void 0,rewriteChoiceGroupSelected:!1})}onRewriteReportSuggestionNext(){this.setState({rewriteState:hl.Feedback,rewriteChoiceGroupSelected:!1})}getIndexOfReportedSuggestion(){const e=this.state.rewriteReportedSuggestionId,t=this.getDefinition();if(t.suggestions)for(let i=0;i<t.suggestions.length;i++){const o=t.suggestions[i];if(o&&o.id===e)return o&&o.title?i:-1}}onFeedbackCardReport(e,t){const i=this.getDefinition();if(!this.state.rewriteReportedSuggestionId||!i.suggestions)return;const o=this.getIndexOfReportedSuggestion();if(void 0===o)return;const r=i.suggestions[o].title;this.props.onAction&&this.props.onAction(Je.Report,o,{action:"feedback",type:i.critiqueType,option:e.option,comments:e.comments,payload:e.payload}),this.isSuggestionAlreadyReported(r)||i.critiqueType===Qe.Grammar||ml.reportedSuggestions.push(r),void 0!==e.option&&ml.isRewriteFeedbackNegative(e.option)&&!this.isSuggestionReportedNegative(r)&&i.critiqueType!==Qe.Grammar&&ml.suggestionsReportedNegative.push(r),this.setState({rewriteReportedSuggestionId:void 0,rewriteChoiceGroupSelected:!1})}constructor(e){super(e),this.onRewriteSelectFeedbackSuggestion=this.onRewriteSelectFeedbackSuggestion.bind(this),this.onRewriteReportSuggestionCancel=this.onRewriteReportSuggestionCancel.bind(this),this.onRewriteReportSuggestionNext=this.onRewriteReportSuggestionNext.bind(this),this.onCritiqueCardClick=this.onCritiqueCardClick.bind(this),this.onFeedbackCardBack=this.onFeedbackCardBack.bind(this),this.onFeedbackCardDismiss=this.onFeedbackCardDismiss.bind(this),this.onFeedbackCardReport=this.onFeedbackCardReport.bind(this),this.state={definition:e.definition,rewriteState:hl.Default,rewriteReportedSuggestionId:void 0,rewriteOption:void 0,rewriteChoiceGroupSelected:!1}}}function yl(e,t,i,o){if(o){for(;!Ds(e.charCodeAt(t))&&t<i;)++t;return t}const r=i;for(;!Ds(e.charCodeAt(i))&&i>t;)--i;return i+1<=r&&++i,i}ml.reportedSuggestions=[],ml.suggestionsReportedNegative=[];class bl extends Zn{critiqueComponent(){const e=this.convertCritiqueType();return this.props.group.critiqueSubType===Vn?ml:e===Qe.NeuralRewrite||e===Qe.Grammar&&"en-US"===this.props.uiCulture||"b1634cf9-5f68-42f4-82ca-e668f893d28f"===this.props.group.critiqueSubType||this.props.group.critiqueSubType===Vn?Ha:za}renderSharedCritique(){const e=this.convertCritiqueType();if(null==e)return null;const t=this.critiqueComponent(),i=this.getCritiqueProps(e),o=C.createElement("div",{id:this.headerId(),"aria-label":this.getCardHeaderText()},C.createElement(t,{ref:this.innerCritique,...i}));return this.props.parameters.definition?.aIRewriteButtonText&&c.Hv.sendTraceTag(506283853,d.n.msoulscat_Wac_Telemetry,u.k.Info,"["+this.props.group.critiqueCategory+"] ECC Nudge Rewrite log - user saw ECC Nudge Rewrite using Copilot"),o}render(){return this.renderSharedCritique()}getCardHeaderText(){switch(this.props.group.type){case Pn:return this.props.resources.spellingCardTitle;case zn:return this.props.resources.RepeatedWordCardTitle;default:return this.headerText()}}getCritiqueProps(e){return{automationId:this.props.group.id||void 0,critiqueSource:"Inference"===this.props.group.icon?.resourceId?o.Inference:void 0,settings:{RenderFooterIcons:this.props.parameters.renderFooterIcons||this.props.group.critiqueSubType===Vn?"true":"false",RenderNeuralRewriteFeedbackCustomerContentData:"true",EnableFeedback:e===Qe.Grammar&&"en-US"===this.props.uiCulture||e===Qe.NeuralRewrite||"b1634cf9-5f68-42f4-82ca-e668f893d28f"===this.props.group.critiqueSubType||this.props.group.critiqueSubType===Vn?"true":"false",ErrorType:this.props.group.errorMessage??""},definition:{definitionType:"CritiqueDefinition",critiqueType:e,header:this.props.group.cardHeader||"",contextText:this.props.group.snippet||void 0,explanation:this.props.group.explanation||void 0,explanationTitle:this.props.group.description||void 0,subheader:this.headerText(),contextDecorations:Ya(this.props.group.snippetFormatting,this.props.group.snippet),suggestions:(t=this.getSuggestionsToRender(),t?t.filter((e=>!!e)).map((e=>{return{id:(t=e).id||void 0,title:t.title||"",titleDecorations:Ya(t.titleFormatting,t.title),subtitle:t.description||void 0,actions:$a(t.supportedActions)};var t})):[]),showContext:this.state.showingContext,showDescription:this.state.showingDescription,actions:Qa(this.props.group.supportedActions,e,this.props.parameters.showEditorButton,this.props.group.critiqueSubType),brandingMode:this.getBrandingMode(e),brandingText:this.props.group.brandingText,brandingImageUri:this.props.group.brandingImageUri,isContentPending:this.props.group.isContentPending,critiqueSetSize:this.props.parameters.definition?this.props.parameters.definition.setSize:void 0,critiquePosition:this.props.parameters.definition?this.props.parameters.definition.positionInSet:void 0,helpLink:il(this.props.parameters.definition?.helpLink),showDictationCommandUx:this.props.parameters.showDictationCommandUx,showAIRewriteNudgeForCritiqueType:this.props.parameters.definition?.aIRewriteButtonText?[Qe.Grammar,Qe.Refinement]:void 0,aIRewriteButtonText:this.props.parameters.definition?.aIRewriteButtonText},addOnFooterData:el(this.props.parameters.addOnFooterData),onAction:this.onInnerCritiqueClick,style:this.getInnerCritiqueStyle(e),theme:hn(),strings:Ka(this.props.resources),resources:this.props.resources};var t}getBrandingMode(e){return e===Qe.AddinCritique?(this.props.group.brandingImageUri?.length??0)>0&&(this.props.group.brandingText?.length??0)>0?Ye.CustomImageAndText:void 0:this.props.parameters.showEditorButton||this.props.parameters.showEditorBranding?Ye.IconAndTextButton:void 0}getInnerCritiqueStyle(e){return{minWidth:e===Qe.NeuralRewrite?370:248,maxWidth:380}}convertCritiqueType(){switch(this.props.group.type){case Pn:return Qe.Spelling;case zn:return Qe.RepeatedWord;case Un:return Qe.Grammar;case Wn:return Qe.Refinement;case Gn:return Qe.NeuralRewrite;case _n:return Qe.DictationCorrection;case qn:return Qe.AddinCritique}return null}onInnerCritiqueClick(e,t,i,o){let n;switch(e){case Je.ToggleContext:this.onShowHideContext(),n=jn;break;case Je.ToggleDescription:this.onShowHideDescription(),n=Hn;break;case Je.AddOnFooterAction:n=this.props.parameters.addOnFooterData.actionText;break;case Je.Dismiss:this.props.dismiss&&this.props.dismiss(o??{actionSourceId:r.Unknown});break;case Je.LaunchAIRewrite:c.Hv.sendTraceTag(506283852,d.n.msoulscat_Wac_Telemetry,u.k.Info,"["+this.props.group.critiqueCategory+"] ECC Nudge Rewrite log - user clicked on the Rewrite Nudge")}const s=Xa(e);if(null==s)return void c.Hv.sendTraceTag(590116176,d.n.msoulscat_Wac_Telemetry,u.k.Error,"Unknown actionId");e===Je.Accept&&this.props.parameters.definition?.aIRewriteButtonText&&c.Hv.sendTraceTag(506283851,d.n.msoulscat_Wac_Telemetry,u.k.Info,"["+this.props.group.critiqueCategory+"] ECC Nudge Rewrite log - user saw Nudge but fixed using Editor suggestions");const a=function(e,t){if(t&&e===zr.Report&&"feedback"===t.action){const e=t;return JSON.stringify(e)}}(s,i),l=this.props.group.suggestions&&void 0!==t&&t<this.props.group.suggestions.length?this.props.group.suggestions[t]:void 0;this.onAction(null,s,Pr.Try,this.props.group,l||void 0,n,a,o)}headerText(){return this.props.group.critiqueSubType===Vn?this.props.resources.AIFeedbackCardSubHeader:this.props.group.title?this.props.group.title:""}onShowHideContext(){this.setState((e=>({showingContext:!e.showingContext})))}onShowHideDescription(){this.setState((e=>({showingDescription:!e.showingDescription})))}suggestionListDescription(){return""}invokeBadgeId(e){this.innerCritique.current&&this.innerCritique.current.executeBadgedAction(e)}constructor(e){super(e),this.innerCritique=C.createRef(),this.onInnerCritiqueClick=this.onInnerCritiqueClick.bind(this),(0,hs.Y)(new ms.F),e.dependencies.loadUpsellDependencies?.(),this.state={showingContext:this.props.parameters.showSnippet,showingDescription:this.props.parameters.showDescription}}}class fl extends ls{static getDerivedStateFromProps(e,t){const i=fl.getSelectedSuggestion(e);return i!==t.selectedSuggestion?{selectedSuggestion:i}:null}static getSelectedSuggestion(e){return e.group.previewData?this.getPreviewData(e)?.getSelectedOption():e.group?.suggestions?.length?e.group.suggestions[0]:void 0}static getPreviewData(e){return e.group?.previewData}getActionString(e){return e===zr.ViewOriginal?this.state.isViewingOriginal?this.props.resources.ViewSuggestionTooltip:this.props.resources.ViewOriginalTooltip:e===zr.Next?1===this.props.parameters.definition.setSize?this.props.resources.DoneButton:this.props.resources.NextButton:e===zr.OpenDesignerPane?this.props.resources.DesignerButtonText:e===zr.SnoozeAll?this.props.resources.HideSuggestionsButton:super.getActionString(e)}headerText(){return this.props.group.title??this.props.resources.DesignerMenuText}renderSuggestions(){return null}renderFooter(){return C.createElement("div",{key:"footer",style:this.props.styleProvider.footerStyles},C.createElement("div",{style:this.props.styleProvider.footerActionsStyleWrapper},C.createElement("div",{style:this.props.styleProvider.footerActionsLeftStyle},this.renderLeftActions()),C.createElement("div",{style:this.props.styleProvider.footerActionsRightStyle},this.renderRightActions())))}render(){return C.createElement("div",{style:this.props.styleProvider.externalWrapperStyles},super.render(),this.renderProactivePrompt())}getProactivePromptSideIconProps(){return{iconName:"MeetingInsights_20",styles:this.props.styleProvider.promptIconStyle}}getProactivePromptBodyIconProps(){return{iconName:"More",styles:this.props.styleProvider.promptBodyIconStyle}}getProactivePromptBodyText(){if(this.props.parameters.proactivePromptHintType)switch(this.props.parameters.proactivePromptHintType){case Vr.None:return c.Hv.shipAssertTag(523637135,d.n.msoulscat_Wac_WordDesigner,!1,"getProactivePromptBodyText with no hint"),"";case Vr.HideFromReviewCard:return this.props.resources.HideSuggestionsProactiveHintBody;case Vr.HideFromReviewCardAndRibbon:return this.props.resources.HideSuggestionsWithRibbonProactiveHintBody}return this.props.resources.HideSuggestionsProactiveHintBody}getProactivePromptCaptionText(){if(this.props.parameters.proactivePromptHintType)switch(this.props.parameters.proactivePromptHintType){case Vr.None:return c.Hv.shipAssertTag(523637136,d.n.msoulscat_Wac_WordDesigner,!1,"getProactivePromptCaptionText with no hint"),"";case Vr.HideFromReviewCard:return this.props.resources.HideSuggestionsProactiveHintCaption;case Vr.HideFromReviewCardAndRibbon:return this.props.resources.HideSuggestionsWithRibbonProactiveHintCaption}return this.props.resources.HideSuggestionsProactiveHintCaption}renderProactivePrompt(){if(!this.props.parameters.proactivePromptHintType||this.props.parameters.proactivePromptHintType===Vr.None)return;const e=this.getProactivePromptBodyText(),t=e.substring(0,e.indexOf("{0}")),i=e.substring(e.indexOf("{0}")+3,e.length);return C.createElement("div",{key:"prompt",style:this.props.styleProvider.promptStyles},C.createElement("div",{style:this.props.styleProvider.promptStyleWrapper},C.createElement("div",{style:this.props.styleProvider.promptIconStyleWrapper},C.createElement(is.I,{...this.getProactivePromptSideIconProps()})),C.createElement("div",{style:this.props.styleProvider.promptTextStyleWrapper},C.createElement("div",{style:this.props.styleProvider.promptTextHeadingStyle},this.getProactivePromptCaptionText()),C.createElement("div",{style:this.props.styleProvider.promptTextBodyStyle},t,C.createElement(is.I,{...this.getProactivePromptBodyIconProps()}),i))))}getActionButtonIconProps(e){switch(e){case zr.Accepted:return{iconName:"Accept",styles:this.props.styleProvider.acceptIconStyles(this.shouldDisableActionButton(e))};case zr.Rejected:return{iconName:"Clear",styles:this.props.styleProvider.rejectIconStyles(this.shouldDisableActionButton(e))};case zr.ViewOriginal:return{iconName:this.state.isViewingOriginal?"ViewOriginalFormattingBlue_16":"ViewOriginalFormattingGray_16",styles:this.props.styleProvider.viewOriginalIconStyles(this.state.isViewingOriginal)};case zr.Undo:return{iconName:"Undo",styles:this.props.styleProvider.defaultIconStyles};case zr.OpenDesignerPane:return{iconName:"Designer_20",styles:this.props.styleProvider.openPaneIconStyle};case zr.SnoozeAll:return{iconName:"Hide_16",styles:this.props.styleProvider.overflowActionIconStyles};case zr.AcceptAll:case zr.RejectAll:case zr.ShowHideContext:return{iconName:"Empty_16",styles:this.props.styleProvider.overflowActionIconStyles};case zr.GiveFeedback:return{iconName:"Feedback",styles:this.props.styleProvider.giveFeedbackIconStyles}}}renderLeftActions(){const e={isViewingOriginal:this.state.isViewingOriginal,setIsViewingOriginal:e=>this.setState({isViewingOriginal:e},(()=>this.viewOriginalButtonRef.current?.focus()))};return[this.renderActionButton(zr.Accepted,this.props.styleProvider.actionButtonStyles,void 0,void 0,!0),this.renderActionButton(zr.Rejected,this.props.styleProvider.actionButtonStyles,void 0,void 0,!0),this.renderActionButton(zr.ViewOriginal,this.props.styleProvider.viewOriginalButtonStyles(this.state.isViewingOriginal),void 0,void 0,!0,e),this.renderActionButton(zr.Next,this.props.styleProvider.nextButtonStyles),this.renderActionButton(zr.Undo,this.props.styleProvider.actionButtonStyles,void 0,void 0,!0),this.renderOverflowMenu()]}renderRightActions(){return this.state.isContextualSuggestion?[this.renderActionButton(zr.GiveFeedback,this.props.styleProvider.actionButtonStyles,void 0,void 0,!0),this.renderActionButton(zr.OpenDesignerPane,this.props.styleProvider.openPaneButtonStyle,void 0,void 0,!0)]:this.renderNextPrev()}getActionButtonAriaDescription(e){switch(e){case zr.Accepted:return this.props.resources.AcceptTooltip;case zr.Rejected:return this.props.resources.RejectTooltip;case zr.OpenDesignerPane:return this.props.resources.DesignerButtonTooltipContent}}renderOverflowActions(){const e=[this.renderShowHideContextButton()];return this.state.isContextualSuggestion&&!this.state.isFormattingSuggestion||e.push(this.renderActionButton(zr.AcceptAll,this.props.styleProvider.overflowActionButtonStyles,void 0,"menuitem")),e.push(this.renderActionButton(zr.RejectAll,this.props.styleProvider.overflowActionButtonStyles,void 0,"menuitem")),e.push(this.renderActionButton(zr.SnoozeAll,this.props.styleProvider.overflowActionButtonStyles,void 0,"menuitem")),e}shouldDisableActionButton(e,t){return this.state.isViewingOriginal?e!==zr.ViewOriginal&&e!==zr.GiveFeedback&&e!==zr.OpenDesignerPane:e===zr.Rejected&&!this.hasActionType(e,t)}shouldDismissOnAction(e){return!(!this.props.parameters.shouldSkipTwoStepReview||e!==zr.Accepted&&e!==zr.Rejected)||super.shouldDismissOnAction(e)&&e!==zr.Apply&&e!==zr.Accepted&&e!==zr.Rejected&&e!==zr.Undo&&e!==zr.ViewOriginal&&e!==zr.ShowMore}getTooltipString(e){if(!this.shouldDisableActionButton(e))switch(e){case zr.Accepted:return this.props.resources.AcceptButton;case zr.Rejected:return this.props.resources.RejectButton;case zr.OpenDesignerPane:return this.props.resources.DesignerButtonTooltipContent;case zr.Undo:return this.props.resources.UndoButton;case zr.ViewOriginal:return this.state.isViewingOriginal?this.props.resources.ViewSuggestionTooltip:this.props.resources.ViewOriginalTooltip;case zr.GiveFeedback:return this.props.resources.GiveFeedbackButtonText;case zr.SnoozeAll:return this.props.resources.HideSuggestionsButtonTooltip;default:return}}renderOverflowMenu(){return C.createElement(ol.S,{directionalHint:f.A.bottomCenter,content:this.props.resources.OverflowButtonAccessibilityLabel},super.renderOverflowMenu())}getActionButtonToRender(e,t){const i=this.getActionString(e),o=this.getActionButtonAriaDescription(e),r=this.getTooltipString(e);let n=C.createElement(Kn._,{...t,ariaLabel:i,ariaDescription:o,componentRef:e===zr.ViewOriginal?this.viewOriginalButtonRef:void 0});return e===zr.Next&&(n=C.createElement(ns.j,{...t,ariaLabel:i,ariaDescription:o})),void 0===r?n:C.createElement(ol.S,{directionalHint:f.A.bottomCenter,content:r},n)}renderNavigationButton(e){const t=e?this.props.resources.NextButton:this.props.resources.PreviousButton;return C.createElement(ol.S,{directionalHint:f.A.bottomCenter,content:t},super.renderNavigationButton(e))}constructor(e){super(e),this.viewOriginalButtonRef=C.createRef(),this.state={showingContext:this.props.parameters.showSnippet,selectedSuggestion:fl.getSelectedSuggestion(this.props),shouldScrollToSelectedMenuItem:!0,isContextualSuggestion:!0===this.props.parameters.showDesignerButton,isFormattingSuggestion:!0===this.props.parameters.isFormattingSuggestion,isViewingOriginal:!1}}}fl.critique="DesignerCritiqueV2",fl.imageCritique="DesignerImageCritique",fl.pqCritique="DesignerPQCritique";var Sl=i(94869),vl=i(61186);class Cl extends fl{renderSuggestions(){if(!this.props.group.suggestions?.length)return null;const e=this.state.selectedSuggestion?.title,t={maxWidth:"175px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",lineHeight:"32px",padding:"0px 7px",...this.getTriageItemStyle(this.state.selectedSuggestion?.titleFormatting)},i={...this.props.styleProvider.triageButtonStyles,label:t};return C.createElement(ol.S,{directionalHint:f.A.bottomCenter,content:this.state.isViewingOriginal?void 0:this.props.resources.ChangeRoleTooltip},C.createElement(ss.Y,{text:e,styles:i,disabled:this.state.isViewingOriginal,menuProps:this.getTriageMenuProps(),menuAs:this.getTriageMenu,"aria-description":this.props.resources.ChangeRoleTooltip,autoFocus:!0}))}getTriageMenuProps(){const e=this.getTriageItems(),t={key:"separator-designer",itemType:Sl.G.Divider,itemProps:{styles:this.props.styleProvider.triageContextualMenuItemStyles}},i=fl.getPreviewData(this.props)?.getSeparatorIndexes();if(i){let o=0;for(const r of i)e.splice(r+o,0,t),o+=1}else e.splice(2,0,t);return{coverTarget:!0,items:e,contextualMenuItemAs:e=>C.createElement("span",{style:e.item.checked?this.props.styleProvider.menuSelectedItemSpanStyles:this.props.styleProvider.menuItemSpanStyles,ref:e.item.checked?this.scrollToSelectedItem:void 0},e.item.text),styles:this.props.styleProvider.triageContextualMenuStyles,directionalHint:this.props.isRightToLeft?f.A.topRightEdge:f.A.topLeftEdge,calloutProps:{styles:this.props.styleProvider.triageCalloutStyles},onMenuOpened:()=>{this.setState({shouldScrollToSelectedMenuItem:!0})}}}getTriageMenu(e){return C.createElement(vl.l,{...e})}getTriageItems(){return this.props.group.suggestions.filter((e=>!!e)).map((e=>({key:e.id,text:e.title,data:e,role:"menuitemradio",checked:e===this.state.selectedSuggestion,itemProps:{styles:e===this.state.selectedSuggestion?this.props.styleProvider.triageContextualMenuSelectedItemStyles:this.props.styleProvider.triageContextualMenuItemStyles},style:this.getTriageItemStyle(e.titleFormatting),onClick:()=>{this.onAction(null,zr.Apply,Pr.Try,this.props.group,e)}})))}getTriageItemStyle(e){if(e)for(const t of e)if(t)return{fontFamily:t.font,fontWeight:t.fontWeight===Ur.Bold?"bold":"normal",fontStyle:t.italic?"italic":void 0,fontSize:t.fontSize?`${t.fontSize}pt`:void 0,color:t.cssColor,textDecoration:t.underlineType>Gr.None?"underline":void 0,textDecorationStyle:t.underlineType>Gr.None?t.underlineType===Gr.Single?"solid":"double":void 0,backgroundColor:"transparent",backgroundImage:`url('${t.backgroundImg}')`,backgroundSize:"cover"}}constructor(){super(...arguments),this.scrollToSelectedItem=e=>{e&&this.state.shouldScrollToSelectedMenuItem&&(e.scrollIntoView({block:"center"}),this.setState({shouldScrollToSelectedMenuItem:!1}))}}}var xl=i(65156),kl=i(49538);const Tl=e=>{const t=(0,Er.Zq)({height:"100%",width:"100%",objectFit:"cover",objectPosition:"center"}),i=(0,C.useRef)(Date.now()),o=(0,C.useRef)(!1);return C.createElement(xl.A,{...e,title:e.imgAltText,focusOnHover:!1},C.createElement("img",{src:e.thumbnailSrc,alt:e.imgAltText,"aria-hidden":!0,className:t,onError:()=>c.Hv.shipAssertTag(526722326,d.n.msoulscat_Wac_WordDesigner,!1,"Image thumbnail failed to load"),onLoad:()=>{const e=Date.now()-i.current;!o.current&&e>1e3&&c.Hv.sendTraceTag(526722327,d.n.msoulscat_Wac_WordDesigner,u.k.Info,`Image thumbnail loaded after ${e}ms`),o.current=!0}}))},Il=e=>{const t=e.suggestion?.contentData,i=(0,Er.Zq)({height:"105%",width:"105%"}),o=(0,Er.Zq)({display:"-webkit-box",position:"absolute",overflow:"hidden",textOverflow:"ellipsis",WebkitLineClamp:"2",WebkitBoxOrient:"vertical",width:"calc(100% - 30px)",fontSize:"8px",fontFamily:t?.font,fontWeight:t?.bold===Ur.Bold?"bold":"normal",fontStyle:t?.italic?"italic":void 0,color:t?.color});return C.createElement(xl.A,{...e,title:t?.title,focusOnHover:!1},C.createElement("img",{src:t?.backgroundImg,alt:t?.title,"aria-hidden":!0,className:i}),C.createElement("span",{className:o},t?.title))};class wl extends fl{getSuggestionGalleryButtons(){const e=this.props.group.suggestions;if(!e)return[];const t=e.length;if(!t)return[];const i=[],o=Math.ceil(t/this.props.styleProvider.columnCount);for(let r=0;r<o;r++)for(let n=0;n<(this.props.styleProvider.columnCount??1);n++){const s=n*o+r;if(s>t)break;const a=e[s];if(!a)break;i.push({type:"AppGalleryButtonProps",id:a.id??`AppGalleryButton${s}`,style:this.props.styleProvider.galleryButtonStyles(n),thumbnailSrc:a.image?.src,imgAltText:a.image?.imageAltText,suggestion:a})}return i}render(){const e=this.props.group.suggestions?.length,t=e&&e>3?2:1;return this.props.styleProvider.columnCount=t,super.render()}renderSuggestions(){if(!this.props.group.suggestions?.length)return null;const e=this.getSuggestionGalleryButtons();return C.createElement("div",{className:this.props.styleProvider.imageSuggestionGalleryClassName},C.createElement(mt.R,{isCircularNavigation:!1},C.createElement(kl.z,{id:"DesignerGallerySuggestions",role:"menu",columns:this.props.styleProvider.columnCount??1,selectedId:this.state.selectedSuggestion?.id,onGalleryButtonExecute:this.onGalleryButtonExecute,getGalleryButtonComponent:this.props.group.type===fl.pqCritique?Il:Tl,gallerySections:[{galleryButtons:e}],defaultWidth:this.props.styleProvider.cardWidth})),this.shouldHideActionButton(zr.ShowMore)?null:C.createElement(as.N,{className:this.props.styleProvider.showMoreLinkClassName,onClick:()=>this.onAction(null,zr.ShowMore,Pr.Try,this.props.group,void 0)},this.props.resources.ShowMoreImagesLink))}constructor(){super(...arguments),this.onGalleryButtonExecute=e=>{const{galleryButton:t}=e;t&&this.onAction(null,zr.Apply,Pr.Try,this.props.group,t.suggestion)}}}class Al extends Zn{headerText(){return"Try saying:"}maximumSuggestions(){return 6}suggestionListDescription(){return""}renderHeader(){return C.createElement("div",null,super.renderHeader())}renderSuggestion(e,t){const i={allowDisabledFocus:!1,text:e.title,styles:this.props.styleProvider.suggestionButtonStyles,iconProps:{iconName:this.props.styleProvider.compoundButtonIconName(e),styles:this.props.styleProvider.suggestionButtonIconStyles},onClick:t=>this.onAction(t,zr.Apply,Pr.Try,this.props.group,e)};return C.createElement(Kn._,{key:e.id,...i})}}Al.id="Intent-DiscoveryCommand";class Dl extends C.Component{componentDidUpdate(){this.state.hasError&&this.props.onError&&this.props.onError(this.state.error,this.state.info)}render(){return this.state.hasError?this.props.fallbackRender?this.props.fallbackRender():null:this.props.children}componentDidCatch(e,t){this.setState({hasError:!0,error:e,info:t})}constructor(e){super(e),this.state={hasError:!1}}}var El=i(84719),Ml=i(30949);class Ll extends C.PureComponent{updateOnScrollOrResize(e){const t=e.target;this.calloutWrapperElement.current&&(0,h.s)(this.calloutWrapperElement.current,t)||this.pendingUpdate||(this.pendingUpdate=!0,this.forceUpdate())}dismissOnLostFocus(e){if(this.state.focusInside||this.state.parameters.shouldIgnoreFocusEvent?.(e.target))return;const t=e.target;this.calloutWrapperElement.current&&!(0,h.s)(this.calloutWrapperElement.current,t)&&this.dismiss({actionSourceId:r.Unknown})}ensureListeners(){this.async.setTimeout((()=>{null==this.targetWindow&&this.updateWindowIfNeeded(),null!=this.targetWindow&&(this.hasListeners&&this.removeListeners(),this.props.parameters.preventDismissOnScroll&&this.disposables.push((0,m.on)(this.targetWindow,"scroll",this.updateOnScrollOrResize,!0)),this.props.parameters.preventDismissOnResize&&this.disposables.push((0,m.on)(this.targetWindow,"resize",this.updateOnScrollOrResize,!0)),this.disposables.push((0,m.on)(this.targetWindow.document.documentElement,"click",this.dismissOnLostFocus,!0)),this.disposables.push((0,m.on)(this.targetWindow.document.documentElement,"focus",this.dismissOnLostFocus,!0)),this.hasListeners=!0)}),0)}removeListeners(){this.disposables.forEach((e=>e())),this.disposables=[],this.hasListeners=!1}getTargetElement(){return this.props.parameters.targetElement||this.props.parameters.containerElement}updateWindowIfNeeded(){const e=(0,y.z)(this.getTargetElement());if(e===this.targetWindow)return;const t=this.hasListeners;t&&this.removeListeners(),this.targetWindow=e||null,t&&this.ensureListeners()}componentDidMount(){this.props.parameters.onShow&&this.props.parameters.onShow(),this.ensureListeners()}componentWillUnmount(){this.async.dispose(),this.pendingUpdate=!1,this.targetWindow=null,this.hasListeners&&this.removeListeners(),this.props.parameters.onDismiss&&this.props.parameters.onDismiss(this.commonActionData)}componentDidUpdate(){this.ensureListeners()}render(){return this.pendingUpdate=!1,C.createElement("div",{ref:this.calloutWrapperElement},(0,El.isChangeGateEnabled)("OfficeVSO:9654079_wrapReactUiPaintTiming")?C.createElement(Ml.M,{elementTimingId:"canvas-contextual-menu",interactivityTrackerContext:this.props.parameters.definition?.id||void 0}):C.createElement(l.y,{elementTimingId:"canvas-contextual-menu",interactivityTrackerContext:this.props.parameters.definition?.id||void 0,isChangeGateEnabled:El.isChangeGateEnabled}),C.createElement(b.P,{role:"dialog","aria-labelledby":this.headerId(),setInitialFocus:!1,onDismiss:this.calloutOnDismissHandler,target:this.getTargetElement(),styles:this.props.styleProvider.contextualMenuStyles,isBeakVisible:!1,preventDismissOnEvent:this.props.parameters.preventDismissOnEvent??void 0,preventDismissOnLostFocus:!this.state.focusInside,preventDismissOnScroll:this.props.parameters.preventDismissOnScroll,preventDismissOnResize:this.props.parameters.preventDismissOnResize,onPositioned:this.props.parameters.onPositioned,bounds:this.props.parameters.bounds??void 0,directionalHint:!0===this.props.parameters.isMultiParagraphSuggestion?f.A.topLeftEdge:void 0},C.createElement(S.Y,{isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:this.state.focusInside,disableFirstFocus:this.props.parameters.keepCurrentFocus,componentRef:this.focusTrapZone,style:this.props.styleProvider.focusTrapStyles},C.createElement("div",{ref:this.calloutBodyElement},this.createContentGroups(this.state.parameters.definition)))))}focus(){this.focusTrapZone.current&&(this.setState({focusInside:!0}),this.focusTrapZone.current.focus())}calloutOnDismissHandler(){this.dismiss({actionSourceId:r.Unknown})}dismiss(e){e&&(this.commonActionData=e),Kr.unmountComponentAtNode(this.props.parameters.containerElement)}setDefinition(e){e?this.setState((t=>{const i={...t.parameters};return i.definition=e,{parameters:i}})):c.Hv.sendTraceTag(595658962,d.n.msoulscat_Wac_Telemetry,u.k.Warning,"Tried to set null definition for an open menu")}updatePosition(){this.forceUpdate()}executeDefaultAction(){this.defaultActionableIntent&&this.defaultActionableIntent.executeDefaultAction()}executeActionFromString(e){this.defaultActionableIntent&&e&&this.defaultActionableIntent.executeActionFromString(e)}invokeBadgeId(e){null!=e?this.defaultActionableIntent&&this.defaultActionableIntent.invokeBadgeId(e):c.Hv.sendTraceTag(526653642,d.n.msoulscat_Wac_Telemetry,u.k.Warning,"Tried to invoke null badge ID for an open menu")}getElementBounds(){if(!this.calloutBodyElement.current)return null;try{const e=this.calloutBodyElement.current.getBoundingClientRect();return{left:e.left,top:e.top,width:e.right-e.left,height:e.bottom-e.top}}catch{return null}}onAutoReplaceAction(e,t,i){this.props.parameters.onAction&&this.props.parameters.onAction({actionType:e,engagement:t,objectName:$n,objectFulfillment:i})}createAutoReplaceAction(e,t){return this.onAutoReplaceAction.bind(this,e,Pr.Try,t)}createAutoReplaceContent(e){const t=e.contentData,i={onAction:this.onUndo,originalText:t.originalText,strings:{undoAccessibilityLabel:"Undo"}};return C.createElement(Hr,{...i})}createTrackChangeContent(e){const t=e.contentData,i=t.changeDescriptor?.localizedDate||"",o={definition:{definitionType:"TrackChangeDefinition",authorName:t.authorName||"",authorColor:t.authorColor||"",changeDescriptor:{formatting:t.changeDescriptor?.formatting,text:t.changeDescriptor?.text||"",localizedDate:i},theme:t.theme,acceptDisabled:!!t.acceptDisabled,rejectDisabled:!!t.rejectDisabled},strings:{acceptHoveredHeading:this.props.resources.TrackChangeCardAcceptSuggestionLabel,regularHeading:this.props.resources.TrackChangeCardAcceptOrRejectSuggestionLabel,rejectHoveredHeading:this.props.resources.TrackChangeCardRejectSuggestionLabel},style:{minWidth:240,maxWidth:240},onAcceptHoverIn:this.onAcceptPreviewStart,onRejectHoverIn:this.onRejectPreviewStart,onAcceptHoverOut:this.onAcceptPreviewEnd,onRejectHoverOut:this.onRejectPreviewEnd,onAcceptClick:this.onAccepted,onRejectClick:this.onRejected},r=i?`on ${i}`:"";return C.createElement("div",{id:this.headerId(),"aria-label":`${o.definition.authorName} ${o.definition.changeDescriptor.text} ${r}`},C.createElement(Zr.I,{...o}))}getInlineFileSuggestionSourceType(e){switch(e){case"ClassicAttachment":return a.ClassicAttachment;case"OneDriveForBusiness":return a.OneDriveForBusiness;case"SharepointOnline":return a.SharepointOnline;default:return a.Undefined}}convertTopicResultToSuggestion(e){return{id:e.Id,title:e.DisplayName,subtitle:e.Description,url:e.Url,type:g.c.Topic,tooltip:e.Description}}convertFileResultToSuggestion(e){return{type:e.entityType,sourceType:this.getInlineFileSuggestionSourceType(e.FileSourceType),fileName:e.FileName,hitFileName:e.FileName,fileExtension:e.FileExtension||"",url:e.AccessUrl||"",lastAccessDateTime:e.DateAccessed,lastModifiedDateTime:e.DateModified,createdDateTime:e.DateCreated,itemId:e.Id,fileSize:e.FileSize||0}}getPersonImageUrl(e){if(e&&this.state.profileImageUrlCache[e])return this.state.profileImageUrlCache[e]}convertPersonResultToSuggestion(e){const t=e.EmailAddresses&&e.EmailAddresses?.length>0?e.EmailAddresses[0]:void 0;return{type:e.entityType,displayName:e.DisplayName||t||"",primaryEmailAddress:t||"",imageUrl:this.getPersonImageUrl(t),initials:(0,v.I)(e.text,this.props.isRightToLeft)}}getFlagType(e){switch(e){case g.c.People:return tt.Person;case g.c.Address:return tt.Location;case g.c.Satori:return tt.SatoriEntity;case g.c.Topic:return tt.Topic;default:return tt.Location}}getEntityTitle(e){switch(e){case g.c.File:return this.props.resources.FileEntityLabel;case g.c.People:return this.props.resources.PeopleEntityLabel;case g.c.Address:return this.props.resources.AddressEntityLabel;case g.c.Satori:return this.props.resources.SatoriEntityLabel;case g.c.Topic:return this.props.resources.TopicsEntityLabel;default:return""}}sortEntityTitle(e,t){const i={},o=[this.getEntityTitle(""),this.getEntityTitle(g.c.People),this.getEntityTitle(g.c.File),this.getEntityTitle(g.c.Address),this.getEntityTitle(g.c.Topic),this.getEntityTitle(g.c.Satori)];for(let e=0;e<o.length;e++)i[o[e]]=e;return i[e]-i[t]||e.localeCompare(t)}fromInlineActionId(e){switch(e){case s.Retry:return zr.Retry;case s.ClearSearch:return zr.ClearSearch;default:return null}}convertContextIQResult(e){switch(e.entityType){case g.c.File:return this.convertFileResultToSuggestion(e);case g.c.People:const t=this.convertPersonResultToSuggestion(e);return this.fetchProfileImageUrl(t),t;case g.c.Topic:return this.convertTopicResultToSuggestion(e)}}async fetchProfileImageUrl(e){if(e.primaryEmailAddress&&!this.state.profileImageUrlCache[e.primaryEmailAddress]&&this.state.parameters.getPersonImageUrl){const t=await this.state.parameters.getPersonImageUrl(e.primaryEmailAddress,e.displayName);if(t){const i={...this.state.profileImageUrlCache,[e.primaryEmailAddress]:t};this.setState({profileImageUrlCache:i})}}}onContextIQItemFocused(e){this.state.parameters.editingElement&&this.state.parameters.editingElement.setAttribute("aria-activedescendant",e.focusedItemHtmlId)}createContextIQContent(e){let t=tt.Location;const i={},o={},r=e.contentData;if(r.results?.forEach((e=>{const n=this.convertContextIQResult(e);if(n){const s=r.bestMatchResults&&-1!==r.bestMatchResults.findIndex((t=>t.entityId===e.entityId))?"":this.getEntityTitle(n.type);t=this.getFlagType(n.type),i[s]?(i[s].push(n),o[s]++):(i[s]=[n],o[s]=1)}})),!e.isContentPending&&this.prevPreviewDataCIQ!==e.previewData){this.prevPreviewDataCIQ=e.previewData;const t=""===e.previewData;this.props.dependencies.actionLogger.logNumCIQResults(o,t,e.isFirstInvoke??!1,e.previewData?e.previewData.length:0)}let n;const s={brandingMode:Ye.IconAndTextButton,actions:this.props.parameters.showEditorButton?[Je.OpenEditorPane]:[]};e.type===Xn?(n={menuType:"InlineSuggestionsResultsFlagMenuType",...s,flag:t},n.actions.push(Je.IgnoreOnce)):e.type===Jn&&(n={menuType:"InlineSuggestionsResultsUserInitiatedMenuType",...s});const a={results:Object.keys(i).sort(this.sortEntityTitle).map((e=>({title:e,suggestions:i[e]}))),queryString:e.previewData?e.previewData:"@",onItemSelected:t=>{this.contextIQAction({actionType:zr.Apply,engagement:Pr.Keep,objectName:e.type,objectFulfillment:void 0,descriptorData:t,data:{entityType:t.type,queryLength:e.previewData?e.previewData.length:0}})},onAction:t=>{const i=this.fromInlineActionId(t);null!=i?this.contextIQAction({actionType:i,engagement:Pr.Try,objectName:e.type}):c.Hv.sendTraceTag(537536654,d.n.msoulscat_Wac_Telemetry,u.k.Warning,"Unknown InlineActionId")},isLoading:e.isContentPending,isError:!!e.errorMessage,strings:Ka(this.props.resources),styles:{itemsStyles:{noSuggestionsStyles:{description:{paddingHorizontal:14,paddingVertical:8},item:{height:38,paddingHorizontal:0,textHorizontalPadding:10}}}},theme:Fn(),keyboardHandlerTarget:this.state.parameters.keyboardHandlerTarget?this.state.parameters.keyboardHandlerTarget:void 0,onFocus:this.onContextIQItemFocused,menuType:n,onFooterAction:t=>{const i=Xa(t);i&&this.contextIQAction({actionType:i,engagement:Pr.None,objectName:e.type,descriptorData:{annotationId:e.contentData?.annotationId}})}};return C.createElement(Nr,{...a})}createContentGroups(e){if(e&&e.suggestionGroups){const t=e.suggestionGroups.map(((e,t)=>this.createGroup(e,t))).filter((e=>!!e));return 1===t.length?t[0]:C.createElement("div",{role:"list","aria-label":this.props.resources.GroupListLabel},t)}return c.Hv.sendTraceTag(595854147,d.n.msoulscat_Wac_Telemetry,u.k.Warning,"Failure to create content groups because data model is missing or empty"),null}createGroup(e,t){if(!e)return c.Hv.sendTraceTag(595854149,d.n.msoulscat_Wac_Telemetry,u.k.Warning,"group is null or undefined"),null;if(this.props.dependencies.hostServices&&!this.props.dependencies.hostServices.isGroupEnabled(e))return c.Hv.sendTraceTag(595637723,d.n.msoulscat_Wac_Telemetry,u.k.Info,`Group type '${e.type}' is not enabled and thus skipped`),null;switch(e.type){case Yn.id:return this.createIntentComponent(t,e,Yn,un);case ps.sensitiveContent:return this.createIntentComponent(t,e,ps,mn);case fl.critique:return this.createIntentComponent(t,e,Cl,Ln);case fl.imageCritique:case fl.pqCritique:return this.createIntentComponent(t,e,wl,Rn);case Pn:case zn:case Un:case Wn:case Gn:case _n:case qn:return this.createIntentComponent(t,e,bl,mn);case ps.neuralRewrite:return this.createIntentComponent(t,e,ps,yn);case ps.similarity:return this.createIntentComponent(t,e,ps,bn);case Al.id:return this.createIntentComponent(t,e,Al,On);case Qn:return this.createTrackChangeContent(e);case $n:return this.createAutoReplaceContent(e);case Xn:case Jn:return this.createContextIQContent(e);default:return c.Hv.sendTraceTag(595854148,d.n.msoulscat_Wac_Telemetry,u.k.Warning,`Unknown group: ${e.type}`),null}}createIntentComponent(e,t,i,o){const r=this.createIntentProps(t,o,e);return this.createIntentView(e,r,i)}createIntentProps(e,t,i){return{parameters:this.state.parameters,dismiss:this.dismiss,group:e,resources:this.props.resources,isRightToLeft:this.props.isRightToLeft,uiCulture:this.props.uiCulture,styleProvider:new t(this.props.isRightToLeft),hostElementRef:this.focusTrapZone,dependencies:this.props.dependencies,position:i}}createIntentView(e,t,i){const o=i;return C.createElement(o,{key:e,ref:t=>this.assignDefaultActionableIntent(e,t),...t})}assignDefaultActionableIntent(e,t){0===e&&(this.defaultActionableIntent=t)}onTrackChangeAction(e,t,i){this.props.parameters.onAction&&this.props.parameters.onAction({actionType:e,engagement:t,objectName:Qn,objectFulfillment:i})}createTrackChangeToggleAction(e){return this.onTrackChangeAction.bind(this,zr.Toggle,Pr.See,e)}headerId(){return 1===this.props.parameters.definition?.suggestionGroups?.length&&this.props.parameters.definition.suggestionGroups[0]?.type?Zn.createHeaderId(this.props.parameters.definition.suggestionGroups[0].type):""}contextIQAction(e){this.props.parameters.onAction?.(e),this.props.dependencies.actionLogger.logAction(e,{actionSourceId:r.Unknown})}constructor(e){super(e),this.dismiss=this.dismiss.bind(this),this.calloutOnDismissHandler=this.calloutOnDismissHandler.bind(this),this.updateOnScrollOrResize=this.updateOnScrollOrResize.bind(this),this.dismissOnLostFocus=this.dismissOnLostFocus.bind(this),this.onAcceptPreviewStart=this.createTrackChangeToggleAction("AcceptMouseOver"),this.onAcceptPreviewEnd=this.createTrackChangeToggleAction("AcceptMouseOut"),this.onRejectPreviewStart=this.createTrackChangeToggleAction("RejectMouseOver"),this.onRejectPreviewEnd=this.createTrackChangeToggleAction("RejectMouseOut"),this.onUndo=this.createAutoReplaceAction(zr.Undo),this.onAccepted=this.onTrackChangeAction.bind(this,zr.Accepted,Pr.Keep),this.onRejected=this.onTrackChangeAction.bind(this,zr.Rejected,Pr.Keep),this.onContextIQItemFocused=this.onContextIQItemFocused.bind(this),this.sortEntityTitle=this.sortEntityTitle.bind(this),this.state={parameters:e.parameters,focusInside:!e.parameters.keepCurrentFocus,profileImageUrlCache:{}},this.async=new p.j(this),this.hasListeners=!1,this.pendingUpdate=!1,this.disposables=[],this.targetWindow=null,this.calloutWrapperElement=C.createRef(),this.calloutBodyElement=C.createRef(),this.focusTrapZone=C.createRef(),this.defaultActionableIntent=null,this.commonActionData={actionSourceId:r.Unknown},this.prevPreviewDataCIQ=null}}function Rl(e){if(1===e.definition?.suggestionGroups?.length&&e.definition.suggestionGroups[0]?.type){if(e.definition?.suggestionGroups[0]?.critiqueSubType===Vn)return!0;const t=e.definition.suggestionGroups[0].type;return t===Un||t===Pn||t===Wn||t===zn}return!1}function Ol(e){return"SharedSpellingCritique"===e.definition?.id||"SharedGrammarCritique"===e.definition?.id}var Fl,Bl=i(85073);class Nl{logAction(e,t){if(!e)return;const i={...e};i.actionName=zr[e.actionType],i.engagementName=Pr[e.engagement];const o=[{name:"actionType",int64:i.actionType},{name:"engagement",int64:i.engagement},{name:"actionName",string:i.actionName},{name:"engagementName",string:i.engagementName},{name:"objectName",string:i.objectName},{name:"objectId",string:i.objectId},{name:"objectFulfillment",string:i.objectFulfillment},{name:"actionSourceId",int64:t.actionSourceId}];void 0!==t.executedBadgeId&&o.push({name:"executedBadgeId",int64:t.executedBadgeId}),void 0!==t.maxBadgeId&&o.push({name:"maxBadgeId",int64:t.maxBadgeId});const r=i.objectName?Fl.userActionCommandMap[i.objectName]?.[i.engagement]??Fl.canvasContextualActionName:Fl.canvasContextualActionName;if(i.data){const e=i.data;Object.keys(e).forEach((t=>{const i=e[t],r=typeof i;"string"===r?o.push({name:t,string:i}):"boolean"===r?o.push({name:t,bool:i}):"number"===r&&Number.isInteger(i)?o.push({name:t,int64:i}):"number"===r?o.push({name:t,double:i}):c.Hv.sendTraceTag(528498709,d.n.msoulscat_Wac_Telemetry,u.k.Warning,`ActionLogger: Data type '${r}' is not supported and therefore skipped.`)}))}const n=r===Fl.contextIQCardSeen;n&&5===Fl.seenCountWithoutKept?(Fl.seenCountWithoutKept=0,this.logSystemInitiatedFeedback?this.logSystemInitiatedFeedback("CIQ_SeenNotKept"):c.Hv.sendTraceTag(509104668,d.n.msoulscat_Wac_Telemetry,u.k.Warning,"ActionLogger: No SystemInitiatedFeedback logger function found and thus the CIQ_SeenNotKept survey trigger is not fired.")):n&&Fl.seenCountWithoutKept++,r===Fl.contextIQCardKept&&(Fl.seenCountWithoutKept=0),(0,Bl.sendUserActionEvent)({actionName:r,dataFields:o})}logNumCIQResults(e,t,i,o){const r=Fl.contextIQCardNumberOfResults,n=[{name:"isInZeroState",bool:t},{name:"isFirstInvoke",bool:i},{name:"queryLength",int64:o}];Object.keys(e).forEach((t=>{n.push({name:t,int64:e[t]})})),(0,Bl.sendUserActionEvent)({actionName:r,dataFields:n})}constructor(e){this.logSystemInitiatedFeedback=e}}Fl=Nl,Nl.canvasContextualActionName="CanvasContextualSuggestion",Nl.contextIQCardSeen="ContextIQCardSeen",Nl.contextIQCardTried="ContextIQCardTried",Nl.contextIQCardKept="ContextIQCardKept",Nl.contextIQCardNumberOfResults="ContextIQCardNumberOfResults",Nl.userActionCommandMap={[Jn]:{[Pr.See]:Fl.contextIQCardSeen,[Pr.Try]:Fl.contextIQCardTried,[Pr.Keep]:Fl.contextIQCardKept}},Nl.seenCountWithoutKept=0;class jl{createContextualUi(e){return e&&e.containerElement&&this.params?function(e,t,i,o){return new Promise(((n,s)=>{const a=(new Qr).loadStrings(t),l=(t,i)=>{const o=t?{message:t.message,stack:t.stack}:{};c.Hv.sendTraceTag(595637724,d.n.msoulscat_Wac_Telemetry,u.k.Error,`Crash while rendering. Error: ${JSON.stringify(o)} Info: ${JSON.stringify(i)}`),s(t),(new p.j).setImmediate((()=>{e.onDismiss&&e.onDismiss({actionSourceId:r.Unknown}),Kr.unmountComponentAtNode(e.containerElement)}))};a.then((r=>{Kr.render(C.createElement(Dl,{onError:l},C.createElement(Ll,{ref:e=>{n(e)},parameters:e,styleProvider:new fn({isRightToLeft:i,alignInnerTextWithAnchor:Rl(e),allowContentOverflow:e.definition?.id===Qn,customScrollbarUsed:e.definition?.id===Xn||e.definition?.id===Jn,disableCardAnimation:Ol(e)}),resources:r,isRightToLeft:i,uiCulture:t,dependencies:o})),e.containerElement)})).catch((e=>s(e)))}))}(e,this.getUiCulture(),this.params.isRightToLeft,this.createDependencies(e.hostServices)):Promise.reject(new Error("Arguments are not provided or incorrect."))}logAction(e,t){e&&this.actionLogger.logAction(e,t??{actionSourceId:r.Unknown})}createDependencies(e){const{dimeCallback:t,loadUpsellDependencies:i}=this.params;return{actionLogger:this.actionLogger,hostServices:e,dimeCallback:t,loadUpsellDependencies:i}}getUiCulture(){return this.params.uiCulture||"en-US"}constructor(e){this.params=e,this.actionLogger=new Nl(this.params.logSystemInitiatedFeedback)}}var Hl=i(19044),Pl={accdb:{extensions:["accdb","mdb"]},archive:{extensions:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z"]},audio:{extensions:["aif","aiff","aac","alac","amr","ape","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","oga","ra","rm","wav","wma","wv"]},calendar:{extensions:["ical","icalendar","ics","ifb","vcs"]},code:{extensions:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","cbl","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","h","h++","haml","handlebars","hbs","hcp","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsproj","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","ps1xml","psd1","psm1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","shtml","sml","svn-base","swift","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"]},contact:{extensions:["vcf"]},csv:{extensions:["csv"]},desktopfolder:{},docset:{},documentfolder:{},docx:{extensions:["doc","docm","docx","docb"]},dotx:{extensions:["dot","dotm","dotx"]},email:{extensions:["eml","msg","ost","pst"]},exe:{extensions:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"]},folder:{},font:{extensions:["ttf","otf","woff"]},fluid:{extensions:["b","fluid"]},genericfile:{},html:{extensions:["htm","html","mht"]},link:{extensions:["lnk","link","url","website","webloc"]},linkedfolder:{},listitem:{},officescript:{extensions:["osts"]},splist:{extensions:["listitem"]},model:{extensions:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layer","layout","max","mcworld","mtl","obj","off","ply","skp","stp","stl","t","thl","x"]},mpp:{extensions:["mpp"]},mpt:{extensions:["mpt"]},multiple:{},one:{extensions:["note","one"]},onetoc:{extensions:["ms-one-stub","onetoc","onetoc2","onepkg"]},pbiapp:{},pdf:{extensions:["pdf"]},photo:{extensions:["arw","bmp","cr2","crw","dic","dicm","dcm","dcm30","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psb","psd","raw","tga","tif","tiff","wdp"]},photo360:{},picturesfolder:{},potx:{extensions:["pot","potm","potx"]},powerbi:{extensions:["pbids","pbix"]},ppsx:{extensions:["pps","ppsm","ppsx"]},pptx:{extensions:["ppt","pptm","pptx","sldx","sldm"]},presentation:{extensions:["odp","gslides","key"]},pub:{extensions:["pub"]},spo:{extensions:["aspx","classifier"]},sponews:{},spreadsheet:{extensions:["odc","ods","gsheet","numbers","tsv"]},stream:{},rtf:{extensions:["epub","gdoc","odt","rtf","wri","pages"]},sharedfolder:{},sway:{},sysfile:{extensions:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","ldt","lrprev","pkpass","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xlb","xll"]},txt:{extensions:["dif","diff","readme","out","plist","properties","text","txt"]},vaultclosed:{},vaultopen:{},vector:{extensions:["ai","ait","cvs","dgn","gdraw","pd","emf","eps","fig","ind","indd","indl","indt","indb","ps","svg","svgz","wmf","oxps","xps","xd","sketch"]},video:{extensions:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4","mp4v","mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"]},video360:{},vsdx:{extensions:["vdx","vsd","vsdm","vsdx","vsw","vdw"]},vssx:{extensions:["vss","vssm","vssx"]},vstx:{extensions:["vst","vstm","vstx","vsx"]},whiteboard:{extensions:["whiteboard"]},xlsx:{extensions:["xlc","xls","xlsb","xlsm","xlsx","xlw"]},xltx:{extensions:["xlt","xltm","xltx"]},xml:{extensions:["xaml","xml","xsl"]},xsn:{extensions:["xsn"]},zip:{extensions:["zip"]}},zl="_png",Ul="_svg",Wl=[16,20,24,32,40,48,64,96];class Gl{static createController(e){return(0,Hl.v)(void 0,{disableWarnings:!0}),i={disableWarnings:!0},void 0===(t=void 0)&&(t="https://spoprod-a.akamaihd.net/files/fabric-cdn-prod_20210115.001/assets/item-types/"),Wl.forEach((function(e){!function(e,t,i){var o=Object.keys(Pl),r={};o.forEach((function(i){var o=e+t+"/"+i;r[i+t+zl]=C.createElement("img",{src:o+".png",alt:""}),r[i+t+Ul]=C.createElement("img",{src:o+".svg",alt:""}),r[i+t+"_1.5x"+zl]=C.createElement("img",{src:e+t+"_1.5x/"+i+".png",height:"100%",width:"100%",alt:""}),r[i+t+"_1.5x"+Ul]=C.createElement("img",{src:e+t+"_1.5x/"+i+".svg",height:"100%",width:"100%",alt:""}),r[i+t+"_2x"+zl]=C.createElement("img",{src:e+t+"_2x/"+i+".png",height:"100%",width:"100%",alt:""}),r[i+t+"_3x"+zl]=C.createElement("img",{src:e+t+"_3x/"+i+".png",height:"100%",width:"100%",alt:""}),r[i+t+"_4x"+zl]=C.createElement("img",{src:e+t+"_4x/"+i+".png",height:"100%",width:"100%",alt:""})})),(0,Er.K1)({fontFace:{},style:{width:t,height:t,overflow:"hidden"},icons:r,mergeImageProps:!0},i)}(t,e,i)})),new jl(e);var t,i}}var _l,ql=i(97638);class Vl{get documentScore(){return this._documentScoreHandler.documentScore}get _relativeSpellingScore(){return this._documentScoreHandler.documentScoreWithoutSpelling-this.documentScore}get _relativeGrammarScore(){return this._documentScoreHandler.documentScoreWithoutGrammar-this.documentScore}get _relativeRefinementsScore(){return this._documentScoreHandler.documentScoreWithoutRefinements-this.documentScore}get isIncipient(){return this.wordCount<100}get progressBarData(){return this.scaleCritiquesPercentage(this.documentScore,this.relativeCritiqueScores)}get wordCount(){return this._documentScoreHandler.wordCount}get critiquesCount(){return this._documentScoreHandler.critiquesCount}get relativeCritiqueScores(){return{grammarPercent:this._relativeGrammarScore,refinementsPercent:this._relativeRefinementsScore,spellingPercent:this._relativeSpellingScore}}scaleCritiquesPercentage(e,t){const{spellingPercent:i,grammarPercent:o,refinementsPercent:r}=t,n=i+o,s=i+o+r,a=this.scaleCritiquePercentage(n,s,100-e),l=100-e-a;return{spellingPercent:this.scaleCritiquePercentage(i,n,a),grammarPercent:this.scaleCritiquePercentage(o,n,a),refinementsPercent:this.scaleCritiquePercentage(r,s-n,l)}}constructor(e){this._documentScoreHandler=e,this.skittleArgs={isThinking:!1},this.kpiConfigOfferLevel=void 0,this.scaleCritiquePercentage=(e,t,i)=>0===t?0:Math.round(e*i/t)}}(0,ql.decorate)(Vl,{wordCount:ql.computed,isIncipient:ql.computed,critiquesCount:ql.computed,documentScore:ql.computed,progressBarData:ql.computed,skittleArgs:ql.observable});class Zl{get currentHoveredOrFocused(){var e;return null!==(e=this.currentFocused)&&void 0!==e?e:this.currentHovered}get isHoveredOrFocused(){return!!this.currentHoveredOrFocused||this.isFocusForced}constructor(){this.currentFocused=document.createElement("div"),this.currentHovered=document.createElement("div"),this.isFocusForced=!1,this.forceFocus=e=>{this.isFocusForced=e},this.handleElementHoveredOrFocused=e=>{e.stopPropagation(),"mouseover"!==e.type&&"mouseenter"!==e.type||(this.currentHovered=e.currentTarget),"mouseout"!==e.type&&"mouseleave"!==e.type||(this.currentHovered=null),"focus"!==e.type&&"click"!==e.type||(this.currentFocused=e.currentTarget),"blur"===e.type&&(this.currentFocused=null)},this.reset=()=>{this.currentFocused=this.currentHovered=null}}}(0,ql.decorate)(Zl,{currentFocused:ql.observable,currentHovered:ql.observable,currentHoveredOrFocused:ql.computed,isHoveredOrFocused:ql.computed,forceFocus:ql.action,isFocusForced:ql.observable,handleElementHoveredOrFocused:ql.action,reset:ql.action}),function(e){e[e.Collapsed=0]="Collapsed",e[e.Disabled=1]="Disabled",e[e.Short=2]="Short",e[e.FullSize=3]="FullSize"}(_l||(_l={}));class Kl{get cardSize(){return this.viewportHeight<180?_l.Disabled:this.verticalScrollValue<this.fullSizeLimit?_l.FullSize:this.verticalScrollValue<this.shortSizeLimit&&this._store.isIncipient?_l.Collapsed:this.verticalScrollValue<this.shortSizeLimit?_l.Short:_l.Collapsed}constructor(e){this._store=e,this.verticalScrollValue=0,this.fullSizeLimit=30,this.shortSizeLimit=600,this.viewportHeight=window.innerHeight}}let Yl;function Ql(){return Yl}var $l,Jl;(0,ql.decorate)(Kl,{cardSize:ql.computed,verticalScrollValue:ql.observable,fullSizeLimit:ql.observable,shortSizeLimit:ql.observable,viewportHeight:ql.observable}),function(e){e[e.Unknown=0]="Unknown",e[e.Disabled=1]="Disabled",e[e.Corrections=2]="Corrections",e[e.Refinements=3]="Refinements",e[e.KeyPoints=4]="KeyPoints",e[e.WritingAnalytics=5]="WritingAnalytics",e[e.Similarity=6]="Similarity",e[e.EditorScore=7]="EditorScore",e[e.Goals=8]="Goals",e[e.FirstRunExperience=9]="FirstRunExperience",e[e.BxPromo=10]="BxPromo",e[e.Skittle=11]="Skittle",e[e.TonalRewriteFre=12]="TonalRewriteFre",e[e.ContentCreation=14]="ContentCreation"}($l||($l={})),function(e){e.Acronyms="Acronyms",e.AiFeedbackSkittle="AI Feedback Proactive Skittle",e.BxPromo="BxPromo",e.Clarity="Clarity",e.Conciseness="Conciseness",e.ContentCreationSummary="Summary Generation",e.ContentCreationWritersUnblock="Text Generation",e.DictationCorrections="Did you say?",e.EditorScore="Editor Score",e.FirstRunExperience="First run experience",e.Skittle="Skittle",e.Formality="Formality",e.Goals="Goals",e.Grammar="Grammar",e.Inclusiveness="Inclusiveness",e.Perspectives="Perspectives",e.PunctuationConventions="Punctuation Conventions",e.Resume="Resume",e.SensitiveGeopoliticalReferences="Sensitive Geopolitical References",e.Spelling="Spelling",e.Stats="Stats",e.StatsInEditor="StatsInEditor",e.StatsInRibbon="StatsInRibbon",e.StatsInStatusBar="StatsInStatusBar",e.Topics="Topics",e.Vocabulary="Vocabulary",e.TopProofingIssues="TopProofingIssues",e.Similarity="Similarity",e.TonalRewrite="Tone",e.TonalRewriteFre="Tonal Rewrite First Run Experience",e.KeyPoints="KeyPoints"}(Jl||(Jl={}));class Xl{constructor(){this.css=(...e)=>(0,Er.Zq)(...e),this.keyframes=Er.i7}}const ec="button",tc="dialog",ic="group",oc="textbox",rc=new Map;let nc;const sc=()=>({viewportHeight:window.innerHeight||document.documentElement.clientHeight||0,viewportWidth:window.innerWidth||document.documentElement.clientWidth||0,viewportVisible:"visible"===document.visibilityState}),ac=(e,t,i)=>{const o={stopMonitoring:!1,visible:i};e(o),o.stopMonitoring&&cc(t)},lc=()=>{const{viewportHeight:e,viewportWidth:t,viewportVisible:i}=sc();i&&t&&e||rc.forEach(((e,t)=>ac(e,t,!1))),rc.forEach(((i,o)=>{const{left:r,top:n,right:s,bottom:a,width:l,height:c}=o.getBoundingClientRect();ac(i,o,(0!==l||0!==c)&&(r>=0&&n>=0&&s<=t&&a<=e))}))},cc=e=>{rc.delete(e),nc&&0===rc.size&&(window.clearInterval(nc),nc=void 0)},dc=e=>{const[t,i]=C.useState(null);return C.useEffect((()=>{const{visibilityChanged:i,visibilityChangedCallbackMode:o}=e;return t&&i&&(r=t,n=((e,t="polling")=>{let i;return o=>{"polling"!==t&&o.visible===i||(i=o.visible,e(o))}})(i,o),rc.has(r)||(rc.set(r,n),ac(n,r,(e=>{const{viewportHeight:t,viewportWidth:i,viewportVisible:o}=sc();if(!o||!i||!t)return!1;const{left:r,top:n,right:s,bottom:a,width:l,height:c}=e.getBoundingClientRect();return(0!==l||0!==c)&&r>=0&&n>=0&&s<=i&&a<=t})(r)),void 0===nc&&(nc=window.setInterval(lc,999)))),()=>{t&&cc(t)};var r,n}),[t]),e.children?C.createElement("div",{ref:i},e.children):C.createElement(C.Fragment,null)},uc="(-ms-high-contrast: active), (forced-colors: active)",gc="(-ms-high-contrast: white-on-black), (forced-colors: active) and (prefers-color-scheme: dark)",pc="(-ms-high-contrast: black-on-white), (forced-colors: active) and (prefers-color-scheme: light)",hc="@media screen and "+uc,mc="@media screen and "+gc,yc="@media screen and "+pc;new class{get isHighContrastActive(){return window.matchMedia(uc).matches}get isHighContrastBlack(){return window.matchMedia(gc).matches}get isHighContrastWhite(){return window.matchMedia(pc).matches}};var bc,fc=i(86188);!function(e){e.arrowDown="ArrowDown",e.arrowLeft="ArrowLeft",e.arrowRight="ArrowRight",e.arrowUp="ArrowUp",e.backspace="Backspace",e.control="Control",e.enter="Enter",e.escape="Escape",e.space=" ",e.tab="Tab",e.home="Home",e.end="End",e.j="j",e.r="r",e.t="t",e.J="J",e.R="R",e.T="T"}(bc||(bc={}));class Sc{static createEvaluator(e,t,i,o,r){return n=>Sc.isKey(n,e,t,i,o,r)}static isKey(e,t,i,o,r,n){if(void 0!==i&&e.altKey!==i||void 0!==o&&e.ctrlKey!==o||void 0!==r&&e.metaKey!==r||void 0!==n&&e.shiftKey!==n)return!1;if(Array.isArray(t))return t.some((t=>Sc.isKey(e,t,i,o,r,n)));if(e.key===t)return!0;if(t in fc.c){const i=fc.c[t];return e.which===i||e.keyCode===i}return!1}}Sc.isEnterKey=e=>{const t=bc.enter;return Sc.isKey(e,t)},Sc.isEnterOrSpaceKey=e=>{const t=bc.enter,i=bc.space;return Sc.isKey(e,[t,i])},Sc.isEscapeKey=e=>{const t=bc.escape;return Sc.isKey(e,t)},Sc.focusIfEscapeKey=e=>{Sc.isKey(e,bc.escape)&&(e.currentTarget.focus(),e.stopPropagation())},Sc.isSpaceKey=e=>{const t=bc.space;return Sc.isKey(e,t)};const vc=(0,Xr.a)({semanticColors:{cardShadow:"0px 1px 2.5px 0px rgba(0, 0, 0, 0.12),0px 2px 4px 0px rgba(0, 0, 0, 0.08)",cardShadowHovered:"0 8px 24px 0 rgba(0,0,0,0.1), 0 8px 16px 0 rgba(0,0,0,0.12)",buttonBackground:"#ffffff",buttonBackgroundHovered:"#f5f5f5",buttonBackgroundPressed:"#e0e0e0",buttonBorder:"#e1dfdd",bodyStandoutBackground:"#c4c4c4",buttonText:"#242424",buttonTextDisabled:"#616161",primaryButtonText:"#ffffff",disabledText:"#bdbdbd",disabledBodyText:"#605e5c",errorText:"#a80000",accentButtonText:"#185abd",accentButtonBackground:"#d2e0f4",bodyDivider:"#c7e0f4",focusBorder:"#242424",variantBorder:"#bdbdbd",infoIcon:"#185abd",successBackground:"#d2e0f4",successIcon:"#185ABD",menuDivider:"#e0e0e0",warningBackground:"#d4edd4",warningIcon:"#094609",errorBackground:"#fde5e5",errorIcon:"#3f1011",buttonTextChecked:"#185ABD",buttonBackgroundChecked:"#d2e0f4",buttonTextCheckedHovered:"#185ABD",buttonBackgroundCheckedHovered:"#d2e0f4",actionLink:"#185ABD",actionLinkHovered:"#185ABD",linkHovered:"#185ABD",bodySubtext:"#616161",bodyBackground:"#f5f5f5",cardStandoutBackground:"#ebf3fc",infoBackground:"#F0F0F0",listItemBackgroundHovered:"#f3f2f1"},palette:{themeDarker:"#185abd",themeDark:"#185abd",themeDarkAlt:"#185abd",themePrimary:"#185abd",themeSecondary:"#185abd",themeTertiary:"#185abd",themeLight:"#d2e0f4",themeLighter:"#d2e0f4",black:"#242424",neutralDark:"#242424",neutralPrimary:"#242424",neutralPrimaryAlt:"#242424",neutralSecondary:"#616161",neutralSecondaryAlt:"#616161",neutralTertiary:"#bdbdbd",neutralTertiaryAlt:"#bdbdbd",neutralQuaternary:"#e0e0e0",neutralQuaternaryAlt:"#e0e0e0",neutralLight:"#e0e0e0",neutralLighter:"#f5f5f5",neutralLighterAlt:"#f5f5f5",white:"#ffffff"}}),Cc=(0,Xr.a)({semanticColors:{cardShadow:"none",cardShadowHovered:"none",buttonBackground:"#292929",buttonBackgroundHovered:"#3d3d3d",buttonBackgroundPressed:"#1f1f1f",buttonBorder:"#3d3d3d",bodyStandoutBackground:"default",buttonText:"#ffffff",buttonTextDisabled:"#858585",primaryButtonText:"#ffffff",disabledText:"#858585",disabledBodyText:"#d6d6d6",errorText:"#f1707b",accentButtonText:"#82ABF1",accentButtonBackground:"#0c2145",bodyDivider:"#598fec",focusBorder:"#ffffff",variantBorder:"#5c5c5c",infoIcon:"#82ABF1",successBackground:"#071225",successIcon:"#82ABF1",menuDivider:"#666666",warningBackground:"#094609",warningIcon:"#d4edd4",errorBackground:"#3f1011",errorIcon:"#fde5e5",buttonTextChecked:"#82ABF1",buttonBackgroundChecked:"#0c2145",buttonTextCheckedHovered:"#82ABF1",buttonBackgroundCheckedHovered:"#0c2145",actionLink:"#82ABF1",actionLinkHovered:"#82ABF1",linkHovered:"#82ABF1",bodySubtext:"#adadad",bodyBackground:"#141414",cardStandoutBackground:"#3d3d3d",infoBackground:"#292929",listItemBackgroundHovered:"#1651AA"},palette:{themeDarker:"#82abf1",themeDark:"#82abf1",themeDarkAlt:"#82abf1",themePrimary:"#82abf1",themeSecondary:"#82abf1",themeTertiary:"#82abf1",themeLight:"#0c2145",themeLighter:"#071225",black:"#ffffff",neutralDark:"#ffffff",neutralPrimary:"#ffffff",neutralPrimaryAlt:"#ffffff",neutralSecondary:"#adadad",neutralSecondaryAlt:"#adadad",neutralTertiary:"#858585",neutralTertiaryAlt:"#858585",neutralQuaternary:"#666666",neutralQuaternaryAlt:"#5c5c5c",neutralLight:"#1f1f1f",neutralLighter:"#3d3d3d",neutralLighterAlt:"#292929",white:"#141414"},isInverted:!0});var xc;!function(e){e.Light="Light",e.Dark="Dark"}(xc||(xc={}));const kc=(0,ql.observable)({theme:vc});function Tc(){return kc.theme.semanticColors}function Ic(){return kc.theme}(0,ql.action)((e=>{kc.theme=e===xc.Dark?Cc:vc})),(0,ql.action)((e=>{kc.theme=e}));const wc=e=>{Sc.isKey(e,bc.escape)&&(e.currentTarget.focus(),e.stopPropagation())},Ac=e=>{const{shouldRenderAsPremium:t,styleProvider:i}=e,o=!e.hasHeader&&!e.ariaLabel,r=`IdeasCardHeader_${e.id}`,n=function(){const e=Tc();return{boxShadow:e.cardShadow,backgroundColor:e.buttonBackground,emptyCells:"hide","&:not(:empty)":{[yc]:{border:"1px solid #000"},[mc]:{border:"1px solid #fff"}}}}(),s=i.css(function(){const e=Tc();return{borderRadius:"4px",boxShadow:e.cardShadow,backgroundColor:e.buttonBackground,msHighContrastAdjust:"auto",position:"relative",emptyCells:"hide","&:not(:empty)":{[yc]:{border:"1px solid #000"},[mc]:{border:"1px solid #fff"}}}}(),t?n:[]);return o?C.createElement("div",{className:s,"data-card":1,"data-automation-id":r,"data-ignore-user-engagement":e.ignoreUserEngagement},e.children):C.createElement(mt.R,{className:s,"data-card":1,"data-automation-id":r,"data-ignore-user-engagement":e.ignoreUserEngagement,isCircularNavigation:!0,onKeyDown:wc,direction:3},e.children)};class Dc extends C.Component{render(){const{id:e,title:t}=this.props;return C.createElement("div",{className:this.props.styleProvider.css(this._styles.header),id:e},t&&this.renderTitle())}renderTitle(){const{icon:e,styleProvider:t}=this.props;return C.createElement("h1",{"aria-level":1,className:t.css(this._styles.title)},e,this.props.title)}constructor(){super(...arguments),this._styles={header:{marginBottom:"12px",padding:"0"},title:{display:"flex",alignItems:"center",fontSize:"14px",fontWeight:"600"}}}}const Ec=()=>({diamondIcon:{width:"27px",color:Tc().infoIcon,fontSize:"20px",margin:"15px 15px 0px 15px"},diamondIconHeader:{color:"inherit",margin:"0px 0px 0px 0px"}}),Mc=e=>{const t=e.styleProvider.css(Ec().diamondIcon,e.isHeader?Ec().diamondIconHeader:[]);return C.createElement(is.I,{"aria-hidden":!0,iconName:"Diamond",className:t})};function Lc(){const e=Tc();return{diamondHeader:{color:e.disabledText,":hover i":{color:e.accentButtonText}},header:{color:e.buttonText}}}const Rc=e=>e.shouldRenderAsPremium?C.createElement("div",{"data-automation-id":e.id,className:e.styleProvider.css(Lc().diamondHeader)},C.createElement(Dc,Object.assign({},e,{icon:C.createElement(Mc,{isHeader:!0,styleProvider:e.styleProvider})}))):C.createElement("div",{"data-automation-id":e.id,className:e.styleProvider.css(Lc().header)},C.createElement(Dc,Object.assign({},e))),Oc={padding:"0"},Fc=e=>{var t,i;const{id:o,styleProvider:r}=e,n=e.ariaHidden,s=null!==(t=e.ariaLabel)&&void 0!==t?t:void 0,a=null!==(i=e.contentRole)&&void 0!==i?i:ic;return C.createElement("div",{"aria-hidden":n,"aria-label":s,id:o,"data-automation-id":o,onFocus:e.onFocus,onBlur:e.onBlur,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,role:a,tabIndex:-1},C.createElement("div",{className:r.css(Oc)},e.children))},Bc=(0,ql.observable)({isTABNavigationUsed:!1});function Nc(){return Bc.isTABNavigationUsed}const jc=(0,ql.action)((()=>{const e=document.querySelector("body");Bc.isTABNavigationUsed=!!e&&e.classList.contains("ms-Fabric--isFocusVisible")})),Hc=e=>{var t;const i={description:e.description,title:e.title,hasHeader:e.hasHeader},o=Object.assign({margin:"24px 0 10px 0",":first-of-type":{marginTop:"6px"}},e.style),{styleProvider:r,theme:n,visibilityChanged:s,visibilityChangedCallbackMode:a}=e,l=C.useCallback((t=>{var i;const o=t.target;o&&(e=>{if(jc(),!Nc())return;if(e.getBoundingClientRect().top>=180)return;const t=window.scrollY,i=Math.max(t-180,0);window.requestAnimationFrame((()=>{window.scrollTo(0,i)}))})(o),null===(i=e.onFocus)||void 0===i||i.call(e)}),[e.onFocus]),c=null!==(t=e.contentRole)&&void 0!==t?t:ic,d=C.createElement("div",{className:`ideas-card ${r.css(o)}`},e.hasHeader&&C.createElement(Rc,Object.assign({shouldRenderAsPremium:e.shouldRenderAsPremium,id:e.headerId,styleProvider:e.styleProvider,theme:n},i)),C.createElement(Ac,{id:e.headerId,hasHeader:e.hasHeader,ariaLabel:e.ariaLabel,ignoreUserEngagement:e.ignoreUserEngagement,shouldRenderAsPremium:e.shouldRenderAsPremium,styleProvider:e.styleProvider,theme:n},C.createElement(Fc,Object.assign({id:"shell"+e.headerId,styleProvider:e.styleProvider,shouldRenderAsPremium:e.shouldRenderAsPremium,ariaLabel:e.ariaLabel,ariaHidden:!e.hasHeader&&!e.ariaLabel||void 0,contentRole:c,onFocus:l,onBlur:e.onBlur,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave},i),e.children)));return s?C.createElement(dc,{visibilityChanged:s,visibilityChangedCallbackMode:a},d):d};(0,ql.decorate)(class{get documentScore(){return this._documentScoreHandler.documentScore}get _relativeSpellingScore(){return this._documentScoreHandler.documentScoreWithoutSpelling-this.documentScore}get _relativeGrammarScore(){return this._documentScoreHandler.documentScoreWithoutGrammar-this.documentScore}get _relativeRefinementsScore(){return this._documentScoreHandler.documentScoreWithoutRefinements-this.documentScore}get isIncipient(){return this.wordCount<100}get progressBarData(){return this.scaleCritiquesPercentage(this.documentScore,this.relativeCritiqueScores)}get wordCount(){return this._documentScoreHandler.wordCount}get critiquesCount(){return this._documentScoreHandler.critiquesCount}get relativeCritiqueScores(){return{grammarPercent:this._relativeGrammarScore,refinementsPercent:this._relativeRefinementsScore,spellingPercent:this._relativeSpellingScore}}scaleCritiquesPercentage(e,t){const{spellingPercent:i,grammarPercent:o,refinementsPercent:r}=t,n=i+o,s=i+o+r,a=this.scaleCritiquePercentage(n,s,100-e),l=100-e-a;return{spellingPercent:this.scaleCritiquePercentage(i,n,a),grammarPercent:this.scaleCritiquePercentage(o,n,a),refinementsPercent:this.scaleCritiquePercentage(r,s-n,l)}}constructor(e){this._documentScoreHandler=e,this.skittleArgs={isThinking:!1},this.kpiConfigOfferLevel=void 0,this.scaleCritiquePercentage=(e,t,i)=>0===t?0:Math.round(e*i/t)}},{wordCount:ql.computed,isIncipient:ql.computed,critiquesCount:ql.computed,documentScore:ql.computed,progressBarData:ql.computed,skittleArgs:ql.observable});const Pc='"Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif',zc=`Segoe UI Semibold, Bahnschrift, Bahnschrift Web, ${Pc}`,Uc="Bahnschrift, Bahnschrift Web, Segoe UI, Helvetica Neue, sans-serif";var Wc,Gc,_c,qc;function Vc(){const e=Tc();return{mainWrapper:{borderRadius:"4px",boxShadow:"0px 1px 2.5px 0px rgba(0, 0, 0, 0.12), 0px 2px 4px 0px rgba(0, 0, 0, 0.08)",boxSizing:"border-box",height:"96px",marginTop:"1px",overflow:"hidden",position:"relative",top:"0",transition:"height 400ms cubic-bezier(0.1, 0.9, 0.2, 1), top 400ms cubic-bezier(0.1, 0.45, 0.2, 1)",userSelect:"none",width:"100%",":focus":Nc()?{outline:`1px solid ${e.focusBorder} !important`}:{},":focus > :first-child > :first-child":{backgroundColor:e.buttonBackgroundHovered},[Er.up]:{outline:"1px solid transparent"}},skittleMainWrapper:{height:"auto"},mainWrapperCollapsed:{boxShadow:"none",height:"48px",left:"12px",top:"-52px",position:"fixed",width:"calc(100% - 24px)"},mainWrapperShort:{height:"48px"},mainWrapperProgress:{boxShadow:"0px 0.3px 0.9px 0px rgba(0, 0, 0, 0.108), 0px 1.6px 3.6px 0px rgba(0, 0, 0, 0.132)"},progressCardWrapper:{alignItems:"flex-start",display:"flex",height:"100%",position:"relative"},pyroCardStyles:{margin:"0px",":first-of-type":{marginTop:"0px"}},disabledOffset:{marginTop:"-96px"}}}!function(e){e.communicationShade30="#004578",e.communicationShade20="#005a9e",e.communicationShade10="#106ebe",e.communicationPrimary="#0078d4",e.communicationTint10="#2b88d8",e.communicationTint20="#c7e0f4",e.communicationTint30="#deecf9",e.communicationTint40="#eff6fc"}(Wc||(Wc={})),function(e){e.black="#000000",e.gray400="#c4c4c4",e.gray300="#dbdbdb",e.gray220="#11100f",e.gray210="#161514",e.gray200="#1b1a19",e.gray190="#201f1e",e.gray180="#252423",e.gray170="#292827",e.gray160="#323130",e.gray150="#3b3a39",e.gray140="#484644",e.gray130="#605e5c",e.gray120="#797775",e.gray110="#8a8886",e.gray100="#979593",e.gray90="#a19f9d",e.gray80="#b3b0ad",e.gray70="#bebbb8",e.gray60="#c8c6c4",e.gray50="#d2d0ce",e.gray40="#e1dfdd",e.gray30="#edebe9",e.gray20="#f3f2f1",e.gray10="#faf9f8",e.white="#ffffff"}(Gc||(Gc={})),function(e){e.pinkRed10="#750b1c",e.red30="#a4262c",e.red10="#d13438",e.redOrange10="#da3b01",e.orange30="#8e562e",e.orange20="#ca5010",e.orange10="#ffaa44",e.yellow10="#fce100",e.orangeYellow20="#986f0b",e.orangeYellow10="#c19c00",e.yellowGreen10="#8cbd18",e.green20="#0b6a0b",e.green10="#498205",e.greenCyan10="#00ad56",e.cyan30="#005b70",e.cyan20="#038387",e.cyan10="#00b7c3",e.cyanBlue20="#004e8c",e.cyanBlue10="#0078d4",e.blue10="#4f6bed",e.blueMagenta30="#5c2e91",e.blueMagenta20="#8764b8",e.blueMagenta10="#8378de",e.magenta20="#881798",e.magenta10="#c239b3",e.magentaPink20="#9b0062",e.magentaPink10="#e3008c",e.gray40="#393939",e.gray30="#7a7574",e.gray20="#69797e",e.gray10="#a0aeb2"}(_c||(_c={})),function(e){e.activeReviewMode="#0e336a",e.aliceBlueBackground="#f3f7fc",e.barBackground="#d2e0f4",e.barGradientColor="#13458f",e.countColor="#1651aa",e.textColor="#6d6b69",e.grayBackground="#f3f3f3",e.gray1="#d2d2d2",e.gray2="#262626",e.gray3="#757470",e.gray4="#ebebeb",e.gray5="#3c3b3b",e.blueMagenta1="#5a4ebc",e.waterBlue="#D2E0F4",e.wordBlue="#2E6AC5",e.wordBlueDarkAlt="#295fb1",e.wordBlueDark="#225095",e.wordPrimary="#185ABD",e.lightPink="#FDE5E5",e.lightGreen="#D4EDD4",e.darkGreen="#0b5a08"}(qc||(qc={}));class Zc extends C.Component{render(){const{isVisible:e}=this.props,{styleProvider:t}=this.props,i=(0,hs.$)().getStringsFor("ProofingStrings"),o=function(){const e=Tc();return{mainContainer:{alignItems:"center",backgroundColor:e.buttonBackground,display:"flex",flexDirection:"column",height:"100%",justifyContent:"center",opacity:"0",position:"absolute",top:"0",transition:"opacity 200ms linear, z-index 0ms 200ms",width:"100%",zIndex:"-1",":hover,&:focus":{backgroundColor:e.buttonBackgroundHovered},":active":{backgroundColor:e.buttonBackgroundPressed},fontFamily:Pc},mainContainerVisible:{opacity:"1",transition:"opacity 200ms linear, z-index 0ms 0ms",zIndex:"103"},startWritingLabel:{color:qc.wordBlue,fontSize:"20px",fontWeight:"600",height:"24px",lineHeight:"18px",letterSpacing:"0px",maxWidth:"94%",overflow:"hidden",textAlign:"center",textOverflow:"ellipsis",whiteSpace:"nowrap"},editorScoreLabel:{color:e.buttonText,fontSize:"14px",lineHeight:"17px",position:"absolute",height:"19px",left:"17px",top:"13px"},incipientDocumentLabel:{color:"#262626",fontSize:"12px",maxWidth:"300px",textAlign:"center",width:"88%"},hundredWordsLabel:{color:e.bodySubtext,fontSize:"14px",lineHeight:"16px",position:"absolute",height:"19px",left:"17px",top:"34px"}}}(),r=t.css(o.mainContainer,e?o.mainContainerVisible:[]);return C.createElement("div",{className:r},C.createElement("div",{"aria-hidden":!0,"data-is-focusable":!1,className:t.css(o.editorScoreLabel)},i("ProgressCardTitle")),C.createElement("div",{"aria-hidden":!0,"data-is-focusable":!1,className:t.css(o.hundredWordsLabel)},i("IncipientDocumentLabel")))}}var Kc=i(29192),Yc=i(39144),Qc=i(66251);class $c{static isElement(e){return"getAttribute"in e}static isNode(e){return"parentElement"in e}static createRect(e,t,i){const o={bottom:0,height:t,left:0,right:0,top:0,width:e,x:null!=i?i:0,y:0,toJSON:()=>""};return t<0?(o.top=o.y+t,o.bottom=o.y):(o.top=o.y,o.bottom=o.y+t),e<0?(o.right=o.x,o.left=o.x+e):(o.right=o.x+e,o.left=o.x),o}}const Jc=(e,t=6)=>{const i=(e=>{const t=document.getElementById("ideasApp"),i=null==t?void 0:t.getBoundingClientRect();return i?$c.createRect(i.width-2*e,window.innerHeight,e):void 0})(t);let o;return e&&i?o=i.width<e?i.width:e:e?o=e:i&&(o=i.width),{bounds:i,calloutMaxHeight:void 0,calloutMaxWidth:o,minPagePadding:void 0}};function Xc(){const e=Tc();return{flexContainer:{backgroundColor:e.buttonBackground,alignItems:"center",display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",height:"100%",width:"100%",":hover":{backgroundColor:e.buttonBackgroundHovered},":active":{backgroundColor:e.buttonBackgroundPressed}},focusStyle:{":hover > :last-child > *":{backgroundColor:e.bodyStandoutBackground}},suggestionsContainer:{alignItems:"flex-start",cursor:"default",display:"flex",flexDirection:"row",height:"47px",justifyContent:"center",margin:"13px 16px 0px 17px",width:"100%"},suggestionsContainerShort:{alignItems:"flex-start",cursor:"default",display:"flex",flexDirection:"row",height:"22px",justifyContent:"flex-end",marginLeft:"6px",order:2,width:"35px"},editorScoreWrapper:{alignItems:"flex-start",display:"flex",flexDirection:"row",justifyContent:"flex-end",height:"44px",width:"36%"},editorScoreWrapperShort:{alignItems:"flex-start",display:"flex",flexDirection:"row",justifyContent:"flex-end",height:"20px",width:"35px"},focusableScoreWrapper:{alignItems:"flex-start",cursor:"pointer",display:"flex",flexDirection:"row",justifyContent:"flex-end",height:"38px",padding:"0px 1px"},focusableScoreWrapperShort:{alignItems:"flex-start",cursor:"pointer",display:"flex",flexDirection:"row",justifyContent:"flex-end",height:"22px",padding:"0px 1px"},progressNumberContainer:{color:e.accentButtonText,fontFamily:Uc,fontSize:"40px",fontWeight:"600",height:"44px",letterSpacing:"-1.15px",lineHeight:"43px",overflow:"hidden",pointerEvents:"none",textAlign:"right","@media screen and (-ms-high-contrast: none)":{paddingTop:"2.5px"}},progressNumberContainerShort:{color:e.accentButtonText,fontFamily:Uc,fontSize:"17px",fontWeight:"600",height:"20px",letterSpacing:"0px",lineHeight:"25px",textAlign:"right",paddingRight:"1px",order:2,overflow:"hidden",pointerEvents:"none","@media screen and (-ms-high-contrast: none)":{paddingTop:"1px"}},percentageContainer:{color:e.accentButtonText,fontFamily:Uc,fontSize:"16px",fontWeight:"bold",lineHeight:"23.5px",letterSpacing:"0px",marginLeft:"1px",pointerEvents:"none",textAlign:"right"},percentageContainerShort:{color:e.accentButtonText,fontFamily:Uc,fontSize:"11px",fontWeight:"bold",height:"16px",letterSpacing:"0px",lineHeight:"22px",marginLeft:"1px",order:3,pointerEvents:"none",textAlign:"right"},progressNumber:{height:"100%"},progressLabel:{color:e.buttonText,fontSize:"14px",lineHeight:"17px",height:"17px",width:"64%"},progressLabelShort:{height:"0px",width:"0px",visibility:"hidden"},progressBarWrapper:{alignItems:"center",alignSelf:"center",flexDirection:"row",display:"flex",justifyContent:"center",height:"12px",margin:"12px 16px 12px 16px",width:"100%"},progressBarWrapperShort:{alignItems:"center",alignSelf:"center",flexDirection:"row",display:"flex",justifyContent:"center",order:1,height:"44px",margin:"2px",width:"calc(100% - 72px)"},progressBarUnit:{background:`${e.accentButtonText} !important`,borderRadius:"4px",transition:"flex-grow 300ms",height:"8px",margin:"0.5px",forcedColorAdjust:"none",":hover":{cursor:"pointer"},[yc]:{background:"none",backgroundColor:Gc.black},[mc]:{background:"none",backgroundColor:Gc.white}},progressBarSecondaryUnit:{background:"none",backgroundColor:e.variantBorder,[hc]:{opacity:.5}},attentionUnitStyle:{":hover,&:focus":{[hc]:{opacity:1}}},calloutPopUp:{backgroundColor:e.bodyBackground,borderRadius:"3px",boxShadow:"0 8px 24px 0 rgba(0,0,0,0.1), 0 8px 16px 0 rgba(0,0,0,0.12)",padding:"6px 10px 8px 10px",pointerEvents:"none","> .ms-Callout-beakCurtain":{borderRadius:"2px"}},calloutPopUpTextStyle:{color:e.buttonText,fontFamily:Pc,fontSize:"12px"},calloutPopUpNumberStyle:{fontFamily:Uc,fontSize:"12px",fontWeight:"bold"},SkittleFocusStyle:{cursor:"pointer"},skittleCloseButton:{display:"inline-block",width:"24px",height:"24px"},skittleCritiqueCountWrapper:{alignItems:"center",alignSelf:"center",flexDirection:"row",display:"flex",justifyContent:"flex-start",height:"16px",margin:"0px 12px 7px 12px",width:"100%",fontFamily:Pc,fontSize:"10px",letterSpacing:"0px",color:e.buttonText},skittleCritiqueCount:{color:e.accentButtonText,fontFamily:zc,fontWeight:"bold",margin:"0px 2px 0px 2px"},skittleShimmer:{position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%",transform:"translateX(-100%)",animationDuration:"2s",animationTimingFunction:"ease-in-out",animationDirection:"normal",animationIterationCount:"infinite",animationName:"shimmerAnimation",background:"linear-gradient(to right, rgb(243, 242, 241) 0%, rgb(237, 235, 233) 50%, rgb(243, 242, 241) 100%) 0px 0px / 90% 100% no-repeat rgb(243, 242, 241)"},skittleProgressBarWrapper:{backgroundColor:e.variantBorder,borderRadius:"4px",height:"6px",alignItems:"flex-start",display:"flex",flexDirection:"row",justifyContent:"flex-start",margin:"8px 12px 5px 12px",width:"100%",overflow:"hidden",[Er.up]:{outline:"1px solid transparent",outlineOffset:"-1px"}},skittleProgressBar:{background:e.accentButtonText,borderRadius:"4px",height:"6px",transition:"width 0.3s",minWidth:"6px",[Er.up]:{outline:"3px solid transparent",outlineOffset:"-3px"}},skittleSuggestionsContainer:{alignItems:"flex-start",display:"flex",flexDirection:"row",margin:"8px 12px 6px 12px",width:"100%",justifyContent:"space-between",cursor:"pointer"},skittleEditorScoreWrapper:{alignItems:"flex-start",display:"flex",flexDirection:"row",justifyContent:"flex-start",width:"36%"},skittleScoreWrapper:{alignItems:"flex-start",cursor:"pointer",display:"flex",flexDirection:"row",justifyContent:"flex-end",height:"25px"},skittleNumberContainer:{height:"25px",fontSize:"26px",letterSpacing:"-1px",lineHeight:"30px"},skittlePercentageContainer:{size:"14px"},editorIconStyles:{display:"flex",margin:"0px 0px 5px 57px"}}}function ed(){const e={backgroundColor:`${Tc().bodyBackground} !important`};return{beak:e,beakCurtain:e,calloutMain:e}}var td=i(98706),id=i(75592);class od extends C.Component{get styles(){return Xc()}render(){const{styleProvider:e,barLength:t,ariaLabel:i,isSecondary:o,color:r,isVisible:n}=this.props,s={backgroundColor:`${r} !important`},a=this.element.current===this.props.orchestrator.currentHoveredOrFocused,l=t?{flexGrow:t,minWidth:"8px"}:{margin:"0"},c=n&&t>0,d=!c||void 0,u=this.styles;return C.createElement(C.Fragment,null,C.createElement("div",{"aria-hidden":d,"aria-label":(0,td.G)(i,Math.round(t)),"aria-readonly":!0,className:e.css(u.progressBarUnit,l,o?u.progressBarSecondaryUnit:[],u.attentionUnitStyle,a?s:[]),"data-is-focusable":c,onClick:this.props.orchestrator.handleElementHoveredOrFocused,onBlur:this.props.orchestrator.handleElementHoveredOrFocused,onFocus:this.props.orchestrator.handleElementHoveredOrFocused,onMouseOver:this.props.orchestrator.handleElementHoveredOrFocused,onMouseOut:this.props.orchestrator.handleElementHoveredOrFocused,ref:this.element,role:oc},this.renderBarUnitPopUp()))}renderBarUnitPopUp(){const{styleProvider:e,calloutContent:t,color:i,barLength:o}=this.props,r=this.styles,n=e.css(r.calloutPopUp),s=e.css(r.calloutPopUpTextStyle),a=e.css(r.calloutPopUpNumberStyle,{color:i}),l=this.element.current===this.props.orchestrator.currentHoveredOrFocused,c=0===o||!l||this.props.cardSize===_l.Collapsed;return C.createElement(b.P,Object.assign({className:n,styles:ed(),role:tc,hidden:c,target:this.element.current,setInitialFocus:!0,directionalHint:f.A.bottomCenter,beakWidth:20},Jc(236)),C.createElement("span",{className:s},t),C.createElement("span",{className:a}," ",Math.round(o),"%"))}constructor(e){super(e),this.element=(0,C.createRef)()}}const rd=(0,id.PA)(od),nd=(e,t,i,o,r)=>{var n;const s=t===(null===(n=o.currentHoveredOrFocused)||void 0===n?void 0:n.id),a=Xc(),l=i.css(a.calloutPopUp),c=i.css(a.calloutPopUpTextStyle),d=!s||r===_l.Collapsed;return C.createElement(b.P,Object.assign({styles:ed(),className:l,role:tc,target:document.getElementById(t),setInitialFocus:!0,hidden:d,directionalHint:f.A.bottomCenter,beakWidth:20},Jc(268)),C.createElement("div",{className:c},e))};var sd;!function(e){e.Add="Add",e.ArrowEnterLeft="ArrowEnterLeft",e.Blocked="Blocked12",e.ChevronUp="ChevronUp",e.ChevronDown="ChevronDown",e.ChevronLeft="ChevronLeft",e.ChevronRight="ChevronRight",e.Copy="Copy",e.Delete="Delete",e.Edit="Edit",e.Feedback="Feedback",e.Forward="Forward",e.Lightbulb="Lightbulb",e.More="More",e.ReturnKey="ReturnKey",e.Back="Back",e.Cancel="Cancel",e.Diamond="Diamond",e.Undo="Undo",e.Save="Save",e.ReadingMode="ReadingMode",e.Dictionary="Dictionary",e.Clock="Clock",e.Info="Info",e.CircleFill="CircleFill",e.StatusCircleCheckmark="StatusCircleCheckmark",e.Sync="Sync"}(sd||(sd={}));var ad=i(49982);const ld="SkittleOptionsButton",cd="SkittleCloseButton",dd=e=>{const{buttonStyle:t,dismissMenuProps:i,buttonIconStyle:o}=e,{styleProvider:r,orchestrator:n,cardSize:s}=i,a=(0,hs.$)().getStringsFor("ProofingStrings")("SkittleCloseButton");return C.createElement(C.Fragment,null,nd(a,cd,r,n,s),C.createElement(ad.K,{iconProps:{iconName:sd.Cancel,style:o},id:cd,ariaLabel:a,className:t}))},ud=e=>{const{buttonStyle:t,dismissMenuProps:i,buttonIconStyle:o,dismissMenuState:r,onDismiss:n}=e,{styleProvider:s,orchestrator:a,cardSize:l,onClosePermanent:c}=i,d=(0,hs.$)().getStringsFor("ProofingStrings"),u=d("SkittleClosePermanentButton"),g=Tc(),p={menuItem:{color:g.buttonText,fontSize:"16px",width:"16px"},buttonIcon:o,callout:{backgroundColor:g.bodyBackground}},h=[{key:"1",ariaLabel:u,text:u,onClick:c,iconProps:{style:p.menuItem,iconName:sd.Blocked}}];return C.createElement(C.Fragment,null,nd(d("SkittleOptions"),ld,s,a,l),C.createElement(ad.K,{iconProps:{iconName:sd.More,style:p.buttonIcon},id:ld,ariaLabel:d("SkittleOptions"),className:t}),C.createElement(vl.l,{items:h,target:"#"+ld,directionalHint:f.A.bottomRightEdge,hidden:r.isMenuHidden,onDismiss:n,calloutProps:{styles:{calloutMain:p.callout}},isBeakVisible:!1,theme:Ic()}))},gd=e=>{const[t,i]=(0,C.useState)(!0),o={isMenuHidden:t,setIsMenuHidden:i},{isHoveredOrFocused:r,forceFocus:n,reset:s}=e.orchestrator;(0,C.useEffect)((()=>{var e;return null===(e=document.getElementById(ld))||void 0===e?void 0:e.addEventListener("click",(()=>{n(!0),o.setIsMenuHidden(!1),s(),(0,Kc.C)().logEvent(525169620,"OptionsClicked",Yc.h.EditorScore,Qc.q.Info)}))}),[]);const a=(0,C.useCallback)((()=>{n(!1),s(),o.setIsMenuHidden(!0)}),[]),l=!r&&o.isMenuHidden?{display:"none"}:[],c=(0,Er.Zq)(Xc().skittleCloseButton,l),d={color:Tc().bodySubtext,fontSize:"16px",width:"28px"},u={buttonStyle:c,dismissMenuProps:e,buttonIconStyle:d,dismissMenuState:o,onDismiss:a},g={buttonStyle:c,dismissMenuProps:e,buttonIconStyle:d};return C.createElement("div",null,C.createElement(ud,Object.assign({},u)),C.createElement(dd,Object.assign({},g)))};class pd extends C.Component{componentDidMount(){const{orchestrator:e}=this.props;e.reset();const t=document.getElementById(cd);this.setupEventListeners(!0,t,this.onCloseIconButtonHandler);const i=document.getElementById(ld);this.setupEventListeners(!0,i,this.onOptionsIconButtonHandler);const o=this._editorScoreRef.current;this.setupEventListeners(!0,o,this.onClickButtonHandler)}componentWillUnmount(){const e=document.getElementById(cd);this.setupEventListeners(!1,e,this.onCloseIconButtonHandler);const t=document.getElementById(ld);this.setupEventListeners(!0,t,this.onOptionsIconButtonHandler);const i=this._editorScoreRef.current;this.setupEventListeners(!1,i,this.onClickButtonHandler)}setupEventListeners(e,t,i){if(!t)return;const{orchestrator:o}=this.props,r=(e?t.addEventListener:t.removeEventListener).bind(t);r("click",i),r("blur",o.handleElementHoveredOrFocused),r("focus",o.handleElementHoveredOrFocused),r("mouseover",o.handleElementHoveredOrFocused),r("mouseleave",o.handleElementHoveredOrFocused)}componentDidUpdate(e){const{documentScore:t,cardSize:i}=this.props;t===this.state.oldDocumentScore||this.state.isAnimating||i!==e.cardSize||(window.requestAnimationFrame((()=>{this.setState({isAnimating:!0})})),window.setTimeout((()=>{window.requestAnimationFrame((()=>{this.setState({isAnimating:!1,oldDocumentScore:t})}))}),this._animationTimeout))}getSkittleAdditionalButtons(e){return e?this.renderSkittleSuppressionMenu():C.createElement(C.Fragment,null)}render(){const{cardSize:e,styleProvider:t,isSkittle:i}=this.props,o=Xc(),r=e!==_l.FullSize,n=r?o.progressBarWrapperShort:o.progressBarWrapper,s=r?o.suggestionsContainerShort:o.suggestionsContainer,a=r?o.progressLabelShort:o.progressLabel,l=r?o.editorScoreWrapperShort:o.editorScoreWrapper,c=i?o.skittleSuggestionsContainer:s,d=i?o.skittleEditorScoreWrapper:l,u=i?o.SkittleFocusStyle:o.focusStyle;return C.createElement(C.Fragment,null,C.createElement("div",{id:"ProgressBar",className:t.css(o.flexContainer,u),role:ec},C.createElement("div",{className:t.css(c)},!i&&C.createElement("div",{"aria-hidden":!0,className:t.css(a)},this._str("ProgressCardTitle")),C.createElement("div",{className:t.css(d)},this.renderEditorScore()),i&&this.renderEditorIcon(),this.getSkittleAdditionalButtons(!!i)),!i&&C.createElement("div",{className:t.css(n)},this.renderProgressBarUnits()),i&&this.renderSkittleBar(),i&&this.renderSkittleFooter()))}renderEditorScore(){const{isVisible:e,cardSize:t,styleProvider:i,documentScore:o,orchestrator:r,isSkittle:n}=this.props,{isAnimating:s}=this.state,a=!e||void 0,l=t!==_l.FullSize,c=Xc(),d=l?c.progressNumberContainerShort:c.progressNumberContainer,u=l?c.percentageContainerShort:c.percentageContainer,g=l?this._slideUpStyles.slideUpShort:this._slideUpStyles.slideUp,p=s?g:[],h=l?c.focusableScoreWrapperShort:c.focusableScoreWrapper,m=n?c.skittleScoreWrapper:[],y=n?c.skittleNumberContainer:[],b=n?c.skittlePercentageContainer:[],f=n&&s?this._slideUpStyles.slideUpSkittle:[];return C.createElement(C.Fragment,null,C.createElement("div",{id:"ProgressCardScore","aria-hidden":a,"aria-label":(0,td.G)(this._str("ReviewProgressAriaLabel"),o)+this._str("EditorScoreTooltip"),"data-is-focusable":e,className:i.css(h,m),ref:this._editorScoreRef,role:"note"},C.createElement("div",{"aria-hidden":!0,className:i.css(d,y)},C.createElement("div",{className:i.css(c.progressNumber,p,f)},this.state.oldDocumentScore),C.createElement("div",{className:i.css(c.progressNumber)},o)),C.createElement("div",{"aria-hidden":!0,className:i.css(u,b)},"%")),nd(this._str("EditorScoreTooltip"),"ProgressCardScore",i,r,t))}renderEditorIcon(){const{orchestrator:e,styleProvider:t}=this.props,i=e.isHoveredOrFocused?{display:"none"}:[];return C.createElement("div",{className:t.css(Xc().editorIconStyles,i),"aria-hidden":!0},C.createElement("img",{src:kc.theme.isInverted?"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE3LjUgNUMxNy43MDgzIDUgMTcuOTAzNiA1LjAzOTA2IDE4LjA4NTkgNS4xMTcxOUMxOC4yNjgyIDUuMTk1MzEgMTguNDI3NyA1LjMwMjczIDE4LjU2NDUgNS40Mzk0NUMxOC43MDEyIDUuNTc2MTcgMTguODA4NiA1LjczNTY4IDE4Ljg4NjcgNS45MTc5N0MxOC45NjQ4IDYuMTAwMjYgMTkuMDAzOSA2LjI5NTU3IDE5LjAwMzkgNi41MDM5MUMxOS4wMDM5IDYuNzEyMjQgMTguOTY0OCA2LjkwNzU1IDE4Ljg4NjcgNy4wODk4NEMxOC44MDg2IDcuMjY1NjIgMTguNzAxMiA3LjQyMTg4IDE4LjU2NDUgNy41NTg1OUMxOC40Mjc3IDcuNjk1MzEgMTguMjY4MiA3LjgwMjczIDE4LjA4NTkgNy44ODA4NkMxNy45MDM2IDcuOTU4OTggMTcuNzA4MyA3Ljk5ODA1IDE3LjUgNy45OTgwNUgxMS42NjAyTDEwLjIxNDggMTBIMTQuNTAyQzE0LjcxMDMgMTAgMTQuOTA1NiAxMC4wMzkxIDE1LjA4NzkgMTAuMTE3MkMxNS4yNzAyIDEwLjE5NTMgMTUuNDI5NyAxMC4zMDI3IDE1LjU2NjQgMTAuNDM5NUMxNS42OTY2IDEwLjU3NjIgMTUuODAwOCAxMC43MzU3IDE1Ljg3ODkgMTAuOTE4QzE1Ljk1NyAxMS4xMDAzIDE1Ljk5NjEgMTEuMjk1NiAxNS45OTYxIDExLjUwMzlDMTUuOTk2MSAxMS43MTIyIDE1Ljk1NyAxMS45MDc2IDE1Ljg3ODkgMTIuMDg5OEMxNS44MDA4IDEyLjI2NTYgMTUuNjk2NiAxMi40MjE5IDE1LjU2NjQgMTIuNTU4NkMxNS40Mjk3IDEyLjY5NTMgMTUuMjcwMiAxMi44MDI3IDE1LjA4NzkgMTIuODgwOUMxNC45MDU2IDEyLjk1OSAxNC43MTAzIDEyLjk5OCAxNC41MDIgMTIuOTk4SDguMDI3MzRMNi41ODIwMyAxNUgxMS41MDM5QzExLjcwNTcgMTUgMTEuODk3OCAxNS4wMzkxIDEyLjA4MDEgMTUuMTE3MkMxMi4yNjI0IDE1LjE5NTMgMTIuNDIxOSAxNS4zMDI3IDEyLjU1ODYgMTUuNDM5NUMxMi42OTUzIDE1LjU3NjIgMTIuODAyNyAxNS43MzU3IDEyLjg4MDkgMTUuOTE4QzEyLjk1OSAxNi4xMDAzIDEyLjk5OCAxNi4yOTU2IDEyLjk5OCAxNi41MDM5QzEyLjk5OCAxNi43MTIyIDEyLjk1OSAxNi45MDc2IDEyLjg4MDkgMTcuMDg5OEMxMi44MDI3IDE3LjI2NTYgMTIuNjk1MyAxNy40MjE5IDEyLjU1ODYgMTcuNTU4NkMxMi40MjE5IDE3LjY5NTMgMTIuMjYyNCAxNy44MDI3IDEyLjA4MDEgMTcuODgwOUMxMS44OTc4IDE3Ljk1OSAxMS43MDU3IDE3Ljk5OCAxMS41MDM5IDE3Ljk5OEgzLjU3NDIyTDIuNTY4MzYgMTguNzIwN0MyLjUxNjI4IDE4Ljc1MzMgMi40NjA5NCAxOC43Njk1IDIuNDAyMzQgMTguNzY5NUMyLjM0Mzc1IDE4Ljc2OTUgMi4yOTE2NyAxOC43NTY1IDIuMjQ2MDkgMTguNzMwNUwxLjEyMzA1IDE5LjU2MDVDMS4xMDM1MiAxOS41NzM2IDEuMDcwOTYgMTkuNTgwMSAxLjAyNTM5IDE5LjU4MDFDMC44NTYxMiAxOS41ODAxIDAuNzEyODkxIDE5LjUzMTIgMC41OTU3MDMgMTkuNDMzNkMwLjQ3ODUxNiAxOS4zMzU5IDAuNDE5OTIyIDE5LjIyODUgMC40MTk5MjIgMTkuMTExM1YxOS4wODJMMC44MzAwNzggMTcuNzI0NkMwLjc0NTQ0MyAxNy42NTk1IDAuNzAzMTI1IDE3LjU3ODEgMC43MDMxMjUgMTcuNDgwNUMwLjcwMzEyNSAxNy40NjA5IDAuNzA5NjM1IDE3LjQzMTYgMC43MjI2NTYgMTcuMzkyNkwxLjY2OTkyIDE0LjIyODVMMTEuNjUwNCAwLjUzNzEwOUMxMS43MTU1IDAuNDkxNTM2IDExLjc2NDMgMC40NjIyNCAxMS43OTY5IDAuNDQ5MjE5QzExLjgyMjkgMC40MzYxOTggMTEuODY4NSAwLjQyOTY4OCAxMS45MzM2IDAuNDI5Njg4QzExLjk4NTcgMC40Mjk2ODggMTIuMDgzMyAwLjQ2MjI0IDEyLjIyNjYgMC41MjczNDRDMTIuMzY5OCAwLjU5MjQ0OCAxMi41NDIzIDAuNjgwMzM5IDEyLjc0NDEgMC43OTEwMTZDMTIuOTM5NSAwLjkwMTY5MyAxMy4xNTQzIDEuMDMxOSAxMy4zODg3IDEuMTgxNjRDMTMuNjE2NSAxLjMzMTM4IDEzLjg0NDQgMS40OTA4OSAxNC4wNzIzIDEuNjYwMTZDMTQuMjkzNiAxLjgyOTQzIDE0LjUwMiAyLjAwNTIxIDE0LjY5NzMgMi4xODc1QzE0Ljg5MjYgMi4zNjMyOCAxNS4wNTIxIDIuNTM5MDYgMTUuMTc1OCAyLjcxNDg0QzE1LjIwODMgMi43NjA0MiAxNS4yMzQ0IDIuODAyNzMgMTUuMjUzOSAyLjg0MThDMTUuMjczNCAyLjg4MDg2IDE1LjI4MzIgMi45MTY2NyAxNS4yODMyIDIuOTQ5MjJDMTUuMjgzMiAyLjk4ODI4IDE1LjI2NjkgMy4wMzA2IDE1LjIzNDQgMy4wNzYxN0wxMy44Mzc5IDVIMTcuNVpNMi41NzgxMiAxNC42ODc1TDEuODI2MTcgMTcuMTk3M0wyLjQwMjM0IDE3LjYwNzRMNC41NzAzMSAxNi4wNjQ1TDEzLjQyNzcgMy44NjcxOUwxMS40NzQ2IDIuNDgwNDdWMi40OTAyM0wyLjU3ODEyIDE0LjY4NzVaIiBmaWxsPSIjODJBQkYxIi8+Cjwvc3ZnPgo=":"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjAgMCAyMCAyMCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTE3LjUgNUMxNy43MDgzIDUgMTcuOTAzNiA1LjAzOTA2IDE4LjA4NTkgNS4xMTcxOUMxOC4yNjgyIDUuMTk1MzEgMTguNDI3NyA1LjMwMjczIDE4LjU2NDUgNS40Mzk0NUMxOC43MDEyIDUuNTc2MTcgMTguODA4NiA1LjczNTY4IDE4Ljg4NjcgNS45MTc5N0MxOC45NjQ4IDYuMTAwMjYgMTkuMDAzOSA2LjI5NTU3IDE5LjAwMzkgNi41MDM5MUMxOS4wMDM5IDYuNzEyMjQgMTguOTY0OCA2LjkwNzU1IDE4Ljg4NjcgNy4wODk4NEMxOC44MDg2IDcuMjY1NjIgMTguNzAxMiA3LjQyMTg4IDE4LjU2NDUgNy41NTg1OUMxOC40Mjc3IDcuNjk1MzEgMTguMjY4MiA3LjgwMjczIDE4LjA4NTkgNy44ODA4NkMxNy45MDM2IDcuOTU4OTggMTcuNzA4MyA3Ljk5ODA1IDE3LjUgNy45OTgwNUgxMS42NjAyTDEwLjIxNDggMTBIMTQuNTAyQzE0LjcxMDMgMTAgMTQuOTA1NiAxMC4wMzkxIDE1LjA4NzkgMTAuMTE3MkMxNS4yNzAyIDEwLjE5NTMgMTUuNDI5NyAxMC4zMDI3IDE1LjU2NjQgMTAuNDM5NUMxNS42OTY2IDEwLjU3NjIgMTUuODAwOCAxMC43MzU3IDE1Ljg3ODkgMTAuOTE4QzE1Ljk1NyAxMS4xMDAzIDE1Ljk5NjEgMTEuMjk1NiAxNS45OTYxIDExLjUwMzlDMTUuOTk2MSAxMS43MTIyIDE1Ljk1NyAxMS45MDc2IDE1Ljg3ODkgMTIuMDg5OEMxNS44MDA4IDEyLjI2NTYgMTUuNjk2NiAxMi40MjE5IDE1LjU2NjQgMTIuNTU4NkMxNS40Mjk3IDEyLjY5NTMgMTUuMjcwMiAxMi44MDI3IDE1LjA4NzkgMTIuODgwOUMxNC45MDU2IDEyLjk1OSAxNC43MTAzIDEyLjk5OCAxNC41MDIgMTIuOTk4SDguMDI3MzRMNi41ODIwMyAxNUgxMS41MDM5QzExLjcwNTcgMTUgMTEuODk3OCAxNS4wMzkxIDEyLjA4MDEgMTUuMTE3MkMxMi4yNjI0IDE1LjE5NTMgMTIuNDIxOSAxNS4zMDI3IDEyLjU1ODYgMTUuNDM5NUMxMi42OTUzIDE1LjU3NjIgMTIuODAyNyAxNS43MzU3IDEyLjg4MDkgMTUuOTE4QzEyLjk1OSAxNi4xMDAzIDEyLjk5OCAxNi4yOTU2IDEyLjk5OCAxNi41MDM5QzEyLjk5OCAxNi43MTIyIDEyLjk1OSAxNi45MDc2IDEyLjg4MDkgMTcuMDg5OEMxMi44MDI3IDE3LjI2NTYgMTIuNjk1MyAxNy40MjE5IDEyLjU1ODYgMTcuNTU4NkMxMi40MjE5IDE3LjY5NTMgMTIuMjYyNCAxNy44MDI3IDEyLjA4MDEgMTcuODgwOUMxMS44OTc4IDE3Ljk1OSAxMS43MDU3IDE3Ljk5OCAxMS41MDM5IDE3Ljk5OEgzLjU3NDIyTDIuNTY4MzYgMTguNzIwN0MyLjUxNjI4IDE4Ljc1MzMgMi40NjA5NCAxOC43Njk1IDIuNDAyMzQgMTguNzY5NUMyLjM0Mzc1IDE4Ljc2OTUgMi4yOTE2NyAxOC43NTY1IDIuMjQ2MDkgMTguNzMwNUwxLjEyMzA1IDE5LjU2MDVDMS4xMDM1MiAxOS41NzM2IDEuMDcwOTYgMTkuNTgwMSAxLjAyNTM5IDE5LjU4MDFDMC44NTYxMiAxOS41ODAxIDAuNzEyODkxIDE5LjUzMTIgMC41OTU3MDMgMTkuNDMzNkMwLjQ3ODUxNiAxOS4zMzU5IDAuNDE5OTIyIDE5LjIyODUgMC40MTk5MjIgMTkuMTExM1YxOS4wODJMMC44MzAwNzggMTcuNzI0NkMwLjc0NTQ0MyAxNy42NTk1IDAuNzAzMTI1IDE3LjU3ODEgMC43MDMxMjUgMTcuNDgwNUMwLjcwMzEyNSAxNy40NjA5IDAuNzA5NjM1IDE3LjQzMTYgMC43MjI2NTYgMTcuMzkyNkwxLjY2OTkyIDE0LjIyODVMMTEuNjUwNCAwLjUzNzEwOUMxMS43MTU1IDAuNDkxNTM2IDExLjc2NDMgMC40NjIyNCAxMS43OTY5IDAuNDQ5MjE5QzExLjgyMjkgMC40MzYxOTggMTEuODY4NSAwLjQyOTY4OCAxMS45MzM2IDAuNDI5Njg4QzExLjk4NTcgMC40Mjk2ODggMTIuMDgzMyAwLjQ2MjI0IDEyLjIyNjYgMC41MjczNDRDMTIuMzY5OCAwLjU5MjQ0OCAxMi41NDIzIDAuNjgwMzM5IDEyLjc0NDEgMC43OTEwMTZDMTIuOTM5NSAwLjkwMTY5MyAxMy4xNTQzIDEuMDMxOSAxMy4zODg3IDEuMTgxNjRDMTMuNjE2NSAxLjMzMTM4IDEzLjg0NDQgMS40OTA4OSAxNC4wNzIzIDEuNjYwMTZDMTQuMjkzNiAxLjgyOTQzIDE0LjUwMiAyLjAwNTIxIDE0LjY5NzMgMi4xODc1QzE0Ljg5MjYgMi4zNjMyOCAxNS4wNTIxIDIuNTM5MDYgMTUuMTc1OCAyLjcxNDg0QzE1LjIwODMgMi43NjA0MiAxNS4yMzQ0IDIuODAyNzMgMTUuMjUzOSAyLjg0MThDMTUuMjczNCAyLjg4MDg2IDE1LjI4MzIgMi45MTY2NyAxNS4yODMyIDIuOTQ5MjJDMTUuMjgzMiAyLjk4ODI4IDE1LjI2NjkgMy4wMzA2IDE1LjIzNDQgMy4wNzYxN0wxMy44Mzc5IDVIMTcuNVpNMi41NzgxMiAxNC42ODc1TDEuODI2MTcgMTcuMTk3M0wyLjQwMjM0IDE3LjYwNzRMNC41NzAzMSAxNi4wNjQ1TDEzLjQyNzcgMy44NjcxOUwxMS40NzQ2IDIuNDgwNDdWMi40OTAyM0wyLjU3ODEyIDE0LjY4NzVaIiBmaWxsPSIjMTg1QUJEIi8+Cjwvc3ZnPgo="}))}constructor(e){super(e),this._maxCritiqueCountNumber=99,this._animationTimeout=500,this._editorScoreRef=(0,C.createRef)(),this._str=(0,hs.$)().getStringsFor("ProofingStrings"),this.slideUpKeyframes=this.props.styleProvider.keyframes({from:{marginTop:"0px"},to:{marginTop:"-44px"}}),this.slideUpShortKeyframes=this.props.styleProvider.keyframes({from:{marginTop:"0px"},to:{marginTop:"-20px"}}),this.skittleSlideUpKeyframes=this.props.styleProvider.keyframes({from:{marginTop:"0px"},to:{marginTop:"-25px"}}),this._slideUpStyles={slideUp:{animationDuration:"300ms",animationName:this.slideUpKeyframes,animationTimingFunction:"ease-out",marginTop:"-44px"},slideUpShort:{animationDuration:"300ms",animationName:this.slideUpShortKeyframes,animationTimingFunction:"ease-out",marginTop:"-20px"},slideUpSkittle:{animationDuration:"300ms",animationName:this.skittleSlideUpKeyframes,animationTimingFunction:"ease-out",marginTop:"-25px"}},this.renderSkittleBar=()=>{const{documentScore:e,styleProvider:t,isThinking:i}=this.props,o={width:`${e}%`},r=Tc(),n=Xc(),s=i?{backgroundSize:"200% 100%",background:`linear-gradient(97.75deg, ${r.accentButtonBackground} 5.99%, ${r.accentButtonText} 48.17%, ${r.accentButtonBackground} 94.01%)`,animationDuration:"2s",animationTimingFunction:"ease",animationIterationCount:"infinite",animationName:t.keyframes({"0%":{backgroundPosition:"200% 100%"},"100%":{backgroundPosition:"0% 100%"}})}:[];return C.createElement("div",{className:t.css(n.skittleProgressBarWrapper)},C.createElement("div",{className:t.css(n.skittleProgressBar,s,o)}))},this.renderSkittleFooter=()=>{const{styleProvider:e,critiquesCount:t}=this.props,i=t>1?this._str("SkittleCritiquesFooterPlural"):this._str("SkittleCritiquesFooterSingular"),o=t>this._maxCritiqueCountNumber?this._maxCritiqueCountNumber+"+":t,r=Xc();return C.createElement("div",{className:e.css(r.skittleCritiqueCountWrapper)},t?C.createElement(C.Fragment,null,((e,t,...i)=>{const o=i.length,r=e.split(/\{(\d+)\}/g),n=[];for(let e=0;e<r.length;e++){const s=r[e],a=Number(s),l=`spanListItem${e}-${t}-${o}`;""!==s&&(!isNaN(a)&&a<o?n.push(C.createElement("span",{key:l,className:i[a].className},i[a].item)):n.push(C.createElement("span",{key:l,className:t},s)))}return n})(i,"",{item:o,className:e.css(r.skittleCritiqueCount)})):C.createElement(C.Fragment,null,this._str("SkittleCritiquesAllGood")))},this.renderSkittleSuppressionMenu=()=>{const{orchestrator:e,styleProvider:t,cardSize:i}=this.props;return C.createElement(C.Fragment,null,C.createElement(gd,{orchestrator:e,onClosePermanent:this.onClosePermanent,onClose:this.onCloseInSession,styleProvider:t,cardSize:i}))},this.renderProgressBarUnits=()=>{const{documentScore:e,isVisible:t,cardSize:i,styleProvider:o,orchestrator:r,progressBarData:n}=this.props,{spellingPercent:s,grammarPercent:a,refinementsPercent:l}=n,c={isVisible:t,cardSize:i,styleProvider:o,orchestrator:r},d=Ic();return C.createElement(C.Fragment,null,C.createElement(rd,Object.assign({},c,{barLength:e,ariaLabel:this._str("CompletedProgressAriaLabel"),calloutContent:this._str("CompletedProgressCalloutContent"),color:d.semanticColors.accentButtonText,isSecondary:!1})),C.createElement(rd,Object.assign({},c,{barLength:s,ariaLabel:this._str("SpellingProgressAriaLabel"),calloutContent:this._str("SpellingProgressCalloutContent"),color:"#ef0000",isSecondary:!0})),C.createElement(rd,Object.assign({},c,{barLength:a,ariaLabel:this._str("GrammarProgressAriaLabel"),calloutContent:this._str("GrammarProgressCalloutContent"),color:"#3368ff",isSecondary:!0})),C.createElement(rd,Object.assign({},c,{barLength:l,ariaLabel:this._str("RefinementsProgressAriaLabel"),calloutContent:this._str("RefinementsProgressCalloutContent"),color:"#7160eb",isSecondary:!0})))},this.onClickButtonHandler=e=>{var t,i;this.props.orchestrator.handleElementHoveredOrFocused(e),null===(i=(t=this.props).onClick)||void 0===i||i.call(t)},this.onCloseIconButtonHandler=e=>{this.props.orchestrator.handleElementHoveredOrFocused(e),this.onCloseInSession()},this.onOptionsIconButtonHandler=e=>{this.props.orchestrator.handleElementHoveredOrFocused(e)},this.onCloseInSession=()=>this.onClosed(!1),this.onClosePermanent=()=>this.onClosed(!0),this.onClosed=e=>{var t,i,o,r;Ql().logCategoryRejectedAcrossLevels(Jl.Skittle),(0,Kc.C)().logEvent(537518217,"SkittleDismissed",Yc.h.EditorScore,Qc.q.Info,{permanent:e}),e?null===(i=(t=this.props).onClosePermanently)||void 0===i||i.call(t):null===(r=(o=this.props).onClose)||void 0===r||r.call(o)},this.state={isAnimating:!1,oldDocumentScore:e.documentScore}}}const hd=(0,id.PA)(pd);class md extends C.Component{componentDidUpdate(){this.props.sizeStore.cardSize===_l.Collapsed&&this.props.orchestrator.reset()}componentDidMount(){const{isSkittle:e}=this.props;this.setupEventListeners(!0),window.addEventListener("resize",this.handleWindowResize);const t=Ql(),i=e?Jl.Skittle:Jl.EditorScore;t.logCategoryOfferedAcrossLevels(i)}componentWillUnmount(){this.setupEventListeners(!1),window.removeEventListener("resize",this.handleWindowResize)}setupEventListeners(e){const t=this._progressCardRef.current;if(!t)return;const i=(e?t.addEventListener:t.removeEventListener).bind(t);i("mousedown",this.handleMouseEvent),i("mouseover",this.handleMouseEvent),i("mouseenter",this.handleMouseEvent),i("mouseleave",this.handleMouseEvent),i("mouseup",this.handleMouseEvent),i("focus",this.scrollToTop),i("blur",this.props.orchestrator.handleElementHoveredOrFocused),i("click",this.onClickHandler),i("contextmenu",this.onRightClickHandler)}render(){const e=Vc(),{orchestrator:t,isSkittle:i}=this.props,{isIncipient:o}=this.props.store,{cardSize:r}=this.props.sizeStore,n=r===_l.Disabled,s=r===_l.Collapsed,a=r===_l.Short,l=o?oc:i?ec:ic,c=this.styleProvider.css(e.mainWrapper,i?e.skittleMainWrapper:[],s||n?e.mainWrapperCollapsed:[],a?e.mainWrapperShort:[],o?[]:e.mainWrapperProgress);return C.createElement("div",{className:this.styleProvider.css(n?e.disabledOffset:[])},C.createElement(Hc,{ariaLabel:this._str("ProgressCardAriaLabel"),headerId:"progressCard-header",hasHeader:!1,styleProvider:this.styleProvider,shouldRenderAsPremium:!1,style:e.pyroCardStyles,visibilityChanged:this.visibilityChanged,visibilityChangedCallbackMode:"onchanged"},C.createElement("div",{id:"ProgressCardWrapper",className:c,role:l,"data-is-focusable":!0,"aria-label":this.getAriaLabel(),ref:this._progressCardRef},this.renderProgressCard(),!i&&this.renderIncipientDocumentLabel(),i&&nd(this._str("SkittleCardCallot"),"ProgressCardWrapper",this.styleProvider,t,r))))}getAriaLabel(){const{documentScore:e,isIncipient:t}=this.props.store,i=this.props.isSkittle?this._str("SkittleCardCallot"):"";return t?this._str("IncipientDocumentAriaLabel"):(0,td.G)(this._str("ReviewProgressAriaLabel"),e)+i}renderIncipientDocumentLabel(){const{styleProvider:e}=this,{isIncipient:t}=this.props.store;return C.createElement(Zc,{isVisible:t,styleProvider:e})}constructor(e){super(e),this._progressCardRef=(0,C.createRef)(),this._str=(0,hs.$)().getStringsFor("ProofingStrings"),this.focusedByMouse=!1,this.styleProvider=new Xl,this.onClickHandler=e=>{const{orchestrator:t,onClick:i,isSkittle:o}=this.props;o&&(t.handleElementHoveredOrFocused(e),null==i||i())},this.onRightClickHandler=e=>{this.props.isSkittle&&(e.stopPropagation(),e.preventDefault())},this.renderProgressCard=()=>{const e=Vc(),{orchestrator:t,isSkittle:i,onClose:o,onClick:r,onClosePermanently:n}=this.props,{documentScore:s,isIncipient:a,critiquesCount:l,progressBarData:c,skittleArgs:d}=this.props.store,{isThinking:u}=d,{cardSize:g}=this.props.sizeStore;return C.createElement("div",{"aria-hidden":!!a||void 0,className:this.styleProvider.css(e.progressCardWrapper),id:"progress-container"},C.createElement(hd,{documentScore:s,cardSize:g,progressBarData:c,critiquesCount:l,orchestrator:t,styleProvider:this.styleProvider,isSkittle:i,isThinking:u,isVisible:!a,onClose:o,onClick:r,onClosePermanently:n}))},this.handleMouseEvent=e=>{const{orchestrator:t,isSkittle:i,onMouseEnter:o}=this.props,r=Ql(),n=i?Jl.Skittle:Jl.EditorScore;switch(this.focusedByMouse=!1,e.type){case"mouseenter":o&&o(),r.logCategoryTriedAcrossLevels(n);break;case"mouseover":r.logCategoryTriedAcrossLevels(n);break;case"mousedown":this.focusedByMouse=!0,r.logCategoryKeptAcrossLevels(n)}i&&t.handleElementHoveredOrFocused(e)},this.scrollToTop=e=>{const{orchestrator:t,isSkittle:i}=this.props;this.focusedByMouse||i||window.scrollTo(0,0),i&&t.handleElementHoveredOrFocused(e)},this.visibilityChanged=e=>{const{isSkittle:t}=this.props;if(!e.visible)return;const i=Ql(),o=t?Jl.Skittle:Jl.EditorScore;i.logCategorySeenAcrossLevels(o),e.stopMonitoring=!0},this.handleWindowResize=()=>{this.props.sizeStore.viewportHeight=window.innerHeight}}}const yd=(0,id.PA)(md),bd={position:"fixed",zIndex:"2",right:"19px",marginTop:"19px",width:"148px",transition:"visibility 0s, opacity 0.3s linear 0.3s",transformOrigin:"top right"},fd="visible",Sd="hidden";class vd{render(e){if(!e)return void this._ulsLogger.sendTraceTag(529073373,d.n.msoulscat_Wac_Telemetry,u.k.Error,"Bad Skittle arguments!");if(this._skittleContainer)return void this._ulsLogger.sendTraceTag(529073374,d.n.msoulscat_Wac_Telemetry,u.k.Info,"Skittle already rendered!");this._zoomContainerElement=document.getElementsByClassName("PageContentOrigin").item(0),this._contentContainerElement=document.getElementsByClassName("Page").item(0),this._scrollParentContainerElement=document.getElementById("WACViewPanelContainer"),this._skittleContainer=document.createElement("div"),this._skittleContainer.id=vd.skittleContainerId,this._skittleContainer.className=(0,Er.Zq)(bd),this._documentScoreHandler.documentScore=e.documentScore,this._documentScoreHandler.critiquesCount=e.critiqueNumber,this._store.skittleArgs.isThinking=e.isThinking;const t={store:this._store,orchestrator:this._orchestrator,sizeStore:this._sizeStore,isSkittle:!0,onClick:()=>{e.onClick(),this._orchestrator.reset()},onClose:e.onClose,onClosePermanently:e.onClosePermanently};this._scrollParentContainerElement?.appendChild(this._skittleContainer),Kr.render(C.createElement(yd,{...t}),this._skittleContainer),this.show(),this._ulsLogger.sendTraceTag(529073375,d.n.msoulscat_Wac_Telemetry,u.k.Info,"Skittle rendered!")}update(e){this._documentScoreHandler.documentScore=e.documentScore,this._documentScoreHandler.critiquesCount=e.critiqueNumber,this._store.skittleArgs.isThinking=e.isThinking,this._ulsLogger.sendTraceTag(529073376,d.n.msoulscat_Wac_Telemetry,u.k.Info,"Skittle updated!")}dispose(){this._skittleContainer&&this._scrollParentContainerElement?(this._scrollParentContainerElement.removeChild(this._skittleContainer),Kr.unmountComponentAtNode(this._skittleContainer),this.removeEventListeners(),this._scrollParentContainerElement=this._zoomContainerElement=this._contentContainerElement=this._skittleContainer=null,this._ulsLogger.sendTraceTag(529073378,d.n.msoulscat_Wac_Telemetry,u.k.Info,"Skittle disposed!")):this._ulsLogger.sendTraceTag(529073377,d.n.msoulscat_Wac_Telemetry,u.k.Info,"Skittle already disposed!")}show(){this.shouldSkittleRender=!0,this.addEventListeners(),this.calculateCanSkittleRender(),this.tryShow()}tryShow(){this._skittleContainer&&this.canSkittleRender&&!this.isSkittleRendered&&(this._skittleContainer.style.visibility=fd,this._skittleContainer.style.opacity="1",this._skittleContainer.style.overflow=fd,this.isSkittleRendered=!0,this._ulsLogger.sendTraceTag(529073379,d.n.msoulscat_Wac_Telemetry,u.k.Info,"Skittle shown!"))}hide(){this.shouldSkittleRender=!1,this.removeEventListeners(),this.unconditionallyHide()}unconditionallyHide(){this._skittleContainer&&(this._skittleContainer.style.visibility=Sd,this._skittleContainer.style.opacity="0",this._skittleContainer.style.overflow=Sd,this.isSkittleRendered=!1,this._ulsLogger.sendTraceTag(529073408,d.n.msoulscat_Wac_Telemetry,u.k.Info,"Skittle hidden!"))}addEventListeners(){window.addEventListener("resize",this.calculateCanSkittleRender)}removeEventListeners(){window.removeEventListener("resize",this.calculateCanSkittleRender)}constructor(e){var t;this._ulsLogger=e,this._skittleContainer=null,this._zoomContainerElement=null,this._contentContainerElement=null,this._scrollParentContainerElement=null,this.shouldSkittleRender=!1,this.canSkittleRender=void 0,this.isSkittleRendered=!1,this._orchestrator=new Zl,this._documentScoreHandler=(0,ql.observable)({documentScore:0,critiquesCount:0}),this._store=(t=this._documentScoreHandler,new Vl(t)),this._sizeStore=new Kl(this._store),this.reposition=()=>{this._skittleContainer&&this._zoomContainerElement&&(this._skittleContainer.style.transform=this._zoomContainerElement.style.transform,this.calculateCanSkittleRender())},this.calculateCanSkittleRender=()=>{if(!this._contentContainerElement||!this._skittleContainer||!this._scrollParentContainerElement)return;const e=this._contentContainerElement.getBoundingClientRect().width,t=(this._scrollParentContainerElement.getBoundingClientRect().width-e)/2-35>this._skittleContainer.getBoundingClientRect().width;t!==this.canSkittleRender&&(this.canSkittleRender=t,this.shouldSkittleRender&&(this.canSkittleRender?this.tryShow():this.unconditionallyHide()))}}}function Cd(e){return{skittleContainerStyles:{position:"fixed",right:"19px",marginTop:e?"2%":"",paddingTop:e?"84px":"15px",width:"148px",transition:"visibility 0s, opacity 0.3s linear 0.3s",transformOrigin:"top right"},transitionNone:"none",visible:"visible",hidden:"hidden",opacityVisible:"1",opacityHidden:"0",hiddenWidth:"0px",skittleWidthNumber:148,skittleWidth:"148px",skittlePaddingFromCanvas:35}}var xd,kd;vd.skittleContainerId="skittleContainer",function(e){e.Offered="Offered",e.Seen="Seen",e.Tried="Tried",e.Kept="Kept",e.Rejected="Rejected"}(xd||(xd={}));class Td{constructor(){this.css=(...e)=>(0,Er.Zq)(...e),this.keyframes=Er.i7}}!function(e){e.Add="Add",e.ArrowEnterLeft="ArrowEnterLeft",e.Blocked="Blocked12",e.ChevronUp="ChevronUp",e.ChevronDown="ChevronDown",e.ChevronLeft="ChevronLeft",e.ChevronRight="ChevronRight",e.Copy="Copy",e.Delete="Delete",e.Edit="Edit",e.Feedback="Feedback",e.Forward="Forward",e.Lightbulb="Lightbulb",e.More="More",e.ReturnKey="ReturnKey",e.Back="Back",e.Cancel="Cancel",e.Diamond="Diamond",e.Undo="Undo",e.Save="Save",e.ReadingMode="ReadingMode",e.Dictionary="Dictionary",e.Clock="Clock",e.Info="Info",e.CircleFill="CircleFill",e.StatusCircleCheckmark="StatusCircleCheckmark",e.Sync="Sync"}(kd||(kd={}));const Id=new Map;let wd;const Ad=()=>({viewportHeight:window.innerHeight||document.documentElement.clientHeight||0,viewportWidth:window.innerWidth||document.documentElement.clientWidth||0,viewportVisible:"visible"===document.visibilityState}),Dd=(e,t,i)=>{const o={stopMonitoring:!1,visible:i};e(o),o.stopMonitoring&&Md(t)},Ed=()=>{const{viewportHeight:e,viewportWidth:t,viewportVisible:i}=Ad();i&&t&&e||Id.forEach(((e,t)=>Dd(e,t,!1))),Id.forEach(((i,o)=>{const{left:r,top:n,right:s,bottom:a,width:l,height:c}=o.getBoundingClientRect();Dd(i,o,(0!==l||0!==c)&&(r>=0&&n>=0&&s<=t&&a<=e))}))},Md=e=>{Id.delete(e),wd&&0===Id.size&&(window.clearInterval(wd),wd=void 0)},Ld=e=>{const[t,i]=C.useState(null);return C.useEffect((()=>{const{visibilityChanged:i,visibilityChangedCallbackMode:o}=e;return t&&i&&(r=t,n=((e,t="polling")=>{let i;return o=>{"polling"!==t&&o.visible===i||(i=o.visible,e(o))}})(i,o),Id.has(r)||(Id.set(r,n),Dd(n,r,(e=>{const{viewportHeight:t,viewportWidth:i,viewportVisible:o}=Ad();if(!o||!i||!t)return!1;const{left:r,top:n,right:s,bottom:a,width:l,height:c}=e.getBoundingClientRect();return(0!==l||0!==c)&&r>=0&&n>=0&&s<=i&&a<=t})(r)),void 0===wd&&(wd=window.setInterval(Ed,999)))),()=>{t&&Md(t)};var r,n}),[t]),e.children?C.createElement("div",{ref:i},e.children):C.createElement(C.Fragment,null)},Rd="(-ms-high-contrast: white-on-black), (forced-colors: active) and (prefers-color-scheme: dark)",Od="(-ms-high-contrast: black-on-white), (forced-colors: active) and (prefers-color-scheme: light)",Fd="@media screen and "+Rd,Bd="@media screen and "+Od;var Nd;new class{get isHighContrastActive(){return window.matchMedia("(-ms-high-contrast: active), (forced-colors: active)").matches}get isHighContrastBlack(){return window.matchMedia(Rd).matches}get isHighContrastWhite(){return window.matchMedia(Od).matches}},function(e){e.arrowDown="ArrowDown",e.arrowLeft="ArrowLeft",e.arrowRight="ArrowRight",e.arrowUp="ArrowUp",e.backspace="Backspace",e.control="Control",e.enter="Enter",e.escape="Escape",e.space=" ",e.tab="Tab",e.home="Home",e.end="End",e.j="j",e.r="r",e.t="t",e.J="J",e.R="R",e.T="T"}(Nd||(Nd={}));class jd{static createEvaluator(e,t,i,o,r){return n=>jd.isKey(n,e,t,i,o,r)}static isKey(e,t,i,o,r,n){if(void 0!==i&&e.altKey!==i||void 0!==o&&e.ctrlKey!==o||void 0!==r&&e.metaKey!==r||void 0!==n&&e.shiftKey!==n)return!1;if(Array.isArray(t))return t.some((t=>jd.isKey(e,t,i,o,r,n)));if(e.key===t)return!0;if(t in fc.c){const i=fc.c[t];return e.which===i||e.keyCode===i}return!1}}jd.isEnterKey=e=>{const t=Nd.enter;return jd.isKey(e,t)},jd.isEnterOrSpaceKey=e=>{const t=Nd.enter,i=Nd.space;return jd.isKey(e,[t,i])},jd.isEscapeKey=e=>{const t=Nd.escape;return jd.isKey(e,t)},jd.focusIfEscapeKey=e=>{jd.isKey(e,Nd.escape)&&(e.currentTarget.focus(),e.stopPropagation())},jd.isSpaceKey=e=>{const t=Nd.space;return jd.isKey(e,t)};const Hd=(0,Xr.a)({semanticColors:{cardShadow:"0px 1px 2.5px 0px rgba(0, 0, 0, 0.12),0px 2px 4px 0px rgba(0, 0, 0, 0.08)",cardShadowHovered:"0 8px 24px 0 rgba(0,0,0,0.1), 0 8px 16px 0 rgba(0,0,0,0.12)",buttonBackground:"#ffffff",buttonBackgroundHovered:"#f5f5f5",buttonBackgroundPressed:"#e0e0e0",buttonBorder:"#e1dfdd",bodyStandoutBackground:"#c4c4c4",buttonText:"#242424",buttonTextDisabled:"#616161",primaryButtonText:"#ffffff",disabledText:"#bdbdbd",disabledBodyText:"#605e5c",errorText:"#a80000",accentButtonText:"#185abd",accentButtonBackground:"#d2e0f4",bodyDivider:"#c7e0f4",focusBorder:"#242424",variantBorder:"#bdbdbd",infoIcon:"#185abd",successBackground:"#d2e0f4",successIcon:"#185ABD",menuDivider:"#e0e0e0",warningBackground:"#d4edd4",warningIcon:"#094609",errorBackground:"#fde5e5",errorIcon:"#3f1011",buttonTextChecked:"#185ABD",buttonBackgroundChecked:"#d2e0f4",buttonTextCheckedHovered:"#185ABD",buttonBackgroundCheckedHovered:"#d2e0f4",actionLink:"#185ABD",actionLinkHovered:"#185ABD",linkHovered:"#185ABD",bodySubtext:"#616161",bodyBackground:"#f5f5f5",cardStandoutBackground:"#ebf3fc",infoBackground:"#F0F0F0",listItemBackgroundHovered:"#f3f2f1"},palette:{themeDarker:"#185abd",themeDark:"#185abd",themeDarkAlt:"#185abd",themePrimary:"#185abd",themeSecondary:"#185abd",themeTertiary:"#185abd",themeLight:"#d2e0f4",themeLighter:"#d2e0f4",black:"#242424",neutralDark:"#242424",neutralPrimary:"#242424",neutralPrimaryAlt:"#242424",neutralSecondary:"#616161",neutralSecondaryAlt:"#616161",neutralTertiary:"#bdbdbd",neutralTertiaryAlt:"#bdbdbd",neutralQuaternary:"#e0e0e0",neutralQuaternaryAlt:"#e0e0e0",neutralLight:"#e0e0e0",neutralLighter:"#f5f5f5",neutralLighterAlt:"#f5f5f5",white:"#ffffff"}}),Pd=(0,Xr.a)({semanticColors:{cardShadow:"none",cardShadowHovered:"none",buttonBackground:"#292929",buttonBackgroundHovered:"#3d3d3d",buttonBackgroundPressed:"#1f1f1f",buttonBorder:"#3d3d3d",bodyStandoutBackground:"default",buttonText:"#ffffff",buttonTextDisabled:"#858585",primaryButtonText:"#ffffff",disabledText:"#858585",disabledBodyText:"#d6d6d6",errorText:"#f1707b",accentButtonText:"#82ABF1",accentButtonBackground:"#0c2145",bodyDivider:"#598fec",focusBorder:"#ffffff",variantBorder:"#5c5c5c",infoIcon:"#82ABF1",successBackground:"#071225",successIcon:"#82ABF1",menuDivider:"#666666",warningBackground:"#094609",warningIcon:"#d4edd4",errorBackground:"#3f1011",errorIcon:"#fde5e5",buttonTextChecked:"#82ABF1",buttonBackgroundChecked:"#0c2145",buttonTextCheckedHovered:"#82ABF1",buttonBackgroundCheckedHovered:"#0c2145",actionLink:"#82ABF1",actionLinkHovered:"#82ABF1",linkHovered:"#82ABF1",bodySubtext:"#adadad",bodyBackground:"#141414",cardStandoutBackground:"#3d3d3d",infoBackground:"#292929",listItemBackgroundHovered:"#1651AA"},palette:{themeDarker:"#82abf1",themeDark:"#82abf1",themeDarkAlt:"#82abf1",themePrimary:"#82abf1",themeSecondary:"#82abf1",themeTertiary:"#82abf1",themeLight:"#0c2145",themeLighter:"#071225",black:"#ffffff",neutralDark:"#ffffff",neutralPrimary:"#ffffff",neutralPrimaryAlt:"#ffffff",neutralSecondary:"#adadad",neutralSecondaryAlt:"#adadad",neutralTertiary:"#858585",neutralTertiaryAlt:"#858585",neutralQuaternary:"#666666",neutralQuaternaryAlt:"#5c5c5c",neutralLight:"#1f1f1f",neutralLighter:"#3d3d3d",neutralLighterAlt:"#292929",white:"#141414"},isInverted:!0});var zd;!function(e){e.Light="Light",e.Dark="Dark"}(zd||(zd={}));const Ud=(0,ql.observable)({theme:Hd});function Wd(){return Ud.theme.semanticColors}(0,ql.action)((e=>{Ud.theme=e===zd.Dark?Pd:Hd})),(0,ql.action)((e=>{Ud.theme=e}));const Gd=e=>{jd.isKey(e,Nd.escape)&&(e.currentTarget.focus(),e.stopPropagation())},_d=e=>{const{shouldRenderAsPremium:t,styleProvider:i}=e,o=!e.hasHeader&&!e.ariaLabel,r=`IdeasCardHeader_${e.id}`,n=function(){const e=Wd();return{boxShadow:e.cardShadow,backgroundColor:e.buttonBackground,emptyCells:"hide","&:not(:empty)":{[Bd]:{border:"1px solid #000"},[Fd]:{border:"1px solid #fff"}}}}(),s=i.css(function(){const e=Wd();return{borderRadius:"4px",boxShadow:e.cardShadow,backgroundColor:e.buttonBackground,msHighContrastAdjust:"auto",position:"relative",emptyCells:"hide","&:not(:empty)":{[Bd]:{border:"1px solid #000"},[Fd]:{border:"1px solid #fff"}}}}(),t?n:[]);return o?C.createElement("div",{className:s,"data-card":1,"data-automation-id":r,"data-ignore-user-engagement":e.ignoreUserEngagement},e.children):C.createElement(mt.R,{className:s,"data-card":1,"data-automation-id":r,"data-ignore-user-engagement":e.ignoreUserEngagement,isCircularNavigation:!0,onKeyDown:Gd,direction:3},e.children)};class qd extends C.Component{render(){const{id:e,title:t}=this.props;return C.createElement("div",{className:this.props.styleProvider.css(this._styles.header),id:e},t&&this.renderTitle())}renderTitle(){const{icon:e,styleProvider:t}=this.props;return C.createElement("h1",{"aria-level":1,className:t.css(this._styles.title)},e,this.props.title)}constructor(){super(...arguments),this._styles={header:{marginBottom:"12px",padding:"0"},title:{display:"flex",alignItems:"center",fontSize:"14px",fontWeight:"600"}}}}const Vd=()=>({diamondIcon:{width:"27px",color:Wd().infoIcon,fontSize:"20px",margin:"15px 15px 0px 15px"},diamondIconHeader:{color:"inherit",margin:"0px 0px 0px 0px"}}),Zd=e=>{const t=e.styleProvider.css(Vd().diamondIcon,e.isHeader?Vd().diamondIconHeader:[]);return C.createElement(is.I,{"aria-hidden":!0,iconName:"Diamond",className:t})};function Kd(){const e=Wd();return{diamondHeader:{color:e.disabledText,":hover i":{color:e.accentButtonText}},header:{color:e.buttonText}}}const Yd=e=>e.shouldRenderAsPremium?C.createElement("div",{"data-automation-id":e.id,className:e.styleProvider.css(Kd().diamondHeader)},C.createElement(qd,Object.assign({},e,{icon:C.createElement(Zd,{isHeader:!0,styleProvider:e.styleProvider})}))):C.createElement("div",{"data-automation-id":e.id,className:e.styleProvider.css(Kd().header)},C.createElement(qd,Object.assign({},e))),Qd="group",$d={padding:"0"},Jd=e=>{var t,i;const{id:o,styleProvider:r}=e,n=e.ariaHidden,s=null!==(t=e.ariaLabel)&&void 0!==t?t:void 0,a=null!==(i=e.contentRole)&&void 0!==i?i:Qd;return C.createElement("div",{"aria-hidden":n,"aria-label":s,id:o,"data-automation-id":o,onFocus:e.onFocus,onBlur:e.onBlur,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,role:a,tabIndex:-1},C.createElement("div",{className:r.css($d)},e.children))},Xd=(0,ql.observable)({isTABNavigationUsed:!1});function eu(){return Xd.isTABNavigationUsed}const tu=(0,ql.action)((()=>{const e=document.querySelector("body");Xd.isTABNavigationUsed=!!e&&e.classList.contains("ms-Fabric--isFocusVisible")})),iu=e=>{var t;const i={description:e.description,title:e.title,hasHeader:e.hasHeader},o=Object.assign({margin:"24px 0 10px 0",":first-of-type":{marginTop:"6px"}},e.style),{styleProvider:r,theme:n,visibilityChanged:s,visibilityChangedCallbackMode:a}=e,l=C.useCallback((t=>{var i;const o=t.target;o&&(e=>{if(tu(),!eu())return;if(e.getBoundingClientRect().top>=180)return;const t=window.scrollY,i=Math.max(t-180,0);window.requestAnimationFrame((()=>{window.scrollTo(0,i)}))})(o),null===(i=e.onFocus)||void 0===i||i.call(e)}),[e.onFocus]),c=null!==(t=e.contentRole)&&void 0!==t?t:Qd,d=C.createElement("div",{className:`ideas-card ${r.css(o)}`},e.hasHeader&&C.createElement(Yd,Object.assign({shouldRenderAsPremium:e.shouldRenderAsPremium,id:e.headerId,styleProvider:e.styleProvider,theme:n},i)),C.createElement(_d,{id:e.headerId,hasHeader:e.hasHeader,ariaLabel:e.ariaLabel,ignoreUserEngagement:e.ignoreUserEngagement,shouldRenderAsPremium:e.shouldRenderAsPremium,styleProvider:e.styleProvider,theme:n},C.createElement(Jd,Object.assign({id:"shell"+e.headerId,styleProvider:e.styleProvider,shouldRenderAsPremium:e.shouldRenderAsPremium,ariaLabel:e.ariaLabel,ariaHidden:!e.hasHeader&&!e.ariaLabel||void 0,contentRole:c,onFocus:l,onBlur:e.onBlur,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave},i),e.children)));return s?C.createElement(Ld,{visibilityChanged:s,visibilityChangedCallbackMode:a},d):d};var ou=i(19409),ru=i(25332);const nu=(0,id.PA)((e=>{const t=(0,C.createRef)(),i=(0,hs.$)().getStringsFor("AiFeedbackSkittleStrings"),o=new Td,r=function(){const e=Wd();return{skittleTitle:{root:{fontSize:"12px",font:"segoeui",fontWeight:"600",lineHeight:"16px",color:e.buttonText}},skittleSubtitle:{root:{fontSize:"10px",font:"segoeui",fontWeight:"400",lineHeight:"14px",color:e.buttonText,padding:"2px 8px 10px 12px",display:"flex",justifyContent:"left"}},topContainer:{padding:"8px 11px 0px 12px"},pyroCard:{borderRadius:"4px",height:"auto",width:"100%",cursor:"pointer",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)",boxSizing:"border-box"},colors:{height:"auto",width:"100%",borderRadius:"4px",backgroundColor:e.buttonBackground,":hover":{backgroundColor:e.buttonBackgroundHovered},":active":{backgroundColor:e.buttonBackgroundPressed},":focus":eu()?{outline:`1px solid ${e.focusBorder} !important`}:{}},iconStyles:{width:"24px",height:"24px",padding:"6px 3px 0px 0px"},closeButtonStyle:{root:{color:e.buttonText,display:"inline-block",width:"24px",height:"24px",padding:"4px"},rootHovered:{backgroundColor:e.buttonBackgroundPressed},rootPressed:{backgroundColor:e.buttonBackgroundPressed,borderStyle:"solid",borderWidth:"1px",borderColor:e.focusBorder}},closeIconStyle:{color:e.bodySubtext}}}(),n=Ql(),s=Jl.AiFeedbackSkittle;C.useEffect((()=>n.logCategoryOfferedAcrossLevels(s)),[s,n]);const a="AIFeedbackApp",l=(0,Kc.C)();C.useEffect((()=>l.logKpi(a,a,xd.Offered,!0,{isFromSkittle:!0})),[l]);const[c,d]=C.useState(!1),[u,g]=C.useState(!1),p=C.useCallback((()=>u?()=>{n.logCategoryRejectedAcrossLevels(s),e.onClose()}:()=>{n.logCategoryKeptAcrossLevels(s),l.logKpi(a,a,xd.Tried,!0,{isFromSkittle:!0}),e.onClick()}),[s,u,l,n,e]),h=()=>{d(!0),n.logCategoryTriedAcrossLevels(s)};return C.createElement(iu,{headerId:"feedbackSkittle-header",hasHeader:!1,styleProvider:o,shouldRenderAsPremium:!1,visibilityChanged:e=>{e.visible&&(n.logCategorySeenAcrossLevels(s),e.stopMonitoring=!0)},visibilityChangedCallbackMode:"onchanged",style:r.pyroCard},C.createElement("div",{id:"AiFeedbackSkittle",ref:t,role:"button","aria-label":i("ariaLabelSkittle"),"data-is-focusable":!0,onClick:p(),onMouseEnter:h,onFocus:h,onMouseLeave:()=>d(!1),onKeyDown:e=>{"Enter"===e.key&&p()},className:o.css(r.colors)},C.createElement(ou.B,{horizontal:!0,tokens:{childrenGap:10},style:r.topContainer},C.createElement(ru.E,{"aria-hidden":!0,styles:r.skittleTitle},i("title")),C.createElement("div",{style:{width:"32px",height:"32px"}},c?C.createElement((()=>C.createElement(ad.K,{iconProps:{iconName:kd.Cancel,style:r.closeIconStyle},id:"AiFeedbackSkittleCloseButton",ariaLabel:i("closeAriaLabel"),styles:r.closeButtonStyle,onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1)})),null):C.createElement("img",{src:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGcgY2xpcC1wYXRoPSJ1cmwoI2NsaXAwXzM0NzBfMTk5MjA5KSI+CjxwYXRoIGQ9Ik0zMi43ODM3IDcuNjg3NUwxMy45OTkgMTguNTM1NEMxMC4yODY3IDIwLjY3OTIgOCAyNC42NDA0IDggMjguOTI3MVY1MS4wNzI2QzggNTUuMzU5MiAxMC4yODY2IDU5LjMyMDMgMTMuOTk4NiA2MS40NjQxTDIzLjA2ODUgNjYuNzAyMkwyMy45NjAzIDY0TDQwLjk0OTMgNTMuODI2OEwzMy45OTg2IDQ5LjgxMjVDMzAuMjg2NiA0Ny42Njg3IDI4IDQzLjcwNzYgMjggMzkuNDIxVjMzLjA5MzhMMjkuODYyNSAzMC43MTgxTDM2IDI1Ljk2N1YxMkwzMy4yOTY5IDguMDQ2ODhMMzAuMzQwNyAxMC4xNTUyQzMxLjAyNDkgOS4yMjY3IDMxLjg0NTUgOC4zOTM0NiAzMi43ODM3IDcuNjg3NVoiIGZpbGw9InVybCgjcGFpbnQwX2xpbmVhcl8zNDcwXzE5OTIwOSkiLz4KPHBhdGggZD0iTTMyLjc4MzcgNy42ODc1TDEzLjk5OSAxOC41MzU0QzEwLjI4NjcgMjAuNjc5MiA4IDI0LjY0MDQgOCAyOC45MjcxVjUxLjA3MjZDOCA1NS4zNTkyIDEwLjI4NjYgNTkuMzIwMyAxMy45OTg2IDYxLjQ2NDFMMjMuMDY4NSA2Ni43MDIyTDIzLjk2MDMgNjRMNDAuOTQ5MyA1My44MjY4TDMzLjk5ODYgNDkuODEyNUMzMC4yODY2IDQ3LjY2ODcgMjggNDMuNzA3NiAyOCAzOS40MjFWMzMuMDkzOEwyOS44NjI1IDMwLjcxODFMMzYgMjUuOTY3VjEyTDMzLjI5NjkgOC4wNDY4OEwzMC4zNDA3IDEwLjE1NTJDMzEuMDI0OSA5LjIyNjcgMzEuODQ1NSA4LjM5MzQ2IDMyLjc4MzcgNy42ODc1WiIgZmlsbD0idXJsKCNwYWludDFfbGluZWFyXzM0NzBfMTk5MjA5KSIvPgo8cGF0aCBkPSJNNTEuOTk1MiAzMC40NjA5VjM5LjQyMzdDNTEuOTk1MiA0My43MTAzIDQ5LjcwODYgNDcuNjcxNCA0NS45OTY2IDQ5LjgxNTJMMjUuOTk2NiA2MS4zNjU4QzIyLjI4MyA2My41MTA1IDE3LjcwNzMgNjMuNTEwNSAxMy45OTM4IDYxLjM2NThMMTIuNzgxMiA2MC42NjU2QzEzLjE2NiA2MC45NTUgMTMuNTcwNiA2MS4yMjI5IDEzLjk5MzggNjEuNDY3M0wzMy45OTM4IDczLjAxNzlDMzcuNzA3MyA3NS4xNjI2IDQyLjI4MyA3NS4xNjI2IDQ1Ljk5NjYgNzMuMDE3OUw2NS45OTY2IDYxLjQ2NzNDNjkuNzA4NiA1OS4zMjM1IDcxLjk5NTIgNTUuMzYyNCA3MS45OTUyIDUxLjA3NThWNDIuNzUxNkw1MS45OTUyIDMwLjQ2MDlaIiBmaWxsPSJ1cmwoI3BhaW50Ml9yYWRpYWxfMzQ3MF8xOTkyMDkpIi8+CjxwYXRoIGQ9Ik01MS45OTUyIDMwLjQ2MDlWMzkuNDIzN0M1MS45OTUyIDQzLjcxMDMgNDkuNzA4NiA0Ny42NzE0IDQ1Ljk5NjYgNDkuODE1MkwyNS45OTY2IDYxLjM2NThDMjIuMjgzIDYzLjUxMDUgMTcuNzA3MyA2My41MTA1IDEzLjk5MzggNjEuMzY1OEwxMi43ODEyIDYwLjY2NTZDMTMuMTY2IDYwLjk1NSAxMy41NzA2IDYxLjIyMjkgMTMuOTkzOCA2MS40NjczTDMzLjk5MzggNzMuMDE3OUMzNy43MDczIDc1LjE2MjYgNDIuMjgzIDc1LjE2MjYgNDUuOTk2NiA3My4wMTc5TDY1Ljk5NjYgNjEuNDY3M0M2OS43MDg2IDU5LjMyMzUgNzEuOTk1MiA1NS4zNjI0IDcxLjk5NTIgNTEuMDc1OFY0Mi43NTE2TDUxLjk5NTIgMzAuNDYwOVoiIGZpbGw9InVybCgjcGFpbnQzX2xpbmVhcl8zNDcwXzE5OTIwOSkiLz4KPHBhdGggZD0iTTMyLjc4MSA3LjY4NjY3TDMzLjk5OSA2Ljk4MzNDMzcuNzEyMyA0LjgzODkgNDIuMjg3NyA0LjgzODkgNDYuMDAxIDYuOTgzM0w2Ni4wMDEgMTguNTMzQzY5LjcxMzMgMjAuNjc2NyA3MiAyNC42Mzc5IDcyIDI4LjkyNDdWNTEuMDcwMkM3MiA1MS4xNTI2IDcxLjk5OTIgNTEuMjM0OSA3MS45OTc1IDUxLjMxNzFDNzEuOTExNSA0Ny4xMjU1IDY5LjY0MTkgNDMuMjc0OCA2Ni4wMDEgNDEuMTcyM0w0Ni4wMDEgMjkuNjIyNkM0Mi4yODc3IDI3LjQ3ODIgMzcuNzEyMyAyNy40NzgyIDMzLjk5OSAyOS42MjI2TDI4IDMzLjA4NjlWMTcuMjcyNkMyOCAxMy40NzY4IDI5Ljc5MyA5LjkzNjE5IDMyLjc4MSA3LjY4NjY3WiIgZmlsbD0idXJsKCNwYWludDRfcmFkaWFsXzM0NzBfMTk5MjA5KSIvPgo8cGF0aCBkPSJNMzIuNzgxIDcuNjg2NjdMMzMuOTk5IDYuOTgzM0MzNy43MTIzIDQuODM4OSA0Mi4yODc3IDQuODM4OSA0Ni4wMDEgNi45ODMzTDY2LjAwMSAxOC41MzNDNjkuNzEzMyAyMC42NzY3IDcyIDI0LjYzNzkgNzIgMjguOTI0N1Y1MS4wNzAyQzcyIDUxLjE1MjYgNzEuOTk5MiA1MS4yMzQ5IDcxLjk5NzUgNTEuMzE3MUM3MS45MTE1IDQ3LjEyNTUgNjkuNjQxOSA0My4yNzQ4IDY2LjAwMSA0MS4xNzIzTDQ2LjAwMSAyOS42MjI2QzQyLjI4NzcgMjcuNDc4MiAzNy43MTIzIDI3LjQ3ODIgMzMuOTk5IDI5LjYyMjZMMjggMzMuMDg2OVYxNy4yNzI2QzI4IDEzLjQ3NjggMjkuNzkzIDkuOTM2MTkgMzIuNzgxIDcuNjg2NjdaIiBmaWxsPSJ1cmwoI3BhaW50NV9saW5lYXJfMzQ3MF8xOTkyMDkpIi8+CjxwYXRoIGQ9Ik04LjAwMjUzIDUxLjMxNzFDOC4wMDI1MyA1MS4zMTcxIDguMDAyNTMgNTEuMzE3IDguMDAyNTMgNTEuMzE3MVoiIGZpbGw9InVybCgjcGFpbnQ2X3JhZGlhbF8zNDcwXzE5OTIwOSkiLz4KPHBhdGggZD0iTTguMDAyNTMgNTEuMzE3MUM4LjAwMjUzIDUxLjMxNzEgOC4wMDI1MyA1MS4zMTcgOC4wMDI1MyA1MS4zMTcxWiIgZmlsbD0idXJsKCNwYWludDdfbGluZWFyXzM0NzBfMTk5MjA5KSIvPgo8L2c+CjxkZWZzPgo8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50MF9saW5lYXJfMzQ3MF8xOTkyMDkiIHgxPSIzNi4zNzI5IiB5MT0iMjMuMzEyOCIgeDI9IjE4Ljk3OTciIHkyPSI3My45NDc2IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wIHN0b3AtY29sb3I9IiNBRTdGRTIiLz4KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjMDA3OEQ0Ii8+CjwvbGluZWFyR3JhZGllbnQ+CjxsaW5lYXJHcmFkaWVudCBpZD0icGFpbnQxX2xpbmVhcl8zNDcwXzE5OTIwOSIgeDE9IjI5Ljc3MjMiIHkxPSI2MC44ODQzIiB4Mj0iMjYuNzYyOCIgeTI9IjU1LjU3NTUiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agb2Zmc2V0PSIwLjk5OTkiIHN0b3AtY29sb3I9IiMxMTRBOEIiLz4KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjMDA3OEQ0IiBzdG9wLW9wYWNpdHk9IjAiLz4KPC9saW5lYXJHcmFkaWVudD4KPHJhZGlhbEdyYWRpZW50IGlkPSJwYWludDJfcmFkaWFsXzM0NzBfMTk5MjA5IiBjeD0iMCIgY3k9IjAiIHI9IjEiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiBncmFkaWVudFRyYW5zZm9ybT0idHJhbnNsYXRlKDIwLjU4NDMgNTkuMDMwOSkgcm90YXRlKC0xMy4wNjg4KSBzY2FsZSg1MS4xMDg5IDM5LjM3MDkpIj4KPHN0b3Agb2Zmc2V0PSIwLjE0MDAyOSIgc3RvcC1jb2xvcj0iI0Q1OURGRiIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM1RTQzOEYiLz4KPC9yYWRpYWxHcmFkaWVudD4KPGxpbmVhckdyYWRpZW50IGlkPSJwYWludDNfbGluZWFyXzM0NzBfMTk5MjA5IiB4MT0iNjMuMzAzOSIgeTE9IjM5LjM4ODQiIHgyPSI2MC40MjM0IiB5Mj0iNDQuMDA5NSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgo8c3RvcCBvZmZzZXQ9IjAuOTk5OSIgc3RvcC1jb2xvcj0iIzQ5MzQ3NCIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM4QzY2QkEiIHN0b3Atb3BhY2l0eT0iMCIvPgo8L2xpbmVhckdyYWRpZW50Pgo8cmFkaWFsR3JhZGllbnQgaWQ9InBhaW50NF9yYWRpYWxfMzQ3MF8xOTkyMDkiIGN4PSIwIiBjeT0iMCIgcj0iMSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIGdyYWRpZW50VHJhbnNmb3JtPSJ0cmFuc2xhdGUoNjYuMTY0MyA0MS4yNzE4KSByb3RhdGUoLTE0My4wODMpIHNjYWxlKDQ1LjY0NzkgNDUuNjQ3OSkiPgo8c3RvcCBzdG9wLWNvbG9yPSIjNTBFNkZGIi8+CjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzQzNkRDRCIvPgo8L3JhZGlhbEdyYWRpZW50Pgo8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50NV9saW5lYXJfMzQ3MF8xOTkyMDkiIHgxPSIyOC4wNjk2IiB5MT0iMjIuMjU5OCIgeDI9IjMyLjcyODIiIHkyPSIyMi4yNTk4IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wIG9mZnNldD0iMC45OTk5IiBzdG9wLWNvbG9yPSIjMTE0QThCIi8+CjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzAwNzhENCIgc3RvcC1vcGFjaXR5PSIwIi8+CjwvbGluZWFyR3JhZGllbnQ+CjxyYWRpYWxHcmFkaWVudCBpZD0icGFpbnQ2X3JhZGlhbF8zNDcwXzE5OTIwOSIgY3g9IjAiIGN5PSIwIiByPSIxIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgZ3JhZGllbnRUcmFuc2Zvcm09InRyYW5zbGF0ZSg2Ni4xNjQzIDQxLjI3MTgpIHJvdGF0ZSgtMTQzLjA4Mykgc2NhbGUoNDUuNjQ3OSA0NS42NDc5KSI+CjxzdG9wIHN0b3AtY29sb3I9IiM1MEU2RkYiLz4KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjNDM2RENEIi8+CjwvcmFkaWFsR3JhZGllbnQ+CjxsaW5lYXJHcmFkaWVudCBpZD0icGFpbnQ3X2xpbmVhcl8zNDcwXzE5OTIwOSIgeDE9IjI4LjA2OTYiIHkxPSIyMi4yNTk4IiB4Mj0iMzIuNzI4MiIgeTI9IjIyLjI1OTgiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agb2Zmc2V0PSIwLjk5OTkiIHN0b3AtY29sb3I9IiMxMTRBOEIiLz4KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjMDA3OEQ0IiBzdG9wLW9wYWNpdHk9IjAiLz4KPC9saW5lYXJHcmFkaWVudD4KPGNsaXBQYXRoIGlkPSJjbGlwMF8zNDcwXzE5OTIwOSI+CjxyZWN0IHdpZHRoPSI4MCIgaGVpZ2h0PSI4MCIgZmlsbD0id2hpdGUiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K",alt:"Copilot Logo",style:r.iconStyles}))),C.createElement(ru.E,{"aria-hidden":!0,styles:r.skittleSubtitle},i("subtitle"))))}));class su{render(e){if(!e)return void this._ulsLogger.sendTraceTag(509354829,d.n.msoulscat_Wac_Telemetry,u.k.Error,"Bad AI Feedback Skittle arguments!");if(this._skittleContainer)return void this._ulsLogger.sendTraceTag(509354946,d.n.msoulscat_Wac_Telemetry,u.k.Info,"AI Feedback Skittle already rendered!");this._zoomContainerElement=document.getElementsByClassName("PageContentOrigin").item(0),this._contentContainerElement=document.getElementsByClassName("Page").item(0),this._scrollParentContainerElement=document.getElementById("WACViewPanelContainer");const t=null!=document.getElementById(vd.skittleContainerId);this._skittleContainer=document.createElement("div"),this._skittleContainer.id=su.skittleContainerId,this._skittleContainer.className=(0,Er.Zq)(Cd(t).skittleContainerStyles);const i={onClose:e.onClose,onClick:e.onClick};this._scrollParentContainerElement?.appendChild(this._skittleContainer),Kr.render(C.createElement(nu,{...i}),this._skittleContainer),this.show(),this._ulsLogger.sendTraceTag(509354945,d.n.msoulscat_Wac_Telemetry,u.k.Info,"AI Feedback Skittle rendered!")}dispose(){this._skittleContainer&&this._scrollParentContainerElement?(this._scrollParentContainerElement.removeChild(this._skittleContainer),Kr.unmountComponentAtNode(this._skittleContainer),this.removeEventListeners(),this._scrollParentContainerElement=this._zoomContainerElement=this._contentContainerElement=this._skittleContainer=null,this._ulsLogger.sendTraceTag(509354915,d.n.msoulscat_Wac_Telemetry,u.k.Info,"AI Feedback Skittle disposed!")):this._ulsLogger.sendTraceTag(509354944,d.n.msoulscat_Wac_Telemetry,u.k.Info,"AI Feedback Skittle already disposed!")}show(){this.shouldAiFeedbackSkittleRender=!0,this.addEventListeners(),this.calculateCanSkittleRender(),this.tryShow()}tryShow(){this._skittleContainer&&!this.isSkittleRendered&&(this._skittleContainer.style.visibility=Cd().visible,this._skittleContainer.style.opacity=Cd().opacityVisible,this._skittleContainer.style.overflow=Cd().visible,this.isSkittleRendered=!0,this._ulsLogger.sendTraceTag(509354914,d.n.msoulscat_Wac_Telemetry,u.k.Info,"AI Feedback Skittle shown!"))}hide(){this.shouldAiFeedbackSkittleRender=!1,this.removeEventListeners(),this.unconditionallyHide()}unconditionallyHide(){this._skittleContainer&&(this._skittleContainer.style.visibility=Cd().hidden,this._skittleContainer.style.opacity=Cd().opacityHidden,this._skittleContainer.style.overflow=Cd().hidden,this.isSkittleRendered=!1,this._ulsLogger.sendTraceTag(509354913,d.n.msoulscat_Wac_Telemetry,u.k.Info,"AI Feedback Skittle hidden!"))}update(){}addEventListeners(){window.addEventListener("resize",this.calculateCanSkittleRender)}removeEventListeners(){window.removeEventListener("resize",this.calculateCanSkittleRender)}constructor(e){this._ulsLogger=e,this._skittleContainer=null,this._scrollParentContainerElement=null,this._zoomContainerElement=null,this._contentContainerElement=null,this.canSkittleRender=void 0,this.shouldAiFeedbackSkittleRender=!1,this.isSkittleRendered=!1,this.reposition=()=>{if(!this._skittleContainer||!this._zoomContainerElement)return;const e=null!=document.getElementById(vd.skittleContainerId);this._skittleContainer.className=(0,Er.Zq)(Cd(e).skittleContainerStyles),this._skittleContainer.style.transform=this._zoomContainerElement.style.transform,this.calculateCanSkittleRender()},this.calculateCanSkittleRender=()=>{if(!this._contentContainerElement||!this._skittleContainer||!this._scrollParentContainerElement)return;const e=this._contentContainerElement.getBoundingClientRect().width,t=this._scrollParentContainerElement.getBoundingClientRect().width,i=this._skittleContainer.getBoundingClientRect().width,o=(t-e)/2-Cd().skittlePaddingFromCanvas>i;o!==this.canSkittleRender&&(this.canSkittleRender=o,this.shouldAiFeedbackSkittleRender&&(this.canSkittleRender?this.tryShow():this.unconditionallyHide()))}}}su.skittleContainerId="AIFeedbackSkittleContainer";var au,lu,cu,du,uu,gu,pu,hu,mu=i(48245),yu=i(9646);!function(e){e.DataClassification={EssentialServiceMetadata:1,AccountData:2,SystemMetadata:4,OrganizationIdentifiableInformation:8,EndUserIdentifiableInformation:16,CustomerContent:32,AccessControl:64,PublicNonPersonalData:128,EndUserPseudonymousInformation:256,PublicPersonalData:512,SupportData:1024,DirectMeasurementData:2048,Everything:65535},e.DataFieldType={String:0,Boolean:1,Int64:2,Double:3,Guid:4},e.SamplingPolicy={NotSet:0,Measure:1,Diagnostics:2,CriticalBusinessImpact:191,CriticalCensus:192,CriticalExperimentation:193,CriticalUsage:194},e.PersistencePriority={NotSet:0,Normal:1,High:2},e.CostPriority={NotSet:0,Normal:1,High:2},e.DataCategories={NotSet:0,SoftwareSetup:1,ProductServiceUsage:2,ProductServicePerformance:4,DeviceConfiguration:8,InkingTypingSpeech:16},e.DiagnosticLevel={ReservedDoNotUse:0,Required:10,BasicEvent:10,Optional:100,FullEvent:100,RequiredServiceData:110,NecessaryServiceDataEvent:110,RequiredServiceDataForEssentialServices:120,AlwaysOnNecessaryServiceDataEvent:120},e.DnmInterval={Hourly:1,Daily:2},e.AllowedPartA={ReleaseAudienceGroup:1,WacRing:2,AppName:3,AppPlatform:4,AppVersion:5},e.CustomerContentType={None:0,MocaAddIn:1},e.LogLevel={Error:0,Warning:1,Info:2,Verbose:3},e.Category={Core:0,Sink:1,Transport:2},e.PrimaryIdentitySpace={UserObjectId:"UserObjectId",MSACID:"MSACID",OrgIdPuid:"OrgIdPuid",OrgIdPUID:"OrgIdPUID",OrgIdCID:"OrgIdCID",MsaPuid:"MsaPuid",MSAPUID:"MSAPUID",WopiAuth:"WopiAuth",ThirdParty:"ThirdParty",Other:"Other"},e.AudienceGroup={Automation:"Automation",Dogfood:"Dogfood",Microsoft:"Microsoft",Insiders:"Insiders",Production:"Production"}}(au||(au={})),function(e){e.getFields=function(e,t){var i=[];return i.push((0,yu.Ug)("".concat(e,".Code"),t.code)),void 0!==t.type&&i.push((0,yu.m9)("".concat(e,".Type"),t.type)),void 0!==t.tag&&i.push((0,yu.Ug)("".concat(e,".Tag"),t.tag)),void 0!==t.isExpected&&i.push((0,yu.LK)("".concat(e,".IsExpected"),t.isExpected)),i.push((0,yu.m9)("zC.Activity.Result","Office.System.Result")),i}}(lu||(lu={})),function(e){e.contractName="Office.System.Activity",e.getFields=function(t){var i="Activity",o=[];return void 0!==t.cV&&o.push((0,yu.m9)("".concat(i,".CV"),t.cV)),o.push((0,yu.Ug)("".concat(i,".Duration"),t.duration)),o.push((0,yu.Ug)("".concat(i,".Count"),t.count)),o.push((0,yu.Ug)("".concat(i,".AggMode"),t.aggMode)),void 0!==t.success&&o.push((0,yu.LK)("".concat(i,".Success"),t.success)),void 0!==t.result&&o.push.apply(o,lu.getFields("".concat(i,".Result"),t.result)),o.push((0,yu.m9)("zC.Activity",e.contractName)),o}}(cu||(cu={})),function(e){e.getFields=function(e,t){var i=[];return void 0!==t.id&&i.push((0,yu.m9)("".concat(e,".Id"),t.id)),void 0!==t.version&&i.push((0,yu.m9)("".concat(e,".Version"),t.version)),void 0!==t.sessionId&&i.push((0,yu.m9)("".concat(e,".SessionId"),t.sessionId)),i}}(du||(du={})),function(e){e.getFields=function(e,t){var i=[];return void 0!==t.alias&&i.push((0,yu.m9)("".concat(e,".Alias"),t.alias)),void 0!==t.primaryIdentityHash&&i.push((0,yu.m9)("".concat(e,".PrimaryIdentityHash"),t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&i.push((0,yu.m9)("".concat(e,".PrimaryIdentitySpace"),t.primaryIdentitySpace)),void 0!==t.tenantId&&i.push((0,yu.m9)("".concat(e,".TenantId"),t.tenantId)),void 0!==t.tenantGroup&&i.push((0,yu.m9)("".concat(e,".TenantGroup"),t.tenantGroup)),void 0!==t.isAnonymous&&i.push((0,yu.LK)("".concat(e,".IsAnonymous"),t.isAnonymous)),i}}(uu||(uu={})),function(e){e.getFields=function(e,t){var i=[];return void 0!==t.name&&i.push((0,yu.m9)("".concat(e,".Name"),t.name)),void 0!==t.state&&i.push((0,yu.m9)("".concat(e,".State"),t.state)),i}}(gu||(gu={})),function(e){e.getFields=function(e,t){var i=[];return void 0!==t.id&&i.push((0,yu.Ug)("".concat(e,".Id"),t.id)),void 0!==t.name&&i.push((0,yu.m9)("".concat(e,".Name"),t.name)),void 0!==t.commandSurface&&i.push((0,yu.m9)("".concat(e,".CommandSurface"),t.commandSurface)),void 0!==t.parentName&&i.push((0,yu.m9)("".concat(e,".ParentName"),t.parentName)),void 0!==t.triggerMethod&&i.push((0,yu.m9)("".concat(e,".TriggerMethod"),t.triggerMethod)),void 0!==t.timeOffsetMs&&i.push((0,yu.Ug)("".concat(e,".TimeOffsetMs"),t.timeOffsetMs)),i}}(pu||(pu={})),(hu||(hu={})).getFields=function(e,t){var i=[];return i.push((0,yu.m9)("".concat(e,".ErrorGroup"),t.errorGroup)),i.push((0,yu.Ug)("".concat(e,".Tag"),t.tag)),void 0!==t.code&&i.push((0,yu.Ug)("".concat(e,".Code"),t.code)),void 0!==t.id&&i.push((0,yu.Ug)("".concat(e,".Id"),t.id)),void 0!==t.count&&i.push((0,yu.Ug)("".concat(e,".Count"),t.count)),i};var bu,fu=cu,Su=lu,vu=hu,Cu=gu,xu=du,ku=pu,Tu=uu;!function(e){var t,i;t=e.Office||(e.Office={}),(i=t.System||(t.System={})).Activity=fu,i.Result=Su,i.Error=vu,i.Funnel=Cu,i.Host=xu,i.User=Tu,i.UserAction=ku}(bu||(bu={}));var Iu=i(508);class wu{logEvent(e,t,i,o,r,n,s,a){const l=`${i}.${t}`;if(o===Qc.q.Debug)return;const c=[(0,yu.Ug)("Tag",e),(0,yu.Ug)("Level",o)];r&&c.push((0,yu.m9)("Data",(0,Iu.v)(r))),c.forEach((e=>e.classification=au.DataClassification.SystemMetadata)),this.uploadEvent(l,c,null!=n?n:wu.DEFAULT_SAMPLING_POLICY,null!=s?s:wu.DEFAULT_DIAGNOSTIC_LEVEL,null!=a?a:wu.DEFAULT_DATA_CATEGORIES)}logKpi(e,t,i,o,r){if(!this.kpisEnabled)return;const n=`KPIs.${e}`,s=[(0,yu.m9)("Entity_Id",t),(0,yu.LK)("IsPremium",o)];r&&s.push((0,yu.m9)("Data",JSON.stringify(r))),s.forEach((e=>e.classification=au.DataClassification.SystemMetadata));const a=bu.Office.System.Funnel.getFields("Funnel",{name:this._logGroupName,state:i});s.push(...a),this.uploadEvent(n,s,au.SamplingPolicy.CriticalUsage,au.DiagnosticLevel.RequiredServiceData,au.DataCategories.ProductServiceUsage)}logStandaloneMetric(e,t,i,o,r=[]){const n=null!=t?t:wu.DEFAULT_SAMPLING_POLICY,s=null!=i?i:wu.DEFAULT_DIAGNOSTIC_LEVEL,a=null!=o?o:wu.DEFAULT_DATA_CATEGORIES;this.uploadEvent(e,r,n,s,a)}createActivity(e,t,i){const o=t?`${t}.${e}`:e;return this._oTelTelemetryLogger.createActivity({eventName:this.getFullEventName(o),eventFlags:null!=i?i:{dataCategories:au.DataCategories.ProductServiceUsage}})}uploadEvent(e,t,i,o,r){const n=this.getFullEventName(e);this._oTelTelemetryLogger.sendTelemetryEvent({eventName:n,dataFields:t,eventFlags:{dataCategories:r,diagnosticLevel:o,costPriority:au.CostPriority.Normal,persistencePriority:au.PersistencePriority.Normal,samplingPolicy:i}})}getFullEventName(e){return this.capitalize(`${this._namespace}.${e}`)}capitalize(e){return e.split(".").map(this.capitalizeWord).join(".")}capitalizeWord(e){return e.charAt(0).toUpperCase()+e.slice(1)}constructor(e,t,i=!1,o=new mu.M){this.kpisEnabled=i,this._oTelTelemetryLogger=o;const{logGroupName:r,tenant:n}=e,{tenantName:s,ariaTenantToken:a,nexusTenantToken:l}=n;this._logGroupName=r,this._oTelTelemetryLogger.addSink(t),this._oTelTelemetryLogger.setTenantToken(`Office.${s}`,a,l),this._namespace=`Office.${s}.${r}`}}wu.DEFAULT_SAMPLING_POLICY=au.SamplingPolicy.Measure,wu.DEFAULT_DIAGNOSTIC_LEVEL=au.DiagnosticLevel.RequiredServiceData,wu.DEFAULT_DATA_CATEGORIES=au.DataCategories.ProductServiceUsage;var Au;!function(e){e.Host="Host",e.CorrectionsOfferLevel="CorrectionsOfferLevel",e.RefinementsOfferLevel="RefinementsOfferLevel",e.SimilarityOfferLevel="SimilarityOfferLevel",e.WritingAnalyticsOfferLevel="WritingAnalyticsOfferLevel",e.BxPromoOffer="BxPromoOffer",e.GoalsOfferLevel="GoalsOfferLevel",e.FirstRunExperienceOffer="FirstRunExperienceOffer",e.TonalRewriteFreOffer="TonalRewriteFreOffer",e.EditorScoreOfferLevel="EditorScoreOfferLevel",e.EditorScoreCategoryLevel="EditorScoreCategoryLevel",e.SkittleOfferLevel="SkittleOfferLevel",e.SkittleCategoryLevel="SkittleCategoryLevel",e.AIFeedbackSkittleOfferLevel="AiFeedbackSkittleOfferLevel",e.AIFeedbackSkittleCatgoryLevel="AiFeedbackSkittleCategoryLevel",e.CorrectionsCategoryLevel="CorrectionsCategoryLevel",e.GoalsCategoryLevel="GoalsCategoryLevel",e.RefinementsCategoryLevel="RefinementsCategoryLevel",e.SimilarityCategoryLevel="SimilarityCategoryLevel",e.WritingAnalyticsCategoryLevel="WritingAnalyticsCategoryLevel",e.CorrectionsSuggestionLevel="CorrectionsSuggestionLevel",e.RefinementsSuggestionLevel="RefinementsSuggestionLevel",e.SimilaritySuggestionLevel="SimilaritySuggestionLevel",e.WritingAnalyticsSuggestionLevel="WritingAnalyticsSuggestionLevel",e.ContentCreationSummaryOfferLevel="ContentCreationSummaryOfferLevel",e.ContentCreationSummaryCategoryLevel="ContentCreationSummaryCategoryLevel",e.ContentCreationWritersUnblockOfferLevel="ContentCreationWritersUnblockOfferLevel",e.ContentCreationWritersUnblockCategoryLevel="ContentCreationWritersUnblockCategoryLevel"}(Au||(Au={}));const Du={critiqueUiType:$l.EditorScore,kpiGroupOfferLevel:Au.EditorScoreOfferLevel,kpiGroupCategoryLevel:Au.EditorScoreCategoryLevel,isPremium:!1},Eu={critiqueUiType:$l.Skittle,kpiGroupOfferLevel:Au.SkittleOfferLevel,kpiGroupCategoryLevel:Au.SkittleCategoryLevel,isPremium:!1},Mu={critiqueUiType:$l.Goals,kpiGroupOfferLevel:Au.GoalsOfferLevel,kpiGroupCategoryLevel:Au.GoalsCategoryLevel,isPremium:!0},Lu={critiqueUiType:$l.FirstRunExperience,kpiGroupOfferLevel:Au.FirstRunExperienceOffer,kpiGroupCategoryLevel:Au.FirstRunExperienceOffer,isPremium:!1},Ru={critiqueUiType:$l.Corrections,kpiGroupOfferLevel:Au.CorrectionsOfferLevel,kpiGroupCategoryLevel:Au.CorrectionsCategoryLevel,kpiGroupSuggestionLevel:Au.CorrectionsSuggestionLevel,isPremium:!1},Ou={critiqueUiType:$l.Refinements,kpiGroupOfferLevel:Au.RefinementsOfferLevel,kpiGroupCategoryLevel:Au.RefinementsCategoryLevel,kpiGroupSuggestionLevel:Au.RefinementsSuggestionLevel,isPremium:!0},Fu={critiqueUiType:$l.WritingAnalytics,kpiGroupOfferLevel:Au.WritingAnalyticsOfferLevel,kpiGroupCategoryLevel:Au.WritingAnalyticsCategoryLevel,kpiGroupSuggestionLevel:Au.WritingAnalyticsSuggestionLevel,isPremium:!1},Bu={critiqueUiType:$l.Similarity,kpiGroupOfferLevel:Au.SimilarityOfferLevel,kpiGroupCategoryLevel:Au.SimilarityCategoryLevel,kpiGroupSuggestionLevel:Au.SimilaritySuggestionLevel,isPremium:!0},Nu={critiqueUiType:$l.BxPromo,kpiGroupOfferLevel:Au.BxPromoOffer,isPremium:!1},ju={critiqueUiType:$l.TonalRewriteFre,kpiGroupOfferLevel:Au.TonalRewriteFreOffer,isPremium:!0},Hu={critiqueUiType:$l.ContentCreation,kpiGroupOfferLevel:Au.ContentCreationSummaryOfferLevel,kpiGroupCategoryLevel:Au.ContentCreationSummaryCategoryLevel,isPremium:false},Pu={critiqueUiType:$l.ContentCreation,kpiGroupOfferLevel:Au.ContentCreationWritersUnblockOfferLevel,kpiGroupCategoryLevel:Au.ContentCreationWritersUnblockCategoryLevel,isPremium:false},zu={critiqueUiType:$l.Skittle,kpiGroupOfferLevel:Au.AIFeedbackSkittleOfferLevel,kpiGroupCategoryLevel:Au.AIFeedbackSkittleCatgoryLevel,isPremium:!0};class Uu{mapCategoryToCritiqueUiType(e){const t=this.getCategoryMapping(e);return t?t.critiqueUiType:$l.Unknown}mapCategoryToKpiGroups(e){const t=this.getCategoryMapping(e);return Object.assign({},t)}isKPIGroupPremium(e){const t=this._kpiGroupPremiumMap.get(e);return void 0===t?(this._logger.logEvent(553944021,"InvalidKpiGroupPremiumMapping",Yc.h.Host,Qc.q.Error,e),!1):t}getCategoryMapping(e){const t=this._mapCritiqueCategoryToUiType.get(e);return t||this._logger.logEvent(559019996,"InvalidProofingCategoryMapped",Yc.h.Proofing,Qc.q.Error,e),t}constructor(e){this._logger=e,this._mapCritiqueCategoryToUiType=new Map([[Jl.EditorScore,Du],[Jl.Skittle,Eu],[Jl.Goals,Mu],[Jl.Grammar,Ru],[Jl.Spelling,Ru],[Jl.DictationCorrections,Ru],[Jl.Acronyms,Ou],[Jl.Clarity,Ou],[Jl.Conciseness,Ou],[Jl.Formality,Ou],[Jl.Inclusiveness,Ou],[Jl.Perspectives,Ou],[Jl.PunctuationConventions,Ou],[Jl.Resume,Ou],[Jl.SensitiveGeopoliticalReferences,Ou],[Jl.Topics,Ou],[Jl.Vocabulary,Ou],[Jl.TonalRewrite,Ou],[Jl.Stats,Fu],[Jl.StatsInEditor,Fu],[Jl.StatsInRibbon,Fu],[Jl.StatsInStatusBar,Fu],[Jl.TopProofingIssues,Fu],[Jl.Similarity,Bu],[Jl.FirstRunExperience,Lu],[Jl.BxPromo,Nu],[Jl.TonalRewriteFre,ju],[Jl.ContentCreationSummary,Hu],[Jl.ContentCreationWritersUnblock,Pu],[Jl.AiFeedbackSkittle,zu]]),this.createKpiGroupPremiumMap=()=>{const e=new Map;return this._mapCritiqueCategoryToUiType.forEach((t=>{t.kpiGroupCategoryLevel&&e.set(t.kpiGroupCategoryLevel,t.isPremium),t.kpiGroupOfferLevel&&e.set(t.kpiGroupOfferLevel,t.isPremium),t.kpiGroupSuggestionLevel&&e.set(t.kpiGroupSuggestionLevel,t.isPremium)})),e.set(Au.Host,false),e},this._kpiGroupPremiumMap=this.createKpiGroupPremiumMap()}}class Wu{logOffered(e,t,i){const o=xd.Offered;this.hasLoggedEngagement(t,e,o)||this.logEngagement(e,t,o,i)}logSeen(e,t,i,o,r){const n=xd.Seen;o&&this.completeChain(e,t,n,i),this.hasLoggedEngagement(t,e,n)||(r||this.hasLoggedEngagement(t,e,xd.Offered)?this.logEngagement(e,t,n,i):this._logger.logEvent(571524805,"LoggedSeenWithoutOffered",Yc.h.Host,Qc.q.Error,{entityId:e,kpiGroup:t}))}logTried(e,t,i,o,r){const n=xd.Tried;o&&this.completeChain(e,t,n,i),this.hasLoggedEngagement(t,e,n)||(r||this.hasLoggedEngagement(t,e,xd.Seen)?this.logEngagement(e,t,n,i):this._logger.logEvent(571524806,"LoggedTriedWithoutSeen",Yc.h.Host,Qc.q.Error,{entityId:e,kpiGroup:t}))}logKept(e,t,i,o,r){const n=xd.Kept;this.logKeptOrRejected(n,e,t,i,o,r)}logRejected(e,t,i,o,r){const n=xd.Rejected;this.logKeptOrRejected(n,e,t,i,o,r)}logKeptOrRejected(e,t,i,o,r,n){r&&this.completeChain(t,i,e,o),this.hasLoggedEngagement(i,t,e)||(n||this.validateKeptOrRejectedForEntity(t,i,e))&&this.logEngagement(t,i,e,o)}logEngagement(e,t,i,o){const r=this._featureCategoryMapper.isKPIGroupPremium(t);this._logger.logKpi(t,e,i,r,o),this.storeLoggedEngagement(t,e,i),this._loggedEngagements.get(Wu.HOST_ENTITY_ID).has(i)||(this._logger.logKpi(Au.Host,Wu.HOST_ENTITY_ID,i,!1),this._loggedEngagements.get(Wu.HOST_ENTITY_ID).add(i))}storeLoggedEngagement(e,t,i){const o=Wu.getIdentifierForEntityInGroup(t,e);this._loggedEngagements.has(o)||this._loggedEngagements.set(o,new Set),this._loggedEngagements.get(o).add(i)}hasLoggedEngagement(e,t,i){const o=Wu.getIdentifierForEntityInGroup(t,e),r=this._loggedEngagements.get(o);return!!r&&r.has(i)}completeChain(e,t,i,o){i!==xd.Offered&&(this.logOffered(e,t,o),i!==xd.Seen&&(this.logSeen(e,t,o,!1),i!==xd.Tried&&this.logTried(e,t,o,!1)))}validateKeptOrRejectedForEntity(e,t,i){return!!this.hasLoggedEngagement(t,e,xd.Tried)||(this._logger.logEvent(571524807,"LoggedKeptOrRejectedWithoutTried",Yc.h.Host,Qc.q.Error,{entityId:e,kpiGroup:t,engagement:i}),!1)}static getIdentifierForEntityInGroup(e,t){return`${t}.${e}`}constructor(e,t){this._logger=e,this._featureCategoryMapper=t,this._loggedEngagements=new Map,this._loggedEngagements.set(Wu.HOST_ENTITY_ID,new Set)}}var Gu;Wu.HOST_ENTITY_ID="KpiTracker",function(e){e.Offer="Offer",e.Readability="Readability",e.DistinctWords="DistinctWords",e.TimeToRead="TimeToRead",e.TimeToSpeak="TimeToSpeak",e.Navigation="Navigation",e.Similarity="Similarity",e.Stats="Stats",e.FormalityGoal="FormalityGoal",e.TopProofingIssues="TopProofingIssues",e.EditorScore="EditorScore",e.Skittle="Skittle"}(Gu||(Gu={}));class _u{logCategoryOfferedAcrossLevels(e){if(this.shouldSkipCategory(e))return;const{offerLevelKpiGroup:t,offerLevelEntityId:i,categoryLevelKpiGroup:o,categoryLevelEntityId:r}=this.getOnCanvasItemKpiParamsAcrossLevels(e);r&&o&&this._kpiTracker.logOffered(r,o,void 0),i&&t&&this._kpiTracker.logOffered(i,t,void 0)}logCategorySeenAcrossLevels(e){var t;if(this.shouldSkipCategory(e))return;const{offerLevelKpiGroup:i,offerLevelEntityId:o,categoryLevelKpiGroup:r,categoryLevelEntityId:n}=this.getOnCanvasItemKpiParamsAcrossLevels(e);n&&r&&(this._kpiTracker.logSeen(n,r,void 0,!0),null===(t=this._scorecardMetric)||void 0===t||t.call(this,r,xd.Seen)),o&&i&&this._kpiTracker.logSeen(o,i,void 0,!0)}logCategoryTriedAcrossLevels(e){var t;if(this.shouldSkipCategory(e))return;const{offerLevelKpiGroup:i,offerLevelEntityId:o,categoryLevelKpiGroup:r,categoryLevelEntityId:n}=this.getOnCanvasItemKpiParamsAcrossLevels(e);n&&r&&(this._kpiTracker.logTried(n,r,void 0,!0),null===(t=this._scorecardMetric)||void 0===t||t.call(this,r,xd.Tried)),o&&i&&this._kpiTracker.logTried(o,i,void 0,!0)}logOnCanvasItemSeenAcrossLevels(e){const t=e.category;if(this.shouldSkipCategory(t))return;const{offerLevelKpiGroup:i,offerLevelEntityId:o,categoryLevelKpiGroup:r,categoryLevelEntityId:n,suggestionLevelKpiGroup:s,suggestionLevelEntityId:a,suggestionLevelData:l}=this.getOnCanvasItemKpiParamsAcrossLevels(t,e.annotationId);a&&s&&this._kpiTracker.logSeen(a,s,this.itemLogData(l,e),!0),n&&r&&this._kpiTracker.logSeen(n,r,void 0,!0),o&&i&&this._kpiTracker.logSeen(o,i,void 0,!0)}logCategoryKeptAcrossLevels(e){this.logonCanvasItemKeptAcrossLevels({category:e,annotationId:""})}logCategoryRejectedAcrossLevels(e){this.logOnCanvasItemRejectedAcrossLevels({category:e,annotationId:""})}logonCanvasItemKeptAcrossLevels(e){var t;const i=e.category;if(this.shouldSkipCategory(i))return;const{offerLevelKpiGroup:o,offerLevelEntityId:r,categoryLevelKpiGroup:n,categoryLevelEntityId:s,suggestionLevelKpiGroup:a,suggestionLevelEntityId:l,suggestionLevelData:c}=this.getOnCanvasItemKpiParamsAcrossLevels(i,e.annotationId);l&&a&&(this._kpiTracker.logKept(l,a,this.itemLogData(c,e),!0),null===(t=this._scorecardMetric)||void 0===t||t.call(this,a,xd.Kept)),s&&n&&this._kpiTracker.logKept(s,n,void 0,!0),r&&o&&this._kpiTracker.logKept(r,o,void 0,!0)}logOnCanvasItemRejectedAcrossLevels(e){var t;const i=e.category;if(this.shouldSkipCategory(i))return;const{offerLevelKpiGroup:o,offerLevelEntityId:r,categoryLevelKpiGroup:n,categoryLevelEntityId:s,suggestionLevelKpiGroup:a,suggestionLevelEntityId:l,suggestionLevelData:c}=this.getOnCanvasItemKpiParamsAcrossLevels(i,e.annotationId);l&&a&&(this._kpiTracker.logRejected(l,a,this.itemLogData(c,e),!0),null===(t=this._scorecardMetric)||void 0===t||t.call(this,a,xd.Rejected)),s&&n&&this._kpiTracker.logRejected(s,n,void 0,!0),r&&o&&this._kpiTracker.logRejected(r,o,void 0,!0)}getOnCanvasItemKpiParamsAcrossLevels(e,t){if(!qu(e))throw new Error("Unexpected on canvas item type category: "+e);const{kpiGroupOfferLevel:i,kpiGroupCategoryLevel:o,kpiGroupSuggestionLevel:r}=this._featureCategoryMapper.mapCategoryToKpiGroups(e),n=e.replace(/\s/g,"");let s,a;return t&&(s=t,a=e.replace(/\s/g,"")),{offerLevelKpiGroup:i,offerLevelEntityId:Gu.Offer,categoryLevelKpiGroup:o,categoryLevelEntityId:n,suggestionLevelKpiGroup:r,suggestionLevelEntityId:s,suggestionLevelData:a}}shouldSkipCategory(e){return this._featureCategoryMapper.mapCategoryToCritiqueUiType(e)===$l.Disabled}itemLogData(e,t){const i={category:e,type:t.typeId,language:t.language,suggestionCount:t.suggestionCount};return this._getAdditionalLogData&&Object.assign(i,this._getAdditionalLogData()),i}constructor(e,t,i,o){this._featureCategoryMapper=e,this._kpiTracker=t,this._scorecardMetric=i,this._getAdditionalLogData=o}}const qu=e=>Object.keys(Jl).map((e=>Jl[e])).includes(e);var Vu=i(29105);class Zu{init(){const e=new wu({logGroupName:"IdeasInWord",tenant:{tenantName:"NaturalLanguage",ariaTenantToken:"71cc1046851042108843d90e5d3ef6c1-61e5de5c-238c-4de5-95de-3b40d20ea6e5-6899",nexusTenantToken:1733},defaultEventName:"",logToConsole:!0,logToKusto:!0},{sendTelemetryEvent:e=>{const t={otelEvent:e};(0,Bl.sendOtelEvent)(t)}},!0),t=new Uu(e),i=new Wu(e,t),o=new _u(t,i);this.setEditorTheme(),(0,Er.TV)(this.setEditorTheme),function(e){Yl=e}(o),(0,Kc.L)(e),(0,hs.Y)(new ms.F),(0,hs.$)().loadLocale(this._params.uiCulture??"en-US"),this._ulsLogger.sendTraceTag(557061700,d.n.msoulscat_Wac_Telemetry,u.k.Info,"Editor initialized!")}constructor(e){this._params=e,this.setEditorTheme=()=>{const e=en.o3.getInstance().getThemeMode()===en.bx.Dark?Vu.bx.Dark:Vu.bx.Light;(0,Vu.Yl)(e)},this._ulsLogger=this._params.ulsLogger}}const Ku=new class{getWordContextualControllerInstance(e){if(e)return e.ulsLogger&&c.Hv.setLogger(e.ulsLogger),c.Hv.sendTraceTag(595858313,d.n.msoulscat_Wac_Telemetry,u.k.Info,"Canvas contextual factory requested."),Gl.createController(e)}getSkittleControllerV2Instance(e){return e.ulsLogger&&c.Hv.setLogger(e.ulsLogger),c.Hv.sendTraceTag(529073372,d.n.msoulscat_Wac_Telemetry,u.k.Info,"Canvas contextual factory requested for Skittle Controller."),new vd(e.ulsLogger)}getEditorInitializerInstance(e){return e.ulsLogger&&c.Hv.setLogger(e.ulsLogger),c.Hv.sendTraceTag(557061699,d.n.msoulscat_Wac_Telemetry,u.k.Info,"Canvas contextual factory requested for Editor Initializer."),new Zu(e)}getAIFeedbackSkittleControllerInstance(e){return e.ulsLogger&&c.Hv.setLogger(e.ulsLogger),c.Hv.sendTraceTag(509366921,d.n.msoulscat_Wac_Telemetry,u.k.Info,"Canvas contextual factory requested for AI Feedback Skittle Controller."),new su(e.ulsLogger)}};(0,n.N)()},91501:function(e,t,i){var o={"./af-ZA/canvas-contextual.json":[78368,6297],"./am-ET/canvas-contextual.json":[55031,35068],"./ar-SA/canvas-contextual.json":[68149,55622],"./as-IN/canvas-contextual.json":[78183,17936],"./az-Latn-AZ/canvas-contextual.json":[1070,11153],"./be-BY/canvas-contextual.json":[10118,13695],"./bg-BG/canvas-contextual.json":[53298,33879],"./bn-BD/canvas-contextual.json":[48734,70095],"./bn-IN/canvas-contextual.json":[6884,16268],"./bs-Latn-BA/canvas-contextual.json":[18712,8991],"./ca-ES/canvas-contextual.json":[96584,13113],"./ca-Es-VALENCIA/canvas-contextual.json":[14658,48129],"./chr-Cher-US/canvas-contextual.json":[87438,17283],"./cs-CZ/canvas-contextual.json":[49087,39188],"./cy-GB/canvas-contextual.json":[95429,24638],"./da-DK/canvas-contextual.json":[44712,37005],"./de-DE/canvas-contextual.json":[36237,60327],"./el-GR/canvas-contextual.json":[93206,4895],"./en-GB/canvas-contextual.json":[64272,14109],"./en-US/canvas-contextual.json":[29657,13766],"./es-ES/canvas-contextual.json":[62084,69785],"./es-MX/canvas-contextual.json":[25285,68782],"./et-EE/canvas-contextual.json":[86873,59394],"./eu-ES/canvas-contextual.json":[99506,37179],"./fa-IR/canvas-contextual.json":[95176,65073],"./fi-FI/canvas-contextual.json":[10514,51307],"./fil-PH/canvas-contextual.json":[64437,3660],"./fr-CA/canvas-contextual.json":[53048,91517],"./fr-FR/canvas-contextual.json":[52396,70221],"./ga-IE/canvas-contextual.json":[71910,43791],"./gd-gb/canvas-contextual.json":[84784,34801],"./gl-ES/canvas-contextual.json":[78049,87250],"./gu-IN/canvas-contextual.json":[55431,57652],"./ha-Latn-NG/canvas-contextual.json":[20494,36173],"./he-IL/canvas-contextual.json":[59204,12557],"./hi-IN/canvas-contextual.json":[95858,94763],"./hr-HR/canvas-contextual.json":[51164,62025],"./hu-HU/canvas-contextual.json":[10938,93591],"./hy-AM/canvas-contextual.json":[82847,52660],"./id-ID/canvas-contextual.json":[52482,21767],"./is-IS/canvas-contextual.json":[41532,98705],"./it-IT/canvas-contextual.json":[94306,37607],"./ja-JP/canvas-contextual.json":[98529,23174],"./ka-GE/canvas-contextual.json":[17192,31061],"./kk-KZ/canvas-contextual.json":[19639,94316],"./km-KH/canvas-contextual.json":[94595,40388],"./kn-IN/canvas-contextual.json":[74856,91217],"./ko-KR/canvas-contextual.json":[2787,7024],"./kok-IN/canvas-contextual.json":[64610,10753],"./ky-KG/canvas-contextual.json":[47950,38835],"./lb-LU/canvas-contextual.json":[60817,35018],"./lo-LA/canvas-contextual.json":[30924,63317],"./lt-LT/canvas-contextual.json":[45192,61729],"./lv-LV/canvas-contextual.json":[41404,82417],"./mi-NZ/canvas-contextual.json":[51158,11119],"./mk-MK/canvas-contextual.json":[29572,14649],"./ml-IN/canvas-contextual.json":[8940,29121],"./mn-MN/canvas-contextual.json":[42958,54855],"./mr-IN/canvas-contextual.json":[20926,56903],"./ms-MY/canvas-contextual.json":[18030,57939],"./mt-MT/canvas-contextual.json":[18282,80511],"./nb-NO/canvas-contextual.json":[9311,22508],"./ne-NP/canvas-contextual.json":[10141,47858],"./nl-NL/canvas-contextual.json":[68808,57173],"./nn-NO/canvas-contextual.json":[53947,55952],"./or-IN/canvas-contextual.json":[77464,31302],"./pa-IN/canvas-contextual.json":[34626,12411],"./pl-PL/canvas-contextual.json":[86928,37641],"./prs-AF/canvas-contextual.json":[3038,15905],"./pt-BR/canvas-contextual.json":[51556,33105],"./pt-PT/canvas-contextual.json":[65168,72137],"./qps-ploc/canvas-contextual.json":[38440,79067],"./qps-ploca/canvas-contextual.json":[60441,3242],"./qps-plocm/canvas-contextual.json":[72061,33606],"./quz-PE/canvas-contextual.json":[83952,42958],"./ro-RO/canvas-contextual.json":[74114,57799],"./ru-RU/canvas-contextual.json":[69346,41403],"./sd-Arab-PK/canvas-contextual.json":[50127,65202],"./si-LK/canvas-contextual.json":[13389,27750],"./sk-SK/canvas-contextual.json":[64432,64281],"./sl-SI/canvas-contextual.json":[33729,40910],"./sq-AL/canvas-contextual.json":[75377,48334],"./sr-Cyrl-BA/canvas-contextual.json":[53351,56022],"./sr-Cyrl-RS/canvas-contextual.json":[30401,15620],"./sr-Latn-RS/canvas-contextual.json":[21036,39003],"./sv-SE/canvas-contextual.json":[50135,39776],"./sw-KE/canvas-contextual.json":[97810,84547],"./ta-IN/canvas-contextual.json":[79126,67263],"./te-IN/canvas-contextual.json":[17626,54467],"./th-TH/canvas-contextual.json":[56176,22537],"./tk-TM/canvas-contextual.json":[18780,17765],"./tr-TR/canvas-contextual.json":[91436,67305],"./tt-RU/canvas-contextual.json":[31605,89854],"./ug-CN/canvas-contextual.json":[78893,18858],"./uk-UA/canvas-contextual.json":[430,5491],"./ur-PK/canvas-contextual.json":[78788,84553],"./uz-Latn-UZ/canvas-contextual.json":[1974,9193],"./vi-VN/canvas-contextual.json":[19235,51128],"./zh-CN/canvas-contextual.json":[48039,42804],"./zh-TW/canvas-contextual.json":[19063,14356]};function r(e){if(!i.o(o,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=o[e],r=t[0];return i.e(t[1]).then((function(){return i.t(r,19)}))}r.keys=function(){return Object.keys(o)},r.id=91501,e.exports=r}}]);
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/canvasContextual.min.js.map/b95796f1ad8b2a608d5dcaf897bf0334/canvasContextual.min.js.map